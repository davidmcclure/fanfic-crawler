11:45:39 RQ worker 'rq:worker:CESTA-F5KN902TF694.41366' started, version 0.7.0
11:45:39 Cleaning registries for queue: chapters
11:45:39 Cleaning registries for queue: profiles
11:45:39 Cleaning registries for queue: reviews
11:45:39 
11:45:39 *** Listening on chapters, profiles, reviews...
11:45:39 reviews: fanfic.jobs.crawl_reviews(10131915) (42b4cfaa-dcf6-4314-a99e-ea01ca7e6af4)
11:47:56 reviews: Job OK (42b4cfaa-dcf6-4314-a99e-ea01ca7e6af4)
11:47:56 Result is kept for 500 seconds
11:47:56 
11:47:56 *** Listening on chapters, profiles, reviews...
11:47:56 reviews: fanfic.jobs.crawl_reviews(10132840) (2e1acda8-36e0-4304-8b63-502a6c47854e)
11:48:57 reviews: Job OK (2e1acda8-36e0-4304-8b63-502a6c47854e)
11:48:57 Result is kept for 500 seconds
11:48:57 
11:48:57 *** Listening on chapters, profiles, reviews...
11:48:57 reviews: fanfic.jobs.crawl_reviews(10133905) (41e47629-f91e-4b3e-9f95-390c01b07a04)
11:49:47 reviews: Job OK (41e47629-f91e-4b3e-9f95-390c01b07a04)
11:49:47 Result is kept for 500 seconds
11:49:47 
11:49:47 *** Listening on chapters, profiles, reviews...
11:49:47 reviews: fanfic.jobs.crawl_reviews(10134481) (40a42e36-88a4-4b66-a58d-318588e630c6)
11:51:54 reviews: Job OK (40a42e36-88a4-4b66-a58d-318588e630c6)
11:51:54 Result is kept for 500 seconds
11:51:54 
11:51:54 *** Listening on chapters, profiles, reviews...
11:51:54 reviews: fanfic.jobs.crawl_reviews(10134610) (1d236814-fd2f-4c10-96fb-b4947d648c33)
11:54:39 reviews: Job OK (1d236814-fd2f-4c10-96fb-b4947d648c33)
11:54:39 Result is kept for 500 seconds
11:54:39 
11:54:39 *** Listening on chapters, profiles, reviews...
11:54:39 reviews: fanfic.jobs.crawl_reviews(10134950) (4f988f6d-535e-442e-a68a-55a902ae6a67)
11:55:25 reviews: Job OK (4f988f6d-535e-442e-a68a-55a902ae6a67)
11:55:25 Result is kept for 500 seconds
11:55:25 
11:55:25 *** Listening on chapters, profiles, reviews...
11:55:25 reviews: fanfic.jobs.crawl_reviews(10136172) (bec96e50-269a-46cc-901c-dd0f64d2b912)
12:13:30 reviews: Job OK (bec96e50-269a-46cc-901c-dd0f64d2b912)
12:13:30 Result is kept for 500 seconds
12:13:30 
12:13:30 *** Listening on chapters, profiles, reviews...
12:13:30 reviews: fanfic.jobs.crawl_reviews(10137157) (c6fd9ce6-6134-4b14-a442-3d83df1f7bdb)
12:13:54 reviews: Job OK (c6fd9ce6-6134-4b14-a442-3d83df1f7bdb)
12:13:54 Result is kept for 500 seconds
12:13:54 
12:13:54 *** Listening on chapters, profiles, reviews...
12:13:54 reviews: fanfic.jobs.crawl_reviews(10137876) (fbe52711-1ee3-471c-a4d4-456ce3d2bdad)
12:15:22 reviews: Job OK (fbe52711-1ee3-471c-a4d4-456ce3d2bdad)
12:15:22 Result is kept for 500 seconds
12:15:22 
12:15:22 *** Listening on chapters, profiles, reviews...
12:15:22 reviews: fanfic.jobs.crawl_reviews(10138430) (5c17db22-8371-45c2-97a5-d9875709d627)
12:15:54 reviews: Job OK (5c17db22-8371-45c2-97a5-d9875709d627)
12:15:54 Result is kept for 500 seconds
12:15:54 
12:15:54 *** Listening on chapters, profiles, reviews...
12:15:54 reviews: fanfic.jobs.crawl_reviews(10138549) (adc3ccae-4b1f-4dfb-89ce-5f635dc92276)
12:16:24 reviews: Job OK (adc3ccae-4b1f-4dfb-89ce-5f635dc92276)
12:16:24 Result is kept for 500 seconds
12:16:24 
12:16:24 *** Listening on chapters, profiles, reviews...
12:16:24 reviews: fanfic.jobs.crawl_reviews(10139126) (aa1fca84-6671-4f81-8be2-0665523258e5)
12:17:46 reviews: Job OK (aa1fca84-6671-4f81-8be2-0665523258e5)
12:17:46 Result is kept for 500 seconds
12:17:46 
12:17:46 *** Listening on chapters, profiles, reviews...
12:17:46 reviews: fanfic.jobs.crawl_reviews(10139565) (2163d62b-6ae9-4124-a346-74836b156c3e)
12:27:15 reviews: Job OK (2163d62b-6ae9-4124-a346-74836b156c3e)
12:27:15 Result is kept for 500 seconds
12:27:15 
12:27:15 *** Listening on chapters, profiles, reviews...
12:27:15 reviews: fanfic.jobs.crawl_reviews(10140062) (52801f12-626f-47e7-84ec-a62f0bc3dc28)
12:27:47 reviews: Job OK (52801f12-626f-47e7-84ec-a62f0bc3dc28)
12:27:47 Result is kept for 500 seconds
12:27:47 
12:27:47 *** Listening on chapters, profiles, reviews...
12:27:47 reviews: fanfic.jobs.crawl_reviews(10143791) (d3fee4bb-49a1-4703-8dad-df21d86dcfbb)
12:29:46 reviews: Job OK (d3fee4bb-49a1-4703-8dad-df21d86dcfbb)
12:29:46 Result is kept for 500 seconds
12:29:46 
12:29:46 *** Listening on chapters, profiles, reviews...
12:29:46 reviews: fanfic.jobs.crawl_reviews(10143901) (4622f410-781d-45e0-80ea-157c7668f122)
12:31:11 reviews: Job OK (4622f410-781d-45e0-80ea-157c7668f122)
12:31:11 Result is kept for 500 seconds
12:31:11 
12:31:11 *** Listening on chapters, profiles, reviews...
12:31:11 reviews: fanfic.jobs.crawl_reviews(10145048) (14a924c8-01e5-4322-922f-d7c185694bde)
12:33:41 reviews: Job OK (14a924c8-01e5-4322-922f-d7c185694bde)
12:33:41 Result is kept for 500 seconds
12:33:41 
12:33:41 *** Listening on chapters, profiles, reviews...
12:33:41 reviews: fanfic.jobs.crawl_reviews(10146711) (e2862774-3914-45b0-8a27-03233bae5079)
12:34:30 reviews: Job OK (e2862774-3914-45b0-8a27-03233bae5079)
12:34:30 Result is kept for 500 seconds
12:34:30 
12:34:30 *** Listening on chapters, profiles, reviews...
12:34:30 reviews: fanfic.jobs.crawl_reviews(10147172) (75d04ca3-38e1-4891-9442-9bf766b27a0c)
12:36:31 reviews: Job OK (75d04ca3-38e1-4891-9442-9bf766b27a0c)
12:36:31 Result is kept for 500 seconds
12:36:31 
12:36:31 *** Listening on chapters, profiles, reviews...
12:36:31 reviews: fanfic.jobs.crawl_reviews(10147354) (cf465cdb-3db9-43fe-8ada-e58d3dc034cf)
12:37:18 reviews: Job OK (cf465cdb-3db9-43fe-8ada-e58d3dc034cf)
12:37:18 Result is kept for 500 seconds
12:37:18 
12:37:18 *** Listening on chapters, profiles, reviews...
12:37:18 reviews: fanfic.jobs.crawl_reviews(10147901) (892997e7-c819-4ce0-9239-b1d2a19428e0)
12:37:33 reviews: Job OK (892997e7-c819-4ce0-9239-b1d2a19428e0)
12:37:33 Result is kept for 500 seconds
12:37:33 
12:37:33 *** Listening on chapters, profiles, reviews...
12:37:33 reviews: fanfic.jobs.crawl_reviews(10148818) (f9370e07-7236-4f0f-a46b-03837c53ec54)
2017-02-07 12:37:39 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 20:37:39.280061', 10148818, 210041260, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (568 characters truncated) ... 43845">10/31/2014</span> </small><div style="margin-top:5px">I love this story...I have read up until ch 17 and I cant stop so far.</div></td>\n</tr>'), ('2017-02-07 20:37:39.280066', 10148818, 204211724, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4819738&amp;r ... (897 characters truncated) ... chapter 21 . <span data-xutime="1405572566">7/16/2014</span> </small><div style="margin-top:5px">I am really glad how you did this.</div></td>\n</tr>'), ('2017-02-07 20:37:39.280068', 10148818, 203816839, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3672862&amp;r ... (1388 characters truncated) ... ot and destroying JK Rowling\'s genius, but instead blending them into it, all while truly creating people and not just characters.</div></td>\n</tr>'), ('2017-02-07 20:37:39.280070', 10148818, 196592906, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1503899&amp;r ... (929 characters truncated) ... span data-xutime="1394818371">3/14/2014</span> </small><div style="margin-top:5px">Loved this story! Can\'t wait for the sequel. :)</div></td>\n</tr>'), ('2017-02-07 20:37:39.280072', 10148818, 196246189, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4784850&amp;r ... (1214 characters truncated) ... to the sequel! :D Oh, and don\'t you worry about those grammar nazis, no one is perfect. It can be expected to miss a few things ;)</div></td>\n</tr>'), ('2017-02-07 20:37:39.280074', 10148818, 195843697, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (605 characters truncated) ... tyle="margin-top:5px">you have a good idea for this story, but your grammar needs edited a bit to make your fiction easier to read.</div></td>\n</tr>'), ('2017-02-07 20:37:39.280076', 10148818, 195762301, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (853 characters truncated) ... ing one but if readers cannot get past grammatical errors then they may just give up on the story. This is not a flame just advice.</div></td>\n</tr>'), ('2017-02-07 20:37:39.280078', 10148818, 210041260, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (568 characters truncated) ... 43845">10/31/2014</span> </small><div style="margin-top:5px">I love this story...I have read up until ch 17 and I cant stop so far.</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-07 20:37:39.280087', 10148818, 195843697, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (605 characters truncated) ... tyle="margin-top:5px">you have a good idea for this story, but your grammar needs edited a bit to make your fiction easier to read.</div></td>\n</tr>'), ('2017-02-07 20:37:39.280089', 10148818, 195762301, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (853 characters truncated) ... ing one but if readers cannot get past grammatical errors then they may just give up on the story. This is not a flame just advice.</div></td>\n</tr>'))]
12:37:39 reviews: Job OK (f9370e07-7236-4f0f-a46b-03837c53ec54)
12:37:39 Result is kept for 500 seconds
12:37:39 
12:37:39 *** Listening on chapters, profiles, reviews...
12:37:39 reviews: fanfic.jobs.crawl_reviews(10149880) (d9fe59d7-0baf-4076-9bfb-3322c3e3ba5c)
12:41:50 reviews: Job OK (d9fe59d7-0baf-4076-9bfb-3322c3e3ba5c)
12:41:50 Result is kept for 500 seconds
12:41:50 
12:41:50 *** Listening on chapters, profiles, reviews...
12:41:50 reviews: fanfic.jobs.crawl_reviews(10149952) (0bea6b55-7029-412e-abfe-384f9280422b)
12:42:21 reviews: Job OK (0bea6b55-7029-412e-abfe-384f9280422b)
12:42:21 Result is kept for 500 seconds
12:42:21 
12:42:21 *** Listening on chapters, profiles, reviews...
12:42:21 reviews: fanfic.jobs.crawl_reviews(10149954) (e024639b-d03b-454a-b797-4092424db403)
12:43:31 reviews: Job OK (e024639b-d03b-454a-b797-4092424db403)
12:43:31 Result is kept for 500 seconds
12:43:31 
12:43:31 *** Listening on chapters, profiles, reviews...
12:43:31 reviews: fanfic.jobs.crawl_reviews(10150331) (00157e9a-ab4a-4e20-88d1-0af3ec504f53)
12:45:08 reviews: Job OK (00157e9a-ab4a-4e20-88d1-0af3ec504f53)
12:45:08 Result is kept for 500 seconds
12:45:08 
12:45:08 *** Listening on chapters, profiles, reviews...
12:45:08 reviews: fanfic.jobs.crawl_reviews(10151973) (b7e741a7-257e-48ec-b215-1457f611e6f3)
12:45:24 reviews: Job OK (b7e741a7-257e-48ec-b215-1457f611e6f3)
12:45:24 Result is kept for 500 seconds
12:45:24 
12:45:24 *** Listening on chapters, profiles, reviews...
12:45:24 reviews: fanfic.jobs.crawl_reviews(10152281) (53a9bd2a-e1da-45ca-b9aa-d822c54903e7)
12:46:37 reviews: Job OK (53a9bd2a-e1da-45ca-b9aa-d822c54903e7)
12:46:37 Result is kept for 500 seconds
12:46:37 Cleaning registries for queue: chapters
12:46:37 Cleaning registries for queue: profiles
12:46:37 Cleaning registries for queue: reviews
12:46:37 
12:46:37 *** Listening on chapters, profiles, reviews...
12:46:37 reviews: fanfic.jobs.crawl_reviews(10153951) (093dcd81-7af4-4d1a-b061-246603cde625)
12:47:06 reviews: Job OK (093dcd81-7af4-4d1a-b061-246603cde625)
12:47:06 Result is kept for 500 seconds
12:47:06 
12:47:06 *** Listening on chapters, profiles, reviews...
12:47:06 reviews: fanfic.jobs.crawl_reviews(10154205) (1632a366-6370-46dc-b2eb-27e22417a123)
12:47:11 reviews: Job OK (1632a366-6370-46dc-b2eb-27e22417a123)
12:47:11 Result is kept for 500 seconds
12:47:11 
12:47:11 *** Listening on chapters, profiles, reviews...
12:47:11 reviews: fanfic.jobs.crawl_reviews(10154207) (bbde9a82-0908-41f4-b557-8fcde70c5024)
12:48:33 reviews: Job OK (bbde9a82-0908-41f4-b557-8fcde70c5024)
12:48:33 Result is kept for 500 seconds
12:48:33 
12:48:33 *** Listening on chapters, profiles, reviews...
12:48:33 reviews: fanfic.jobs.crawl_reviews(10155733) (d172aab9-b9ee-4892-a5e3-f9198c929a1f)
12:51:04 reviews: Job OK (d172aab9-b9ee-4892-a5e3-f9198c929a1f)
12:51:04 Result is kept for 500 seconds
12:51:04 
12:51:04 *** Listening on chapters, profiles, reviews...
12:51:04 reviews: fanfic.jobs.crawl_reviews(10157331) (6104605f-6944-4d47-b216-d8eba5f2ff30)
12:52:04 reviews: Job OK (6104605f-6944-4d47-b216-d8eba5f2ff30)
12:52:04 Result is kept for 500 seconds
12:52:04 
12:52:04 *** Listening on chapters, profiles, reviews...
12:52:04 reviews: fanfic.jobs.crawl_reviews(10157608) (c7f22800-4c4c-4c33-b621-c36a6ff81090)
12:52:41 reviews: Job OK (c7f22800-4c4c-4c33-b621-c36a6ff81090)
12:52:41 Result is kept for 500 seconds
12:52:41 
12:52:41 *** Listening on chapters, profiles, reviews...
12:52:41 reviews: fanfic.jobs.crawl_reviews(10158575) (94781fd2-ac8f-489a-99ff-10fdb494a976)
12:53:17 reviews: Job OK (94781fd2-ac8f-489a-99ff-10fdb494a976)
12:53:17 Result is kept for 500 seconds
12:53:17 
12:53:17 *** Listening on chapters, profiles, reviews...
12:53:17 reviews: fanfic.jobs.crawl_reviews(10159229) (5c4b88c8-ee41-4466-a8d0-ed849886509d)
12:53:38 reviews: Job OK (5c4b88c8-ee41-4466-a8d0-ed849886509d)
12:53:38 Result is kept for 500 seconds
12:53:38 
12:53:38 *** Listening on chapters, profiles, reviews...
12:53:38 reviews: fanfic.jobs.crawl_reviews(10159789) (914b295d-a2e3-4fcd-8fd7-2b2d54788ca8)
12:55:10 reviews: Job OK (914b295d-a2e3-4fcd-8fd7-2b2d54788ca8)
12:55:10 Result is kept for 500 seconds
12:55:10 
12:55:10 *** Listening on chapters, profiles, reviews...
12:55:10 reviews: fanfic.jobs.crawl_reviews(10161175) (f9359a72-a346-4fd0-8f02-70767a6fdc3f)
12:55:16 reviews: Job OK (f9359a72-a346-4fd0-8f02-70767a6fdc3f)
12:55:16 Result is kept for 500 seconds
12:55:16 
12:55:16 *** Listening on chapters, profiles, reviews...
12:55:16 reviews: fanfic.jobs.crawl_reviews(10161217) (79d7377b-d199-4b39-8379-4d7d1520cdce)
12:57:03 reviews: Job OK (79d7377b-d199-4b39-8379-4d7d1520cdce)
12:57:03 Result is kept for 500 seconds
12:57:03 
12:57:03 *** Listening on chapters, profiles, reviews...
12:57:03 reviews: fanfic.jobs.crawl_reviews(10161270) (d981f22d-3261-48a5-816c-dfc2f428d235)
12:57:52 reviews: Job OK (d981f22d-3261-48a5-816c-dfc2f428d235)
12:57:52 Result is kept for 500 seconds
12:57:52 
12:57:52 *** Listening on chapters, profiles, reviews...
12:57:52 reviews: fanfic.jobs.crawl_reviews(10161421) (027cd0ac-b33f-4bff-a93b-24c62205337c)
12:58:04 reviews: Job OK (027cd0ac-b33f-4bff-a93b-24c62205337c)
12:58:04 Result is kept for 500 seconds
12:58:04 
12:58:04 *** Listening on chapters, profiles, reviews...
12:58:04 reviews: fanfic.jobs.crawl_reviews(10161569) (7e618fc7-ade4-4c2f-ab58-4eacc491b3d3)
12:58:50 reviews: Job OK (7e618fc7-ade4-4c2f-ab58-4eacc491b3d3)
12:58:50 Result is kept for 500 seconds
12:58:50 
12:58:50 *** Listening on chapters, profiles, reviews...
12:58:50 reviews: fanfic.jobs.crawl_reviews(10162011) (087dddd0-940c-48be-b43d-0a7499c0e54f)
12:59:04 reviews: Job OK (087dddd0-940c-48be-b43d-0a7499c0e54f)
12:59:04 Result is kept for 500 seconds
12:59:04 
12:59:04 *** Listening on chapters, profiles, reviews...
12:59:04 reviews: fanfic.jobs.crawl_reviews(10162407) (0d82e72d-1d5d-4ba1-8839-860651bea0d2)
2017-02-07 12:59:10 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 20:59:10.612179', 10162407, 215194502, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3328399&amp;r ... (877 characters truncated) ... 015</span> </small><div style="margin-top:5px">Holy crap! My heart just stopped for a second Pru found the two. Please Update Soon!</div></td>\n</tr>'), ('2017-02-07 20:59:10.612183', 10162407, 214391507, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2142886&amp;r ... (1054 characters truncated) ... nt Slytherin who\'s childhood friend was the Slytherin prince himself. A great premise, I can\'t wait to see what you do with this.</div></td>\n</tr>'), ('2017-02-07 20:59:10.612186', 10162407, 210461754, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (663 characters truncated) ... nd I already love it. I really hope you\'ll update regularly cause I\'m just dying to know what happens next. Keep up the good work</div></td>\n</tr>'), ('2017-02-07 20:59:10.612188', 10162407, 210384526, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5664923&amp;r ... (838 characters truncated) ...  . <span data-xutime="1415330802">11/6/2014</span> </small><div style="margin-top:5px">AHHH! this story is so good! love love love!</div></td>\n</tr>'), ('2017-02-07 20:59:10.612190', 10162407, 206111408, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5569416&amp;r ... (1720 characters truncated) ... , the Beatles? Charmed? To each their own. Last, the granddaughter thing comes in. Still, fully appreciate your critique, thanks :)</div></td>\n</tr>'), ('2017-02-07 20:59:10.612192', 10162407, 206097212, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (636 characters truncated) ... ">I have a sick mind...but you dont. So thanks for posting this, because not only it is a love story, but its a well written story.</div></td>\n</tr>'), ('2017-02-07 20:59:10.612194', 10162407, 206097126, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (554 characters truncated) ... <span data-xutime="1408168832">8/15/2014</span> </small><div style="margin-top:5px">Luv draco nd prudence togethr they go so well 3</div></td>\n</tr>'), ('2017-02-07 20:59:10.612196', 10162407, 206097067, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (584 characters truncated) ... 4</span> </small><div style="margin-top:5px">I..love..this..fanfic. pls keep on writing, and your work here is utterly astonishing!</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-07 20:59:10.612235', 10162407, 199635031, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4194680&amp;r ... (889 characters truncated) ...  style="margin-top:5px">I really enjoy your story. Its very well written and extremely interesting. Cant wait for the next chapter!</div></td>\n</tr>'), ('2017-02-07 20:59:10.612237', 10162407, 196509701, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2797023&amp;r ... (913 characters truncated) ... pter 1 . <span data-xutime="1394681442">3/12/2014</span> </small><div style="margin-top:5px">This is looking very promising so far!</div></td>\n</tr>'))]
12:59:10 reviews: Job OK (0d82e72d-1d5d-4ba1-8839-860651bea0d2)
12:59:10 Result is kept for 500 seconds
12:59:10 
12:59:10 *** Listening on chapters, profiles, reviews...
12:59:10 reviews: fanfic.jobs.crawl_reviews(10162504) (9ee825a3-a604-4116-8ac1-576591e603f3)
12:59:33 reviews: Job OK (9ee825a3-a604-4116-8ac1-576591e603f3)
12:59:33 Result is kept for 500 seconds
12:59:33 
12:59:33 *** Listening on chapters, profiles, reviews...
12:59:33 reviews: fanfic.jobs.crawl_reviews(10164884) (f3d6907c-7e12-4eaf-8e8f-25cf59c69a75)
13:00:34 reviews: Job OK (f3d6907c-7e12-4eaf-8e8f-25cf59c69a75)
13:00:34 Result is kept for 500 seconds
13:00:34 
13:00:34 *** Listening on chapters, profiles, reviews...
13:00:34 reviews: fanfic.jobs.crawl_reviews(10165967) (8b572823-4b4d-4adb-b710-e27b21b84ad1)
13:01:26 reviews: Job OK (8b572823-4b4d-4adb-b710-e27b21b84ad1)
13:01:26 Result is kept for 500 seconds
13:01:26 
13:01:26 *** Listening on chapters, profiles, reviews...
13:01:26 reviews: fanfic.jobs.crawl_reviews(10166713) (70835142-555c-436f-9703-e82ff3ebc582)
13:01:39 reviews: Job OK (70835142-555c-436f-9703-e82ff3ebc582)
13:01:39 Result is kept for 500 seconds
13:01:39 
13:01:39 *** Listening on chapters, profiles, reviews...
13:01:39 reviews: fanfic.jobs.crawl_reviews(10167803) (36d00e6b-62a7-41e5-b202-19cab56896dc)
13:03:23 reviews: Job OK (36d00e6b-62a7-41e5-b202-19cab56896dc)
13:03:23 Result is kept for 500 seconds
13:03:23 
13:03:23 *** Listening on chapters, profiles, reviews...
13:03:23 reviews: fanfic.jobs.crawl_reviews(10167974) (db040f9f-9b5a-4d41-b019-b797bbdde028)
13:03:28 reviews: Job OK (db040f9f-9b5a-4d41-b019-b797bbdde028)
13:03:28 Result is kept for 500 seconds
13:03:28 
13:03:28 *** Listening on chapters, profiles, reviews...
13:03:28 reviews: fanfic.jobs.crawl_reviews(10168120) (834f8027-0306-443f-9d75-84ad093cdb10)
13:03:53 reviews: Job OK (834f8027-0306-443f-9d75-84ad093cdb10)
13:03:53 Result is kept for 500 seconds
13:03:53 
13:03:53 *** Listening on chapters, profiles, reviews...
13:03:53 reviews: fanfic.jobs.crawl_reviews(10170890) (9ff79e0c-e271-44b9-8432-01ca8526d47d)
13:04:28 reviews: Job OK (9ff79e0c-e271-44b9-8432-01ca8526d47d)
13:04:28 Result is kept for 500 seconds
13:04:28 
13:04:28 *** Listening on chapters, profiles, reviews...
13:04:28 reviews: fanfic.jobs.crawl_reviews(10172247) (ac6c06ca-1228-42a7-b2e9-a53b32d7b6aa)
2017-02-07 13:04:33 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 21:04:33.793049', 10172247, 199961265, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5509420&amp;r ... (1020 characters truncated) ...  for that. To live forever. Unless I had someone who is going through it too. Both are to be together forever. Never happen though.</div></td>\n</tr>'), ('2017-02-07 21:04:33.793053', 10172247, 199890312, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (750 characters truncated) ... lin is putting so much effort into this though? And Draco isn\'t in the least bit suspicious? Guess I\'ll have to read to find out!</div></td>\n</tr>'), ('2017-02-07 21:04:33.793056', 10172247, 199889259, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (751 characters truncated) ... n learn? How can he expect Colin to defend them without a wand? Seems pretty stupid to me. I wonder where Ron is? Will we find out?</div></td>\n</tr>'), ('2017-02-07 21:04:33.793058', 10172247, 199888649, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (617 characters truncated) ... -top:5px">I wonder what made Colin change his mind about Harry - and for Draco no less! I can tell this is going to be interesting!</div></td>\n</tr>'), ('2017-02-07 21:04:33.793060', 10172247, 198472333, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (675 characters truncated) ... eresting story and I love the StarKid reference! Was the Zefron another one or was that separate? <br>\n<br>\nAnyway, keep it up :)</div></td>\n</tr>'), ('2017-02-07 21:04:33.793062', 10172247, 198277870, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (577 characters truncated) ... 11/2014</span> </small><div style="margin-top:5px">It looks like this is going to be a very interesting story! Great first chapter!</div></td>\n</tr>'), ('2017-02-07 21:04:33.793064', 10172247, 198246352, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (642 characters truncated) ... OMG YES! He didn\'t say he loved him, but introducing Colin to his mother is certainly a step forward! More! Please post more soon!</div></td>\n</tr>'), ('2017-02-07 21:04:33.793066', 10172247, 198246231, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (672 characters truncated) ... early loves Colin! Now if only he will admit it! I hope he does soon! I\'m just glad Morrigan is out of the picture! Great chapter!</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-07 21:04:33.793079', 10172247, 198246352, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (642 characters truncated) ... OMG YES! He didn\'t say he loved him, but introducing Colin to his mother is certainly a step forward! More! Please post more soon!</div></td>\n</tr>'), ('2017-02-07 21:04:33.793081', 10172247, 198246231, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (672 characters truncated) ... early loves Colin! Now if only he will admit it! I hope he does soon! I\'m just glad Morrigan is out of the picture! Great chapter!</div></td>\n</tr>'))]
13:04:33 reviews: Job OK (ac6c06ca-1228-42a7-b2e9-a53b32d7b6aa)
13:04:33 Result is kept for 500 seconds
13:04:33 
13:04:33 *** Listening on chapters, profiles, reviews...
13:04:33 reviews: fanfic.jobs.crawl_reviews(10174660) (e383695b-bb92-4e4d-a096-e1baa3774b67)
13:06:01 reviews: Job OK (e383695b-bb92-4e4d-a096-e1baa3774b67)
13:06:01 Result is kept for 500 seconds
13:06:01 
13:06:01 *** Listening on chapters, profiles, reviews...
13:06:01 reviews: fanfic.jobs.crawl_reviews(10175118) (27b6b996-4245-4cd4-8349-f1cda807524e)
13:07:02 reviews: Job OK (27b6b996-4245-4cd4-8349-f1cda807524e)
13:07:02 Result is kept for 500 seconds
13:07:02 
13:07:02 *** Listening on chapters, profiles, reviews...
13:07:02 reviews: fanfic.jobs.crawl_reviews(10175897) (d3a6b634-6eb3-48dd-91be-65082816edd0)
13:07:28 reviews: Job OK (d3a6b634-6eb3-48dd-91be-65082816edd0)
13:07:28 Result is kept for 500 seconds
13:07:28 
13:07:28 *** Listening on chapters, profiles, reviews...
13:07:28 reviews: fanfic.jobs.crawl_reviews(10176608) (2dc095f0-2cd8-45d3-a672-2410194c1aeb)
2017-02-07 13:07:34 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 21:07:34.276713', 10176608, 217666389, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (1038 characters truncated) ... amazing! I read it in one day, because I was sick at home. I love it! I\'m going to go ahead and read the second one now.<br>\n-Jen</div></td>\n</tr>'), ('2017-02-07 21:07:34.276718', 10176608, 217666389, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (1038 characters truncated) ... amazing! I read it in one day, because I was sick at home. I love it! I\'m going to go ahead and read the second one now.<br>\n-Jen</div></td>\n</tr>'))]
13:07:34 reviews: Job OK (2dc095f0-2cd8-45d3-a672-2410194c1aeb)
13:07:34 Result is kept for 500 seconds
13:07:34 
13:07:34 *** Listening on chapters, profiles, reviews...
13:07:34 reviews: fanfic.jobs.crawl_reviews(10176706) (bb2a7104-da79-4c0a-a213-d3b11452e2d2)
2017-02-07 13:07:40 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 21:07:40.289522', 10176706, 217666767, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (1663 characters truncated) ... vorite stories of ALL TIME! I really mean it. So, you are really talented, keep writing and I would love to read more!<br>\n-Jen xx</div></td>\n</tr>'), ('2017-02-07 21:07:40.289527', 10176706, 217666577, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (939 characters truncated) ... 27309828">3/25/2015</span> </small><div style="margin-top:5px">This is amazing! You\'re such a brilliant author! I love this story!</div></td>\n</tr>'), ('2017-02-07 21:07:40.289529', 10176706, 217666534, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (937 characters truncated) ... 427309773">3/25/2015</span> </small><div style="margin-top:5px">Just tuning in to let you know that I\'m still loving this story :)</div></td>\n</tr>'), ('2017-02-07 21:07:40.289531', 10176706, 217666514, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (927 characters truncated) ... -xutime="1427309739">3/25/2015</span> </small><div style="margin-top:5px">Ooh, I loved this chapter! I\'m going to read more now :)</div></td>\n</tr>'), ('2017-02-07 21:07:40.289533', 10176706, 217666411, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (920 characters truncated) ... an data-xutime="1427309583">3/25/2015</span> </small><div style="margin-top:5px">Amazing first chapter, I can\'t wait to read more!</div></td>\n</tr>'), ('2017-02-07 21:07:40.289535', 10176706, 217666767, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (1663 characters truncated) ... vorite stories of ALL TIME! I really mean it. So, you are really talented, keep writing and I would love to read more!<br>\n-Jen xx</div></td>\n</tr>'), ('2017-02-07 21:07:40.289537', 10176706, 217666577, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (939 characters truncated) ... 27309828">3/25/2015</span> </small><div style="margin-top:5px">This is amazing! You\'re such a brilliant author! I love this story!</div></td>\n</tr>'), ('2017-02-07 21:07:40.289539', 10176706, 217666534, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (937 characters truncated) ... 427309773">3/25/2015</span> </small><div style="margin-top:5px">Just tuning in to let you know that I\'m still loving this story :)</div></td>\n</tr>'), ('2017-02-07 21:07:40.289541', 10176706, 217666514, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (927 characters truncated) ... -xutime="1427309739">3/25/2015</span> </small><div style="margin-top:5px">Ooh, I loved this chapter! I\'m going to read more now :)</div></td>\n</tr>'), ('2017-02-07 21:07:40.289543', 10176706, 217666411, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (920 characters truncated) ... an data-xutime="1427309583">3/25/2015</span> </small><div style="margin-top:5px">Amazing first chapter, I can\'t wait to read more!</div></td>\n</tr>'))]
13:07:40 reviews: Job OK (bb2a7104-da79-4c0a-a213-d3b11452e2d2)
13:07:40 Result is kept for 500 seconds
13:07:40 
13:07:40 *** Listening on chapters, profiles, reviews...
13:07:40 reviews: fanfic.jobs.crawl_reviews(10177170) (a567276e-2b72-467f-bb86-6e4c99109a10)
13:07:45 reviews: Job OK (a567276e-2b72-467f-bb86-6e4c99109a10)
13:07:45 Result is kept for 500 seconds
13:07:45 
13:07:45 *** Listening on chapters, profiles, reviews...
13:07:45 reviews: fanfic.jobs.crawl_reviews(10178449) (1429bd2c-dc33-4429-bcf5-945fe9adb65d)
13:07:54 reviews: Job OK (1429bd2c-dc33-4429-bcf5-945fe9adb65d)
13:07:54 Result is kept for 500 seconds
13:07:54 
13:07:54 *** Listening on chapters, profiles, reviews...
13:07:54 reviews: fanfic.jobs.crawl_reviews(10178824) (6c979543-e23c-44d6-b389-da2cb9a859ce)
13:08:15 reviews: Job OK (6c979543-e23c-44d6-b389-da2cb9a859ce)
13:08:15 Result is kept for 500 seconds
13:08:15 
13:08:15 *** Listening on chapters, profiles, reviews...
13:08:15 reviews: fanfic.jobs.crawl_reviews(10179438) (a988a539-cd11-45c2-a308-899cf4be849c)
13:08:35 reviews: Job OK (a988a539-cd11-45c2-a308-899cf4be849c)
13:08:36 Result is kept for 500 seconds
13:08:36 
13:08:36 *** Listening on chapters, profiles, reviews...
13:08:36 reviews: fanfic.jobs.crawl_reviews(10179471) (1f555fff-fddf-4505-b0aa-a37e183ccf06)
13:13:17 reviews: Job OK (1f555fff-fddf-4505-b0aa-a37e183ccf06)
13:13:17 Result is kept for 500 seconds
13:13:17 
13:13:17 *** Listening on chapters, profiles, reviews...
13:13:17 reviews: fanfic.jobs.crawl_reviews(10179785) (be76bfe6-2290-44c6-a68b-c9f0e161231f)
13:13:23 reviews: Job OK (be76bfe6-2290-44c6-a68b-c9f0e161231f)
13:13:23 Result is kept for 500 seconds
13:13:23 
13:13:23 *** Listening on chapters, profiles, reviews...
13:13:23 reviews: fanfic.jobs.crawl_reviews(10180379) (2ec8ee48-dd48-429a-aa71-dd1ef1af3b35)
13:13:55 reviews: Job OK (2ec8ee48-dd48-429a-aa71-dd1ef1af3b35)
13:13:55 Result is kept for 500 seconds
13:13:55 
13:13:55 *** Listening on chapters, profiles, reviews...
13:13:55 reviews: fanfic.jobs.crawl_reviews(10181081) (adc76525-baae-4518-a158-5da2cfae7c89)
13:14:00 reviews: Job OK (adc76525-baae-4518-a158-5da2cfae7c89)
13:14:00 Result is kept for 500 seconds
13:14:00 
13:14:00 *** Listening on chapters, profiles, reviews...
13:14:00 reviews: fanfic.jobs.crawl_reviews(10181348) (5a283cfb-176b-4198-a11f-ab2e7db730da)
13:14:54 reviews: Job OK (5a283cfb-176b-4198-a11f-ab2e7db730da)
13:14:54 Result is kept for 500 seconds
13:14:54 
13:14:54 *** Listening on chapters, profiles, reviews...
13:14:54 reviews: fanfic.jobs.crawl_reviews(10182397) (fce093da-eaee-4bdd-9e6d-a96a43b8cb82)
13:19:06 reviews: Job OK (fce093da-eaee-4bdd-9e6d-a96a43b8cb82)
13:19:06 Result is kept for 500 seconds
13:19:06 
13:19:06 *** Listening on chapters, profiles, reviews...
13:19:06 reviews: fanfic.jobs.crawl_reviews(10184257) (afd8f80c-bc56-4c55-9a08-1b5051e3b6ee)
13:19:49 reviews: Job OK (afd8f80c-bc56-4c55-9a08-1b5051e3b6ee)
13:19:49 Result is kept for 500 seconds
13:19:49 
13:19:49 *** Listening on chapters, profiles, reviews...
13:19:49 reviews: fanfic.jobs.crawl_reviews(10186112) (12d9350c-e7d5-4833-8f2c-b776f07835c7)
13:20:01 reviews: Job OK (12d9350c-e7d5-4833-8f2c-b776f07835c7)
13:20:01 Result is kept for 500 seconds
13:20:01 
13:20:01 *** Listening on chapters, profiles, reviews...
13:20:01 reviews: fanfic.jobs.crawl_reviews(10186614) (3c564175-f73c-4e5a-8f92-001268e6bbf3)
13:20:15 reviews: Job OK (3c564175-f73c-4e5a-8f92-001268e6bbf3)
13:20:15 Result is kept for 500 seconds
13:20:15 
13:20:15 *** Listening on chapters, profiles, reviews...
13:20:15 reviews: fanfic.jobs.crawl_reviews(10186982) (3eae60db-a6fd-4a6d-a91f-17cfe143ed49)
13:20:29 reviews: Job OK (3eae60db-a6fd-4a6d-a91f-17cfe143ed49)
13:20:29 Result is kept for 500 seconds
13:20:29 
13:20:29 *** Listening on chapters, profiles, reviews...
13:20:29 reviews: fanfic.jobs.crawl_reviews(10187113) (b9ff11ca-969c-402d-ad3e-d9c26f90d624)
13:21:14 reviews: Job OK (b9ff11ca-969c-402d-ad3e-d9c26f90d624)
13:21:14 Result is kept for 500 seconds
13:21:14 
13:21:14 *** Listening on chapters, profiles, reviews...
13:21:14 reviews: fanfic.jobs.crawl_reviews(10189424) (4ca8ef88-5d5b-4084-807f-e0ebc113d2d2)
13:21:53 reviews: Job OK (4ca8ef88-5d5b-4084-807f-e0ebc113d2d2)
13:21:53 Result is kept for 500 seconds
13:21:53 
13:21:53 *** Listening on chapters, profiles, reviews...
13:21:53 reviews: fanfic.jobs.crawl_reviews(10189467) (0e0389ec-cfa7-4de7-9f1c-1256a3ef4fba)
2017-02-07 13:21:58 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 21:21:58.722637', 10189467, 217214161, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (598 characters truncated) ... ll><div style="margin-top:5px">Both Cedric and maddie need a backbone and tell Cho to fuck off. This Cedric is the worst boyfriend.</div></td>\n</tr>'), ('2017-02-07 21:21:58.722641', 10189467, 213317206, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1312 characters truncated) ... nOh well their loss for not getting to enjoy this good story :P<br>\nPs: I can\'t wait to see everybody practice magic together! :)</div></td>\n</tr>'), ('2017-02-07 21:21:58.722644', 10189467, 208070234, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (584 characters truncated) ... ">9/21/2014</span> </small><div style="margin-top:5px">PLEASE UPDATE I love this story so much I want to find out what happens next</div></td>\n</tr>'), ('2017-02-07 21:21:58.722646', 10189467, 203591049, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2389385&amp;r ... (1405 characters truncated) ...  is 31 yrs old, and they have been together for almost 13 yrs :) and they are very happy, and so what?<br>\n<br>\nYou can do it! :)</div></td>\n</tr>'), ('2017-02-07 21:21:58.722648', 10189467, 202755641, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (532 characters truncated) ... y">chapter 8 . <span data-xutime="1403592876">6/23/2014</span> </small><div style="margin-top:5px">This is paedophilia. Disgusting.</div></td>\n</tr>'), ('2017-02-07 21:21:58.722650', 10189467, 201483483, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3772884&amp;r ... (888 characters truncated) ... yle="color:gray">chapter 7 . <span data-xutime="1401809963">6/3/2014</span> </small><div style="margin-top:5px">Great chapter... :)</div></td>\n</tr>'), ('2017-02-07 21:21:58.722652', 10189467, 200841855, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3772884&amp;r ... (884 characters truncated) ... l style="color:gray">chapter 6 . <span data-xutime="1400916856">5/24/2014</span> </small><div style="margin-top:5px">Great chapter,</div></td>\n</tr>'), ('2017-02-07 21:21:58.722654', 10189467, 199128704, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3772884&amp;r ... (960 characters truncated) ... pan> </small><div style="margin-top:5px">Awwwww cute chapter, glad they are together again. He does like to say \'baby\' a lot lol.</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-07 21:21:58.722687', 10189467, 197174481, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3772884&amp;r ... (1053 characters truncated) ... Great chappie. The next chapter you say is heartbreaking? I suppose that\'s when they break up again:\'( can\'t wait for it anyway.</div></td>\n</tr>'), ('2017-02-07 21:21:58.722689', 10189467, 196727720, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3772884&amp;r ... (1124 characters truncated) ... much together. Maybe they could stage a fight and be together secretley? Too bad your not updating till April :( but can\'t wait :D</div></td>\n</tr>'))]
13:21:58 reviews: Job OK (0e0389ec-cfa7-4de7-9f1c-1256a3ef4fba)
13:21:58 Result is kept for 500 seconds
13:21:58 
13:21:58 *** Listening on chapters, profiles, reviews...
13:21:58 reviews: fanfic.jobs.crawl_reviews(10191404) (bf31dd6c-b126-4010-8aaa-3c1267bc406f)
13:26:24 reviews: Job OK (bf31dd6c-b126-4010-8aaa-3c1267bc406f)
13:26:24 Result is kept for 500 seconds
13:26:24 
13:26:24 *** Listening on chapters, profiles, reviews...
13:26:24 reviews: fanfic.jobs.crawl_reviews(10191677) (eb8f803e-4671-4db8-af18-b8aa18407a9e)
13:29:36 reviews: Job OK (eb8f803e-4671-4db8-af18-b8aa18407a9e)
13:29:36 Result is kept for 500 seconds
13:29:36 
13:29:36 *** Listening on chapters, profiles, reviews...
13:29:36 reviews: fanfic.jobs.crawl_reviews(10192197) (9f78fa24-ffd9-44c0-95c5-d7f575724caf)
2017-02-07 13:29:41 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 21:29:41.992061', 10192197, 199953571, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1198759&amp;r ... (1396 characters truncated) ... nd have never been a grammer nazi, just a love for reading. Can\'t wait to see where it goes from here. <br>\nPatiently reading, FP</div></td>\n</tr>'), ('2017-02-07 21:29:41.992066', 10192197, 199566946, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (521 characters truncated) ... style="color:gray">chapter 17 . <span data-xutime="1398882599">4/30/2014</span> </small><div style="margin-top:5px">Interesting ...</div></td>\n</tr>'), ('2017-02-07 21:29:41.992068', 10192197, 199526054, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4586422&amp;r ... (1071 characters truncated) ... estly one of the best books I have ever read. It was filled with mystery, humor, friendship, and even some angst. Really great job!</div></td>\n</tr>'), ('2017-02-07 21:29:41.992070', 10192197, 199503830, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (530 characters truncated) ... chapter 13 . <span data-xutime="1398787516">4/29/2014</span> </small><div style="margin-top:5px">I like this story soo very much...</div></td>\n</tr>'), ('2017-02-07 21:29:41.992073', 10192197, 199167948, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4586422&amp;r ... (977 characters truncated) ... a-xutime="1398487924">4/25/2014</span> </small><div style="margin-top:5px">Ok first if all, DAAAAAAANG, 2.) I am so firkin excited!</div></td>\n</tr>'), ('2017-02-07 21:29:41.992075', 10192197, 198961093, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4586422&amp;r ... (982 characters truncated) ... ime="1398199947">4/22/2014</span> </small><div style="margin-top:5px">Awesome chapter! I can\'t wait to find out what happens next!</div></td>\n</tr>'), ('2017-02-07 21:29:41.992077', 10192197, 198782290, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4586422&amp;r ... (967 characters truncated) ...  <span data-xutime="1397963301">4/19/2014</span> </small><div style="margin-top:5px">Lets go gang! There\'s a mystery to be solved!</div></td>\n</tr>'), ('2017-02-07 21:29:41.992079', 10192197, 198615661, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4586422&amp;r ... (967 characters truncated) ...  <span data-xutime="1397714505">4/16/2014</span> </small><div style="margin-top:5px">No! Omigod, this is so amazing! I am obsessed!</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-07 21:29:41.992118', 10192197, 198065922, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4431303&amp;r ... (904 characters truncated) ... 3811">4/7/2014</span> </small><div style="margin-top:5px">Aahhhhh I love it! I was really hoping she wold get placed in Gryffindor!</div></td>\n</tr>'), ('2017-02-07 21:29:41.992120', 10192197, 197812538, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5258808&amp;r ... (920 characters truncated) ... 3/2014</span> </small><div style="margin-top:5px">WOA I did not see this coming! I just gotta say, keep this up, great story so far</div></td>\n</tr>'))]
13:29:42 reviews: Job OK (9f78fa24-ffd9-44c0-95c5-d7f575724caf)
13:29:42 Result is kept for 500 seconds
13:29:42 
13:29:42 *** Listening on chapters, profiles, reviews...
13:29:42 reviews: fanfic.jobs.crawl_reviews(10192718) (1dcaa6ad-247b-4288-a0f1-846db04986d3)
13:30:13 reviews: Job OK (1dcaa6ad-247b-4288-a0f1-846db04986d3)
13:30:13 Result is kept for 500 seconds
13:30:13 
13:30:13 *** Listening on chapters, profiles, reviews...
13:30:13 reviews: fanfic.jobs.crawl_reviews(10192796) (846e8699-d40d-4628-accd-2b57bd8dc410)
13:31:03 reviews: Job OK (846e8699-d40d-4628-accd-2b57bd8dc410)
13:31:03 Result is kept for 500 seconds
13:31:03 
13:31:03 *** Listening on chapters, profiles, reviews...
13:31:03 reviews: fanfic.jobs.crawl_reviews(10196712) (778bcde5-2f4b-432e-aa90-c7a270354b66)
13:31:36 reviews: Job OK (778bcde5-2f4b-432e-aa90-c7a270354b66)
13:31:36 Result is kept for 500 seconds
13:31:36 
13:31:36 *** Listening on chapters, profiles, reviews...
13:31:36 reviews: fanfic.jobs.crawl_reviews(10197238) (caebef39-c533-44ab-a192-6a29d4b1b06b)
13:33:00 reviews: Job OK (caebef39-c533-44ab-a192-6a29d4b1b06b)
13:33:00 Result is kept for 500 seconds
13:33:00 
13:33:00 *** Listening on chapters, profiles, reviews...
13:33:00 reviews: fanfic.jobs.crawl_reviews(10197285) (ca69ab87-8e4f-4e33-8d86-c4e9949e124e)
13:34:00 reviews: Job OK (ca69ab87-8e4f-4e33-8d86-c4e9949e124e)
13:34:00 Result is kept for 500 seconds
13:34:00 
13:34:00 *** Listening on chapters, profiles, reviews...
13:34:00 reviews: fanfic.jobs.crawl_reviews(10197868) (c6fb4a1e-0d7e-43cd-8272-85703f98361c)
13:34:16 reviews: Job OK (c6fb4a1e-0d7e-43cd-8272-85703f98361c)
13:34:16 Result is kept for 500 seconds
13:34:16 
13:34:16 *** Listening on chapters, profiles, reviews...
13:34:16 reviews: fanfic.jobs.crawl_reviews(10199030) (e0ee1c3d-117f-4bf6-b28c-5a0cb62de8f5)
13:34:32 reviews: Job OK (e0ee1c3d-117f-4bf6-b28c-5a0cb62de8f5)
13:34:32 Result is kept for 500 seconds
13:34:33 
13:34:33 *** Listening on chapters, profiles, reviews...
13:34:33 reviews: fanfic.jobs.crawl_reviews(10201508) (74ffbc5c-9b3e-4fb1-9cd0-f2a33944d382)
2017-02-07 13:34:38 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 21:34:38.424733', 10201508, 229584632, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (601 characters truncated) ... ><div style="margin-top:5px">Please please please continue I must have read thousands of stories by now but this is one of the best</div></td>\n</tr>'), ('2017-02-07 21:34:38.424739', 10201508, 218419986, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=314420&amp;rw ... (1100 characters truncated) ... <br>\n<br>\nAnd Malfoy is beginning to notice him in a positive way, though this is probably not so good for Snape in the long run.</div></td>\n</tr>'), ('2017-02-07 21:34:38.424742', 10201508, 216567139, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4234993&amp;r ... (942 characters truncated) ... 015</span> </small><div style="margin-top:5px">Finally! Thank you, though, for updating. I had thought I\'d have to let it go soon.</div></td>\n</tr>'), ('2017-02-07 21:34:38.424744', 10201508, 207902506, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3300319&amp;r ... (1326 characters truncated) ... ineffectual as he\'s usually portrayed. <br>\n<br>\nI\'m really looking forward to what comes next, so I hope there\'s more coming.</div></td>\n</tr>'), ('2017-02-07 21:34:38.424746', 10201508, 197166045, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (577 characters truncated) ... 23/2014</span> </small><div style="margin-top:5px">Cool story so far. Can Remus become friends with the other three? Pretty please?</div></td>\n</tr>'), ('2017-02-07 21:34:38.424748', 10201508, 229584632, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (601 characters truncated) ... ><div style="margin-top:5px">Please please please continue I must have read thousands of stories by now but this is one of the best</div></td>\n</tr>'), ('2017-02-07 21:34:38.424749', 10201508, 218419986, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=314420&amp;rw ... (1100 characters truncated) ... <br>\n<br>\nAnd Malfoy is beginning to notice him in a positive way, though this is probably not so good for Snape in the long run.</div></td>\n</tr>'), ('2017-02-07 21:34:38.424751', 10201508, 216567139, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4234993&amp;r ... (942 characters truncated) ... 015</span> </small><div style="margin-top:5px">Finally! Thank you, though, for updating. I had thought I\'d have to let it go soon.</div></td>\n</tr>'), ('2017-02-07 21:34:38.424753', 10201508, 207902506, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3300319&amp;r ... (1326 characters truncated) ... ineffectual as he\'s usually portrayed. <br>\n<br>\nI\'m really looking forward to what comes next, so I hope there\'s more coming.</div></td>\n</tr>'), ('2017-02-07 21:34:38.424755', 10201508, 197166045, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (577 characters truncated) ... 23/2014</span> </small><div style="margin-top:5px">Cool story so far. Can Remus become friends with the other three? Pretty please?</div></td>\n</tr>'))]
13:34:38 reviews: Job OK (74ffbc5c-9b3e-4fb1-9cd0-f2a33944d382)
13:34:38 Result is kept for 500 seconds
13:34:38 
13:34:38 *** Listening on chapters, profiles, reviews...
13:34:38 reviews: fanfic.jobs.crawl_reviews(10201587) (6ee0e5dc-162d-46b1-b9fe-51a4121a1d3b)
13:36:21 reviews: Job OK (6ee0e5dc-162d-46b1-b9fe-51a4121a1d3b)
13:36:21 Result is kept for 500 seconds
13:36:21 
13:36:21 *** Listening on chapters, profiles, reviews...
13:36:21 reviews: fanfic.jobs.crawl_reviews(10202355) (4a4823b2-adb2-4e25-bb06-814860307afa)
13:37:08 reviews: Job OK (4a4823b2-adb2-4e25-bb06-814860307afa)
13:37:08 Result is kept for 500 seconds
13:37:08 
13:37:08 *** Listening on chapters, profiles, reviews...
13:37:08 reviews: fanfic.jobs.crawl_reviews(10203246) (7afbd9dc-26fd-42fa-8406-ca3e0dbb33da)
13:39:04 reviews: Job OK (7afbd9dc-26fd-42fa-8406-ca3e0dbb33da)
13:39:04 Result is kept for 500 seconds
13:39:04 
13:39:04 *** Listening on chapters, profiles, reviews...
13:39:04 reviews: fanfic.jobs.crawl_reviews(10204873) (c1944508-7c16-43f7-bbca-19f35a11937a)
2017-02-07 13:39:08 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 21:39:08.470172', 10204873, 244084809, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (568 characters truncated) ... 49785">11/17/2016</span> </small><div style="margin-top:5px">This story is an absolute pleasure. Can not wait for the next chapter!</div></td>\n</tr>'), ('2017-02-07 21:39:08.470177', 10204873, 242084052, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=920624&amp;rw ... (823 characters truncated) ... ray">chapter 9 . <span data-xutime="1474332042">9/19/2016</span> </small><div style="margin-top:5px">God I love this story so much.</div></td>\n</tr>'), ('2017-02-07 21:39:08.470179', 10204873, 238506068, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (659 characters truncated) ...  times over the years and sit in eager anticipation for an update. My greatest fear is that one day you will not finish this story.</div></td>\n</tr>'), ('2017-02-07 21:39:08.470181', 10204873, 234003986, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=920624&amp;rw ... (812 characters truncated) ... le="color:gray">chapter 8 . <span data-xutime="1457307352">3/6/2016</span> </small><div style="margin-top:5px">Yay, more Suki time!</div></td>\n</tr>'), ('2017-02-07 21:39:08.470183', 10204873, 227328715, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (516 characters truncated) ... e="color:gray">chapter 7 . <span data-xutime="1443946354">10/4/2015</span> </small><div style="margin-top:5px">Love it, as always:)</div></td>\n</tr>'), ('2017-02-07 21:39:08.470185', 10204873, 222955272, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=920624&amp;rw ... (890 characters truncated) ... mall><div style="margin-top:5px">I am sad I\'m practically the only one reviewing for you. I love your story still, and await more.</div></td>\n</tr>'), ('2017-02-07 21:39:08.470187', 10204873, 218928211, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (506 characters truncated) ... small style="color:gray">chapter 6 . <span data-xutime="1429394731">4/18/2015</span> </small><div style="margin-top:5px">hilarious!</div></td>\n</tr>'), ('2017-02-07 21:39:08.470189', 10204873, 218345961, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=920624&amp;rw ... (892 characters truncated) ... ll><div style="margin-top:5px">The Hand Wave returns...excellent.<br>\n<br>\nThis story never fails to put a smile my face, thanks.</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-07 21:39:08.470231', 10204873, 197896260, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=920624&amp;rw ... (889 characters truncated) ... small><div style="margin-top:5px">I maintain she is the worst Veela ever, but I love this series.<br>\n<br>\nKeep up the good work.</div></td>\n</tr>'), ('2017-02-07 21:39:08.470233', 10204873, 197012845, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=920624&amp;rw ... (981 characters truncated) ... g this story, it is amazing. Although I think I need to reread last chapter as my memory is terrible and I don\'t really recall it.</div></td>\n</tr>'))]
13:39:08 reviews: Job OK (c1944508-7c16-43f7-bbca-19f35a11937a)
13:39:08 Result is kept for 500 seconds
13:39:08 
13:39:08 *** Listening on chapters, profiles, reviews...
13:39:08 reviews: fanfic.jobs.crawl_reviews(10206680) (d7dbd4b7-f940-471d-a917-79f8403807af)
13:39:34 reviews: Job OK (d7dbd4b7-f940-471d-a917-79f8403807af)
13:39:34 Result is kept for 500 seconds
13:39:34 
13:39:34 *** Listening on chapters, profiles, reviews...
13:39:34 reviews: fanfic.jobs.crawl_reviews(10208152) (1661a889-3db3-4218-b6c6-afa0986beec2)
13:40:14 reviews: Job OK (1661a889-3db3-4218-b6c6-afa0986beec2)
13:40:14 Result is kept for 500 seconds
13:40:14 
13:40:14 *** Listening on chapters, profiles, reviews...
13:40:14 reviews: fanfic.jobs.crawl_reviews(10209075) (b51e594e-07e5-4623-b5af-8f787204c80d)
13:40:43 reviews: Job OK (b51e594e-07e5-4623-b5af-8f787204c80d)
13:40:43 Result is kept for 500 seconds
13:40:43 
13:40:43 *** Listening on chapters, profiles, reviews...
13:40:43 reviews: fanfic.jobs.crawl_reviews(10209135) (62adf970-0ea4-401a-b434-87c7176bd67b)
13:42:49 reviews: Job OK (62adf970-0ea4-401a-b434-87c7176bd67b)
13:42:49 Result is kept for 500 seconds
13:42:49 
13:42:49 *** Listening on chapters, profiles, reviews...
13:42:49 reviews: fanfic.jobs.crawl_reviews(10210053) (2b11e9b9-f882-41d4-906b-d4b5918acd04)
13:43:41 reviews: Job OK (2b11e9b9-f882-41d4-906b-d4b5918acd04)
13:43:41 Result is kept for 500 seconds
13:43:41 
13:43:41 *** Listening on chapters, profiles, reviews...
13:43:41 reviews: fanfic.jobs.crawl_reviews(10211776) (1d5f4342-a0f1-48d9-8ede-0af225fa3e29)
13:44:45 reviews: Job OK (1d5f4342-a0f1-48d9-8ede-0af225fa3e29)
13:44:45 Result is kept for 500 seconds
13:44:45 
13:44:45 *** Listening on chapters, profiles, reviews...
13:44:45 reviews: fanfic.jobs.crawl_reviews(10212593) (7ca6b454-e77e-4644-8bc6-379347b8e1f8)
13:46:29 reviews: Job OK (7ca6b454-e77e-4644-8bc6-379347b8e1f8)
13:46:29 Result is kept for 500 seconds
13:46:29 
13:46:29 *** Listening on chapters, profiles, reviews...
13:46:29 reviews: fanfic.jobs.crawl_reviews(10212875) (8f07fe56-2724-4c83-bf19-1d81bbd9b257)
13:46:54 reviews: Job OK (8f07fe56-2724-4c83-bf19-1d81bbd9b257)
13:46:54 Result is kept for 500 seconds
13:46:54 Cleaning registries for queue: chapters
13:46:54 Cleaning registries for queue: profiles
13:46:54 Cleaning registries for queue: reviews
13:46:54 
13:46:54 *** Listening on chapters, profiles, reviews...
13:46:54 reviews: fanfic.jobs.crawl_reviews(10213907) (0d0f4c68-ecc5-4b8a-afba-9916ba4dadec)
13:47:11 reviews: Job OK (0d0f4c68-ecc5-4b8a-afba-9916ba4dadec)
13:47:11 Result is kept for 500 seconds
13:47:11 
13:47:11 *** Listening on chapters, profiles, reviews...
13:47:11 reviews: fanfic.jobs.crawl_reviews(10214902) (ca0cb7ea-d626-4445-bf70-75bf744e7894)
2017-02-07 13:47:16 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 21:47:16.363070', 10214902, 202349103, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5622230&amp;r ... (1105 characters truncated) ... ell-written and I look forward to the next chapter! It\'s almost addictive really; I can\'t stop reading it! Keep going, please! :)</div></td>\n</tr>'), ('2017-02-07 21:47:16.363076', 10214902, 198155212, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2343122&amp;r ... (888 characters truncated) ... span> </small><div style="margin-top:5px">I hope she saves Bella.. Thank you for updating by the way, the story is very intristing.</div></td>\n</tr>'), ('2017-02-07 21:47:16.363079', 10214902, 198133541, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4945052&amp;r ... (943 characters truncated) ... ta-xutime="1397018454">4/8/2014</span> </small><div style="margin-top:5px">Just looked at your profile - turns out you already are!</div></td>\n</tr>'), ('2017-02-07 21:47:16.363081', 10214902, 198133493, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4945052&amp;r ... (1338 characters truncated) ... y, Elia\'s a bit MarySueish, but this is really well written. I unfortunately can barely stand OCs, but this was surprisingly good.</div></td>\n</tr>'), ('2017-02-07 21:47:16.363084', 10214902, 197869697, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2343122&amp;r ... (1318 characters truncated) ... just be my fixation of evil insane ladies which i have no idea how it developed. Hope to see an update soon. Keep up the good work!</div></td>\n</tr>'), ('2017-02-07 21:47:16.363086', 10214902, 202349103, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5622230&amp;r ... (1105 characters truncated) ... ell-written and I look forward to the next chapter! It\'s almost addictive really; I can\'t stop reading it! Keep going, please! :)</div></td>\n</tr>'), ('2017-02-07 21:47:16.363089', 10214902, 198155212, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2343122&amp;r ... (888 characters truncated) ... span> </small><div style="margin-top:5px">I hope she saves Bella.. Thank you for updating by the way, the story is very intristing.</div></td>\n</tr>'), ('2017-02-07 21:47:16.363091', 10214902, 198133541, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4945052&amp;r ... (943 characters truncated) ... ta-xutime="1397018454">4/8/2014</span> </small><div style="margin-top:5px">Just looked at your profile - turns out you already are!</div></td>\n</tr>'), ('2017-02-07 21:47:16.363094', 10214902, 198133493, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4945052&amp;r ... (1338 characters truncated) ... y, Elia\'s a bit MarySueish, but this is really well written. I unfortunately can barely stand OCs, but this was surprisingly good.</div></td>\n</tr>'), ('2017-02-07 21:47:16.363096', 10214902, 197869697, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2343122&amp;r ... (1318 characters truncated) ... just be my fixation of evil insane ladies which i have no idea how it developed. Hope to see an update soon. Keep up the good work!</div></td>\n</tr>'))]
13:47:16 reviews: Job OK (ca0cb7ea-d626-4445-bf70-75bf744e7894)
13:47:16 Result is kept for 500 seconds
13:47:16 
13:47:16 *** Listening on chapters, profiles, reviews...
13:47:16 reviews: fanfic.jobs.crawl_reviews(10215982) (faf038c4-cc20-48ec-bc72-7a91c7ff3253)
13:47:55 reviews: Job OK (faf038c4-cc20-48ec-bc72-7a91c7ff3253)
13:47:55 Result is kept for 500 seconds
13:47:55 
13:47:55 *** Listening on chapters, profiles, reviews...
13:47:55 reviews: fanfic.jobs.crawl_reviews(10217405) (7e56e0c8-0ac7-4ec4-9f47-7ea6db144e35)
13:48:01 reviews: Job OK (7e56e0c8-0ac7-4ec4-9f47-7ea6db144e35)
13:48:01 Result is kept for 500 seconds
13:48:01 
13:48:01 *** Listening on chapters, profiles, reviews...
13:48:01 reviews: fanfic.jobs.crawl_reviews(10218541) (0777b516-edc2-499d-9db1-4210fb50f049)
13:49:38 reviews: Job OK (0777b516-edc2-499d-9db1-4210fb50f049)
13:49:38 Result is kept for 500 seconds
13:49:38 
13:49:38 *** Listening on chapters, profiles, reviews...
13:49:38 reviews: fanfic.jobs.crawl_reviews(10218769) (3f9c0ecb-b4be-47e9-9dc1-e51058879cb8)
13:51:52 reviews: Job OK (3f9c0ecb-b4be-47e9-9dc1-e51058879cb8)
13:51:52 Result is kept for 500 seconds
13:51:52 
13:51:52 *** Listening on chapters, profiles, reviews...
13:51:52 reviews: fanfic.jobs.crawl_reviews(10219559) (21ad9c29-096f-4596-85d4-35e242f775a8)
13:55:05 reviews: Job OK (21ad9c29-096f-4596-85d4-35e242f775a8)
13:55:05 Result is kept for 500 seconds
13:55:05 
13:55:05 *** Listening on chapters, profiles, reviews...
13:55:05 reviews: fanfic.jobs.crawl_reviews(10220099) (e4752c28-32b1-422a-a6f5-a2d4ee39c899)
13:55:40 reviews: Job OK (e4752c28-32b1-422a-a6f5-a2d4ee39c899)
13:55:40 Result is kept for 500 seconds
13:55:40 
13:55:40 *** Listening on chapters, profiles, reviews...
13:55:40 reviews: fanfic.jobs.crawl_reviews(10220600) (11d2f141-0d73-44cf-96f7-b5bbec53a4bf)
13:58:19 reviews: Job OK (11d2f141-0d73-44cf-96f7-b5bbec53a4bf)
13:58:19 Result is kept for 500 seconds
13:58:19 
13:58:19 *** Listening on chapters, profiles, reviews...
13:58:19 reviews: fanfic.jobs.crawl_reviews(10221776) (9121a0ff-0c94-4153-b5f3-c3f25c4a2fe3)
14:01:48 reviews: Job OK (9121a0ff-0c94-4153-b5f3-c3f25c4a2fe3)
14:01:48 Result is kept for 500 seconds
14:01:48 
14:01:48 *** Listening on chapters, profiles, reviews...
14:01:48 reviews: fanfic.jobs.crawl_reviews(10223278) (7f3f5610-139f-4e18-8c45-3d6ad64abf13)
14:02:02 reviews: Job OK (7f3f5610-139f-4e18-8c45-3d6ad64abf13)
14:02:02 Result is kept for 500 seconds
14:02:02 
14:02:02 *** Listening on chapters, profiles, reviews...
14:02:02 reviews: fanfic.jobs.crawl_reviews(10223438) (d3cd6f60-09de-40f8-8096-209b0e76cf7f)
14:02:16 reviews: Job OK (d3cd6f60-09de-40f8-8096-209b0e76cf7f)
14:02:16 Result is kept for 500 seconds
14:02:16 
14:02:16 *** Listening on chapters, profiles, reviews...
14:02:16 reviews: fanfic.jobs.crawl_reviews(10226216) (6fb77652-f325-44ca-9db5-0520a98e80a6)
14:04:04 reviews: Job OK (6fb77652-f325-44ca-9db5-0520a98e80a6)
14:04:04 Result is kept for 500 seconds
14:04:04 
14:04:04 *** Listening on chapters, profiles, reviews...
14:04:04 reviews: fanfic.jobs.crawl_reviews(10226300) (fb009b4d-0aec-49de-9dda-0780ab16ff9a)
14:04:43 reviews: Job OK (fb009b4d-0aec-49de-9dda-0780ab16ff9a)
14:04:43 Result is kept for 500 seconds
14:04:43 
14:04:43 *** Listening on chapters, profiles, reviews...
14:04:43 reviews: fanfic.jobs.crawl_reviews(10227942) (c71b59d9-54d3-4af8-a42a-4f731cb5f203)
14:05:34 reviews: Job OK (c71b59d9-54d3-4af8-a42a-4f731cb5f203)
14:05:34 Result is kept for 500 seconds
14:05:34 
14:05:34 *** Listening on chapters, profiles, reviews...
14:05:34 reviews: fanfic.jobs.crawl_reviews(10230025) (e7d6ce3b-3c24-4333-b35e-db8da058245a)
14:05:43 reviews: Job OK (e7d6ce3b-3c24-4333-b35e-db8da058245a)
14:05:43 Result is kept for 500 seconds
14:05:43 
14:05:43 *** Listening on chapters, profiles, reviews...
14:05:43 reviews: fanfic.jobs.crawl_reviews(10230613) (c243fc20-e6a1-4406-ba7c-2dfffad265cc)
14:06:06 reviews: Job OK (c243fc20-e6a1-4406-ba7c-2dfffad265cc)
14:06:06 Result is kept for 500 seconds
14:06:06 
14:06:06 *** Listening on chapters, profiles, reviews...
14:06:06 reviews: fanfic.jobs.crawl_reviews(10231321) (143afec8-a9ac-4355-9f10-dd0b2172982c)
14:06:18 reviews: Job OK (143afec8-a9ac-4355-9f10-dd0b2172982c)
14:06:18 Result is kept for 500 seconds
14:06:18 
14:06:18 *** Listening on chapters, profiles, reviews...
14:06:18 reviews: fanfic.jobs.crawl_reviews(10231857) (e8005912-eace-4fd1-88c4-908d74cbfa9f)
14:06:24 reviews: Job OK (e8005912-eace-4fd1-88c4-908d74cbfa9f)
14:06:24 Result is kept for 500 seconds
14:06:24 
14:06:24 *** Listening on chapters, profiles, reviews...
14:06:24 reviews: fanfic.jobs.crawl_reviews(10232220) (b300722b-de3e-46ff-afa7-77653f223126)
14:07:07 reviews: Job OK (b300722b-de3e-46ff-afa7-77653f223126)
14:07:07 Result is kept for 500 seconds
14:07:07 
14:07:07 *** Listening on chapters, profiles, reviews...
14:07:07 reviews: fanfic.jobs.crawl_reviews(10232510) (fd304f6b-4604-4cf9-b1fe-7663ca6419bf)
14:08:00 reviews: Job OK (fd304f6b-4604-4cf9-b1fe-7663ca6419bf)
14:08:00 Result is kept for 500 seconds
14:08:00 
14:08:00 *** Listening on chapters, profiles, reviews...
14:08:00 reviews: fanfic.jobs.crawl_reviews(10233369) (8e330b56-ff3b-41ed-b3dc-40c1c08bb402)
14:09:03 reviews: Job OK (8e330b56-ff3b-41ed-b3dc-40c1c08bb402)
14:09:03 Result is kept for 500 seconds
14:09:03 
14:09:03 *** Listening on chapters, profiles, reviews...
14:09:03 reviews: fanfic.jobs.crawl_reviews(10234209) (d686469a-0de3-4a17-8049-ee6238dca575)
2017-02-07 14:09:09 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 22:09:09.718241', 10234209, 234737707, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=723074&amp;rw ... (899 characters truncated) ... :gray">chapter 26 . <span data-xutime="1458787654">3/23/2016</span> </small><div style="margin-top:5px">It a very interesting story</div></td>\n</tr>'), ('2017-02-07 22:09:09.718246', 10234209, 231587967, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1860009&amp;r ... (920 characters truncated) ... span data-xutime="1452468203">1/10/2016</span> </small><div style="margin-top:5px">please update this has been a really good story.</div></td>\n</tr>'), ('2017-02-07 22:09:09.718248', 10234209, 231578154, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=723074&amp;rw ... (944 characters truncated) ... 3549">1/10/2016</span> </small><div style="margin-top:5px">It a interesting chapter, It funny that Minerve get chastened at her age</div></td>\n</tr>'), ('2017-02-07 22:09:09.718250', 10234209, 231526217, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (670 characters truncated) ... me. I have read both stories. And I can tell u that this one is the best. Please finish it and start another sequel. Plz plz plzzzz</div></td>\n</tr>'), ('2017-02-07 22:09:09.718252', 10234209, 227705385, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=723074&amp;rw ... (909 characters truncated) ... pter 24 . <span data-xutime="1444702715">10/12/2015</span> </small><div style="margin-top:5px">I find the chapter to be interesting</div></td>\n</tr>'), ('2017-02-07 22:09:09.718254', 10234209, 225411904, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=723074&amp;rw ... (1076 characters truncated) ... ng of a wait. But then again I been busy playing Demon souls and skyrim, also watching an few anime. So my mind was on other things</div></td>\n</tr>'), ('2017-02-07 22:09:09.718256', 10234209, 221638824, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=723074&amp;rw ... (1172 characters truncated) ...  don\'t mind waiting for a new chapter, as long as I know the story will get finish in the future don\'t matter how long that take.</div></td>\n</tr>'), ('2017-02-07 22:09:09.718258', 10234209, 216759938, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (534 characters truncated) ... apter 1 . <span data-xutime="1425784620">3/7/2015</span> </small><div style="margin-top:5px">this is fantastic! cant wait for more.</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-07 22:09:09.718283', 10234209, 202177900, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (622 characters truncated) ... in-top:5px">I just recently found your stories and I\'m hooked. It\'s an excellent story line and I eagerly await your next update.</div></td>\n</tr>'), ('2017-02-07 22:09:09.718285', 10234209, 199565117, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=790127&amp;rw ... (2065 characters truncated) ... ght out and updated every week or two.<br>\n<br>\nLike I said this is not meant as a flame and if you take it that way, I am sorry.</div></td>\n</tr>'))]
14:09:09 reviews: Job OK (d686469a-0de3-4a17-8049-ee6238dca575)
14:09:09 Result is kept for 500 seconds
14:09:09 
14:09:09 *** Listening on chapters, profiles, reviews...
14:09:09 reviews: fanfic.jobs.crawl_reviews(10235563) (9a81b799-6808-48ef-ac90-a46942b39940)
14:11:25 reviews: Job OK (9a81b799-6808-48ef-ac90-a46942b39940)
14:11:25 Result is kept for 500 seconds
14:11:25 
14:11:25 *** Listening on chapters, profiles, reviews...
14:11:25 reviews: fanfic.jobs.crawl_reviews(10236556) (0e8e45e4-3507-4a75-9885-c23f411004bf)
14:17:47 reviews: Job OK (0e8e45e4-3507-4a75-9885-c23f411004bf)
14:17:47 Result is kept for 500 seconds
14:17:47 
14:17:47 *** Listening on chapters, profiles, reviews...
14:17:47 reviews: fanfic.jobs.crawl_reviews(10238788) (89f0b97a-537d-4224-9faf-e57585f0efe5)
14:17:52 reviews: Job OK (89f0b97a-537d-4224-9faf-e57585f0efe5)
14:17:52 Result is kept for 500 seconds
14:17:52 
14:17:52 *** Listening on chapters, profiles, reviews...
14:17:52 reviews: fanfic.jobs.crawl_reviews(10239161) (96dd4fb3-1223-4ad7-a685-db7fcb7639b7)
14:17:56 reviews: Job OK (96dd4fb3-1223-4ad7-a685-db7fcb7639b7)
14:17:56 Result is kept for 500 seconds
14:17:56 
14:17:56 *** Listening on chapters, profiles, reviews...
14:17:56 reviews: fanfic.jobs.crawl_reviews(10239915) (3da29e6c-fdc1-4bcb-a7e6-06b3b3936b2c)
14:18:49 reviews: Job OK (3da29e6c-fdc1-4bcb-a7e6-06b3b3936b2c)
14:18:49 Result is kept for 500 seconds
14:18:49 
14:18:49 *** Listening on chapters, profiles, reviews...
14:18:49 reviews: fanfic.jobs.crawl_reviews(10240442) (69e2a9b6-f1a8-4a67-abc0-b0db19256b6f)
14:18:59 reviews: Job OK (69e2a9b6-f1a8-4a67-abc0-b0db19256b6f)
14:18:59 Result is kept for 500 seconds
14:18:59 
14:18:59 *** Listening on chapters, profiles, reviews...
14:18:59 reviews: fanfic.jobs.crawl_reviews(10241759) (29fa62a1-9760-469f-9cb8-055ab171fbf2)
14:19:35 reviews: Job OK (29fa62a1-9760-469f-9cb8-055ab171fbf2)
14:19:35 Result is kept for 500 seconds
14:19:35 
14:19:35 *** Listening on chapters, profiles, reviews...
14:19:35 reviews: fanfic.jobs.crawl_reviews(10243022) (709724b7-dbf6-4bf3-a0e6-b008944739f9)
14:19:43 reviews: Job OK (709724b7-dbf6-4bf3-a0e6-b008944739f9)
14:19:43 Result is kept for 500 seconds
14:19:43 
14:19:43 *** Listening on chapters, profiles, reviews...
14:19:43 reviews: fanfic.jobs.crawl_reviews(10244502) (cb3bd8d4-372b-4811-9fde-0da8997d10c2)
14:19:48 reviews: Job OK (cb3bd8d4-372b-4811-9fde-0da8997d10c2)
14:19:48 Result is kept for 500 seconds
14:19:48 
14:19:48 *** Listening on chapters, profiles, reviews...
14:19:48 reviews: fanfic.jobs.crawl_reviews(10244532) (b3e8361b-f065-4c3c-ac39-244c4252513b)
14:20:31 reviews: Job OK (b3e8361b-f065-4c3c-ac39-244c4252513b)
14:20:31 Result is kept for 500 seconds
14:20:31 
14:20:31 *** Listening on chapters, profiles, reviews...
14:20:31 reviews: fanfic.jobs.crawl_reviews(10246429) (533de0fa-26a1-47d6-96ce-3ee860f69622)
14:21:21 reviews: Job OK (533de0fa-26a1-47d6-96ce-3ee860f69622)
14:21:21 Result is kept for 500 seconds
14:21:21 
14:21:21 *** Listening on chapters, profiles, reviews...
14:21:21 reviews: fanfic.jobs.crawl_reviews(10251378) (77e2becb-6957-4db2-9662-cd2a42359e2b)
14:22:08 reviews: Job OK (77e2becb-6957-4db2-9662-cd2a42359e2b)
14:22:08 Result is kept for 500 seconds
14:22:08 
14:22:08 *** Listening on chapters, profiles, reviews...
14:22:08 reviews: fanfic.jobs.crawl_reviews(10251470) (03bd644f-8a45-4fa9-b4c3-a0ae18bc6f8b)
14:22:16 reviews: Job OK (03bd644f-8a45-4fa9-b4c3-a0ae18bc6f8b)
14:22:16 Result is kept for 500 seconds
14:22:16 
14:22:16 *** Listening on chapters, profiles, reviews...
14:22:16 reviews: fanfic.jobs.crawl_reviews(10253474) (bd2be232-ff5a-43ca-9623-afbd50c783f4)
14:22:21 reviews: Job OK (bd2be232-ff5a-43ca-9623-afbd50c783f4)
14:22:21 Result is kept for 500 seconds
14:22:21 
14:22:21 *** Listening on chapters, profiles, reviews...
14:22:21 reviews: fanfic.jobs.crawl_reviews(10253612) (a40925d7-cca0-4faa-9afa-aedaa15e5f91)
14:23:16 reviews: Job OK (a40925d7-cca0-4faa-9afa-aedaa15e5f91)
14:23:16 Result is kept for 500 seconds
14:23:16 
14:23:16 *** Listening on chapters, profiles, reviews...
14:23:16 reviews: fanfic.jobs.crawl_reviews(10253636) (bf082e5d-55ff-4489-bcdb-3adc24e0a4cd)
2017-02-07 14:23:21 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 22:23:21.569804', 10253636, 244716387, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7071306&amp;r ... (1014 characters truncated) ... an> </small><div style="margin-top:5px">Lol I love Grams! I cant wait for Haryy and all of the other adults to find out about this!</div></td>\n</tr>'), ('2017-02-07 22:23:21.569809', 10253636, 244715860, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7071306&amp;r ... (983 characters truncated) ... time="1481087127">12/6/2016</span> </small><div style="margin-top:5px">This was bloody amazing. and I cant wait to read mkre of it!</div></td>\n</tr>'), ('2017-02-07 22:23:21.569812', 10253636, 200231661, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5347022&amp;r ... (1076 characters truncated) ...  is all i can say! It was amazing loved it to bits. You should create and publish a story. I know i would buy it :D<br>\nEmerald xx</div></td>\n</tr>'), ('2017-02-07 22:23:21.569814', 10253636, 200170114, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5580498&amp;r ... (1004 characters truncated) ...  <span data-xutime="1399928947">5/12/2014</span> </small><div style="margin-top:5px">Hey I love this story thank you for writing it</div></td>\n</tr>'), ('2017-02-07 22:23:21.569816', 10253636, 200144118, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5580498&amp;r ... (997 characters truncated) ... er 17 . <span data-xutime="1399889525">5/12/2014</span> </small><div style="margin-top:5px">please, please, please do an epilogue?!</div></td>\n</tr>'), ('2017-02-07 22:23:21.569818', 10253636, 200090768, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5580498&amp;r ... (1312 characters truncated) ... at happens when they find out that Kay - a muggle - was there for a week learning about magic so as I said before I CAN\'T WAIT! :D</div></td>\n</tr>'), ('2017-02-07 22:23:21.569820', 10253636, 200088638, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5347022&amp;r ... (1009 characters truncated) ... /11/2014</span> </small><div style="margin-top:5px">Whens the next chapter :P Hahaha love this story sooooo much! :D<br>\nEmerald x</div></td>\n</tr>'), ('2017-02-07 22:23:21.569822', 10253636, 199804367, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5347022&amp;r ... (1143 characters truncated) ...  the Golden Trio :P And what is really funny is that my best friend is called Makayla Francis! Spooky right hahaha. Great story! :D</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-07 22:23:21.569861', 10253636, 198217291, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (625 characters truncated) ... x">I\'m really enjoying this story! Can\'t wait for the next chapters to get put up! Hope that Kayla and James get together though!</div></td>\n</tr>'), ('2017-02-07 22:23:21.569863', 10253636, 198100133, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3985701&amp;r ... (1010 characters truncated) ... >4/8/2014</span> </small><div style="margin-top:5px">Nicely done. I really like the character development. Here\'s hoping for more!</div></td>\n</tr>'))]
14:23:21 reviews: Job OK (bf082e5d-55ff-4489-bcdb-3adc24e0a4cd)
14:23:21 Result is kept for 500 seconds
14:23:21 
14:23:21 *** Listening on chapters, profiles, reviews...
14:23:21 reviews: fanfic.jobs.crawl_reviews(10254684) (d3955353-05bb-4680-95bd-5be69e17d0ff)
14:23:44 reviews: Job OK (d3955353-05bb-4680-95bd-5be69e17d0ff)
14:23:44 Result is kept for 500 seconds
14:23:44 
14:23:44 *** Listening on chapters, profiles, reviews...
14:23:44 reviews: fanfic.jobs.crawl_reviews(10255488) (2ea039f1-84d8-4d34-a0e2-8b4946fb3d78)
14:24:50 reviews: Job OK (2ea039f1-84d8-4d34-a0e2-8b4946fb3d78)
14:24:50 Result is kept for 500 seconds
14:24:50 
14:24:50 *** Listening on chapters, profiles, reviews...
14:24:50 reviews: fanfic.jobs.crawl_reviews(10255536) (c2fc7ba5-3cf2-40d4-85b6-f6a9ed6baee6)
14:25:09 reviews: Job OK (c2fc7ba5-3cf2-40d4-85b6-f6a9ed6baee6)
14:25:09 Result is kept for 500 seconds
14:25:09 
14:25:09 *** Listening on chapters, profiles, reviews...
14:25:09 reviews: fanfic.jobs.crawl_reviews(10256543) (0f927be2-2442-4a49-bc27-d4a9cfa9fda2)
14:33:03 reviews: Job OK (0f927be2-2442-4a49-bc27-d4a9cfa9fda2)
14:33:03 Result is kept for 500 seconds
14:33:03 
14:33:03 *** Listening on chapters, profiles, reviews...
14:33:03 reviews: fanfic.jobs.crawl_reviews(10258491) (ce0c2b3a-99de-4021-9f9a-eb325d0024c0)
2017-02-07 14:33:07 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 22:33:07.438933', 10258491, 244847623, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (621 characters truncated) ... op:5px">Just thought you should know, Draco Malfoy is married to and falls in love with Astoria Greengrass acoording to J.K Rowling</div></td>\n</tr>'), ('2017-02-07 22:33:07.438938', 10258491, 229896342, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6612422&amp;r ... (851 characters truncated) ... 15</span> </small><div style="margin-top:5px">I\'m not sure how I feel about this... It was a very stressful read, but I enjoyed it</div></td>\n</tr>'), ('2017-02-07 22:33:07.438941', 10258491, 205182808, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3776490&amp;r ... (1539 characters truncated) ... e and time, the Dark Lord was given another chance at life. Everyone deserved one, at the end of all." - this sentence made my day!</div></td>\n</tr>'), ('2017-02-07 22:33:07.438943', 10258491, 205182019, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3776490&amp;r ... (1035 characters truncated) ... ut Death, the only thing you can do is suicide - he would never appreciate one interfering with the universe\'s plan. Perfect idea!</div></td>\n</tr>'), ('2017-02-07 22:33:07.438945', 10258491, 205181606, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3776490&amp;r ... (2205 characters truncated) ... r story, if I\'m not wrong). <br>\n<br>\nBut all in all this chapter was among the most amazing parts of HP fanfic I\'ve ever read.</div></td>\n</tr>'), ('2017-02-07 22:33:07.438947', 10258491, 204708101, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4636268&amp;r ... (788 characters truncated) ... r:gray">chapter 9 . <span data-xutime="1406243650">7/24/2014</span> </small><div style="margin-top:5px">omg, eso no me lo esperaba.</div></td>\n</tr>'), ('2017-02-07 22:33:07.438949', 10258491, 204627501, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3776490&amp;r ... (1133 characters truncated) ... blem solved, so Draco can now move on to the other problems... I\'m curious how he\'ll get around being marked by the Dark Lord. :)</div></td>\n</tr>'), ('2017-02-07 22:33:07.438951', 10258491, 204544002, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3776490&amp;r ... (1286 characters truncated) ... k them all... what will Draco do when Voldemort finds out he already has the mark... seems things won\'t get easier for poor Draco!</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-07 22:33:07.438986', 10258491, 199319465, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3776490&amp;r ... (1059 characters truncated) ... t you put the marauders in there and I\'m looking forward to some more verbal fights between Draco and James. Lily is amazing, too.</div></td>\n</tr>'), ('2017-02-07 22:33:07.438988', 10258491, 198444196, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4389794&amp;r ... (767 characters truncated) ... /a>  <small style="color:gray">chapter 3 . <span data-xutime="1397481517">4/14/2014</span> </small><div style="margin-top:5px">Nice</div></td>\n</tr>'))]
14:33:07 reviews: Job OK (ce0c2b3a-99de-4021-9f9a-eb325d0024c0)
14:33:07 Result is kept for 500 seconds
14:33:07 
14:33:07 *** Listening on chapters, profiles, reviews...
14:33:07 reviews: fanfic.jobs.crawl_reviews(10261572) (4b52eeac-4c88-4db5-825b-7f0a5f59a9b4)
14:33:38 reviews: Job OK (4b52eeac-4c88-4db5-825b-7f0a5f59a9b4)
14:33:38 Result is kept for 500 seconds
14:33:38 
14:33:38 *** Listening on chapters, profiles, reviews...
14:33:38 reviews: fanfic.jobs.crawl_reviews(10261757) (250ba5f9-80f8-4a82-85e6-80388c56d502)
14:34:40 reviews: Job OK (250ba5f9-80f8-4a82-85e6-80388c56d502)
14:34:40 Result is kept for 500 seconds
14:34:40 
14:34:40 *** Listening on chapters, profiles, reviews...
14:34:40 reviews: fanfic.jobs.crawl_reviews(10263849) (60a5c6b0-18c2-48c9-87d3-4a196f7aa3b5)
14:36:14 reviews: Job OK (60a5c6b0-18c2-48c9-87d3-4a196f7aa3b5)
14:36:14 Result is kept for 500 seconds
14:36:14 
14:36:14 *** Listening on chapters, profiles, reviews...
14:36:14 reviews: fanfic.jobs.crawl_reviews(10264186) (9feb64cf-d686-439c-9777-b8d6b4a5e759)
14:40:04 reviews: Job OK (9feb64cf-d686-439c-9777-b8d6b4a5e759)
14:40:04 Result is kept for 500 seconds
14:40:04 
14:40:04 *** Listening on chapters, profiles, reviews...
14:40:04 reviews: fanfic.jobs.crawl_reviews(10264735) (9b9c4240-6345-4f6a-92c0-d471e7122227)
14:40:14 reviews: Job OK (9b9c4240-6345-4f6a-92c0-d471e7122227)
14:40:14 Result is kept for 500 seconds
14:40:14 
14:40:14 *** Listening on chapters, profiles, reviews...
14:40:14 reviews: fanfic.jobs.crawl_reviews(10266219) (6a2df834-59ad-4369-bb46-f1548d4f950b)
14:40:31 reviews: Job OK (6a2df834-59ad-4369-bb46-f1548d4f950b)
14:40:31 Result is kept for 500 seconds
14:40:31 
14:40:31 *** Listening on chapters, profiles, reviews...
14:40:31 reviews: fanfic.jobs.crawl_reviews(10267302) (238f424c-c254-4c3b-8fd7-c6d09ad22c66)
14:44:17 reviews: Job OK (238f424c-c254-4c3b-8fd7-c6d09ad22c66)
14:44:17 Result is kept for 500 seconds
14:44:17 
14:44:17 *** Listening on chapters, profiles, reviews...
14:44:17 reviews: fanfic.jobs.crawl_reviews(10267462) (fd9316e6-add3-4bc4-a17c-c58fff89b5ff)
14:44:52 reviews: Job OK (fd9316e6-add3-4bc4-a17c-c58fff89b5ff)
14:44:52 Result is kept for 500 seconds
14:44:52 
14:44:52 *** Listening on chapters, profiles, reviews...
14:44:52 reviews: fanfic.jobs.crawl_reviews(10268659) (e6cb0870-70ad-4907-84e9-900bcb010df1)
14:45:18 reviews: Job OK (e6cb0870-70ad-4907-84e9-900bcb010df1)
14:45:18 Result is kept for 500 seconds
14:45:18 
14:45:18 *** Listening on chapters, profiles, reviews...
14:45:18 reviews: fanfic.jobs.crawl_reviews(10271213) (5ee61f3c-9492-4a22-908e-d63a67ee08d4)
14:47:07 reviews: Job OK (5ee61f3c-9492-4a22-908e-d63a67ee08d4)
14:47:07 Result is kept for 500 seconds
14:47:07 Cleaning registries for queue: chapters
14:47:07 Cleaning registries for queue: profiles
14:47:07 Cleaning registries for queue: reviews
14:47:07 
14:47:07 *** Listening on chapters, profiles, reviews...
14:47:07 reviews: fanfic.jobs.crawl_reviews(10271330) (5b30f772-b7a4-4edc-a9be-0d47f998fa9c)
14:47:19 reviews: Job OK (5b30f772-b7a4-4edc-a9be-0d47f998fa9c)
14:47:19 Result is kept for 500 seconds
14:47:19 
14:47:19 *** Listening on chapters, profiles, reviews...
14:47:19 reviews: fanfic.jobs.crawl_reviews(10272040) (9b694685-3de0-4fa5-82ab-2a1576ed3f99)
14:52:08 reviews: Job OK (9b694685-3de0-4fa5-82ab-2a1576ed3f99)
14:52:08 Result is kept for 500 seconds
14:52:08 
14:52:08 *** Listening on chapters, profiles, reviews...
14:52:08 reviews: fanfic.jobs.crawl_reviews(10274072) (a55ee659-d180-4939-8d2c-0626067c3429)
14:52:59 reviews: Job OK (a55ee659-d180-4939-8d2c-0626067c3429)
14:52:59 Result is kept for 500 seconds
14:52:59 
14:52:59 *** Listening on chapters, profiles, reviews...
14:52:59 reviews: fanfic.jobs.crawl_reviews(10275503) (df738f75-3624-49f8-a325-741f3d74b3d4)
14:53:40 reviews: Job OK (df738f75-3624-49f8-a325-741f3d74b3d4)
14:53:40 Result is kept for 500 seconds
14:53:40 
14:53:40 *** Listening on chapters, profiles, reviews...
14:53:40 reviews: fanfic.jobs.crawl_reviews(10276824) (f919ac45-34e7-4ccd-9933-009f129187ca)
14:57:14 reviews: Job OK (f919ac45-34e7-4ccd-9933-009f129187ca)
14:57:14 Result is kept for 500 seconds
14:57:14 
14:57:14 *** Listening on chapters, profiles, reviews...
14:57:14 reviews: fanfic.jobs.crawl_reviews(10277398) (be849266-5bc5-495f-9b06-b1516d2ccc0c)
14:58:10 reviews: Job OK (be849266-5bc5-495f-9b06-b1516d2ccc0c)
14:58:10 Result is kept for 500 seconds
14:58:10 
14:58:10 *** Listening on chapters, profiles, reviews...
14:58:10 reviews: fanfic.jobs.crawl_reviews(10278256) (700a8477-f15d-413d-bca5-28135dd0987f)
14:59:29 reviews: Job OK (700a8477-f15d-413d-bca5-28135dd0987f)
14:59:29 Result is kept for 500 seconds
14:59:29 
14:59:29 *** Listening on chapters, profiles, reviews...
14:59:29 reviews: fanfic.jobs.crawl_reviews(10279019) (a2fe7c29-5359-4681-90c2-9afa57e36734)
15:02:12 reviews: Job OK (a2fe7c29-5359-4681-90c2-9afa57e36734)
15:02:12 Result is kept for 500 seconds
15:02:12 
15:02:12 *** Listening on chapters, profiles, reviews...
15:02:12 reviews: fanfic.jobs.crawl_reviews(10279060) (bf32f92c-192c-4a55-8f81-5c619747d21c)
15:02:15 reviews: Job OK (bf32f92c-192c-4a55-8f81-5c619747d21c)
15:02:15 Result is kept for 500 seconds
15:02:15 
15:02:15 *** Listening on chapters, profiles, reviews...
15:02:15 reviews: fanfic.jobs.crawl_reviews(10280397) (25d42618-77ef-45f9-8172-3c76d6992ed8)
15:03:02 reviews: Job OK (25d42618-77ef-45f9-8172-3c76d6992ed8)
15:03:02 Result is kept for 500 seconds
15:03:02 
15:03:02 *** Listening on chapters, profiles, reviews...
15:03:02 reviews: fanfic.jobs.crawl_reviews(10280426) (f8ea8652-6da7-4bf5-9782-c792309609d3)
15:04:37 reviews: Job OK (f8ea8652-6da7-4bf5-9782-c792309609d3)
15:04:37 Result is kept for 500 seconds
15:04:37 
15:04:37 *** Listening on chapters, profiles, reviews...
15:04:37 reviews: fanfic.jobs.crawl_reviews(10281124) (9c490699-7ab4-4d19-ad51-242daf9712b8)
15:04:49 reviews: Job OK (9c490699-7ab4-4d19-ad51-242daf9712b8)
15:04:49 Result is kept for 500 seconds
15:04:49 
15:04:49 *** Listening on chapters, profiles, reviews...
15:04:49 reviews: fanfic.jobs.crawl_reviews(10282564) (7df7fc74-32af-47f8-83d8-72ea802baba1)
15:04:59 reviews: Job OK (7df7fc74-32af-47f8-83d8-72ea802baba1)
15:04:59 Result is kept for 500 seconds
15:04:59 
15:04:59 *** Listening on chapters, profiles, reviews...
15:04:59 reviews: fanfic.jobs.crawl_reviews(10285624) (cf149cfe-a7cb-456a-a00a-c593c5a3e6b8)
15:05:02 reviews: Job OK (cf149cfe-a7cb-456a-a00a-c593c5a3e6b8)
15:05:02 Result is kept for 500 seconds
15:05:02 
15:05:02 *** Listening on chapters, profiles, reviews...
15:05:02 reviews: fanfic.jobs.crawl_reviews(10287864) (7ef5a70f-0821-4430-aec7-9868d4e3b07d)
15:08:56 reviews: Job OK (7ef5a70f-0821-4430-aec7-9868d4e3b07d)
15:08:56 Result is kept for 500 seconds
15:08:56 
15:08:56 *** Listening on chapters, profiles, reviews...
15:08:56 reviews: fanfic.jobs.crawl_reviews(10288020) (6b0f4cbc-cbac-4675-97a2-7fdb360372bf)
15:09:59 reviews: Job OK (6b0f4cbc-cbac-4675-97a2-7fdb360372bf)
15:09:59 Result is kept for 500 seconds
15:09:59 
15:09:59 *** Listening on chapters, profiles, reviews...
15:09:59 reviews: fanfic.jobs.crawl_reviews(10288529) (f8ba4a6f-a79d-41cf-8f25-5f0520228ce1)
15:10:19 reviews: Job OK (f8ba4a6f-a79d-41cf-8f25-5f0520228ce1)
15:10:19 Result is kept for 500 seconds
15:10:19 
15:10:19 *** Listening on chapters, profiles, reviews...
15:10:19 reviews: fanfic.jobs.crawl_reviews(10290276) (9766883c-88f1-4926-9788-ef96efeaafdb)
15:10:44 reviews: Job OK (9766883c-88f1-4926-9788-ef96efeaafdb)
15:10:44 Result is kept for 500 seconds
15:10:44 
15:10:44 *** Listening on chapters, profiles, reviews...
15:10:44 reviews: fanfic.jobs.crawl_reviews(10290670) (3c750bdc-716b-44e8-a761-0720f27f69c8)
15:12:20 reviews: Job OK (3c750bdc-716b-44e8-a761-0720f27f69c8)
15:12:20 Result is kept for 500 seconds
15:12:20 
15:12:20 *** Listening on chapters, profiles, reviews...
15:12:20 reviews: fanfic.jobs.crawl_reviews(10290899) (7f4f87bc-17d5-47e2-8324-b5394a2748f9)
15:13:38 reviews: Job OK (7f4f87bc-17d5-47e2-8324-b5394a2748f9)
15:13:38 Result is kept for 500 seconds
15:13:38 
15:13:38 *** Listening on chapters, profiles, reviews...
15:13:38 reviews: fanfic.jobs.crawl_reviews(10291475) (4ae06b01-d622-4cb4-97fc-d24888107b3b)
15:14:19 reviews: Job OK (4ae06b01-d622-4cb4-97fc-d24888107b3b)
15:14:19 Result is kept for 500 seconds
15:14:19 
15:14:19 *** Listening on chapters, profiles, reviews...
15:14:19 reviews: fanfic.jobs.crawl_reviews(10291877) (982d5420-8233-4a9d-bdc1-bfb067d5ba29)
15:14:33 reviews: Job OK (982d5420-8233-4a9d-bdc1-bfb067d5ba29)
15:14:33 Result is kept for 500 seconds
15:14:33 
15:14:33 *** Listening on chapters, profiles, reviews...
15:14:33 reviews: fanfic.jobs.crawl_reviews(10292446) (769d1076-827b-447f-80a9-ef481ea23510)
15:15:54 reviews: Job OK (769d1076-827b-447f-80a9-ef481ea23510)
15:15:54 Result is kept for 500 seconds
15:15:54 
15:15:54 *** Listening on chapters, profiles, reviews...
15:15:54 reviews: fanfic.jobs.crawl_reviews(10293154) (938ef9de-3ecd-4711-95b1-390207cd7dc8)
15:18:16 reviews: Job OK (938ef9de-3ecd-4711-95b1-390207cd7dc8)
15:18:16 Result is kept for 500 seconds
15:18:16 
15:18:16 *** Listening on chapters, profiles, reviews...
15:18:16 reviews: fanfic.jobs.crawl_reviews(10294505) (b9c24bc0-32ba-4b44-ab0f-c607e994f3c3)
15:18:26 reviews: Job OK (b9c24bc0-32ba-4b44-ab0f-c607e994f3c3)
15:18:26 Result is kept for 500 seconds
15:18:26 
15:18:26 *** Listening on chapters, profiles, reviews...
15:18:26 reviews: fanfic.jobs.crawl_reviews(10295068) (af827f2a-19e7-41af-a4f0-e64ae0d04d39)
15:20:13 reviews: Job OK (af827f2a-19e7-41af-a4f0-e64ae0d04d39)
15:20:13 Result is kept for 500 seconds
15:20:13 
15:20:13 *** Listening on chapters, profiles, reviews...
15:20:13 reviews: fanfic.jobs.crawl_reviews(10298075) (20db143b-4132-46a9-bf58-128499fdcc03)
15:20:56 reviews: Job OK (20db143b-4132-46a9-bf58-128499fdcc03)
15:20:56 Result is kept for 500 seconds
15:20:56 
15:20:56 *** Listening on chapters, profiles, reviews...
15:20:56 reviews: fanfic.jobs.crawl_reviews(10298096) (464fe014-3226-41f1-a4ca-135fc204b965)
15:28:24 reviews: Job OK (464fe014-3226-41f1-a4ca-135fc204b965)
15:28:24 Result is kept for 500 seconds
15:28:24 
15:28:24 *** Listening on chapters, profiles, reviews...
15:28:24 reviews: fanfic.jobs.crawl_reviews(10298121) (ff0be7cd-a870-4146-b1d4-0f3ec1a4dbfb)
15:29:31 reviews: Job OK (ff0be7cd-a870-4146-b1d4-0f3ec1a4dbfb)
15:29:31 Result is kept for 500 seconds
15:29:31 
15:29:31 *** Listening on chapters, profiles, reviews...
15:29:31 reviews: fanfic.jobs.crawl_reviews(10298470) (18b69113-d5da-4ab2-be50-482a3ea1690b)
15:29:45 reviews: Job OK (18b69113-d5da-4ab2-be50-482a3ea1690b)
15:29:45 Result is kept for 500 seconds
15:29:45 
15:29:45 *** Listening on chapters, profiles, reviews...
15:29:45 reviews: fanfic.jobs.crawl_reviews(10298713) (2810851e-2841-4df6-8ca8-c2064f746a45)
15:33:47 reviews: Job OK (2810851e-2841-4df6-8ca8-c2064f746a45)
15:33:47 Result is kept for 500 seconds
15:33:47 
15:33:47 *** Listening on chapters, profiles, reviews...
15:33:47 reviews: fanfic.jobs.crawl_reviews(10298728) (9eaba1a7-c33f-4bf0-b106-ca2540377da7)
15:34:26 reviews: Job OK (9eaba1a7-c33f-4bf0-b106-ca2540377da7)
15:34:26 Result is kept for 500 seconds
15:34:26 
15:34:26 *** Listening on chapters, profiles, reviews...
15:34:26 reviews: fanfic.jobs.crawl_reviews(10298874) (7304ab2e-5ac4-4c5d-aad2-b83daefdad73)
15:36:17 reviews: Job OK (7304ab2e-5ac4-4c5d-aad2-b83daefdad73)
15:36:17 Result is kept for 500 seconds
15:36:17 
15:36:17 *** Listening on chapters, profiles, reviews...
15:36:17 reviews: fanfic.jobs.crawl_reviews(10299037) (1d4ff106-f21e-4f33-8966-ff0e1d2dddf4)
15:36:47 reviews: Job OK (1d4ff106-f21e-4f33-8966-ff0e1d2dddf4)
15:36:47 Result is kept for 500 seconds
15:36:47 
15:36:47 *** Listening on chapters, profiles, reviews...
15:36:47 reviews: fanfic.jobs.crawl_reviews(10299149) (f1199c81-69d7-419b-addf-6c2fd630b406)
15:36:59 reviews: Job OK (f1199c81-69d7-419b-addf-6c2fd630b406)
15:36:59 Result is kept for 500 seconds
15:36:59 
15:36:59 *** Listening on chapters, profiles, reviews...
15:36:59 reviews: fanfic.jobs.crawl_reviews(10301773) (0997210a-9f35-4387-97a6-cedca9189bf2)
15:39:21 reviews: Job OK (0997210a-9f35-4387-97a6-cedca9189bf2)
15:39:21 Result is kept for 500 seconds
15:39:21 
15:39:21 *** Listening on chapters, profiles, reviews...
15:39:21 reviews: fanfic.jobs.crawl_reviews(10302258) (3ae58860-1ea1-4d66-a85b-9aed3e13f000)
15:45:36 reviews: Job OK (3ae58860-1ea1-4d66-a85b-9aed3e13f000)
15:45:36 Result is kept for 500 seconds
15:45:36 
15:45:36 *** Listening on chapters, profiles, reviews...
15:45:36 reviews: fanfic.jobs.crawl_reviews(10305847) (2b5654dc-3d61-42aa-908d-35b0e4aab390)
15:45:52 reviews: Job OK (2b5654dc-3d61-42aa-908d-35b0e4aab390)
15:45:52 Result is kept for 500 seconds
15:45:52 
15:45:52 *** Listening on chapters, profiles, reviews...
15:45:52 reviews: fanfic.jobs.crawl_reviews(10305905) (0f403bb8-e09d-4d88-bb43-e1980d32ccf7)
15:46:04 reviews: Job OK (0f403bb8-e09d-4d88-bb43-e1980d32ccf7)
15:46:04 Result is kept for 500 seconds
15:46:04 
15:46:04 *** Listening on chapters, profiles, reviews...
15:46:04 reviews: fanfic.jobs.crawl_reviews(10305910) (ef0f2cb2-2647-413f-b5cb-285193dbedf9)
15:46:30 reviews: Job OK (ef0f2cb2-2647-413f-b5cb-285193dbedf9)
15:46:30 Result is kept for 500 seconds
15:46:30 
15:46:30 *** Listening on chapters, profiles, reviews...
15:46:30 reviews: fanfic.jobs.crawl_reviews(10307293) (db227a4d-a667-48c3-b27e-10c4f44f1676)
2017-02-07 15:46:36 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 23:46:36.125205', 10307293, 222629317, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (576 characters truncated) ... /29/2015</span> </small><div style="margin-top:5px">Why are you stopping here I\'m liking this story so far and I want to hear more</div></td>\n</tr>'), ('2017-02-07 23:46:36.125209', 10307293, 221127125, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4826143&amp;r ... (911 characters truncated) ... all style="color:gray">chapter 20 . <span data-xutime="1433182980">6/1/2015</span> </small><div style="margin-top:5px">nice chappy!</div></td>\n</tr>'), ('2017-02-07 23:46:36.125212', 10307293, 202692659, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (528 characters truncated) ... chapter 2 . <span data-xutime="1403339002">6/21/2014</span> </small><div style="margin-top:5px">this is bad and you should feel bad</div></td>\n</tr>'), ('2017-02-07 23:46:36.125214', 10307293, 201095681, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (527 characters truncated) ... ray">chapter 3 . <span data-xutime="1401090328">5/26/2014</span> </small><div style="margin-top:5px">ugh so many dreadful mary sues</div></td>\n</tr>'), ('2017-02-07 23:46:36.125216', 10307293, 200284664, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (603 characters truncated) ... v style="margin-top:5px">At least tag this properly; your Sueish OC is the main character, so this should be tagged as an OC story.</div></td>\n</tr>'), ('2017-02-07 23:46:36.125217', 10307293, 200261855, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4793814&amp;r ... (971 characters truncated) ... 059326">5/14/2014</span> </small><div style="margin-top:5px">Great chapter! I\'m so excited to see what house she gets sorted into!</div></td>\n</tr>'), ('2017-02-07 23:46:36.125219', 10307293, 199853987, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4793814&amp;r ... (1086 characters truncated) ... st to take care of all the small mistakes. I would offer but I\'m not too great at all the spelling and grammar stuff. Update soon!</div></td>\n</tr>'), ('2017-02-07 23:46:36.125221', 10307293, 199440145, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4793814&amp;r ... (1253 characters truncated) ...  when people are speaking, each time a new person is speaking you have to start a new line. I\'m really enjoying this. Update soon!</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-07 23:46:36.125234', 10307293, 199853987, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4793814&amp;r ... (1086 characters truncated) ... st to take care of all the small mistakes. I would offer but I\'m not too great at all the spelling and grammar stuff. Update soon!</div></td>\n</tr>'), ('2017-02-07 23:46:36.125236', 10307293, 199440145, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4793814&amp;r ... (1253 characters truncated) ...  when people are speaking, each time a new person is speaking you have to start a new line. I\'m really enjoying this. Update soon!</div></td>\n</tr>'))]
15:46:36 reviews: Job OK (db227a4d-a667-48c3-b27e-10c4f44f1676)
15:46:36 Result is kept for 500 seconds
15:46:36 
15:46:36 *** Listening on chapters, profiles, reviews...
15:46:36 reviews: fanfic.jobs.crawl_reviews(10307870) (aaee005b-0d45-4d45-8433-246b9c105efb)
15:47:18 reviews: Job OK (aaee005b-0d45-4d45-8433-246b9c105efb)
15:47:18 Result is kept for 500 seconds
15:47:18 Cleaning registries for queue: chapters
15:47:18 Cleaning registries for queue: profiles
15:47:18 Cleaning registries for queue: reviews
15:47:18 
15:47:18 *** Listening on chapters, profiles, reviews...
15:47:18 reviews: fanfic.jobs.crawl_reviews(10308652) (0f444987-fd8b-447f-bd26-e0e142917067)
15:47:28 reviews: Job OK (0f444987-fd8b-447f-bd26-e0e142917067)
15:47:28 Result is kept for 500 seconds
15:47:28 
15:47:28 *** Listening on chapters, profiles, reviews...
15:47:28 reviews: fanfic.jobs.crawl_reviews(10309545) (1dd5b8ea-3f34-4e85-8648-2fa967ad55e3)
15:48:13 reviews: Job OK (1dd5b8ea-3f34-4e85-8648-2fa967ad55e3)
15:48:13 Result is kept for 500 seconds
15:48:13 
15:48:13 *** Listening on chapters, profiles, reviews...
15:48:13 reviews: fanfic.jobs.crawl_reviews(10309669) (29b35a5b-a7ed-442d-a2f8-670ab45d0251)
2017-02-07 15:48:19 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-07 23:48:19.859429', 10309669, 226418414, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5348050&amp;r ... (1492 characters truncated) ...  Sydney.<br>\n<br>\nOther than that, its good. Just that bit threw me off with timing because I know the climate of Sydney in July.</div></td>\n</tr>'), ('2017-02-07 23:48:19.859434', 10309669, 212295095, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4487762&amp;r ... (936 characters truncated) ... ><div style="margin-top:5px">I loved every chapter and couldn\'t stop myself from reading it all in one sitting. On to the next! :3</div></td>\n</tr>'), ('2017-02-07 23:48:19.859437', 10309669, 203145014, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2167499&amp;r ... (921 characters truncated) ... 30/2014</span> </small><div style="margin-top:5px">The last two chapters were awesome! Can\'t wait to read the third installment :D</div></td>\n</tr>'), ('2017-02-07 23:48:19.859439', 10309669, 200984024, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2167499&amp;r ... (996 characters truncated) ... o interesting! I can\'t wait to find out what happens next. I\'m also really curious about what Harry\'s told Draco. Update soon :)</div></td>\n</tr>'), ('2017-02-07 23:48:19.859441', 10309669, 199901305, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1198759&amp;r ... (1024 characters truncated) ... ade a great story here! i have no idea where its going and i love it! AWESOMENESS! just wanted to thank you for sharing your story.</div></td>\n</tr>'), ('2017-02-07 23:48:19.859443', 10309669, 199742511, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2167499&amp;r ... (1015 characters truncated) ... st installment extremely quickly! Can\'t wait to see where you go with it and I\'m excited to read the next chapter :) Update soon!</div></td>\n</tr>'), ('2017-02-07 23:48:19.859445', 10309669, 226418414, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5348050&amp;r ... (1492 characters truncated) ...  Sydney.<br>\n<br>\nOther than that, its good. Just that bit threw me off with timing because I know the climate of Sydney in July.</div></td>\n</tr>'), ('2017-02-07 23:48:19.859447', 10309669, 212295095, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4487762&amp;r ... (936 characters truncated) ... ><div style="margin-top:5px">I loved every chapter and couldn\'t stop myself from reading it all in one sitting. On to the next! :3</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-07 23:48:19.859453', 10309669, 199901305, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1198759&amp;r ... (1024 characters truncated) ... ade a great story here! i have no idea where its going and i love it! AWESOMENESS! just wanted to thank you for sharing your story.</div></td>\n</tr>'), ('2017-02-07 23:48:19.859455', 10309669, 199742511, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2167499&amp;r ... (1015 characters truncated) ... st installment extremely quickly! Can\'t wait to see where you go with it and I\'m excited to read the next chapter :) Update soon!</div></td>\n</tr>'))]
15:48:19 reviews: Job OK (29b35a5b-a7ed-442d-a2f8-670ab45d0251)
15:48:19 Result is kept for 500 seconds
15:48:19 
15:48:19 *** Listening on chapters, profiles, reviews...
15:48:19 reviews: fanfic.jobs.crawl_reviews(10310594) (d2fa5dcf-5b13-4d81-b8b7-cb0a071c0553)
15:48:45 reviews: Job OK (d2fa5dcf-5b13-4d81-b8b7-cb0a071c0553)
15:48:45 Result is kept for 500 seconds
15:48:45 
15:48:45 *** Listening on chapters, profiles, reviews...
15:48:45 reviews: fanfic.jobs.crawl_reviews(10310847) (af2b2b13-9b9a-449e-b132-7cbb84691ec0)
15:50:50 reviews: Job OK (af2b2b13-9b9a-449e-b132-7cbb84691ec0)
15:50:50 Result is kept for 500 seconds
15:50:50 
15:50:50 *** Listening on chapters, profiles, reviews...
15:50:50 reviews: fanfic.jobs.crawl_reviews(10311215) (3bf33dad-562f-4398-9567-b15186c16c38)
15:56:46 reviews: Job OK (3bf33dad-562f-4398-9567-b15186c16c38)
15:56:46 Result is kept for 500 seconds
15:56:46 
15:56:46 *** Listening on chapters, profiles, reviews...
15:56:46 reviews: fanfic.jobs.crawl_reviews(10312662) (5c0f292f-6418-47e7-a49b-65e1c5e5fee8)
16:06:48 reviews: Job OK (5c0f292f-6418-47e7-a49b-65e1c5e5fee8)
16:06:48 Result is kept for 500 seconds
16:06:48 
16:06:48 *** Listening on chapters, profiles, reviews...
16:06:48 reviews: fanfic.jobs.crawl_reviews(10314441) (e0b86b54-16b7-4020-b251-ad4cfab71b05)
16:07:03 reviews: Job OK (e0b86b54-16b7-4020-b251-ad4cfab71b05)
16:07:03 Result is kept for 500 seconds
16:07:03 
16:07:03 *** Listening on chapters, profiles, reviews...
16:07:03 reviews: fanfic.jobs.crawl_reviews(10317365) (5cd213aa-fe1b-468f-b3d9-9a49cd382672)
16:07:19 reviews: Job OK (5cd213aa-fe1b-468f-b3d9-9a49cd382672)
16:07:19 Result is kept for 500 seconds
16:07:19 
16:07:19 *** Listening on chapters, profiles, reviews...
16:07:19 reviews: fanfic.jobs.crawl_reviews(10317642) (d0bd5781-b2ad-47a5-8fe2-748faa98a519)
16:07:45 reviews: Job OK (d0bd5781-b2ad-47a5-8fe2-748faa98a519)
16:07:45 Result is kept for 500 seconds
16:07:45 
16:07:45 *** Listening on chapters, profiles, reviews...
16:07:45 reviews: fanfic.jobs.crawl_reviews(10320665) (abf246c8-39ab-46e0-b3eb-d730d7a10817)
2017-02-07 16:07:50 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 00:07:50.625982', 10320665, 201987810, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4147394&amp;r ... (827 characters truncated) ... pan data-xutime="1402521011">6/11/2014</span> </small><div style="margin-top:5px">Oh, by-the-way my name is Darrell Deam not dream.</div></td>\n</tr>'), ('2017-02-08 00:07:50.625987', 10320665, 201974098, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4147394&amp;r ... (928 characters truncated) ... ort but good chapter. I\'m looking forward to \'Destined Fate\' and the other subsequent stories and hopefully longer chapters. : )</div></td>\n</tr>'), ('2017-02-08 00:07:50.625989', 10320665, 201928421, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4147394&amp;r ... (922 characters truncated) ...  but way too short! If you\'re going to continue writing them this short then you\'re going to have to post four or five a day. : )</div></td>\n</tr>'), ('2017-02-08 00:07:50.625991', 10320665, 201928009, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2116054&amp;r ... (834 characters truncated) ... xutime="1402436848">6/10/2014</span> </small><div style="margin-top:5px">I can\'t wait to see what happens next. I love it. Thanks.</div></td>\n</tr>'), ('2017-02-08 00:07:50.625993', 10320665, 201843067, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4147394&amp;r ... (1086 characters truncated) ... bout naval battles so I used the \'cannon\' spelling out of habit and only noticed it when I clicked on the \'Post Review\' button.</div></td>\n</tr>'), ('2017-02-08 00:07:50.625995', 10320665, 201801134, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4147394&amp;r ... (1323 characters truncated) ...  while at the same time allows your readers some predictability to make it an easier read. I\'m looking forward to future chapters.</div></td>\n</tr>'), ('2017-02-08 00:07:50.625997', 10320665, 200182369, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=293911&amp;rw ... (789 characters truncated) ... yle="color:gray">chapter 6 . <span data-xutime="1399943353">5/12/2014</span> </small><div style="margin-top:5px">Interesting story.</div></td>\n</tr>'), ('2017-02-08 00:07:50.625999', 10320665, 200093638, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4511836&amp;r ... (1028 characters truncated) ... ory. I forgot that it wasn\'t finished and tried to hit the next button- that\'s how lost I was in your writing. Keep going please!</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-08 00:07:50.626020', 10320665, 199911986, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (722 characters truncated) ... and Ginny\'s is due to her being a prodigy. also like that you have Luna with the twins playing pranks. <br>\nHope you update soon.</div></td>\n</tr>'), ('2017-02-08 00:07:50.626022', 10320665, 199777037, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4542573&amp;r ... (1212 characters truncated) ... t they see from other point of views to soon because they are 13 and 14. Interesting story. Will read more on the "pack" for sure:)</div></td>\n</tr>'))]
16:07:50 reviews: Job OK (abf246c8-39ab-46e0-b3eb-d730d7a10817)
16:07:50 Result is kept for 500 seconds
16:07:50 
16:07:50 *** Listening on chapters, profiles, reviews...
16:07:50 reviews: fanfic.jobs.crawl_reviews(10321946) (d59ecece-852a-48e8-a6a1-0ab0bc3d92c2)
16:08:17 reviews: Job OK (d59ecece-852a-48e8-a6a1-0ab0bc3d92c2)
16:08:17 Result is kept for 500 seconds
16:08:17 
16:08:17 *** Listening on chapters, profiles, reviews...
16:08:17 reviews: fanfic.jobs.crawl_reviews(10322060) (42d1a8cf-8c36-4cff-9ed2-c78671d5b5e6)
16:08:22 reviews: Job OK (42d1a8cf-8c36-4cff-9ed2-c78671d5b5e6)
16:08:22 Result is kept for 500 seconds
16:08:22 
16:08:22 *** Listening on chapters, profiles, reviews...
16:08:22 reviews: fanfic.jobs.crawl_reviews(10322127) (871ac859-b427-4084-b969-21d32d83c709)
16:08:54 reviews: Job OK (871ac859-b427-4084-b969-21d32d83c709)
16:08:54 Result is kept for 500 seconds
16:08:54 
16:08:54 *** Listening on chapters, profiles, reviews...
16:08:54 reviews: fanfic.jobs.crawl_reviews(10322359) (23276f5c-45e7-4bb6-b3db-44b9ab161eb7)
16:11:28 reviews: Job OK (23276f5c-45e7-4bb6-b3db-44b9ab161eb7)
16:11:28 Result is kept for 500 seconds
16:11:28 
16:11:28 *** Listening on chapters, profiles, reviews...
16:11:28 reviews: fanfic.jobs.crawl_reviews(10322565) (8f14975c-0e46-4b33-bc86-03be0727e0d9)
16:11:33 reviews: Job OK (8f14975c-0e46-4b33-bc86-03be0727e0d9)
16:11:33 Result is kept for 500 seconds
16:11:33 
16:11:33 *** Listening on chapters, profiles, reviews...
16:11:33 reviews: fanfic.jobs.crawl_reviews(10323063) (46d31f86-7cc0-4733-b369-5fccb7db5fdf)
16:12:02 reviews: Job OK (46d31f86-7cc0-4733-b369-5fccb7db5fdf)
16:12:02 Result is kept for 500 seconds
16:12:02 
16:12:02 *** Listening on chapters, profiles, reviews...
16:12:02 reviews: fanfic.jobs.crawl_reviews(10323078) (245be3d0-703b-4041-a282-7b0e02f86d44)
2017-02-07 16:12:07 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 00:12:07.765094', 10323078, 199704814, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4387089&amp;r ... (2135 characters truncated) ... is to give you some feedback on the story itself, until then I hope you take this is in and improve your use of <br>\nBlazing Auran</div></td>\n</tr>'), ('2017-02-08 00:12:07.765099', 10323078, 199704814, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4387089&amp;r ... (2135 characters truncated) ... is to give you some feedback on the story itself, until then I hope you take this is in and improve your use of <br>\nBlazing Auran</div></td>\n</tr>'))]
16:12:07 reviews: Job OK (245be3d0-703b-4041-a282-7b0e02f86d44)
16:12:07 Result is kept for 500 seconds
16:12:07 
16:12:07 *** Listening on chapters, profiles, reviews...
16:12:07 reviews: fanfic.jobs.crawl_reviews(10323776) (a9092825-e916-42fd-92fd-cbf7ffdd806f)
16:12:16 reviews: Job OK (a9092825-e916-42fd-92fd-cbf7ffdd806f)
16:12:16 Result is kept for 500 seconds
16:12:16 
16:12:16 *** Listening on chapters, profiles, reviews...
16:12:16 reviews: fanfic.jobs.crawl_reviews(10324040) (fdf36c33-6b43-4cd1-8702-02280e94e25c)
16:13:06 reviews: Job OK (fdf36c33-6b43-4cd1-8702-02280e94e25c)
16:13:06 Result is kept for 500 seconds
16:13:06 
16:13:06 *** Listening on chapters, profiles, reviews...
16:13:06 reviews: fanfic.jobs.crawl_reviews(10324853) (b9b330cb-51b6-4e5b-974f-7c26913b0fc4)
16:14:55 reviews: Job OK (b9b330cb-51b6-4e5b-974f-7c26913b0fc4)
16:14:55 Result is kept for 500 seconds
16:14:55 
16:14:55 *** Listening on chapters, profiles, reviews...
16:14:55 reviews: fanfic.jobs.crawl_reviews(10324924) (237f77d0-871d-42d9-a008-a48b0f854d5e)
16:15:49 reviews: Job OK (237f77d0-871d-42d9-a008-a48b0f854d5e)
16:15:49 Result is kept for 500 seconds
16:15:49 
16:15:49 *** Listening on chapters, profiles, reviews...
16:15:49 reviews: fanfic.jobs.crawl_reviews(10325351) (d2c0ec32-a9b9-47a7-87ef-019e887899c5)
16:16:40 reviews: Job OK (d2c0ec32-a9b9-47a7-87ef-019e887899c5)
16:16:40 Result is kept for 500 seconds
16:16:40 
16:16:40 *** Listening on chapters, profiles, reviews...
16:16:40 reviews: fanfic.jobs.crawl_reviews(10328009) (03d5cd73-2878-41c2-86fb-6f45588bc10c)
16:19:24 reviews: Job OK (03d5cd73-2878-41c2-86fb-6f45588bc10c)
16:19:24 Result is kept for 500 seconds
16:19:24 
16:19:24 *** Listening on chapters, profiles, reviews...
16:19:24 reviews: fanfic.jobs.crawl_reviews(10329706) (344724c0-8440-4283-b6b3-4599ef75bbb5)
16:19:43 reviews: Job OK (344724c0-8440-4283-b6b3-4599ef75bbb5)
16:19:43 Result is kept for 500 seconds
16:19:43 
16:19:43 *** Listening on chapters, profiles, reviews...
16:19:43 reviews: fanfic.jobs.crawl_reviews(10329803) (5d827074-05f7-41c3-99c1-0e84df86b9c9)
16:20:18 reviews: Job OK (5d827074-05f7-41c3-99c1-0e84df86b9c9)
16:20:18 Result is kept for 500 seconds
16:20:18 
16:20:18 *** Listening on chapters, profiles, reviews...
16:20:18 reviews: fanfic.jobs.crawl_reviews(10330977) (1ab51d56-67b8-4b9b-8baa-8f57cae0934c)
16:20:23 reviews: Job OK (1ab51d56-67b8-4b9b-8baa-8f57cae0934c)
16:20:23 Result is kept for 500 seconds
16:20:23 
16:20:23 *** Listening on chapters, profiles, reviews...
16:20:23 reviews: fanfic.jobs.crawl_reviews(10331080) (9c570677-d9e8-4b7c-9971-78319c57cc54)
16:21:14 reviews: Job OK (9c570677-d9e8-4b7c-9971-78319c57cc54)
16:21:14 Result is kept for 500 seconds
16:21:14 
16:21:14 *** Listening on chapters, profiles, reviews...
16:21:14 reviews: fanfic.jobs.crawl_reviews(10331307) (ef12b67c-ce42-4f5f-9cdd-2a2d3480a960)
16:23:34 reviews: Job OK (ef12b67c-ce42-4f5f-9cdd-2a2d3480a960)
16:23:34 Result is kept for 500 seconds
16:23:34 
16:23:34 *** Listening on chapters, profiles, reviews...
16:23:34 reviews: fanfic.jobs.crawl_reviews(10331445) (cdcfb0dc-4246-49c3-82bd-33fe0ec73607)
16:23:49 reviews: Job OK (cdcfb0dc-4246-49c3-82bd-33fe0ec73607)
16:23:49 Result is kept for 500 seconds
16:23:49 
16:23:49 *** Listening on chapters, profiles, reviews...
16:23:49 reviews: fanfic.jobs.crawl_reviews(10332434) (5e068399-39e1-4c43-8f87-7d128d6e2829)
16:24:27 reviews: Job OK (5e068399-39e1-4c43-8f87-7d128d6e2829)
16:24:27 Result is kept for 500 seconds
16:24:27 
16:24:27 *** Listening on chapters, profiles, reviews...
16:24:27 reviews: fanfic.jobs.crawl_reviews(10333477) (594f8735-3938-4058-9bc9-d8f814b91059)
16:29:57 reviews: Job OK (594f8735-3938-4058-9bc9-d8f814b91059)
16:29:57 Result is kept for 500 seconds
16:29:57 
16:29:57 *** Listening on chapters, profiles, reviews...
16:29:57 reviews: fanfic.jobs.crawl_reviews(10333593) (4ca3e84d-c18c-4b79-9862-f8081095cfb9)
16:30:15 reviews: Job OK (4ca3e84d-c18c-4b79-9862-f8081095cfb9)
16:30:15 Result is kept for 500 seconds
16:30:15 
16:30:15 *** Listening on chapters, profiles, reviews...
16:30:15 reviews: fanfic.jobs.crawl_reviews(10336385) (a96d41a5-9179-4bce-8a80-ef63717d93f4)
16:31:11 reviews: Job OK (a96d41a5-9179-4bce-8a80-ef63717d93f4)
16:31:11 Result is kept for 500 seconds
16:31:11 
16:31:11 *** Listening on chapters, profiles, reviews...
16:31:11 reviews: fanfic.jobs.crawl_reviews(10336637) (f4efca94-7639-4217-8647-2b45a438c7ca)
16:32:48 reviews: Job OK (f4efca94-7639-4217-8647-2b45a438c7ca)
16:32:48 Result is kept for 500 seconds
16:32:48 
16:32:48 *** Listening on chapters, profiles, reviews...
16:32:48 reviews: fanfic.jobs.crawl_reviews(10338063) (6c30480e-3a7a-40ea-8ce0-7ff4b1da074f)
2017-02-07 16:32:52 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 00:32:52.406706', 10338063, 228701198, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5995213&amp;r ... (924 characters truncated) ... "1446709234">11/4/2015</span> </small><div style="margin-top:5px">What happens! It ended so suddenly! What\'s going to happen next!</div></td>\n</tr>'), ('2017-02-08 00:32:52.406711', 10338063, 200180064, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2801811&amp;r ... (974 characters truncated) ... 12/2014</span> </small><div style="margin-top:5px">I really loved this! Please continue I want to know what happens with these two!</div></td>\n</tr>'), ('2017-02-08 00:32:52.406714', 10338063, 228701198, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5995213&amp;r ... (924 characters truncated) ... "1446709234">11/4/2015</span> </small><div style="margin-top:5px">What happens! It ended so suddenly! What\'s going to happen next!</div></td>\n</tr>'), ('2017-02-08 00:32:52.406716', 10338063, 200180064, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2801811&amp;r ... (974 characters truncated) ... 12/2014</span> </small><div style="margin-top:5px">I really loved this! Please continue I want to know what happens with these two!</div></td>\n</tr>'))]
16:32:52 reviews: Job OK (6c30480e-3a7a-40ea-8ce0-7ff4b1da074f)
16:32:52 Result is kept for 500 seconds
16:32:52 
16:32:52 *** Listening on chapters, profiles, reviews...
16:32:52 reviews: fanfic.jobs.crawl_reviews(10338855) (2c2cc444-b9b6-45e9-a939-8d4d5b05bca4)
16:33:02 reviews: Job OK (2c2cc444-b9b6-45e9-a939-8d4d5b05bca4)
16:33:02 Result is kept for 500 seconds
16:33:02 
16:33:02 *** Listening on chapters, profiles, reviews...
16:33:02 reviews: fanfic.jobs.crawl_reviews(10339714) (eeca6382-3261-4b12-8206-d6725740c023)
16:33:31 reviews: Job OK (eeca6382-3261-4b12-8206-d6725740c023)
16:33:31 Result is kept for 500 seconds
16:33:31 
16:33:31 *** Listening on chapters, profiles, reviews...
16:33:31 reviews: fanfic.jobs.crawl_reviews(10339852) (cd658ef8-1aba-4503-ba2c-962beb4ab25d)
16:44:09 reviews: Job OK (cd658ef8-1aba-4503-ba2c-962beb4ab25d)
16:44:09 Result is kept for 500 seconds
16:44:10 
16:44:10 *** Listening on chapters, profiles, reviews...
16:44:10 reviews: fanfic.jobs.crawl_reviews(10340328) (b709916b-7343-4cb5-9620-f06dfcdceab9)
16:44:35 reviews: Job OK (b709916b-7343-4cb5-9620-f06dfcdceab9)
16:44:35 Result is kept for 500 seconds
16:44:35 
16:44:35 *** Listening on chapters, profiles, reviews...
16:44:35 reviews: fanfic.jobs.crawl_reviews(10340564) (50a21f73-2f40-4f02-a565-a13f4986b9d2)
16:45:11 reviews: Job OK (50a21f73-2f40-4f02-a565-a13f4986b9d2)
16:45:11 Result is kept for 500 seconds
16:45:11 
16:45:11 *** Listening on chapters, profiles, reviews...
16:45:11 reviews: fanfic.jobs.crawl_reviews(10340860) (58fd5e9d-9227-48f7-84b0-2570eacd1d15)
16:45:32 reviews: Job OK (58fd5e9d-9227-48f7-84b0-2570eacd1d15)
16:45:32 Result is kept for 500 seconds
16:45:32 
16:45:32 *** Listening on chapters, profiles, reviews...
16:45:32 reviews: fanfic.jobs.crawl_reviews(10340921) (9b423461-fd9e-4ae5-97f4-9d852f77a733)
16:46:07 reviews: Job OK (9b423461-fd9e-4ae5-97f4-9d852f77a733)
16:46:07 Result is kept for 500 seconds
16:46:07 
16:46:07 *** Listening on chapters, profiles, reviews...
16:46:07 reviews: fanfic.jobs.crawl_reviews(10342423) (e8fc45ec-e3f1-404d-a8ec-defa2be86854)
16:49:11 reviews: Job OK (e8fc45ec-e3f1-404d-a8ec-defa2be86854)
16:49:11 Result is kept for 500 seconds
16:49:11 Cleaning registries for queue: chapters
16:49:11 Cleaning registries for queue: profiles
16:49:11 Cleaning registries for queue: reviews
16:49:11 
16:49:11 *** Listening on chapters, profiles, reviews...
16:49:11 reviews: fanfic.jobs.crawl_reviews(10343166) (ee31ec19-52f0-4170-be5c-85ceb5b478fd)
16:50:32 reviews: Job OK (ee31ec19-52f0-4170-be5c-85ceb5b478fd)
16:50:32 Result is kept for 500 seconds
16:50:32 
16:50:32 *** Listening on chapters, profiles, reviews...
16:50:32 reviews: fanfic.jobs.crawl_reviews(10348441) (4b17c762-572f-4ae7-9bbd-8efdf0a6fe85)
16:51:28 reviews: Job OK (4b17c762-572f-4ae7-9bbd-8efdf0a6fe85)
16:51:28 Result is kept for 500 seconds
16:51:28 
16:51:28 *** Listening on chapters, profiles, reviews...
16:51:28 reviews: fanfic.jobs.crawl_reviews(10349675) (458375bf-a25e-40b3-a66e-7bc50d16f866)
16:58:07 reviews: Job OK (458375bf-a25e-40b3-a66e-7bc50d16f866)
16:58:07 Result is kept for 500 seconds
16:58:07 
16:58:07 *** Listening on chapters, profiles, reviews...
16:58:07 reviews: fanfic.jobs.crawl_reviews(10351238) (063e9ac0-b61b-4a0e-bde4-db9d8bcdeee6)
16:59:10 reviews: Job OK (063e9ac0-b61b-4a0e-bde4-db9d8bcdeee6)
16:59:10 Result is kept for 500 seconds
16:59:10 
16:59:10 *** Listening on chapters, profiles, reviews...
16:59:10 reviews: fanfic.jobs.crawl_reviews(10351981) (23391378-a11d-40db-8490-ea630b60bf1d)
2017-02-07 16:59:16 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 00:59:16.073780', 10351981, 242857076, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=677979&amp;rw ... (1553 characters truncated) ... ;g from going back just defaults to timeline "f" only with them back at the burrow and not on the run about to find goderics sword.</div></td>\n</tr>'), ('2017-02-08 00:59:16.073785', 10351981, 234062250, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2462147&amp;r ... (927 characters truncated) ...  what Sirius\' idea to protect her is! Kudos for the way you kept the different time lines "unconfusing"! Keep it up, my friend! :)</div></td>\n</tr>'), ('2017-02-08 00:59:16.073787', 10351981, 234061938, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2462147&amp;r ... (1142 characters truncated) ... Regulus didn\'t come to help save the day, considering he\'s wanting to get back in his brother\'s good graces again. Good chapter1</div></td>\n</tr>'), ('2017-02-08 00:59:16.073789', 10351981, 232586569, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2462147&amp;r ... (920 characters truncated) ... n\'t wait to find out what happened to "big" Draco! I really liked the idea of his \'keeping the chair warm\' for his younger self.</div></td>\n</tr>'), ('2017-02-08 00:59:16.073791', 10351981, 232370816, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=477880&amp;rw ... (868 characters truncated) ... all><div style="margin-top:5px">Yay! Very glad to see an update! Looking forward to more when you can. And yay for original novels!</div></td>\n</tr>'), ('2017-02-08 00:59:16.073794', 10351981, 228883855, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7122714&amp;r ... (1110 characters truncated) ... writing this, or ever intend to come back to it, but I enjoy your writing style, and intend to find the novel you have published :)</div></td>\n</tr>'), ('2017-02-08 00:59:16.073796', 10351981, 201260918, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2577372&amp;r ... (1081 characters truncated) ...  interactions between all the different timelines and I am honestly in awe how you keep them all straight. Looking forward to more!</div></td>\n</tr>'), ('2017-02-08 00:59:16.073798', 10351981, 200397258, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2577372&amp;r ... (992 characters truncated) ... e this story back! I really enjoyed the intricacies of all the different timelines. Looking forward to getting reacquainted with it</div></td>\n</tr>')  ... displaying 10 of 18 total bound parameter sets ...  ('2017-02-08 00:59:16.073816', 10351981, 200397258, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2577372&amp;r ... (992 characters truncated) ... e this story back! I really enjoyed the intricacies of all the different timelines. Looking forward to getting reacquainted with it</div></td>\n</tr>'), ('2017-02-08 00:59:16.073818', 10351981, 200368080, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=902996&amp;rw ... (1184 characters truncated) ... he two back together) Loved B/W/R btw. For you to attempt this AND hopefully (i\'m rooting for your success) succeed will be great!</div></td>\n</tr>'))]
16:59:16 reviews: Job OK (23391378-a11d-40db-8490-ea630b60bf1d)
16:59:16 Result is kept for 500 seconds
16:59:16 
16:59:16 *** Listening on chapters, profiles, reviews...
16:59:16 reviews: fanfic.jobs.crawl_reviews(10352006) (9aa4b78f-a00a-4953-b9b8-d1d34869a6ac)
16:59:25 reviews: Job OK (9aa4b78f-a00a-4953-b9b8-d1d34869a6ac)
16:59:25 Result is kept for 500 seconds
16:59:25 
16:59:25 *** Listening on chapters, profiles, reviews...
16:59:25 reviews: fanfic.jobs.crawl_reviews(10352421) (ca17e229-f016-49bf-bedd-e8c6431b59c1)
17:03:02 reviews: Job OK (ca17e229-f016-49bf-bedd-e8c6431b59c1)
17:03:02 Result is kept for 500 seconds
17:03:02 
17:03:02 *** Listening on chapters, profiles, reviews...
17:03:02 reviews: fanfic.jobs.crawl_reviews(10353578) (a66d42a6-aff9-47fe-8666-3f0937d0275c)
17:03:30 reviews: Job OK (a66d42a6-aff9-47fe-8666-3f0937d0275c)
17:03:30 Result is kept for 500 seconds
17:03:30 
17:03:30 *** Listening on chapters, profiles, reviews...
17:03:30 reviews: fanfic.jobs.crawl_reviews(10353970) (d6907202-4261-43c6-b819-44fc08eb3274)
17:03:45 reviews: Job OK (d6907202-4261-43c6-b819-44fc08eb3274)
17:03:45 Result is kept for 500 seconds
17:03:45 
17:03:45 *** Listening on chapters, profiles, reviews...
17:03:45 reviews: fanfic.jobs.crawl_reviews(10355421) (09e071c5-b366-4c08-9107-bd428022513e)
17:04:06 reviews: Job OK (09e071c5-b366-4c08-9107-bd428022513e)
17:04:06 Result is kept for 500 seconds
17:04:06 
17:04:06 *** Listening on chapters, profiles, reviews...
17:04:06 reviews: fanfic.jobs.crawl_reviews(10355786) (2c63b8af-d453-4d31-aa7e-2981e2496b3d)
17:05:12 reviews: Job OK (2c63b8af-d453-4d31-aa7e-2981e2496b3d)
17:05:12 Result is kept for 500 seconds
17:05:12 
17:05:12 *** Listening on chapters, profiles, reviews...
17:05:12 reviews: fanfic.jobs.crawl_reviews(10356038) (282a4e9f-057f-4d2d-a114-59c9d23e1511)
17:06:46 reviews: Job OK (282a4e9f-057f-4d2d-a114-59c9d23e1511)
17:06:46 Result is kept for 500 seconds
17:06:46 
17:06:46 *** Listening on chapters, profiles, reviews...
17:06:46 reviews: fanfic.jobs.crawl_reviews(10356239) (8644a033-8fb2-4001-a857-7d1da4ca5d22)
17:08:53 reviews: Job OK (8644a033-8fb2-4001-a857-7d1da4ca5d22)
17:08:53 Result is kept for 500 seconds
17:08:53 
17:08:53 *** Listening on chapters, profiles, reviews...
17:08:53 reviews: fanfic.jobs.crawl_reviews(10357110) (c6a71124-219a-4c6f-91fc-1744c6202364)
17:10:59 reviews: Job OK (c6a71124-219a-4c6f-91fc-1744c6202364)
17:10:59 Result is kept for 500 seconds
17:10:59 
17:10:59 *** Listening on chapters, profiles, reviews...
17:10:59 reviews: fanfic.jobs.crawl_reviews(10357564) (d439543e-4413-44b6-a563-6db95c5d3915)
17:12:11 reviews: Job OK (d439543e-4413-44b6-a563-6db95c5d3915)
17:12:11 Result is kept for 500 seconds
17:12:11 
17:12:11 *** Listening on chapters, profiles, reviews...
17:12:11 reviews: fanfic.jobs.crawl_reviews(10358752) (89e7d040-adb6-4f92-8fff-d1fb3dcf728e)
17:16:37 reviews: Job OK (89e7d040-adb6-4f92-8fff-d1fb3dcf728e)
17:16:37 Result is kept for 500 seconds
17:16:37 
17:16:37 *** Listening on chapters, profiles, reviews...
17:16:37 reviews: fanfic.jobs.crawl_reviews(10359113) (2f4012dc-43bc-49a2-95d5-51c0d462e384)
17:25:04 reviews: Job OK (2f4012dc-43bc-49a2-95d5-51c0d462e384)
17:25:04 Result is kept for 500 seconds
17:25:04 
17:25:04 *** Listening on chapters, profiles, reviews...
17:25:04 reviews: fanfic.jobs.crawl_reviews(10359334) (32b93371-6b5d-4ffb-b91f-09dc1ef7494a)
17:25:44 reviews: Job OK (32b93371-6b5d-4ffb-b91f-09dc1ef7494a)
17:25:44 Result is kept for 500 seconds
17:25:44 
17:25:44 *** Listening on chapters, profiles, reviews...
17:25:44 reviews: fanfic.jobs.crawl_reviews(10359824) (82c44437-1a6f-4b1e-8c03-ff0409acd5ca)
17:26:06 reviews: Job OK (82c44437-1a6f-4b1e-8c03-ff0409acd5ca)
17:26:06 Result is kept for 500 seconds
17:26:06 
17:26:06 *** Listening on chapters, profiles, reviews...
17:26:06 reviews: fanfic.jobs.crawl_reviews(10360006) (612e7cc1-4c42-4d91-90d1-b392320a2339)
2017-02-07 17:26:11 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 01:26:11.095764', 10360006, 208375446, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2642451&amp;r ... (940 characters truncated) ... ure reading it.<br>\n<br>\nBut do you know you\'ve got nearly all your Russian quotes wrong, as well as name of poor Anya Romanova?</div></td>\n</tr>'), ('2017-02-08 01:26:11.095769', 10360006, 204960452, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4803868&amp;r ... (981 characters truncated) ... 5px">wow, how many events, everything was so good <br>\nhonestly i love the relationship between Ana and Severus<br>\nGood Chapter.</div></td>\n</tr>'), ('2017-02-08 01:26:11.095771', 10360006, 202078421, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3756840&amp;r ... (961 characters truncated) ... it, I\'m bored of the Neville/Pansy arc. I want it to go back to Ana/Severus again. Is Ana going to go into remission? Update soon!</div></td>\n</tr>'), ('2017-02-08 01:26:11.095773', 10360006, 201567810, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4607924&amp;r ... (1034 characters truncated) ... really is that the first chapter is so long when i accidently exited the tab it took me ages to find my place again:D update soon:D</div></td>\n</tr>'), ('2017-02-08 01:26:11.095775', 10360006, 201516759, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4803868&amp;r ... (1023 characters truncated) ... ng. <br>\nI liked quite the rapprochement of Pansy and Neville <br>\nNow I wonder, what will be thinking Snape? <br>\n<br>\nkissess</div></td>\n</tr>'), ('2017-02-08 01:26:11.095777', 10360006, 200742928, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1309 characters truncated) ... . Sorry to be this negative, but asresearch has shown, ease of content navigation is a key element in mobile (and other) usability.</div></td>\n</tr>'), ('2017-02-08 01:26:11.095779', 10360006, 200701544, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4803868&amp;r ... (987 characters truncated) ...  will say that all this was confusing. <br>\nBut I really love the story, keep it up. <br>\nPoor Snape, which awaits xD<br>\nkisses</div></td>\n</tr>'), ('2017-02-08 01:26:11.095781', 10360006, 200583751, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3756840&amp;r ... (1002 characters truncated) ... ory when you changed it. I only knew because I was searching for a story to read and found this. Just wanted to give you a warning.</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-08 01:26:11.095795', 10360006, 200701544, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4803868&amp;r ... (987 characters truncated) ...  will say that all this was confusing. <br>\nBut I really love the story, keep it up. <br>\nPoor Snape, which awaits xD<br>\nkisses</div></td>\n</tr>'), ('2017-02-08 01:26:11.095796', 10360006, 200583751, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3756840&amp;r ... (1002 characters truncated) ... ory when you changed it. I only knew because I was searching for a story to read and found this. Just wanted to give you a warning.</div></td>\n</tr>'))]
17:26:11 reviews: Job OK (612e7cc1-4c42-4d91-90d1-b392320a2339)
17:26:11 Result is kept for 500 seconds
17:26:11 
17:26:11 *** Listening on chapters, profiles, reviews...
17:26:11 reviews: fanfic.jobs.crawl_reviews(10360056) (71852dfe-dcab-484d-989c-4cf9248d399f)
17:27:32 reviews: Job OK (71852dfe-dcab-484d-989c-4cf9248d399f)
17:27:32 Result is kept for 500 seconds
17:27:32 
17:27:32 *** Listening on chapters, profiles, reviews...
17:27:32 reviews: fanfic.jobs.crawl_reviews(10360275) (567a3247-d013-485c-9ad2-8b6a294cef34)
17:28:25 reviews: Job OK (567a3247-d013-485c-9ad2-8b6a294cef34)
17:28:25 Result is kept for 500 seconds
17:28:25 
17:28:25 *** Listening on chapters, profiles, reviews...
17:28:25 reviews: fanfic.jobs.crawl_reviews(10360522) (aa04d722-2f38-4ae0-9c49-b2de1d0689a1)
17:29:33 reviews: Job OK (aa04d722-2f38-4ae0-9c49-b2de1d0689a1)
17:29:33 Result is kept for 500 seconds
17:29:33 
17:29:33 *** Listening on chapters, profiles, reviews...
17:29:33 reviews: fanfic.jobs.crawl_reviews(10362319) (712af67c-dcc6-4f5d-8358-0ca82ba79fbb)
17:32:30 reviews: Job OK (712af67c-dcc6-4f5d-8358-0ca82ba79fbb)
17:32:30 Result is kept for 500 seconds
17:32:30 
17:32:30 *** Listening on chapters, profiles, reviews...
17:32:30 reviews: fanfic.jobs.crawl_reviews(10363337) (430df3fa-ab2d-42f3-93a3-4203b51fb20d)
17:33:03 reviews: Job OK (430df3fa-ab2d-42f3-93a3-4203b51fb20d)
17:33:03 Result is kept for 500 seconds
17:33:03 
17:33:03 *** Listening on chapters, profiles, reviews...
17:33:03 reviews: fanfic.jobs.crawl_reviews(10364568) (32b08423-7d7a-4f6d-827b-e4681d2053be)
17:34:26 reviews: Job OK (32b08423-7d7a-4f6d-827b-e4681d2053be)
17:34:26 Result is kept for 500 seconds
17:34:26 
17:34:26 *** Listening on chapters, profiles, reviews...
17:34:26 reviews: fanfic.jobs.crawl_reviews(10364683) (9bce3088-c034-44e1-9e9a-119eb7a88e88)
17:36:27 reviews: Job OK (9bce3088-c034-44e1-9e9a-119eb7a88e88)
17:36:27 Result is kept for 500 seconds
17:36:27 
17:36:27 *** Listening on chapters, profiles, reviews...
17:36:27 reviews: fanfic.jobs.crawl_reviews(10367491) (d849507f-c100-46f7-96d9-9c95b50ffdd8)
17:36:46 reviews: Job OK (d849507f-c100-46f7-96d9-9c95b50ffdd8)
17:36:46 Result is kept for 500 seconds
17:36:46 
17:36:46 *** Listening on chapters, profiles, reviews...
17:36:46 reviews: fanfic.jobs.crawl_reviews(10369035) (61494634-355c-4142-94ed-c84f8dc22d6d)
17:39:43 reviews: Job OK (61494634-355c-4142-94ed-c84f8dc22d6d)
17:39:43 Result is kept for 500 seconds
17:39:43 
17:39:43 *** Listening on chapters, profiles, reviews...
17:39:43 reviews: fanfic.jobs.crawl_reviews(10370009) (929c1243-9f33-4912-a96e-be617e8b4fff)
17:45:03 reviews: Job OK (929c1243-9f33-4912-a96e-be617e8b4fff)
17:45:03 Result is kept for 500 seconds
17:45:03 
17:45:03 *** Listening on chapters, profiles, reviews...
17:45:03 reviews: fanfic.jobs.crawl_reviews(10371133) (256ea8e0-be31-4d5b-b9fc-4e7e814b51ec)
17:46:20 reviews: Job OK (256ea8e0-be31-4d5b-b9fc-4e7e814b51ec)
17:46:20 Result is kept for 500 seconds
17:46:20 
17:46:20 *** Listening on chapters, profiles, reviews...
17:46:20 reviews: fanfic.jobs.crawl_reviews(10371302) (0481fefb-0691-4842-beff-f3ea4ea90bc9)
17:46:36 reviews: Job OK (0481fefb-0691-4842-beff-f3ea4ea90bc9)
17:46:36 Result is kept for 500 seconds
17:46:37 
17:46:37 *** Listening on chapters, profiles, reviews...
17:46:37 reviews: fanfic.jobs.crawl_reviews(10372260) (ce9c06fe-65c0-46af-bf83-7af39bd719dc)
17:49:53 reviews: Job OK (ce9c06fe-65c0-46af-bf83-7af39bd719dc)
17:49:53 Result is kept for 500 seconds
17:49:53 Cleaning registries for queue: chapters
17:49:53 Cleaning registries for queue: profiles
17:49:53 Cleaning registries for queue: reviews
17:49:53 
17:49:53 *** Listening on chapters, profiles, reviews...
17:49:53 reviews: fanfic.jobs.crawl_reviews(10373424) (dfd0a862-a697-4570-a620-9da5badbd410)
17:50:14 reviews: Job OK (dfd0a862-a697-4570-a620-9da5badbd410)
17:50:14 Result is kept for 500 seconds
17:50:14 
17:50:14 *** Listening on chapters, profiles, reviews...
17:50:14 reviews: fanfic.jobs.crawl_reviews(10373589) (b07fe3f2-a112-4718-9eb8-5c0a9cd5280c)
17:50:31 reviews: Job OK (b07fe3f2-a112-4718-9eb8-5c0a9cd5280c)
17:50:31 Result is kept for 500 seconds
17:50:31 
17:50:31 *** Listening on chapters, profiles, reviews...
17:50:31 reviews: fanfic.jobs.crawl_reviews(10373959) (71936309-6fe1-4386-b796-dca6c92e07c7)
17:57:43 reviews: Job OK (71936309-6fe1-4386-b796-dca6c92e07c7)
17:57:43 Result is kept for 500 seconds
17:57:43 
17:57:43 *** Listening on chapters, profiles, reviews...
17:57:43 reviews: fanfic.jobs.crawl_reviews(10374236) (41ceaef3-d170-43a1-b21e-3f1f173d6080)
17:58:02 reviews: Job OK (41ceaef3-d170-43a1-b21e-3f1f173d6080)
17:58:02 Result is kept for 500 seconds
17:58:02 
17:58:02 *** Listening on chapters, profiles, reviews...
17:58:02 reviews: fanfic.jobs.crawl_reviews(10378500) (64344bea-5d2d-4064-83a9-eac9f516a6ed)
17:58:15 reviews: Job OK (64344bea-5d2d-4064-83a9-eac9f516a6ed)
17:58:15 Result is kept for 500 seconds
17:58:15 
17:58:15 *** Listening on chapters, profiles, reviews...
17:58:15 reviews: fanfic.jobs.crawl_reviews(10378968) (21bf1f6e-6f2a-4f39-989f-f0dae2da8b13)
17:58:20 reviews: Job OK (21bf1f6e-6f2a-4f39-989f-f0dae2da8b13)
17:58:20 Result is kept for 500 seconds
17:58:20 
17:58:20 *** Listening on chapters, profiles, reviews...
17:58:20 reviews: fanfic.jobs.crawl_reviews(10379140) (07f5f3b5-538d-4a44-b6cc-a898a6a8906a)
17:58:37 reviews: Job OK (07f5f3b5-538d-4a44-b6cc-a898a6a8906a)
17:58:37 Result is kept for 500 seconds
17:58:37 
17:58:37 *** Listening on chapters, profiles, reviews...
17:58:37 reviews: fanfic.jobs.crawl_reviews(10381434) (c898b484-dfb3-401f-8028-975787d614c9)
18:02:24 reviews: Job OK (c898b484-dfb3-401f-8028-975787d614c9)
18:02:24 Result is kept for 500 seconds
18:02:24 
18:02:24 *** Listening on chapters, profiles, reviews...
18:02:24 reviews: fanfic.jobs.crawl_reviews(10381489) (65fbcbb4-6f80-483e-b3e0-09cc52c97c07)
18:03:25 reviews: Job OK (65fbcbb4-6f80-483e-b3e0-09cc52c97c07)
18:03:25 Result is kept for 500 seconds
18:03:25 
18:03:25 *** Listening on chapters, profiles, reviews...
18:03:25 reviews: fanfic.jobs.crawl_reviews(10382653) (9a85b77d-e1c3-41ce-927e-15c7d637621f)
18:07:31 reviews: Job OK (9a85b77d-e1c3-41ce-927e-15c7d637621f)
18:07:31 Result is kept for 500 seconds
18:07:31 
18:07:31 *** Listening on chapters, profiles, reviews...
18:07:31 reviews: fanfic.jobs.crawl_reviews(10382837) (56fcb068-a6a6-4e55-a68f-bb4601256e4c)
18:09:51 reviews: Job OK (56fcb068-a6a6-4e55-a68f-bb4601256e4c)
18:09:51 Result is kept for 500 seconds
18:09:51 
18:09:51 *** Listening on chapters, profiles, reviews...
18:09:51 reviews: fanfic.jobs.crawl_reviews(10383056) (91aa3a2f-5341-451d-ae8d-23ad9076b083)
2017-02-07 18:09:56 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 02:09:56.339740', 10383056, 241050185, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3073152&amp;r ... (892 characters truncated) ... olor:gray">chapter 14 . <span data-xutime="1471933609">8/22/2016</span> </small><div style="margin-top:5px">I vote for Beauxbatons.</div></td>\n</tr>'), ('2017-02-08 02:09:56.339745', 10383056, 241050090, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3073152&amp;r ... (948 characters truncated) ... /22/2016</span> </small><div style="margin-top:5px">Um, the old word for a harp is lyre, not lyra.<br>\nAnd it\'s Veela, not Vella.</div></td>\n</tr>'), ('2017-02-08 02:09:56.339747', 10383056, 241049610, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3073152&amp;r ... (979 characters truncated) ... yle="margin-top:5px">I\'m a Hufflepuff.<br>\nMy wand is English oak with unicorn hair, eleven and a half inches, slightly yielding.</div></td>\n</tr>'), ('2017-02-08 02:09:56.339749', 10383056, 241048771, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3073152&amp;r ... (884 characters truncated) ... style="color:gray">chapter 3 . <span data-xutime="1471930341">8/22/2016</span> </small><div style="margin-top:5px">Nagini, perhaps?</div></td>\n</tr>'), ('2017-02-08 02:09:56.339751', 10383056, 217837922, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2968678&amp;r ... (911 characters truncated) ... "color:gray">chapter 13 . <span data-xutime="1427608579">3/28/2015</span> </small><div style="margin-top:5px">can\'t wait for more!</div></td>\n</tr>'), ('2017-02-08 02:09:56.339753', 10383056, 205887369, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5585437&amp;r ... (879 characters truncated) ... ll style="color:gray">chapter 12 . <span data-xutime="1407870636">8/12/2014</span> </small><div style="margin-top:5px">update soon!</div></td>\n</tr>'), ('2017-02-08 02:09:56.339755', 10383056, 201183250, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5585437&amp;r ... (893 characters truncated) ... r:gray">chapter 3 . <span data-xutime="1401391958">5/29/2014</span> </small><div style="margin-top:5px">It\'s you know who\'s snake</div></td>\n</tr>'), ('2017-02-08 02:09:56.339757', 10383056, 241050185, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3073152&amp;r ... (892 characters truncated) ... olor:gray">chapter 14 . <span data-xutime="1471933609">8/22/2016</span> </small><div style="margin-top:5px">I vote for Beauxbatons.</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-08 02:09:56.339766', 10383056, 205887369, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5585437&amp;r ... (879 characters truncated) ... ll style="color:gray">chapter 12 . <span data-xutime="1407870636">8/12/2014</span> </small><div style="margin-top:5px">update soon!</div></td>\n</tr>'), ('2017-02-08 02:09:56.339768', 10383056, 201183250, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5585437&amp;r ... (893 characters truncated) ... r:gray">chapter 3 . <span data-xutime="1401391958">5/29/2014</span> </small><div style="margin-top:5px">It\'s you know who\'s snake</div></td>\n</tr>'))]
18:09:56 reviews: Job OK (91aa3a2f-5341-451d-ae8d-23ad9076b083)
18:09:56 Result is kept for 500 seconds
18:09:56 
18:09:56 *** Listening on chapters, profiles, reviews...
18:09:56 reviews: fanfic.jobs.crawl_reviews(10383921) (3558647f-ff1a-4c26-a45b-c6e98f2c1b14)
18:12:44 reviews: Job OK (3558647f-ff1a-4c26-a45b-c6e98f2c1b14)
18:12:44 Result is kept for 500 seconds
18:12:44 
18:12:44 *** Listening on chapters, profiles, reviews...
18:12:44 reviews: fanfic.jobs.crawl_reviews(10384141) (16defef5-1ef1-46b6-afab-92a426fe9401)
18:13:00 reviews: Job OK (16defef5-1ef1-46b6-afab-92a426fe9401)
18:13:00 Result is kept for 500 seconds
18:13:00 
18:13:00 *** Listening on chapters, profiles, reviews...
18:13:00 reviews: fanfic.jobs.crawl_reviews(10384704) (e73d8ff0-cae3-4a5a-880a-97d12fac9615)
2017-02-07 18:13:06 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 02:13:06.383364', 10384704, 242495355, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (552 characters truncated) ... ata-xutime="1475202668">9/29/2016</span> </small><div style="margin-top:5px">Carbon copy of different season with the names changed</div></td>\n</tr>'), ('2017-02-08 02:13:06.383369', 10384704, 203350591, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (587 characters truncated) ... pan> </small><div style="margin-top:5px">didnt go out with a bang but thanks for sharing apt pupil the movie is pretty good too lol</div></td>\n</tr>'), ('2017-02-08 02:13:06.383371', 10384704, 201463702, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1156348&amp;r ... (2435 characters truncated) ... eting. After all, Snape is probably already facing Life in Prison/Death Penalty for his previous crimes. There\'s no real deterent.</div></td>\n</tr>'), ('2017-02-08 02:13:06.383373', 10384704, 201373154, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=649260&amp;rw ... (4124 characters truncated) ... it until the end, and that\'s what you stay in fanfiction for - those gripping ones. Count this one as a gripping story. Thank you.</div></td>\n</tr>'), ('2017-02-08 02:13:06.383375', 10384704, 201093665, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=828258&amp;rw ... (992 characters truncated) ...  something else. However, I can\'t help that feel that nothing was truly resolved in the end? Though that\'s what life is, I guess.</div></td>\n</tr>'), ('2017-02-08 02:13:06.383377', 10384704, 242495355, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (552 characters truncated) ... ata-xutime="1475202668">9/29/2016</span> </small><div style="margin-top:5px">Carbon copy of different season with the names changed</div></td>\n</tr>'), ('2017-02-08 02:13:06.383379', 10384704, 203350591, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (587 characters truncated) ... pan> </small><div style="margin-top:5px">didnt go out with a bang but thanks for sharing apt pupil the movie is pretty good too lol</div></td>\n</tr>'), ('2017-02-08 02:13:06.383380', 10384704, 201463702, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1156348&amp;r ... (2435 characters truncated) ... eting. After all, Snape is probably already facing Life in Prison/Death Penalty for his previous crimes. There\'s no real deterent.</div></td>\n</tr>'), ('2017-02-08 02:13:06.383382', 10384704, 201373154, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=649260&amp;rw ... (4124 characters truncated) ... it until the end, and that\'s what you stay in fanfiction for - those gripping ones. Count this one as a gripping story. Thank you.</div></td>\n</tr>'), ('2017-02-08 02:13:06.383384', 10384704, 201093665, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=828258&amp;rw ... (992 characters truncated) ...  something else. However, I can\'t help that feel that nothing was truly resolved in the end? Though that\'s what life is, I guess.</div></td>\n</tr>'))]
18:13:06 reviews: Job OK (e73d8ff0-cae3-4a5a-880a-97d12fac9615)
18:13:06 Result is kept for 500 seconds
18:13:06 
18:13:06 *** Listening on chapters, profiles, reviews...
18:13:06 reviews: fanfic.jobs.crawl_reviews(10384832) (54561baf-bafb-4a22-9079-cf8a139fc2e5)
18:13:42 reviews: Job OK (54561baf-bafb-4a22-9079-cf8a139fc2e5)
18:13:42 Result is kept for 500 seconds
18:13:42 
18:13:42 *** Listening on chapters, profiles, reviews...
18:13:42 reviews: fanfic.jobs.crawl_reviews(10390949) (3e80617c-0985-470d-ab83-48a29e3790a3)
18:15:41 reviews: Job OK (3e80617c-0985-470d-ab83-48a29e3790a3)
18:15:41 Result is kept for 500 seconds
18:15:41 
18:15:41 *** Listening on chapters, profiles, reviews...
18:15:41 reviews: fanfic.jobs.crawl_reviews(10392181) (8ed03074-85a1-48b2-8ac2-3b42c1364edf)
18:15:45 reviews: Job OK (8ed03074-85a1-48b2-8ac2-3b42c1364edf)
18:15:45 Result is kept for 500 seconds
18:15:45 
18:15:45 *** Listening on chapters, profiles, reviews...
18:15:45 reviews: fanfic.jobs.crawl_reviews(10393075) (fc468636-a013-41b2-b599-a24a7a47338e)
18:17:20 reviews: Job OK (fc468636-a013-41b2-b599-a24a7a47338e)
18:17:20 Result is kept for 500 seconds
18:17:20 
18:17:20 *** Listening on chapters, profiles, reviews...
18:17:20 reviews: fanfic.jobs.crawl_reviews(10393907) (7e22165d-2e0c-46d1-a7a5-f81d00b0b796)
18:20:15 reviews: Job OK (7e22165d-2e0c-46d1-a7a5-f81d00b0b796)
18:20:15 Result is kept for 500 seconds
18:20:15 
18:20:15 *** Listening on chapters, profiles, reviews...
18:20:15 reviews: fanfic.jobs.crawl_reviews(10394278) (8b4f7459-b348-498f-ae35-89f921640561)
18:24:02 reviews: Job OK (8b4f7459-b348-498f-ae35-89f921640561)
18:24:02 Result is kept for 500 seconds
18:24:02 
18:24:02 *** Listening on chapters, profiles, reviews...
18:24:02 reviews: fanfic.jobs.crawl_reviews(10394498) (aab51176-cc66-47ba-a841-c1cfe8af979b)
18:24:11 reviews: Job OK (aab51176-cc66-47ba-a841-c1cfe8af979b)
18:24:11 Result is kept for 500 seconds
18:24:11 
18:24:11 *** Listening on chapters, profiles, reviews...
18:24:11 reviews: fanfic.jobs.crawl_reviews(10394667) (8f322341-545b-4cac-9ba4-fdc0cdf684ae)
18:27:28 reviews: Job OK (8f322341-545b-4cac-9ba4-fdc0cdf684ae)
18:27:28 Result is kept for 500 seconds
18:27:28 
18:27:28 *** Listening on chapters, profiles, reviews...
18:27:28 reviews: fanfic.jobs.crawl_reviews(10395557) (34977649-5f96-4c64-81c7-d1445554b030)
18:27:41 reviews: Job OK (34977649-5f96-4c64-81c7-d1445554b030)
18:27:41 Result is kept for 500 seconds
18:27:41 
18:27:41 *** Listening on chapters, profiles, reviews...
18:27:41 reviews: fanfic.jobs.crawl_reviews(10397629) (0003f343-e4a8-43a8-badf-c69ed65abe5a)
18:27:55 reviews: Job OK (0003f343-e4a8-43a8-badf-c69ed65abe5a)
18:27:55 Result is kept for 500 seconds
18:27:55 
18:27:55 *** Listening on chapters, profiles, reviews...
18:27:55 reviews: fanfic.jobs.crawl_reviews(10398443) (c5ce6b1c-e102-49a2-9c0b-a8ef312d7f4d)
18:28:55 reviews: Job OK (c5ce6b1c-e102-49a2-9c0b-a8ef312d7f4d)
18:28:55 Result is kept for 500 seconds
18:28:55 
18:28:55 *** Listening on chapters, profiles, reviews...
18:28:55 reviews: fanfic.jobs.crawl_reviews(10399789) (e15432ae-3251-4811-8ef9-f3a320ba9b7b)
2017-02-07 18:29:00 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 02:29:00.618623', 10399789, 246536621, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (703 characters truncated) ... with the wand mystery and the dark prince. <br>\nGreat beginning. Yet now it feels like I\'m reading the original books over again.</div></td>\n</tr>'), ('2017-02-08 02:29:00.618627', 10399789, 239902868, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7014691&amp;r ... (929 characters truncated) ... an data-xutime="1469493514">7/25/2016</span> </small><div style="margin-top:5px">Enjoying this story, can\'t wait to read the rest!</div></td>\n</tr>'), ('2017-02-08 02:29:00.618629', 10399789, 230826246, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7031176&amp;r ... (785 characters truncated) ... 7</a>  <small style="color:gray">chapter 4 . <span data-xutime="1451088355">12/25/2015</span> </small><div style="margin-top:5px">i</div></td>\n</tr>'), ('2017-02-08 02:29:00.618631', 10399789, 230826241, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7031176&amp;r ... (785 characters truncated) ... 7</a>  <small style="color:gray">chapter 4 . <span data-xutime="1451088349">12/25/2015</span> </small><div style="margin-top:5px">i</div></td>\n</tr>'), ('2017-02-08 02:29:00.618633', 10399789, 217750410, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5458356&amp;r ... (1441 characters truncated) ... aiting YEARS for your next chapter (or just a few days but that doesnt matter :p). I hope you continue the story and use my advice.</div></td>\n</tr>'), ('2017-02-08 02:29:00.618635', 10399789, 204490236, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (523 characters truncated) ... or:gray">chapter 3 . <span data-xutime="1405785826">7/19/2014</span> </small><div style="margin-top:5px">He stoll hagrids best line</div></td>\n</tr>'), ('2017-02-08 02:29:00.618637', 10399789, 201439598, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1042114&amp;r ... (928 characters truncated) ... y and did enjoy it but need to ask is theremgoing to be any parings if so please pretty please can it not be the same as the books.</div></td>\n</tr>'), ('2017-02-08 02:29:00.618639', 10399789, 201428401, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2055056&amp;r ... (1025 characters truncated) ... n a day. You have my attention. I have a cup of coffee and the cat, so let\'s see where you take us.<br>\n<br>\nthanks for writing!</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-08 02:29:00.618652', 10399789, 201439598, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1042114&amp;r ... (928 characters truncated) ... y and did enjoy it but need to ask is theremgoing to be any parings if so please pretty please can it not be the same as the books.</div></td>\n</tr>'), ('2017-02-08 02:29:00.618654', 10399789, 201428401, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2055056&amp;r ... (1025 characters truncated) ... n a day. You have my attention. I have a cup of coffee and the cat, so let\'s see where you take us.<br>\n<br>\nthanks for writing!</div></td>\n</tr>'))]
18:29:00 reviews: Job OK (e15432ae-3251-4811-8ef9-f3a320ba9b7b)
18:29:00 Result is kept for 500 seconds
18:29:00 
18:29:00 *** Listening on chapters, profiles, reviews...
18:29:00 reviews: fanfic.jobs.crawl_reviews(10406868) (8aeefb1d-dbea-41c6-a2d5-e87ed202222e)
18:30:00 reviews: Job OK (8aeefb1d-dbea-41c6-a2d5-e87ed202222e)
18:30:00 Result is kept for 500 seconds
18:30:00 
18:30:00 *** Listening on chapters, profiles, reviews...
18:30:00 reviews: fanfic.jobs.crawl_reviews(10407506) (3f814a9b-6391-44b4-8e60-91865de998bf)
18:30:10 reviews: Job OK (3f814a9b-6391-44b4-8e60-91865de998bf)
18:30:10 Result is kept for 500 seconds
18:30:10 
18:30:10 *** Listening on chapters, profiles, reviews...
18:30:10 reviews: fanfic.jobs.crawl_reviews(10410758) (39e2ddc9-3c34-4a4a-ad52-9850e22fef94)
18:31:38 reviews: Job OK (39e2ddc9-3c34-4a4a-ad52-9850e22fef94)
18:31:38 Result is kept for 500 seconds
18:31:38 
18:31:38 *** Listening on chapters, profiles, reviews...
18:31:38 reviews: fanfic.jobs.crawl_reviews(10411068) (9f249c35-f41c-468f-9db4-a9e23d6fc1dd)
18:33:12 reviews: Job OK (9f249c35-f41c-468f-9db4-a9e23d6fc1dd)
18:33:12 Result is kept for 500 seconds
18:33:12 
18:33:12 *** Listening on chapters, profiles, reviews...
18:33:12 reviews: fanfic.jobs.crawl_reviews(10411334) (c9ad8fa6-6928-47f2-a4ba-1718f58ca0d9)
18:34:05 reviews: Job OK (c9ad8fa6-6928-47f2-a4ba-1718f58ca0d9)
18:34:05 Result is kept for 500 seconds
18:34:05 
18:34:05 *** Listening on chapters, profiles, reviews...
18:34:05 reviews: fanfic.jobs.crawl_reviews(10412141) (12ed8ada-8ede-4bbf-a6ed-1e45a369e876)
18:35:17 reviews: Job OK (12ed8ada-8ede-4bbf-a6ed-1e45a369e876)
18:35:17 Result is kept for 500 seconds
18:35:17 
18:35:17 *** Listening on chapters, profiles, reviews...
18:35:17 reviews: fanfic.jobs.crawl_reviews(10412302) (d232f43f-18e3-4828-af73-bbd6226b9b84)
18:35:47 reviews: Job OK (d232f43f-18e3-4828-af73-bbd6226b9b84)
18:35:47 Result is kept for 500 seconds
18:35:47 
18:35:47 *** Listening on chapters, profiles, reviews...
18:35:47 reviews: fanfic.jobs.crawl_reviews(10413116) (829579a2-5ea2-45dc-aa3d-b2231882173a)
18:40:32 reviews: Job OK (829579a2-5ea2-45dc-aa3d-b2231882173a)
18:40:32 Result is kept for 500 seconds
18:40:32 
18:40:32 *** Listening on chapters, profiles, reviews...
18:40:32 reviews: fanfic.jobs.crawl_reviews(10415155) (d1aa709c-9e62-4633-9653-9162e28804e0)
18:41:32 reviews: Job OK (d1aa709c-9e62-4633-9653-9162e28804e0)
18:41:32 Result is kept for 500 seconds
18:41:32 
18:41:32 *** Listening on chapters, profiles, reviews...
18:41:32 reviews: fanfic.jobs.crawl_reviews(10415195) (93a905b6-c37e-4f6c-89ca-2b3c64765099)
18:41:57 reviews: Job OK (93a905b6-c37e-4f6c-89ca-2b3c64765099)
18:41:57 Result is kept for 500 seconds
18:41:57 
18:41:57 *** Listening on chapters, profiles, reviews...
18:41:57 reviews: fanfic.jobs.crawl_reviews(10415246) (532aec78-2a7d-44e2-a64f-e3dd5718d7cc)
18:42:39 reviews: Job OK (532aec78-2a7d-44e2-a64f-e3dd5718d7cc)
18:42:39 Result is kept for 500 seconds
18:42:39 
18:42:39 *** Listening on chapters, profiles, reviews...
18:42:39 reviews: fanfic.jobs.crawl_reviews(10415674) (64b3667e-5d7b-466e-a1d7-410e76f3f474)
18:42:53 reviews: Job OK (64b3667e-5d7b-466e-a1d7-410e76f3f474)
18:42:53 Result is kept for 500 seconds
18:42:53 
18:42:53 *** Listening on chapters, profiles, reviews...
18:42:53 reviews: fanfic.jobs.crawl_reviews(10416131) (1c95df63-ccdc-496c-b708-53407a280d1f)
18:44:07 reviews: Job OK (1c95df63-ccdc-496c-b708-53407a280d1f)
18:44:07 Result is kept for 500 seconds
18:44:07 
18:44:07 *** Listening on chapters, profiles, reviews...
18:44:07 reviews: fanfic.jobs.crawl_reviews(10417400) (3b29ad4f-1085-46eb-a54f-3cf4f5d7aea0)
18:44:39 reviews: Job OK (3b29ad4f-1085-46eb-a54f-3cf4f5d7aea0)
18:44:39 Result is kept for 500 seconds
18:44:39 
18:44:39 *** Listening on chapters, profiles, reviews...
18:44:39 reviews: fanfic.jobs.crawl_reviews(10419299) (d4076b9a-f16f-4fd1-b3e3-44d51d6cc1e2)
18:44:55 reviews: Job OK (d4076b9a-f16f-4fd1-b3e3-44d51d6cc1e2)
18:44:55 Result is kept for 500 seconds
18:44:55 
18:44:55 *** Listening on chapters, profiles, reviews...
18:44:55 reviews: fanfic.jobs.crawl_reviews(10419301) (d15a4258-b171-4524-9a98-e72fdf6254da)
2017-02-07 18:45:00 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 02:45:00.658073', 10419301, 223387178, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6932430&amp;r ... (816 characters truncated) ... hapter 4 . <span data-xutime="1436846091">7/13/2015</span> </small><div style="margin-top:5px">How old is the main character again?</div></td>\n</tr>'), ('2017-02-08 02:45:00.658077', 10419301, 221010532, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (841 characters truncated) ... o move on to the sequel. <br>\n<br>\nPerhaps more would find this if published to adultfanfiction or perhaps an archive of our own.</div></td>\n</tr>'), ('2017-02-08 02:45:00.658079', 10419301, 221010531, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (759 characters truncated) ... his, especially in writing. The part that seals the bond of trust fully. Oh my heaven I would give this story the stars if I could.</div></td>\n</tr>'), ('2017-02-08 02:45:00.658081', 10419301, 221010529, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (767 characters truncated) ... kept him in character both with the insecurities and showing how once he was in control, he began to dominate and feel comfortable.</div></td>\n</tr>'), ('2017-02-08 02:45:00.658083', 10419301, 203616759, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4019104&amp;r ... (956 characters truncated) ... 014</span> </small><div style="margin-top:5px">Wow! Absolutely amazing! I am 100 percent in love with this story! More soon please.</div></td>\n</tr>'), ('2017-02-08 02:45:00.658085', 10419301, 223387178, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6932430&amp;r ... (816 characters truncated) ... hapter 4 . <span data-xutime="1436846091">7/13/2015</span> </small><div style="margin-top:5px">How old is the main character again?</div></td>\n</tr>'), ('2017-02-08 02:45:00.658087', 10419301, 221010532, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (841 characters truncated) ... o move on to the sequel. <br>\n<br>\nPerhaps more would find this if published to adultfanfiction or perhaps an archive of our own.</div></td>\n</tr>'), ('2017-02-08 02:45:00.658089', 10419301, 221010531, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (759 characters truncated) ... his, especially in writing. The part that seals the bond of trust fully. Oh my heaven I would give this story the stars if I could.</div></td>\n</tr>'), ('2017-02-08 02:45:00.658091', 10419301, 221010529, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (767 characters truncated) ... kept him in character both with the insecurities and showing how once he was in control, he began to dominate and feel comfortable.</div></td>\n</tr>'), ('2017-02-08 02:45:00.658092', 10419301, 203616759, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4019104&amp;r ... (956 characters truncated) ... 014</span> </small><div style="margin-top:5px">Wow! Absolutely amazing! I am 100 percent in love with this story! More soon please.</div></td>\n</tr>'))]
18:45:00 reviews: Job OK (d15a4258-b171-4524-9a98-e72fdf6254da)
18:45:00 Result is kept for 500 seconds
18:45:00 
18:45:00 *** Listening on chapters, profiles, reviews...
18:45:00 reviews: fanfic.jobs.crawl_reviews(10420833) (2a5617be-4a2f-480f-8002-411074793372)
18:45:12 reviews: Job OK (2a5617be-4a2f-480f-8002-411074793372)
18:45:12 Result is kept for 500 seconds
18:45:12 
18:45:12 *** Listening on chapters, profiles, reviews...
18:45:12 reviews: fanfic.jobs.crawl_reviews(10420958) (cbb77793-2faa-4776-bbea-2e6715fd3026)
18:45:18 reviews: Job OK (cbb77793-2faa-4776-bbea-2e6715fd3026)
18:45:18 Result is kept for 500 seconds
18:45:18 
18:45:18 *** Listening on chapters, profiles, reviews...
18:45:18 reviews: fanfic.jobs.crawl_reviews(10421274) (88676ef4-5cd0-4133-91ba-2cef68b1ede3)
18:46:06 reviews: Job OK (88676ef4-5cd0-4133-91ba-2cef68b1ede3)
18:46:06 Result is kept for 500 seconds
18:46:06 
18:46:06 *** Listening on chapters, profiles, reviews...
18:46:06 reviews: fanfic.jobs.crawl_reviews(10426028) (3a463814-c615-4136-93b0-d0b3800905a2)
18:46:27 reviews: Job OK (3a463814-c615-4136-93b0-d0b3800905a2)
18:46:27 Result is kept for 500 seconds
18:46:27 
18:46:27 *** Listening on chapters, profiles, reviews...
18:46:27 reviews: fanfic.jobs.crawl_reviews(10427666) (7505bff7-42a9-47b2-ab7a-9785f6df2a92)
18:47:20 reviews: Job OK (7505bff7-42a9-47b2-ab7a-9785f6df2a92)
18:47:20 Result is kept for 500 seconds
18:47:20 
18:47:20 *** Listening on chapters, profiles, reviews...
18:47:20 reviews: fanfic.jobs.crawl_reviews(10427729) (9862d253-1d3f-42a5-b8fb-cd2e26b066a4)
18:49:14 reviews: Job OK (9862d253-1d3f-42a5-b8fb-cd2e26b066a4)
18:49:14 Result is kept for 500 seconds
18:49:14 
18:49:14 *** Listening on chapters, profiles, reviews...
18:49:14 reviews: fanfic.jobs.crawl_reviews(10434796) (fd7f4381-b840-44ab-8d98-0deebff76f69)
18:49:20 reviews: Job OK (fd7f4381-b840-44ab-8d98-0deebff76f69)
18:49:20 Result is kept for 500 seconds
18:49:20 
18:49:20 *** Listening on chapters, profiles, reviews...
18:49:20 reviews: fanfic.jobs.crawl_reviews(10435885) (cce210e1-177f-448c-869a-6015d0e1df5e)
18:51:23 reviews: Job OK (cce210e1-177f-448c-869a-6015d0e1df5e)
18:51:23 Result is kept for 500 seconds
18:51:23 Cleaning registries for queue: chapters
18:51:23 Cleaning registries for queue: profiles
18:51:23 Cleaning registries for queue: reviews
18:51:23 
18:51:23 *** Listening on chapters, profiles, reviews...
18:51:23 reviews: fanfic.jobs.crawl_reviews(10437513) (557354a5-f062-420b-a285-754260519811)
18:52:08 reviews: Job OK (557354a5-f062-420b-a285-754260519811)
18:52:08 Result is kept for 500 seconds
18:52:08 
18:52:08 *** Listening on chapters, profiles, reviews...
18:52:08 reviews: fanfic.jobs.crawl_reviews(10437566) (5bb272a3-46f8-4c9d-b0fa-6d1fea270f14)
18:52:13 reviews: Job OK (5bb272a3-46f8-4c9d-b0fa-6d1fea270f14)
18:52:13 Result is kept for 500 seconds
18:52:13 
18:52:13 *** Listening on chapters, profiles, reviews...
18:52:13 reviews: fanfic.jobs.crawl_reviews(10438223) (f073323a-f213-4932-aba5-2b9b598a29ff)
18:53:51 reviews: Job OK (f073323a-f213-4932-aba5-2b9b598a29ff)
18:53:51 Result is kept for 500 seconds
18:53:51 
18:53:51 *** Listening on chapters, profiles, reviews...
18:53:51 reviews: fanfic.jobs.crawl_reviews(10438273) (6bdbc209-c7ce-424b-9ab7-69454dd5b972)
2017-02-07 18:53:57 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 02:53:57.390373', 10438273, 214054626, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4213275&amp;r ... (814 characters truncated) ... span data-xutime="1421393531">1/15/2015</span> </small><div style="margin-top:5px">You\'re off to a great start! Please keep it up!</div></td>\n</tr>'), ('2017-02-08 02:53:57.390378', 10438273, 214054626, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4213275&amp;r ... (814 characters truncated) ... span data-xutime="1421393531">1/15/2015</span> </small><div style="margin-top:5px">You\'re off to a great start! Please keep it up!</div></td>\n</tr>'))]
18:53:57 reviews: Job OK (6bdbc209-c7ce-424b-9ab7-69454dd5b972)
18:53:57 Result is kept for 500 seconds
18:53:57 
18:53:57 *** Listening on chapters, profiles, reviews...
18:53:57 reviews: fanfic.jobs.crawl_reviews(10438556) (2a59097f-d60f-41aa-abe5-1d9f87c2fd86)
2017-02-07 18:54:01 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 02:54:01.873885', 10438556, 205688805, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (525 characters truncated) ... gray">chapter 13 . <span data-xutime="1407589765">8/9/2014</span> </small><div style="margin-top:5px">Great I love this update soon</div></td>\n</tr>'), ('2017-02-08 02:54:01.873889', 10438556, 205688805, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (525 characters truncated) ... gray">chapter 13 . <span data-xutime="1407589765">8/9/2014</span> </small><div style="margin-top:5px">Great I love this update soon</div></td>\n</tr>'))]
18:54:01 reviews: Job OK (2a59097f-d60f-41aa-abe5-1d9f87c2fd86)
18:54:01 Result is kept for 500 seconds
18:54:01 
18:54:01 *** Listening on chapters, profiles, reviews...
18:54:01 reviews: fanfic.jobs.crawl_reviews(10439709) (0eabda1b-c2a8-4cb5-9b23-502e7b8944ae)
18:54:28 reviews: Job OK (0eabda1b-c2a8-4cb5-9b23-502e7b8944ae)
18:54:28 Result is kept for 500 seconds
18:54:28 
18:54:28 *** Listening on chapters, profiles, reviews...
18:54:28 reviews: fanfic.jobs.crawl_reviews(10440984) (3f373c19-115d-4baf-90c7-84994e166c11)
18:55:15 reviews: Job OK (3f373c19-115d-4baf-90c7-84994e166c11)
18:55:15 Result is kept for 500 seconds
18:55:15 
18:55:15 *** Listening on chapters, profiles, reviews...
18:55:15 reviews: fanfic.jobs.crawl_reviews(10441119) (ec6f5233-73a7-4bd2-9836-b327a4b68b06)
18:57:14 reviews: Job OK (ec6f5233-73a7-4bd2-9836-b327a4b68b06)
18:57:14 Result is kept for 500 seconds
18:57:14 
18:57:14 *** Listening on chapters, profiles, reviews...
18:57:14 reviews: fanfic.jobs.crawl_reviews(10441752) (59569b5e-1636-4cf6-b2e4-882422e4b4a8)
18:57:44 reviews: Job OK (59569b5e-1636-4cf6-b2e4-882422e4b4a8)
18:57:44 Result is kept for 500 seconds
18:57:44 
18:57:44 *** Listening on chapters, profiles, reviews...
18:57:44 reviews: fanfic.jobs.crawl_reviews(10441800) (531d88af-2c36-484a-a1c7-c035653a2c77)
18:57:49 reviews: Job OK (531d88af-2c36-484a-a1c7-c035653a2c77)
18:57:49 Result is kept for 500 seconds
18:57:49 
18:57:49 *** Listening on chapters, profiles, reviews...
18:57:49 reviews: fanfic.jobs.crawl_reviews(10444023) (27747e03-3d4c-4678-891f-b63b8dd247d3)
18:58:51 reviews: Job OK (27747e03-3d4c-4678-891f-b63b8dd247d3)
18:58:51 Result is kept for 500 seconds
18:58:51 
18:58:51 *** Listening on chapters, profiles, reviews...
18:58:51 reviews: fanfic.jobs.crawl_reviews(10444942) (cb152848-cbc1-43be-84ce-a33bf15768e5)
19:00:12 reviews: Job OK (cb152848-cbc1-43be-84ce-a33bf15768e5)
19:00:12 Result is kept for 500 seconds
19:00:12 
19:00:12 *** Listening on chapters, profiles, reviews...
19:00:12 reviews: fanfic.jobs.crawl_reviews(10445530) (ab5b0085-4faf-4665-87e2-13cb2e9aa8a4)
19:00:37 reviews: Job OK (ab5b0085-4faf-4665-87e2-13cb2e9aa8a4)
19:00:37 Result is kept for 500 seconds
19:00:37 
19:00:37 *** Listening on chapters, profiles, reviews...
19:00:37 reviews: fanfic.jobs.crawl_reviews(10445611) (3a638837-3dce-490b-8214-0a4d7637da8c)
19:00:52 reviews: Job OK (3a638837-3dce-490b-8214-0a4d7637da8c)
19:00:52 Result is kept for 500 seconds
19:00:52 
19:00:52 *** Listening on chapters, profiles, reviews...
19:00:52 reviews: fanfic.jobs.crawl_reviews(10447429) (2f6f578b-9211-4f6e-8d84-1237f7ca6699)
19:01:31 reviews: Job OK (2f6f578b-9211-4f6e-8d84-1237f7ca6699)
19:01:31 Result is kept for 500 seconds
19:01:31 
19:01:31 *** Listening on chapters, profiles, reviews...
19:01:31 reviews: fanfic.jobs.crawl_reviews(10449341) (fbb8f11d-2e33-4d69-9cae-ccfd6cf2333c)
19:01:56 reviews: Job OK (fbb8f11d-2e33-4d69-9cae-ccfd6cf2333c)
19:01:56 Result is kept for 500 seconds
19:01:56 
19:01:56 *** Listening on chapters, profiles, reviews...
19:01:56 reviews: fanfic.jobs.crawl_reviews(10451202) (eaee373b-27ed-462d-8753-ed8648ed8a8e)
19:02:18 reviews: Job OK (eaee373b-27ed-462d-8753-ed8648ed8a8e)
19:02:18 Result is kept for 500 seconds
19:02:18 
19:02:18 *** Listening on chapters, profiles, reviews...
19:02:18 reviews: fanfic.jobs.crawl_reviews(10451780) (0edf634e-4ced-4a1f-827d-d2947e448fa3)
19:03:58 reviews: Job OK (0edf634e-4ced-4a1f-827d-d2947e448fa3)
19:03:58 Result is kept for 500 seconds
19:03:58 
19:03:58 *** Listening on chapters, profiles, reviews...
19:03:58 reviews: fanfic.jobs.crawl_reviews(10452971) (3184eefa-cc96-49ef-ac89-186e20af35a8)
19:04:08 reviews: Job OK (3184eefa-cc96-49ef-ac89-186e20af35a8)
19:04:08 Result is kept for 500 seconds
19:04:08 
19:04:08 *** Listening on chapters, profiles, reviews...
19:04:08 reviews: fanfic.jobs.crawl_reviews(10454477) (d20c4406-7ff9-47bd-91c7-3b48e2dd73a1)
2017-02-07 19:04:13 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 03:04:13.175586', 10454477, 224075793, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5269926&amp;r ... (976 characters truncated) ... of the characters is exactly how i would have pictured them! Please, please, please update! I cannot wait to see what happens next!</div></td>\n</tr>'), ('2017-02-08 03:04:13.175592', 10454477, 221110373, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5568155&amp;r ... (1116 characters truncated) ... e this thing between them won\'t work. James is perfect, I\'m seriously in love with James Potter ahahaha good chapter! Update soon</div></td>\n</tr>'), ('2017-02-08 03:04:13.175594', 10454477, 220872411, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5568155&amp;r ... (1503 characters truncated) ... an\'t wait to see them in love and together, they truly belong together. I hope you\'ll update soon, because this is really good :)</div></td>\n</tr>'), ('2017-02-08 03:04:13.175596', 10454477, 214910185, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6453987&amp;r ... (1684 characters truncated) ... \'t as potent, idk. Last night I had 12 shots (44ml) of jack Daniels and I weigh 66kg, so just food for thought. <br>\n<br>\nThanks</div></td>\n</tr>'), ('2017-02-08 03:04:13.175598', 10454477, 213798171, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4832521&amp;r ... (1798 characters truncated) ...  personality. Also, I have to say you write Remus very well. Bored and above it all. Managing his unruly friends. I like your take.</div></td>\n</tr>'), ('2017-02-08 03:04:13.175600', 10454477, 213796708, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4832521&amp;r ... (1170 characters truncated) ... e boys chemistry and interaction. Very believable and amusing. I chuckled a few times. I\'m surprised you don\'t have more reviews.</div></td>\n</tr>'), ('2017-02-08 03:04:13.175602', 10454477, 213749394, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4832521&amp;r ... (1423 characters truncated) ...  is something about their improper teenage ways that I like. So, I\'m a hung jury on that. I\'ll be interested to continue reading.</div></td>\n</tr>'), ('2017-02-08 03:04:13.175604', 10454477, 205799987, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=586172&amp;rw ... (1053 characters truncated) ... ngly) did not have that many of them, so I wanted to leave you one! keep up the good work, and I\'m looking forward to an update :)</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-08 03:04:13.175628', 10454477, 203046913, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5703204&amp;r ... (975 characters truncated) ... ll the characters and the interviews with McGonagall were funny-especially Peter\'s- hope you update soon, i\'ve got this on alert!</div></td>\n</tr>'), ('2017-02-08 03:04:13.175630', 10454477, 202232921, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3754850&amp;r ... (792 characters truncated) ... all style="color:gray">chapter 1 . <span data-xutime="1402873405">6/15/2014</span> </small><div style="margin-top:5px">I found you.</div></td>\n</tr>'))]
19:04:13 reviews: Job OK (d20c4406-7ff9-47bd-91c7-3b48e2dd73a1)
19:04:13 Result is kept for 500 seconds
19:04:13 
19:04:13 *** Listening on chapters, profiles, reviews...
19:04:13 reviews: fanfic.jobs.crawl_reviews(10454947) (ec120280-5e57-4af3-ba0e-964772bacf7b)
19:06:51 reviews: Job OK (ec120280-5e57-4af3-ba0e-964772bacf7b)
19:06:51 Result is kept for 500 seconds
19:06:51 
19:06:51 *** Listening on chapters, profiles, reviews...
19:06:51 reviews: fanfic.jobs.crawl_reviews(10458922) (f3d31b02-dea9-4d42-b127-46890aadb374)
19:08:35 reviews: Job OK (f3d31b02-dea9-4d42-b127-46890aadb374)
19:08:35 Result is kept for 500 seconds
19:08:35 
19:08:35 *** Listening on chapters, profiles, reviews...
19:08:35 reviews: fanfic.jobs.crawl_reviews(10460479) (2c0d58a1-be39-48d3-b54c-b9f860f00aa3)
19:09:06 reviews: Job OK (2c0d58a1-be39-48d3-b54c-b9f860f00aa3)
19:09:06 Result is kept for 500 seconds
19:09:06 
19:09:06 *** Listening on chapters, profiles, reviews...
19:09:06 reviews: fanfic.jobs.crawl_reviews(10461516) (f349d9ae-5b5c-4be2-a86c-b9fcd5b9a9d0)
19:09:50 reviews: Job OK (f349d9ae-5b5c-4be2-a86c-b9fcd5b9a9d0)
19:09:50 Result is kept for 500 seconds
19:09:50 
19:09:50 *** Listening on chapters, profiles, reviews...
19:09:50 reviews: fanfic.jobs.crawl_reviews(10467472) (f0fe6586-93c2-4c9a-82b9-3892d97c05a0)
19:10:55 reviews: Job OK (f0fe6586-93c2-4c9a-82b9-3892d97c05a0)
19:10:55 Result is kept for 500 seconds
19:10:55 
19:10:55 *** Listening on chapters, profiles, reviews...
19:10:55 reviews: fanfic.jobs.crawl_reviews(10469128) (d93325ec-edf3-4dc6-b3be-c51b17eddc5e)
19:11:33 reviews: Job OK (d93325ec-edf3-4dc6-b3be-c51b17eddc5e)
19:11:33 Result is kept for 500 seconds
19:11:33 
19:11:33 *** Listening on chapters, profiles, reviews...
19:11:33 reviews: fanfic.jobs.crawl_reviews(10469321) (e84bcf35-04a3-459c-9df4-127e659703b0)
19:12:52 reviews: Job OK (e84bcf35-04a3-459c-9df4-127e659703b0)
19:12:52 Result is kept for 500 seconds
19:12:52 
19:12:52 *** Listening on chapters, profiles, reviews...
19:12:52 reviews: fanfic.jobs.crawl_reviews(10470538) (6549b11c-732b-4180-8f2b-02d9103e7efb)
19:14:12 reviews: Job OK (6549b11c-732b-4180-8f2b-02d9103e7efb)
19:14:12 Result is kept for 500 seconds
19:14:12 
19:14:12 *** Listening on chapters, profiles, reviews...
19:14:12 reviews: fanfic.jobs.crawl_reviews(10470894) (439fc4d5-fa43-4416-b1aa-8125d3efd7e6)
19:14:28 reviews: Job OK (439fc4d5-fa43-4416-b1aa-8125d3efd7e6)
19:14:28 Result is kept for 500 seconds
19:14:28 
19:14:28 *** Listening on chapters, profiles, reviews...
19:14:28 reviews: fanfic.jobs.crawl_reviews(10471371) (52725c9b-ecf0-49aa-ac87-40f9eff2ecf0)
19:15:20 reviews: Job OK (52725c9b-ecf0-49aa-ac87-40f9eff2ecf0)
19:15:20 Result is kept for 500 seconds
19:15:20 
19:15:20 *** Listening on chapters, profiles, reviews...
19:15:20 reviews: fanfic.jobs.crawl_reviews(10471408) (df3620bb-3a44-43f0-9493-f0faa30117ff)
19:16:02 reviews: Job OK (df3620bb-3a44-43f0-9493-f0faa30117ff)
19:16:02 Result is kept for 500 seconds
19:16:02 
19:16:02 *** Listening on chapters, profiles, reviews...
19:16:02 reviews: fanfic.jobs.crawl_reviews(10472849) (e235e559-876a-4f5f-a716-487bf0532d0f)
19:16:43 reviews: Job OK (e235e559-876a-4f5f-a716-487bf0532d0f)
19:16:43 Result is kept for 500 seconds
19:16:43 
19:16:43 *** Listening on chapters, profiles, reviews...
19:16:43 reviews: fanfic.jobs.crawl_reviews(10473197) (157ee103-d04c-42b8-b39f-99b48e844439)
19:19:59 reviews: Job OK (157ee103-d04c-42b8-b39f-99b48e844439)
19:19:59 Result is kept for 500 seconds
19:19:59 
19:19:59 *** Listening on chapters, profiles, reviews...
19:19:59 reviews: fanfic.jobs.crawl_reviews(10474848) (db8e5921-3b9a-40dd-8ee6-4caaea995bd2)
2017-02-07 19:20:04 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 03:20:04.721347', 10474848, 239801004, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1211 characters truncated) ... t character ruined it at least for me. It would be nice of you if you had warned about her. Otherwise keep up your is nice to read.</div></td>\n</tr>'), ('2017-02-08 03:20:04.721351', 10474848, 238220134, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6952806&amp;r ... (871 characters truncated) ... le="margin-top:5px">Harry\'s kinda tiresome...but in biased, who cares what I think?<br>\n(Pretty sure my comment is unanswerable.)</div></td>\n</tr>'), ('2017-02-08 03:20:04.721354', 10474848, 216811481, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2982197&amp;r ... (944 characters truncated) ... 9">3/8/2015</span> </small><div style="margin-top:5px">I loved the story, form beginning to end! Had to finish it in one sitting! _</div></td>\n</tr>'), ('2017-02-08 03:20:04.721356', 10474848, 209014677, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4788992&amp;r ... (932 characters truncated) ... 6932">10/10/2014</span> </small><div style="margin-top:5px">Your old pen name is in this story\'s first chapter, not visitor\'s. :p</div></td>\n</tr>'), ('2017-02-08 03:20:04.721358', 10474848, 207884059, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4483362&amp;r ... (909 characters truncated) ... an data-xutime="1411002290">9/17/2014</span> </small><div style="margin-top:5px">I love the part were Tom uses \'crucio\' on Harry!</div></td>\n</tr>'), ('2017-02-08 03:20:04.721359', 10474848, 206708743, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3642125&amp;r ... (1420 characters truncated) ... rding society change anyway in handling magical children? Etc. <br>\nStill overall a very unique story. It was great fun reading it</div></td>\n</tr>'), ('2017-02-08 03:20:04.721361', 10474848, 204220822, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (619 characters truncated) ... -top:5px">I\'m glad I stopped to read this. it was rather good. Damon made me laugh a lot and I liked how you depicted Tom in this.</div></td>\n</tr>'), ('2017-02-08 03:20:04.721363', 10474848, 203848161, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=731323&amp;rw ... (1119 characters truncated) ... to say, I like your Tom, his evolution, and Voldemort (:3), and all the characters :D <br>\n<br>\nWell, bye :)<br>\n<br>\nSedinette</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-08 03:20:04.721394', 10474848, 202679104, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1050495&amp;r ... (986 characters truncated) ... loved it dearly few years back (it was of the first that got me to Tom/Harry) and I love it now:)<br>\nThanks for revisiting it:DDD</div></td>\n</tr>'), ('2017-02-08 03:20:04.721396', 10474848, 202655144, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1651839&amp;r ... (975 characters truncated) ... e="margin-top:5px">WOOOOOOOO! UPDAAAAAAAAATE!<br>\n<br>\n... *coughs* Thank you for putting this up so promptly. I loved rereading.</div></td>\n</tr>'))]
19:20:04 reviews: Job OK (db8e5921-3b9a-40dd-8ee6-4caaea995bd2)
19:20:04 Result is kept for 500 seconds
19:20:04 
19:20:04 *** Listening on chapters, profiles, reviews...
19:20:04 reviews: fanfic.jobs.crawl_reviews(10476061) (d6447e49-11ba-4938-aa33-484a6defe433)
19:20:09 reviews: Job OK (d6447e49-11ba-4938-aa33-484a6defe433)
19:20:09 Result is kept for 500 seconds
19:20:09 
19:20:09 *** Listening on chapters, profiles, reviews...
19:20:09 reviews: fanfic.jobs.crawl_reviews(10476350) (b5076a37-1692-432f-987e-a3f5d708ea35)
19:22:30 reviews: Job OK (b5076a37-1692-432f-987e-a3f5d708ea35)
19:22:30 Result is kept for 500 seconds
19:22:30 
19:22:30 *** Listening on chapters, profiles, reviews...
19:22:30 reviews: fanfic.jobs.crawl_reviews(10477212) (17123473-7400-41eb-b895-063d124fe1cd)
2017-02-07 19:22:35 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 03:22:35.785614', 10477212, 242999258, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1599009&amp;r ... (1158 characters truncated) ... ch a brilliant story and I\'d love to read more if you have it. But mostly I hope all is well with you! You\'re a fantastic writer!</div></td>\n</tr>'), ('2017-02-08 03:22:35.785618', 10477212, 238828202, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (548 characters truncated) ...  data-xutime="1467106681">6/28/2016</span> </small><div style="margin-top:5px">yar mare card ma garbicg aagye hai boot muskil ma hu</div></td>\n</tr>'), ('2017-02-08 03:22:35.785621', 10477212, 236286473, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2447467&amp;r ... (1300 characters truncated) ... endship/relationship. I\'m really hoping you\'ll update soon and that you haven\'t abandoned the fic because I might cry if you do!</div></td>\n</tr>'), ('2017-02-08 03:22:35.785623', 10477212, 228122663, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1413502&amp;r ... (1104 characters truncated) ... nd I think you do a very good job at capturing James. I really hope you plan on updating this again sometime in the near future! :)</div></td>\n</tr>'), ('2017-02-08 03:22:35.785624', 10477212, 227510332, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (771 characters truncated) ... f my favourites. I literally revisit it once every few months. It\'s WONDERFUL. I\'d love to read more! I hope this is not the end!</div></td>\n</tr>'), ('2017-02-08 03:22:35.785626', 10477212, 224347140, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1213279&amp;r ... (989 characters truncated) ... rites and I haven\'t found such a great portrayal of James anywhere else. Hope you\'re okay and that you get some inspiration soon.</div></td>\n</tr>'), ('2017-02-08 03:22:35.785628', 10477212, 211350077, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1400790&amp;r ... (1053 characters truncated) ... but so compelling. Truly brilliant. Looking forward to a thorough reread next time it gets updated :) <br>\n<br>\nHave a great day!</div></td>\n</tr>'), ('2017-02-08 03:22:35.785630', 10477212, 206665679, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1213279&amp;r ... (1051 characters truncated) ... ly my favourite in all the fics I\'ve read. Looking forward to reading more about what happened to Drake and the Hogsmeade weekend.</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-08 03:22:35.785665', 10477212, 202723634, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (555 characters truncated) ... -xutime="1403540009">6/23/2014</span> </small><div style="margin-top:5px">That last sentence killed me. I literally started crying.</div></td>\n</tr>'), ('2017-02-08 03:22:35.785667', 10477212, 202723633, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (828 characters truncated) ...  and the events after. I was extremely proud of it and then i read yours and i\'m just like…shit mine sucks. So yeah. Keep writing!</div></td>\n</tr>'))]
19:22:35 reviews: Job OK (17123473-7400-41eb-b895-063d124fe1cd)
19:22:35 Result is kept for 500 seconds
19:22:35 
19:22:35 *** Listening on chapters, profiles, reviews...
19:22:35 reviews: fanfic.jobs.crawl_reviews(10477724) (a3c1833b-9bbb-4d2a-b551-0dc79cba8b7e)
19:23:00 reviews: Job OK (a3c1833b-9bbb-4d2a-b551-0dc79cba8b7e)
19:23:00 Result is kept for 500 seconds
19:23:00 
19:23:00 *** Listening on chapters, profiles, reviews...
19:23:00 reviews: fanfic.jobs.crawl_reviews(10478325) (215d906d-e918-45bc-a2a7-df05dbb2dab9)
2017-02-07 19:23:05 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 03:23:05.973237', 10478325, 210230460, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2666225&amp;r ... (1006 characters truncated) ... </span> </small><div style="margin-top:5px">I love this saga so much! Very well written and interesting original plot. Update soon!</div></td>\n</tr>'), ('2017-02-08 03:23:05.973241', 10478325, 208812388, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2167499&amp;r ... (999 characters truncated) ...  they are about to battle the Astaroth. Sooo looking forward to the next chapter, I know it\'ll be awesome! Hope you update soon :)</div></td>\n</tr>'), ('2017-02-08 03:23:05.973244', 10478325, 208564928, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2167499&amp;r ... (886 characters truncated) ... n data-xutime="1412168309">10/1/2014</span> </small><div style="margin-top:5px">Great new chapter! Can\'t wait to read some more :)</div></td>\n</tr>'), ('2017-02-08 03:23:05.973246', 10478325, 207910869, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2167499&amp;r ... (1166 characters truncated) ...  story line, can\'t wait to read some more about the mysterious dragon creature. Anyway, great update and I hope you update soon :)</div></td>\n</tr>'), ('2017-02-08 03:23:05.973248', 10478325, 206829278, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4662740&amp;r ... (1751 characters truncated) ...  tempo and rythm of the story! Just some constructive criticism :)<br>\n<br>\nKeep on writting and I\'m expecting your next update!</div></td>\n</tr>'), ('2017-02-08 03:23:05.973250', 10478325, 206181591, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5943680&amp;r ... (1345 characters truncated) ... , I can\'t wait for the next chapter! I\'m quite excited to see what\'s going to happen with this Founders bit here. So intriguing.</div></td>\n</tr>'), ('2017-02-08 03:23:05.973252', 10478325, 206003066, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2167499&amp;r ... (996 characters truncated) ... it to read the next one, I also really can\'t wait for the big reveal of Romi being Harry\'s sister.. not rushing it or anything :P</div></td>\n</tr>'), ('2017-02-08 03:23:05.973254', 10478325, 205316541, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2167499&amp;r ... (1038 characters truncated) ... lso, just wondering if the rest of the world will be finding out about Romi\'s heritage anytime soon? Hope you update again soon :)</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-08 03:23:05.973278', 10478325, 203150357, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2167499&amp;r ... (1098 characters truncated) ...  I suppose it will throw a spanner into the works. Definitely can\'t wait to see where this story goes so I hope you update soon :)</div></td>\n</tr>'), ('2017-02-08 03:23:05.973280', 10478325, 202818237, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3270142&amp;r ... (1570 characters truncated) ... ide if I want Draco to step up as dating material - if/WHEN any Romi/Draco relationship goes south, he\'d be such a douche after...</div></td>\n</tr>'))]
19:23:05 reviews: Job OK (215d906d-e918-45bc-a2a7-df05dbb2dab9)
19:23:05 Result is kept for 500 seconds
19:23:06 
19:23:06 *** Listening on chapters, profiles, reviews...
19:23:06 reviews: fanfic.jobs.crawl_reviews(10478838) (d9c91025-cfb4-4d0e-9a0b-fe80ce2e43a7)
19:26:56 reviews: Job OK (d9c91025-cfb4-4d0e-9a0b-fe80ce2e43a7)
19:26:56 Result is kept for 500 seconds
19:26:56 
19:26:56 *** Listening on chapters, profiles, reviews...
19:26:56 reviews: fanfic.jobs.crawl_reviews(10479335) (f5cc6bc1-3833-4e37-bf75-b6ba7d3f8afe)
19:28:40 reviews: Job OK (f5cc6bc1-3833-4e37-bf75-b6ba7d3f8afe)
19:28:40 Result is kept for 500 seconds
19:28:40 
19:28:40 *** Listening on chapters, profiles, reviews...
19:28:40 reviews: fanfic.jobs.crawl_reviews(10480835) (aa6e136e-12b6-4786-b561-c61030ad69ed)
2017-02-07 19:28:45 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 03:28:45.337749', 10480835, 228072954, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (568 characters truncated) ... 274590">10/19/2015</span> </small><div style="margin-top:5px">I love that u included the tents, no one else has really done that xx</div></td>\n</tr>'), ('2017-02-08 03:28:45.337756', 10480835, 224594388, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (828 characters truncated) ... rkinson will pop up because i love him a lot but just cant see him with lily. keep up the good work, the storys coming along great!</div></td>\n</tr>'), ('2017-02-08 03:28:45.337758', 10480835, 217144976, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (794 characters truncated) ... ill show up making it nearly impossible to read. Aside from that I\'m absolutely loving the story so far, great writing keep it up!</div></td>\n</tr>'), ('2017-02-08 03:28:45.337760', 10480835, 208037354, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3893883&amp;r ... (979 characters truncated) ... -top:5px">Hi! I love your story, its so funny. Im waiting the next chapter so mucho.<br>\nPleaso, dont leave the story, is amazing!</div></td>\n</tr>'), ('2017-02-08 03:28:45.337762', 10480835, 207675896, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4518139&amp;r ... (963 characters truncated) ...  style="margin-top:5px">Hey! Quick review just to tell you that it\'s a nice story, and I\'m looking forward to the next chapter :)</div></td>\n</tr>'), ('2017-02-08 03:28:45.337764', 10480835, 205845659, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4686785&amp;r ... (885 characters truncated) ... ">chapter 7 . <span data-xutime="1407803151">8/11/2014</span> </small><div style="margin-top:5px">Very good chapter, I loved it ...</div></td>\n</tr>'), ('2017-02-08 03:28:45.337766', 10480835, 204446602, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4686785&amp;r ... (1040 characters truncated) ... he way you write the character of Lily. I think your idea for another story is very interesting, I think you should write about it.</div></td>\n</tr>'), ('2017-02-08 03:28:45.337768', 10480835, 203938905, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4686785&amp;r ... (920 characters truncated) ... 05213529">7/12/2014</span> </small><div style="margin-top:5px">Very good chapter, I\'m loving the character James, keep writing ...</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-08 03:28:45.337795', 10480835, 202930819, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4686785&amp;r ... (970 characters truncated) ... gin-top:5px">Very good first chapter, I love stories with this couple, congratulations you write very well, I\'ll keep watching ...</div></td>\n</tr>'), ('2017-02-08 03:28:45.337797', 10480835, 202772283, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5343603&amp;r ... (1005 characters truncated) ... eat first chapter. <br>\nGot the feeling that i was back at Hogwarts again. <br>\nLooking forward to see where you will take it. :)</div></td>\n</tr>'))]
19:28:45 reviews: Job OK (aa6e136e-12b6-4786-b561-c61030ad69ed)
19:28:45 Result is kept for 500 seconds
19:28:45 
19:28:45 *** Listening on chapters, profiles, reviews...
19:28:45 reviews: fanfic.jobs.crawl_reviews(10482354) (0a7a3a3f-a195-4c99-b5ae-4b5c06e863a9)
19:29:15 reviews: Job OK (0a7a3a3f-a195-4c99-b5ae-4b5c06e863a9)
19:29:15 Result is kept for 500 seconds
19:29:15 
19:29:15 *** Listening on chapters, profiles, reviews...
19:29:15 reviews: fanfic.jobs.crawl_reviews(10483273) (23d24a8e-eefd-4d13-8dc5-e6050e883184)
19:29:48 reviews: Job OK (23d24a8e-eefd-4d13-8dc5-e6050e883184)
19:29:48 Result is kept for 500 seconds
19:29:48 
19:29:48 *** Listening on chapters, profiles, reviews...
19:29:48 reviews: fanfic.jobs.crawl_reviews(10483938) (62a09506-0f65-41f4-9302-6e99d9874666)
19:30:25 reviews: Job OK (62a09506-0f65-41f4-9302-6e99d9874666)
19:30:25 Result is kept for 500 seconds
19:30:25 
19:30:25 *** Listening on chapters, profiles, reviews...
19:30:25 reviews: fanfic.jobs.crawl_reviews(10484218) (adaf34c7-46b6-4db9-9ce7-21f9a070cbda)
19:30:43 reviews: Job OK (adaf34c7-46b6-4db9-9ce7-21f9a070cbda)
19:30:43 Result is kept for 500 seconds
19:30:43 
19:30:43 *** Listening on chapters, profiles, reviews...
19:30:43 reviews: fanfic.jobs.crawl_reviews(10484740) (20e35bbe-f04a-49e8-8177-2c2cf01bf77b)
19:34:36 reviews: Job OK (20e35bbe-f04a-49e8-8177-2c2cf01bf77b)
19:34:36 Result is kept for 500 seconds
19:34:36 
19:34:36 *** Listening on chapters, profiles, reviews...
19:34:36 reviews: fanfic.jobs.crawl_reviews(10487644) (23404514-8fc1-48d7-b403-e5ed7c3edd06)
19:45:17 reviews: Job OK (23404514-8fc1-48d7-b403-e5ed7c3edd06)
19:45:17 Result is kept for 500 seconds
19:45:17 
19:45:17 *** Listening on chapters, profiles, reviews...
19:45:17 reviews: fanfic.jobs.crawl_reviews(10488922) (0d3d3217-8508-45e8-bb1f-c297eac629ca)
19:46:07 reviews: Job OK (0d3d3217-8508-45e8-bb1f-c297eac629ca)
19:46:07 Result is kept for 500 seconds
19:46:07 
19:46:07 *** Listening on chapters, profiles, reviews...
19:46:07 reviews: fanfic.jobs.crawl_reviews(10489298) (941d6f59-7163-4630-8f80-60624e0dcdd8)
19:46:12 reviews: Job OK (941d6f59-7163-4630-8f80-60624e0dcdd8)
19:46:12 Result is kept for 500 seconds
19:46:12 
19:46:12 *** Listening on chapters, profiles, reviews...
19:46:12 reviews: fanfic.jobs.crawl_reviews(10491851) (695a4380-df7f-497a-a646-29ab9a5a850f)
19:50:25 reviews: Job OK (695a4380-df7f-497a-a646-29ab9a5a850f)
19:50:25 Result is kept for 500 seconds
19:50:25 
19:50:25 *** Listening on chapters, profiles, reviews...
19:50:25 reviews: fanfic.jobs.crawl_reviews(10494138) (396f248c-194c-400d-961c-c94156878ccb)
19:50:50 reviews: Job OK (396f248c-194c-400d-961c-c94156878ccb)
19:50:50 Result is kept for 500 seconds
19:50:50 
19:50:50 *** Listening on chapters, profiles, reviews...
19:50:50 reviews: fanfic.jobs.crawl_reviews(10494150) (aee13357-fbc4-4d4e-827a-0cc0fe7c38c8)
19:52:07 reviews: Job OK (aee13357-fbc4-4d4e-827a-0cc0fe7c38c8)
19:52:07 Result is kept for 500 seconds
19:52:07 Cleaning registries for queue: chapters
19:52:07 Cleaning registries for queue: profiles
19:52:07 Cleaning registries for queue: reviews
19:52:07 
19:52:07 *** Listening on chapters, profiles, reviews...
19:52:07 reviews: fanfic.jobs.crawl_reviews(10495118) (0fd74512-60a1-4faf-a56f-880472fc181f)
19:53:32 reviews: Job OK (0fd74512-60a1-4faf-a56f-880472fc181f)
19:53:32 Result is kept for 500 seconds
19:53:32 
19:53:32 *** Listening on chapters, profiles, reviews...
19:53:32 reviews: fanfic.jobs.crawl_reviews(10497787) (76ac2fab-00e0-42e2-bd33-3aec1f55d1ad)
19:53:50 reviews: Job OK (76ac2fab-00e0-42e2-bd33-3aec1f55d1ad)
19:53:50 Result is kept for 500 seconds
19:53:50 
19:53:50 *** Listening on chapters, profiles, reviews...
19:53:50 reviews: fanfic.jobs.crawl_reviews(10497992) (6056f734-1600-44d6-870f-35680374ee9d)
19:54:10 reviews: Job OK (6056f734-1600-44d6-870f-35680374ee9d)
19:54:10 Result is kept for 500 seconds
19:54:10 
19:54:10 *** Listening on chapters, profiles, reviews...
19:54:10 reviews: fanfic.jobs.crawl_reviews(10498669) (0162ace4-fb28-4661-8b14-a909f21038e6)
19:54:31 reviews: Job OK (0162ace4-fb28-4661-8b14-a909f21038e6)
19:54:31 Result is kept for 500 seconds
19:54:31 
19:54:31 *** Listening on chapters, profiles, reviews...
19:54:31 reviews: fanfic.jobs.crawl_reviews(10499313) (88d5f5b2-3064-48c0-9125-0e0d521db49c)
19:55:18 reviews: Job OK (88d5f5b2-3064-48c0-9125-0e0d521db49c)
19:55:18 Result is kept for 500 seconds
19:55:18 
19:55:18 *** Listening on chapters, profiles, reviews...
19:55:18 reviews: fanfic.jobs.crawl_reviews(10499972) (17aaf35e-d0df-4910-bfb5-5e079280f442)
19:56:26 reviews: Job OK (17aaf35e-d0df-4910-bfb5-5e079280f442)
19:56:26 Result is kept for 500 seconds
19:56:26 
19:56:26 *** Listening on chapters, profiles, reviews...
19:56:26 reviews: fanfic.jobs.crawl_reviews(10500138) (f02b4a01-5bc4-4f53-bc14-6060fb0be721)
19:57:14 reviews: Job OK (f02b4a01-5bc4-4f53-bc14-6060fb0be721)
19:57:14 Result is kept for 500 seconds
19:57:14 
19:57:14 *** Listening on chapters, profiles, reviews...
19:57:14 reviews: fanfic.jobs.crawl_reviews(10500166) (a466a8ed-a427-489a-9844-00c314aeafa6)
19:57:46 reviews: Job OK (a466a8ed-a427-489a-9844-00c314aeafa6)
19:57:46 Result is kept for 500 seconds
19:57:46 
19:57:46 *** Listening on chapters, profiles, reviews...
19:57:46 reviews: fanfic.jobs.crawl_reviews(10502653) (b49b55c4-c3df-4626-ba48-6b00853a7e1e)
20:02:34 reviews: Job OK (b49b55c4-c3df-4626-ba48-6b00853a7e1e)
20:02:34 Result is kept for 500 seconds
20:02:34 
20:02:34 *** Listening on chapters, profiles, reviews...
20:02:34 reviews: fanfic.jobs.crawl_reviews(10502800) (4005a051-6daa-487e-ae72-39e679fc7d12)
20:03:07 reviews: Job OK (4005a051-6daa-487e-ae72-39e679fc7d12)
20:03:07 Result is kept for 500 seconds
20:03:07 
20:03:07 *** Listening on chapters, profiles, reviews...
20:03:07 reviews: fanfic.jobs.crawl_reviews(10503431) (3966d0c4-19eb-4990-b19c-63b77f11fadd)
20:03:11 reviews: Job OK (3966d0c4-19eb-4990-b19c-63b77f11fadd)
20:03:11 Result is kept for 500 seconds
20:03:11 
20:03:11 *** Listening on chapters, profiles, reviews...
20:03:11 reviews: fanfic.jobs.crawl_reviews(10504085) (e0f3b39e-749b-4e6e-b1d4-0bb34f87fc7c)
20:05:31 reviews: Job OK (e0f3b39e-749b-4e6e-b1d4-0bb34f87fc7c)
20:05:31 Result is kept for 500 seconds
20:05:31 
20:05:31 *** Listening on chapters, profiles, reviews...
20:05:31 reviews: fanfic.jobs.crawl_reviews(10505765) (4b84c5ba-e777-4d18-98c4-9569b66eb605)
20:06:56 reviews: Job OK (4b84c5ba-e777-4d18-98c4-9569b66eb605)
20:06:56 Result is kept for 500 seconds
20:06:56 
20:06:56 *** Listening on chapters, profiles, reviews...
20:06:56 reviews: fanfic.jobs.crawl_reviews(10506407) (a7aebfa0-4aeb-4292-bae8-66b45f5e013f)
20:07:02 reviews: Job OK (a7aebfa0-4aeb-4292-bae8-66b45f5e013f)
20:07:02 Result is kept for 500 seconds
20:07:02 
20:07:02 *** Listening on chapters, profiles, reviews...
20:07:02 reviews: fanfic.jobs.crawl_reviews(10506441) (af699327-1ac9-478a-92cb-056410fb4d38)
20:17:46 reviews: Job OK (af699327-1ac9-478a-92cb-056410fb4d38)
20:17:46 Result is kept for 500 seconds
20:17:46 
20:17:46 *** Listening on chapters, profiles, reviews...
20:17:46 reviews: fanfic.jobs.crawl_reviews(10506994) (1cec5836-5602-45e6-b85f-ddf83b69fc7b)
20:17:55 reviews: Job OK (1cec5836-5602-45e6-b85f-ddf83b69fc7b)
20:17:55 Result is kept for 500 seconds
20:17:55 
20:17:55 *** Listening on chapters, profiles, reviews...
20:17:55 reviews: fanfic.jobs.crawl_reviews(10507423) (5285667e-9fe4-42c3-ba24-a6abfb97a330)
20:22:45 reviews: Job OK (5285667e-9fe4-42c3-ba24-a6abfb97a330)
20:22:45 Result is kept for 500 seconds
20:22:45 
20:22:45 *** Listening on chapters, profiles, reviews...
20:22:45 reviews: fanfic.jobs.crawl_reviews(10507879) (71dd01a7-47ae-4763-af3d-6f36b1c135f2)
20:24:05 reviews: Job OK (71dd01a7-47ae-4763-af3d-6f36b1c135f2)
20:24:05 Result is kept for 500 seconds
20:24:05 
20:24:05 *** Listening on chapters, profiles, reviews...
20:24:05 reviews: fanfic.jobs.crawl_reviews(10508398) (dbf5e9e0-7bba-45b4-87bb-06d98ddbdec5)
20:24:43 reviews: Job OK (dbf5e9e0-7bba-45b4-87bb-06d98ddbdec5)
20:24:43 Result is kept for 500 seconds
20:24:43 
20:24:43 *** Listening on chapters, profiles, reviews...
20:24:43 reviews: fanfic.jobs.crawl_reviews(10508511) (b7973b0e-d455-4a7c-8e82-75d51c030e06)
20:25:43 reviews: Job OK (b7973b0e-d455-4a7c-8e82-75d51c030e06)
20:25:43 Result is kept for 500 seconds
20:25:43 
20:25:43 *** Listening on chapters, profiles, reviews...
20:25:43 reviews: fanfic.jobs.crawl_reviews(10508602) (06154ff4-f641-43d3-b11b-72edc741fe47)
20:27:08 reviews: Job OK (06154ff4-f641-43d3-b11b-72edc741fe47)
20:27:08 Result is kept for 500 seconds
20:27:08 
20:27:08 *** Listening on chapters, profiles, reviews...
20:27:08 reviews: fanfic.jobs.crawl_reviews(10508872) (b0c35eaa-1a3f-4b09-a4ad-1f1f1d5fb3cd)
20:28:13 reviews: Job OK (b0c35eaa-1a3f-4b09-a4ad-1f1f1d5fb3cd)
20:28:13 Result is kept for 500 seconds
20:28:13 
20:28:13 *** Listening on chapters, profiles, reviews...
20:28:13 reviews: fanfic.jobs.crawl_reviews(10509859) (efcfe549-a6fc-4b60-9040-4369662f8a1b)
20:28:27 reviews: Job OK (efcfe549-a6fc-4b60-9040-4369662f8a1b)
20:28:27 Result is kept for 500 seconds
20:28:27 
20:28:27 *** Listening on chapters, profiles, reviews...
20:28:27 reviews: fanfic.jobs.crawl_reviews(10515677) (597acc56-bc2d-402d-8346-fab08b325261)
20:30:12 reviews: Job OK (597acc56-bc2d-402d-8346-fab08b325261)
20:30:12 Result is kept for 500 seconds
20:30:12 
20:30:12 *** Listening on chapters, profiles, reviews...
20:30:12 reviews: fanfic.jobs.crawl_reviews(10515765) (3c8547c5-0031-45d0-ba52-05b786297f20)
20:32:13 reviews: Job OK (3c8547c5-0031-45d0-ba52-05b786297f20)
20:32:13 Result is kept for 500 seconds
20:32:13 
20:32:13 *** Listening on chapters, profiles, reviews...
20:32:13 reviews: fanfic.jobs.crawl_reviews(10516207) (746edf5a-0886-478d-93de-f691233276c1)
20:33:27 reviews: Job OK (746edf5a-0886-478d-93de-f691233276c1)
20:33:27 Result is kept for 500 seconds
20:33:27 
20:33:27 *** Listening on chapters, profiles, reviews...
20:33:27 reviews: fanfic.jobs.crawl_reviews(10516951) (6f996c62-5c65-4026-80b4-61b81d6f2902)
20:34:00 reviews: Job OK (6f996c62-5c65-4026-80b4-61b81d6f2902)
20:34:00 Result is kept for 500 seconds
20:34:00 
20:34:00 *** Listening on chapters, profiles, reviews...
20:34:00 reviews: fanfic.jobs.crawl_reviews(10517857) (c514c635-31a8-484f-9285-7a183123d45b)
20:35:30 reviews: Job OK (c514c635-31a8-484f-9285-7a183123d45b)
20:35:30 Result is kept for 500 seconds
20:35:30 
20:35:30 *** Listening on chapters, profiles, reviews...
20:35:30 reviews: fanfic.jobs.crawl_reviews(10520211) (52418b08-8a2b-4a1b-8f1c-97df43c001a1)
20:35:50 reviews: Job OK (52418b08-8a2b-4a1b-8f1c-97df43c001a1)
20:35:50 Result is kept for 500 seconds
20:35:50 
20:35:50 *** Listening on chapters, profiles, reviews...
20:35:50 reviews: fanfic.jobs.crawl_reviews(10520281) (1be6fb95-bb3a-4eb3-b9ea-61e1a0a47755)
20:36:07 reviews: Job OK (1be6fb95-bb3a-4eb3-b9ea-61e1a0a47755)
20:36:07 Result is kept for 500 seconds
20:36:07 
20:36:07 *** Listening on chapters, profiles, reviews...
20:36:07 reviews: fanfic.jobs.crawl_reviews(10521681) (d44f4c97-32e2-464c-a4fa-5558a51c5f44)
20:36:43 reviews: Job OK (d44f4c97-32e2-464c-a4fa-5558a51c5f44)
20:36:43 Result is kept for 500 seconds
20:36:43 
20:36:43 *** Listening on chapters, profiles, reviews...
20:36:43 reviews: fanfic.jobs.crawl_reviews(10522345) (cfcd7089-20ed-4eb7-b630-2c5101f336e2)
20:41:14 reviews: Job OK (cfcd7089-20ed-4eb7-b630-2c5101f336e2)
20:41:14 Result is kept for 500 seconds
20:41:14 
20:41:14 *** Listening on chapters, profiles, reviews...
20:41:14 reviews: fanfic.jobs.crawl_reviews(10522549) (ffb0a2f7-caf3-4bc5-a278-39e005193949)
20:41:23 reviews: Job OK (ffb0a2f7-caf3-4bc5-a278-39e005193949)
20:41:23 Result is kept for 500 seconds
20:41:23 
20:41:23 *** Listening on chapters, profiles, reviews...
20:41:23 reviews: fanfic.jobs.crawl_reviews(10523424) (e9621e34-ed79-42b2-8eb5-d68574b56517)
20:41:47 reviews: Job OK (e9621e34-ed79-42b2-8eb5-d68574b56517)
20:41:47 Result is kept for 500 seconds
20:41:47 
20:41:47 *** Listening on chapters, profiles, reviews...
20:41:47 reviews: fanfic.jobs.crawl_reviews(10523682) (e1f93bcb-fbbc-4034-b114-b1468a72d19a)
20:44:44 reviews: Job OK (e1f93bcb-fbbc-4034-b114-b1468a72d19a)
20:44:44 Result is kept for 500 seconds
20:44:44 
20:44:44 *** Listening on chapters, profiles, reviews...
20:44:44 reviews: fanfic.jobs.crawl_reviews(10523820) (87d44d97-1447-4e97-bfbb-30aa2c712fa7)
2017-02-07 20:44:48 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 04:44:48.695683', 10523820, 205484853, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (793 characters truncated) ... ghts belonging to Mr. Lippert doesn\'t absolve you of the legal and moral implications of this kind of hijacking.<br>\n<br>\nShame!</div></td>\n</tr>'), ('2017-02-08 04:44:48.695688', 10523820, 204434145, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5366822&amp;r ... (973 characters truncated) ... credit someone, you can\'t copy their story word for word. You should probably spell the title right too, or just remove the story!</div></td>\n</tr>'), ('2017-02-08 04:44:48.695690', 10523820, 204232505, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=552270&amp;rw ... (918 characters truncated) ... v style="margin-top:5px">Next time, take two seconds to make sure the only bit you typed out yourself, the title, is spelled right.</div></td>\n</tr>'), ('2017-02-08 04:44:48.695692', 10523820, 204037775, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5897676&amp;r ... (874 characters truncated) ... 349338">7/14/2014</span> </small><div style="margin-top:5px">Oh come on man... What was the point in copying Norman Lippert\'s fic?</div></td>\n</tr>'), ('2017-02-08 04:44:48.695694', 10523820, 205484853, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (793 characters truncated) ... ghts belonging to Mr. Lippert doesn\'t absolve you of the legal and moral implications of this kind of hijacking.<br>\n<br>\nShame!</div></td>\n</tr>'), ('2017-02-08 04:44:48.695696', 10523820, 204434145, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5366822&amp;r ... (973 characters truncated) ... credit someone, you can\'t copy their story word for word. You should probably spell the title right too, or just remove the story!</div></td>\n</tr>'), ('2017-02-08 04:44:48.695698', 10523820, 204232505, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=552270&amp;rw ... (918 characters truncated) ... v style="margin-top:5px">Next time, take two seconds to make sure the only bit you typed out yourself, the title, is spelled right.</div></td>\n</tr>'), ('2017-02-08 04:44:48.695700', 10523820, 204037775, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5897676&amp;r ... (874 characters truncated) ... 349338">7/14/2014</span> </small><div style="margin-top:5px">Oh come on man... What was the point in copying Norman Lippert\'s fic?</div></td>\n</tr>'))]
20:44:48 reviews: Job OK (87d44d97-1447-4e97-bfbb-30aa2c712fa7)
20:44:48 Result is kept for 500 seconds
20:44:48 
20:44:48 *** Listening on chapters, profiles, reviews...
20:44:48 reviews: fanfic.jobs.crawl_reviews(10524099) (abf82ab8-9dfa-4ce6-9a73-3f02fe74f7df)
2017-02-07 20:44:50 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/10524099/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
20:44:50 reviews: Job OK (abf82ab8-9dfa-4ce6-9a73-3f02fe74f7df)
20:44:50 Result is kept for 500 seconds
20:44:50 
20:44:50 *** Listening on chapters, profiles, reviews...
20:44:50 reviews: fanfic.jobs.crawl_reviews(10525216) (f66e3ae1-1dd7-4860-b2ac-b1a5228acdc0)
20:45:32 reviews: Job OK (f66e3ae1-1dd7-4860-b2ac-b1a5228acdc0)
20:45:32 Result is kept for 500 seconds
20:45:32 
20:45:32 *** Listening on chapters, profiles, reviews...
20:45:32 reviews: fanfic.jobs.crawl_reviews(10526970) (c2188217-0005-4e70-872b-73c8a2401bfd)
20:45:40 reviews: Job OK (c2188217-0005-4e70-872b-73c8a2401bfd)
20:45:40 Result is kept for 500 seconds
20:45:40 
20:45:40 *** Listening on chapters, profiles, reviews...
20:45:40 reviews: fanfic.jobs.crawl_reviews(10527383) (1d291af5-82c3-412f-a698-25128be6175d)
20:46:51 reviews: Job OK (1d291af5-82c3-412f-a698-25128be6175d)
20:46:51 Result is kept for 500 seconds
20:46:51 
20:46:51 *** Listening on chapters, profiles, reviews...
20:46:51 reviews: fanfic.jobs.crawl_reviews(10527488) (72400e6f-9efe-422d-ab41-efbaeeb0bcf0)
20:46:59 reviews: Job OK (72400e6f-9efe-422d-ab41-efbaeeb0bcf0)
20:46:59 Result is kept for 500 seconds
20:46:59 
20:46:59 *** Listening on chapters, profiles, reviews...
20:46:59 reviews: fanfic.jobs.crawl_reviews(10527785) (2cdc66e5-1dc6-479d-80c1-f6f4415f8542)
20:47:27 reviews: Job OK (2cdc66e5-1dc6-479d-80c1-f6f4415f8542)
20:47:27 Result is kept for 500 seconds
20:47:27 
20:47:27 *** Listening on chapters, profiles, reviews...
20:47:27 reviews: fanfic.jobs.crawl_reviews(10529966) (311b28d0-8919-472f-914e-0b3ac93b0099)
20:48:17 reviews: Job OK (311b28d0-8919-472f-914e-0b3ac93b0099)
20:48:17 Result is kept for 500 seconds
20:48:17 
20:48:17 *** Listening on chapters, profiles, reviews...
20:48:17 reviews: fanfic.jobs.crawl_reviews(10530537) (f98c9db2-5d4f-4c01-82d4-7880127d422e)
20:48:26 reviews: Job OK (f98c9db2-5d4f-4c01-82d4-7880127d422e)
20:48:26 Result is kept for 500 seconds
20:48:26 
20:48:26 *** Listening on chapters, profiles, reviews...
20:48:26 reviews: fanfic.jobs.crawl_reviews(10531945) (18891b7a-9b4a-49a9-b422-1294da6343f9)
20:49:43 reviews: Job OK (18891b7a-9b4a-49a9-b422-1294da6343f9)
20:49:43 Result is kept for 500 seconds
20:49:43 
20:49:43 *** Listening on chapters, profiles, reviews...
20:49:43 reviews: fanfic.jobs.crawl_reviews(10532942) (c4f3b399-40b1-4279-910c-a9574ee910ca)
20:52:09 reviews: Job OK (c4f3b399-40b1-4279-910c-a9574ee910ca)
20:52:09 Result is kept for 500 seconds
20:52:09 Cleaning registries for queue: chapters
20:52:09 Cleaning registries for queue: profiles
20:52:09 Cleaning registries for queue: reviews
20:52:09 
20:52:09 *** Listening on chapters, profiles, reviews...
20:52:09 reviews: fanfic.jobs.crawl_reviews(10533323) (ae3f9769-46b6-4aac-a629-2f556d0fb4f9)
20:52:23 reviews: Job OK (ae3f9769-46b6-4aac-a629-2f556d0fb4f9)
20:52:23 Result is kept for 500 seconds
20:52:23 
20:52:23 *** Listening on chapters, profiles, reviews...
20:52:23 reviews: fanfic.jobs.crawl_reviews(10534342) (fad93a3d-3e09-41f6-bb96-9a695789bbb1)
20:53:01 reviews: Job OK (fad93a3d-3e09-41f6-bb96-9a695789bbb1)
20:53:01 Result is kept for 500 seconds
20:53:01 
20:53:01 *** Listening on chapters, profiles, reviews...
20:53:01 reviews: fanfic.jobs.crawl_reviews(10535886) (df460cfc-7455-454d-8065-1ed61bfd20f0)
20:53:44 reviews: Job OK (df460cfc-7455-454d-8065-1ed61bfd20f0)
20:53:44 Result is kept for 500 seconds
20:53:44 
20:53:44 *** Listening on chapters, profiles, reviews...
20:53:44 reviews: fanfic.jobs.crawl_reviews(10536445) (e8e7c3d2-e39a-450f-893a-9f4646058dfa)
20:57:07 reviews: Job OK (e8e7c3d2-e39a-450f-893a-9f4646058dfa)
20:57:07 Result is kept for 500 seconds
20:57:07 
20:57:07 *** Listening on chapters, profiles, reviews...
20:57:07 reviews: fanfic.jobs.crawl_reviews(10537969) (e36107fb-fe74-4c7c-86c9-6d0ae10d0fe9)
20:57:49 reviews: Job OK (e36107fb-fe74-4c7c-86c9-6d0ae10d0fe9)
20:57:49 Result is kept for 500 seconds
20:57:49 
20:57:49 *** Listening on chapters, profiles, reviews...
20:57:49 reviews: fanfic.jobs.crawl_reviews(10538565) (db3842bd-cbb2-4e15-84b8-b11ba5dc1a2a)
20:58:24 reviews: Job OK (db3842bd-cbb2-4e15-84b8-b11ba5dc1a2a)
20:58:24 Result is kept for 500 seconds
20:58:24 
20:58:24 *** Listening on chapters, profiles, reviews...
20:58:24 reviews: fanfic.jobs.crawl_reviews(10539221) (8c43bfce-9ae4-4a71-b9ed-25b22c0081c6)
21:01:38 reviews: Job OK (8c43bfce-9ae4-4a71-b9ed-25b22c0081c6)
21:01:38 Result is kept for 500 seconds
21:01:38 
21:01:38 *** Listening on chapters, profiles, reviews...
21:01:38 reviews: fanfic.jobs.crawl_reviews(10539586) (db839382-a6a2-401a-bea2-1c61bdab3e8b)
21:04:25 reviews: Job OK (db839382-a6a2-401a-bea2-1c61bdab3e8b)
21:04:25 Result is kept for 500 seconds
21:04:25 
21:04:25 *** Listening on chapters, profiles, reviews...
21:04:25 reviews: fanfic.jobs.crawl_reviews(10540789) (32b579cc-3158-4f19-8e84-c1739f14e2ce)
21:04:46 reviews: Job OK (32b579cc-3158-4f19-8e84-c1739f14e2ce)
21:04:46 Result is kept for 500 seconds
21:04:46 
21:04:46 *** Listening on chapters, profiles, reviews...
21:04:46 reviews: fanfic.jobs.crawl_reviews(10541297) (37bcdbc1-4716-41b6-a710-d25e3c2dd7b6)
21:09:35 reviews: Job OK (37bcdbc1-4716-41b6-a710-d25e3c2dd7b6)
21:09:35 Result is kept for 500 seconds
21:09:35 
21:09:35 *** Listening on chapters, profiles, reviews...
21:09:35 reviews: fanfic.jobs.crawl_reviews(10541753) (dd3d7e9f-dd4a-4a24-8eba-75042d04eb36)
21:09:45 reviews: Job OK (dd3d7e9f-dd4a-4a24-8eba-75042d04eb36)
21:09:45 Result is kept for 500 seconds
21:09:45 
21:09:45 *** Listening on chapters, profiles, reviews...
21:09:45 reviews: fanfic.jobs.crawl_reviews(10541767) (7d8fa73b-5a68-4212-8f28-e20e0fe83166)
21:10:03 reviews: Job OK (7d8fa73b-5a68-4212-8f28-e20e0fe83166)
21:10:03 Result is kept for 500 seconds
21:10:03 
21:10:03 *** Listening on chapters, profiles, reviews...
21:10:03 reviews: fanfic.jobs.crawl_reviews(10542345) (c470033a-26f9-46f0-a12a-be31fbde7644)
21:16:19 reviews: Job OK (c470033a-26f9-46f0-a12a-be31fbde7644)
21:16:19 Result is kept for 500 seconds
21:16:19 
21:16:19 *** Listening on chapters, profiles, reviews...
21:16:19 reviews: fanfic.jobs.crawl_reviews(10544835) (ec4aa990-aea0-47d7-b7c4-572a7d30b001)
21:21:39 reviews: Job OK (ec4aa990-aea0-47d7-b7c4-572a7d30b001)
21:21:39 Result is kept for 500 seconds
21:21:39 
21:21:39 *** Listening on chapters, profiles, reviews...
21:21:39 reviews: fanfic.jobs.crawl_reviews(10547195) (32239d65-687d-42aa-9045-6efac33c261b)
21:21:50 reviews: Job OK (32239d65-687d-42aa-9045-6efac33c261b)
21:21:50 Result is kept for 500 seconds
21:21:50 
21:21:50 *** Listening on chapters, profiles, reviews...
21:21:50 reviews: fanfic.jobs.crawl_reviews(10549407) (45d2933a-76a3-485b-b25d-ff5adc7fc56e)
2017-02-07 21:21:55 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 05:21:55.531614', 10549407, 214100657, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (595 characters truncated) ... small><div style="margin-top:5px">I love this story and the ending! Can\'t wait for the epilogue. What are you going to write next?</div></td>\n</tr>'), ('2017-02-08 05:21:55.531619', 10549407, 207042593, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (513 characters truncated) ... style="color:gray">chapter 9 . <span data-xutime="1409537415">8/31/2014</span> </small><div style="margin-top:5px">Wow, great book!</div></td>\n</tr>'), ('2017-02-08 05:21:55.531621', 10549407, 206878985, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4928242&amp;r ... (895 characters truncated) ... ="margin-top:5px">This is so cute! I love the idea, especially when james/lily get racy! can\'t wait to see more updates from ya :)</div></td>\n</tr>'), ('2017-02-08 05:21:55.531623', 10549407, 205874911, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6000335&amp;r ... (886 characters truncated) ... v style="margin-top:5px">This is really good! I love the little argument they have about which country is better! Very interesting.</div></td>\n</tr>'), ('2017-02-08 05:21:55.531625', 10549407, 214100657, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (595 characters truncated) ... small><div style="margin-top:5px">I love this story and the ending! Can\'t wait for the epilogue. What are you going to write next?</div></td>\n</tr>'), ('2017-02-08 05:21:55.531627', 10549407, 207042593, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (513 characters truncated) ... style="color:gray">chapter 9 . <span data-xutime="1409537415">8/31/2014</span> </small><div style="margin-top:5px">Wow, great book!</div></td>\n</tr>'), ('2017-02-08 05:21:55.531629', 10549407, 206878985, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4928242&amp;r ... (895 characters truncated) ... ="margin-top:5px">This is so cute! I love the idea, especially when james/lily get racy! can\'t wait to see more updates from ya :)</div></td>\n</tr>'), ('2017-02-08 05:21:55.531631', 10549407, 205874911, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6000335&amp;r ... (886 characters truncated) ... v style="margin-top:5px">This is really good! I love the little argument they have about which country is better! Very interesting.</div></td>\n</tr>'))]
21:21:55 reviews: Job OK (45d2933a-76a3-485b-b25d-ff5adc7fc56e)
21:21:55 Result is kept for 500 seconds
21:21:55 
21:21:55 *** Listening on chapters, profiles, reviews...
21:21:55 reviews: fanfic.jobs.crawl_reviews(10549506) (dd966b2c-1079-4442-9ebe-7db85db9aa75)
21:22:01 reviews: Job OK (dd966b2c-1079-4442-9ebe-7db85db9aa75)
21:22:01 Result is kept for 500 seconds
21:22:01 
21:22:01 *** Listening on chapters, profiles, reviews...
21:22:01 reviews: fanfic.jobs.crawl_reviews(10549790) (cfc61f6f-1599-47a7-ad13-25cc949272d0)
21:22:30 reviews: Job OK (cfc61f6f-1599-47a7-ad13-25cc949272d0)
21:22:30 Result is kept for 500 seconds
21:22:30 
21:22:30 *** Listening on chapters, profiles, reviews...
21:22:30 reviews: fanfic.jobs.crawl_reviews(10552564) (7cb3dc66-9ed5-4f9f-970a-e6f4bc3220cb)
21:23:32 reviews: Job OK (7cb3dc66-9ed5-4f9f-970a-e6f4bc3220cb)
21:23:32 Result is kept for 500 seconds
21:23:32 
21:23:32 *** Listening on chapters, profiles, reviews...
21:23:32 reviews: fanfic.jobs.crawl_reviews(10553003) (07488d43-c8c1-41e8-b022-a8747f6e3eab)
21:30:11 reviews: Job OK (07488d43-c8c1-41e8-b022-a8747f6e3eab)
21:30:11 Result is kept for 500 seconds
21:30:11 
21:30:11 *** Listening on chapters, profiles, reviews...
21:30:11 reviews: fanfic.jobs.crawl_reviews(10554013) (7fa7175b-0442-4e39-a821-88c5688909b0)
21:33:59 reviews: Job OK (7fa7175b-0442-4e39-a821-88c5688909b0)
21:33:59 Result is kept for 500 seconds
21:33:59 
21:33:59 *** Listening on chapters, profiles, reviews...
21:33:59 reviews: fanfic.jobs.crawl_reviews(10554509) (6a560276-8468-4fb9-9cce-44d781d1da21)
21:38:54 reviews: Job OK (6a560276-8468-4fb9-9cce-44d781d1da21)
21:38:54 Result is kept for 500 seconds
21:38:54 
21:38:54 *** Listening on chapters, profiles, reviews...
21:38:54 reviews: fanfic.jobs.crawl_reviews(10555281) (6a95dd62-fa1e-4a2d-aade-a9f09de70381)
21:39:28 reviews: Job OK (6a95dd62-fa1e-4a2d-aade-a9f09de70381)
21:39:28 Result is kept for 500 seconds
21:39:28 
21:39:28 *** Listening on chapters, profiles, reviews...
21:39:28 reviews: fanfic.jobs.crawl_reviews(10555403) (b43f3f3e-a0b2-47c5-9205-924abf739d1d)
21:40:04 reviews: Job OK (b43f3f3e-a0b2-47c5-9205-924abf739d1d)
21:40:04 Result is kept for 500 seconds
21:40:04 
21:40:04 *** Listening on chapters, profiles, reviews...
21:40:04 reviews: fanfic.jobs.crawl_reviews(10555997) (90f8fc74-3733-4b6f-bab4-1d274a7c7475)
21:40:42 reviews: Job OK (90f8fc74-3733-4b6f-bab4-1d274a7c7475)
21:40:42 Result is kept for 500 seconds
21:40:42 
21:40:42 *** Listening on chapters, profiles, reviews...
21:40:42 reviews: fanfic.jobs.crawl_reviews(10556030) (9d969d4d-4dd0-41c2-aa81-67fc1d2852c3)
21:43:35 reviews: Job OK (9d969d4d-4dd0-41c2-aa81-67fc1d2852c3)
21:43:35 Result is kept for 500 seconds
21:43:35 
21:43:35 *** Listening on chapters, profiles, reviews...
21:43:35 reviews: fanfic.jobs.crawl_reviews(10556445) (71ec790f-698b-4bf9-b574-9e54c48858d5)
21:44:01 reviews: Job OK (71ec790f-698b-4bf9-b574-9e54c48858d5)
21:44:01 Result is kept for 500 seconds
21:44:01 
21:44:01 *** Listening on chapters, profiles, reviews...
21:44:01 reviews: fanfic.jobs.crawl_reviews(10556815) (54b58147-67a4-47bf-9158-f02349aa2d2f)
21:44:32 reviews: Job OK (54b58147-67a4-47bf-9158-f02349aa2d2f)
21:44:32 Result is kept for 500 seconds
21:44:32 
21:44:32 *** Listening on chapters, profiles, reviews...
21:44:32 reviews: fanfic.jobs.crawl_reviews(10558310) (644d9248-b94e-4a60-9d54-f25b7bced726)
21:48:13 reviews: Job OK (644d9248-b94e-4a60-9d54-f25b7bced726)
21:48:13 Result is kept for 500 seconds
21:48:13 
21:48:13 *** Listening on chapters, profiles, reviews...
21:48:13 reviews: fanfic.jobs.crawl_reviews(10558740) (e1db75d9-8493-4d76-aa8d-50683fc0113e)
21:50:14 reviews: Job OK (e1db75d9-8493-4d76-aa8d-50683fc0113e)
21:50:14 Result is kept for 500 seconds
21:50:14 
21:50:14 *** Listening on chapters, profiles, reviews...
21:50:14 reviews: fanfic.jobs.crawl_reviews(10560639) (2bbb2879-8aca-4284-ba5e-e42590bb1389)
21:50:56 reviews: Job OK (2bbb2879-8aca-4284-ba5e-e42590bb1389)
21:50:56 Result is kept for 500 seconds
21:50:56 
21:50:56 *** Listening on chapters, profiles, reviews...
21:50:56 reviews: fanfic.jobs.crawl_reviews(10561889) (9373fabf-5c35-4adc-a52a-9e92af28c7b1)
21:51:51 reviews: Job OK (9373fabf-5c35-4adc-a52a-9e92af28c7b1)
21:51:51 Result is kept for 500 seconds
21:51:51 
21:51:51 *** Listening on chapters, profiles, reviews...
21:51:51 reviews: fanfic.jobs.crawl_reviews(10561902) (ce1e08ba-1e2a-4792-8468-978514af2dae)
21:52:37 reviews: Job OK (ce1e08ba-1e2a-4792-8468-978514af2dae)
21:52:37 Result is kept for 500 seconds
21:52:37 Cleaning registries for queue: chapters
21:52:37 Cleaning registries for queue: profiles
21:52:37 Cleaning registries for queue: reviews
21:52:37 
21:52:37 *** Listening on chapters, profiles, reviews...
21:52:37 reviews: fanfic.jobs.crawl_reviews(10561926) (583ce98f-a25a-41c0-9ee4-03ed64a0751c)
21:52:47 reviews: Job OK (583ce98f-a25a-41c0-9ee4-03ed64a0751c)
21:52:47 Result is kept for 500 seconds
21:52:47 
21:52:47 *** Listening on chapters, profiles, reviews...
21:52:47 reviews: fanfic.jobs.crawl_reviews(10563416) (426cc28f-c2d9-4a13-836b-e986bbe58a67)
21:53:00 reviews: Job OK (426cc28f-c2d9-4a13-836b-e986bbe58a67)
21:53:00 Result is kept for 500 seconds
21:53:00 
21:53:00 *** Listening on chapters, profiles, reviews...
21:53:00 reviews: fanfic.jobs.crawl_reviews(10563477) (5cce3ddc-5c30-4626-82a9-04466617908b)
21:56:39 reviews: Job OK (5cce3ddc-5c30-4626-82a9-04466617908b)
21:56:39 Result is kept for 500 seconds
21:56:39 
21:56:39 *** Listening on chapters, profiles, reviews...
21:56:39 reviews: fanfic.jobs.crawl_reviews(10563517) (24256d27-1d00-4f23-ac93-ed64162198ad)
2017-02-07 21:56:45 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 05:56:45.248238', 10563517, 230346215, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5702904&amp;r ... (1120 characters truncated) ... so it probably won\'t happen again. But, nonetheless, it is a great story, and I would LOVE it if you updated again. Pretty please?</div></td>\n</tr>'), ('2017-02-08 05:56:45.248242', 10563517, 212058040, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4644151&amp;r ... (862 characters truncated) ... all style="color:gray">chapter 9 . <span data-xutime="1418187993">12/9/2014</span> </small><div style="margin-top:5px">Update soon!</div></td>\n</tr>'), ('2017-02-08 05:56:45.248244', 10563517, 209522329, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (647 characters truncated) ... o let you know I discovered this story last night and finished reading it up to the last chapter in one go. It really has me hooked</div></td>\n</tr>'), ('2017-02-08 05:56:45.248246', 10563517, 207059850, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5009187&amp;r ... (1088 characters truncated) ... e things about the accident, her life, &amp; scorpius &amp; becomes friends with him again...;) can\'t wait till the next chapter:)</div></td>\n</tr>'), ('2017-02-08 05:56:45.248248', 10563517, 206706278, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5009187&amp;r ... (1225 characters truncated) ... nna be horrible! Who the fuck is this "wicked" guy obviously Rose knows who he is vice versa!? Can\'t wait till the next chapter!:D</div></td>\n</tr>'), ('2017-02-08 05:56:45.248250', 10563517, 206602569, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (796 characters truncated) ... he last 20 years. It has been very therapeutic for both of is. My log in is charm night29. Love the story and good luck in college.</div></td>\n</tr>'), ('2017-02-08 05:56:45.248252', 10563517, 206198147, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (703 characters truncated) ... her boyfriend\'s parents want to talk to her? I like stories that do not follow the normal they hate each other to love each other.</div></td>\n</tr>'), ('2017-02-08 05:56:45.248254', 10563517, 206196565, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4981707&amp;r ... (1094 characters truncated) ... wait to find out about them as the story progresses. I wonder is Rose\'s personality different now since she lost all her memories?</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-08 05:56:45.248278', 10563517, 205052192, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4674464&amp;r ... (819 characters truncated) ... data-xutime="1406716621">7/30/2014</span> </small><div style="margin-top:5px">Your story is beautiful, I hope you update soon :) xx</div></td>\n</tr>'), ('2017-02-08 05:56:45.248280', 10563517, 204851535, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5808488&amp;r ... (1102 characters truncated) ... . I just wanna know because I would hate to fall in love with this story and end up crying at the end. Besides that love your story</div></td>\n</tr>'))]
21:56:45 reviews: Job OK (24256d27-1d00-4f23-ac93-ed64162198ad)
21:56:45 Result is kept for 500 seconds
21:56:45 
21:56:45 *** Listening on chapters, profiles, reviews...
21:56:45 reviews: fanfic.jobs.crawl_reviews(10564605) (a213f9d0-f2aa-4a2d-b5ee-a61dfd0dbadd)
21:56:54 reviews: Job OK (a213f9d0-f2aa-4a2d-b5ee-a61dfd0dbadd)
21:56:54 Result is kept for 500 seconds
21:56:54 
21:56:54 *** Listening on chapters, profiles, reviews...
21:56:54 reviews: fanfic.jobs.crawl_reviews(10565061) (c8ea8609-dec8-406e-8445-610d8efcfa99)
21:56:59 reviews: Job OK (c8ea8609-dec8-406e-8445-610d8efcfa99)
21:56:59 Result is kept for 500 seconds
21:56:59 
21:56:59 *** Listening on chapters, profiles, reviews...
21:56:59 reviews: fanfic.jobs.crawl_reviews(10565895) (021f40a4-8905-4355-8904-36c9688abf7d)
21:57:25 reviews: Job OK (021f40a4-8905-4355-8904-36c9688abf7d)
21:57:25 Result is kept for 500 seconds
21:57:25 
21:57:25 *** Listening on chapters, profiles, reviews...
21:57:25 reviews: fanfic.jobs.crawl_reviews(10566893) (d16b9f81-9fec-4122-a53b-295b40505f83)
22:00:10 reviews: Job OK (d16b9f81-9fec-4122-a53b-295b40505f83)
22:00:10 Result is kept for 500 seconds
22:00:10 
22:00:10 *** Listening on chapters, profiles, reviews...
22:00:10 reviews: fanfic.jobs.crawl_reviews(10567688) (66779f29-b1ad-4249-a713-8a783a5b3356)
22:00:30 reviews: Job OK (66779f29-b1ad-4249-a713-8a783a5b3356)
22:00:30 Result is kept for 500 seconds
22:00:30 
22:00:30 *** Listening on chapters, profiles, reviews...
22:00:30 reviews: fanfic.jobs.crawl_reviews(10567941) (89f689b7-688d-4774-b9d3-bbfd9018a3ff)
22:05:31 reviews: Job OK (89f689b7-688d-4774-b9d3-bbfd9018a3ff)
22:05:31 Result is kept for 500 seconds
22:05:31 
22:05:31 *** Listening on chapters, profiles, reviews...
22:05:31 reviews: fanfic.jobs.crawl_reviews(10569323) (3fe86432-f8c4-4663-86b7-9384d4d2f60e)
22:08:24 reviews: Job OK (3fe86432-f8c4-4663-86b7-9384d4d2f60e)
22:08:24 Result is kept for 500 seconds
22:08:24 
22:08:24 *** Listening on chapters, profiles, reviews...
22:08:24 reviews: fanfic.jobs.crawl_reviews(10569817) (aa6fa3fd-06b8-4531-9e9a-caf30582d6c9)
22:09:01 reviews: Job OK (aa6fa3fd-06b8-4531-9e9a-caf30582d6c9)
22:09:01 Result is kept for 500 seconds
22:09:01 
22:09:01 *** Listening on chapters, profiles, reviews...
22:09:01 reviews: fanfic.jobs.crawl_reviews(10570242) (396a7899-276d-4839-9f1e-2cec041dab0b)
22:14:59 reviews: Job OK (396a7899-276d-4839-9f1e-2cec041dab0b)
22:14:59 Result is kept for 500 seconds
22:14:59 
22:14:59 *** Listening on chapters, profiles, reviews...
22:14:59 reviews: fanfic.jobs.crawl_reviews(10571286) (bd17eae9-9f42-4061-a84a-6a8722573d4f)
22:15:22 reviews: Job OK (bd17eae9-9f42-4061-a84a-6a8722573d4f)
22:15:22 Result is kept for 500 seconds
22:15:22 
22:15:22 *** Listening on chapters, profiles, reviews...
22:15:22 reviews: fanfic.jobs.crawl_reviews(10571663) (6d4b4698-f0a2-4503-a6db-41ae9c1b425f)
22:16:30 reviews: Job OK (6d4b4698-f0a2-4503-a6db-41ae9c1b425f)
22:16:30 Result is kept for 500 seconds
22:16:30 
22:16:30 *** Listening on chapters, profiles, reviews...
22:16:30 reviews: fanfic.jobs.crawl_reviews(10572061) (922c850a-22c4-4e1d-ae30-335c0f0be6d5)
22:17:20 reviews: Job OK (922c850a-22c4-4e1d-ae30-335c0f0be6d5)
22:17:20 Result is kept for 500 seconds
22:17:20 
22:17:20 *** Listening on chapters, profiles, reviews...
22:17:20 reviews: fanfic.jobs.crawl_reviews(10572471) (4959c3df-0b73-4a44-85bd-f329db28c87b)
22:17:37 reviews: Job OK (4959c3df-0b73-4a44-85bd-f329db28c87b)
22:17:37 Result is kept for 500 seconds
22:17:37 
22:17:37 *** Listening on chapters, profiles, reviews...
22:17:37 reviews: fanfic.jobs.crawl_reviews(10573310) (7754d1b3-71a0-4243-896d-e2afbebeb003)
22:18:23 reviews: Job OK (7754d1b3-71a0-4243-896d-e2afbebeb003)
22:18:23 Result is kept for 500 seconds
22:18:23 
22:18:23 *** Listening on chapters, profiles, reviews...
22:18:23 reviews: fanfic.jobs.crawl_reviews(10574546) (30f148ca-2532-47ac-b9de-337a7702fffa)
22:19:21 reviews: Job OK (30f148ca-2532-47ac-b9de-337a7702fffa)
22:19:21 Result is kept for 500 seconds
22:19:21 
22:19:21 *** Listening on chapters, profiles, reviews...
22:19:21 reviews: fanfic.jobs.crawl_reviews(10578416) (749c5e43-9306-4cd2-818c-a4129f4e6522)
22:21:01 reviews: Job OK (749c5e43-9306-4cd2-818c-a4129f4e6522)
22:21:02 Result is kept for 500 seconds
22:21:02 
22:21:02 *** Listening on chapters, profiles, reviews...
22:21:02 reviews: fanfic.jobs.crawl_reviews(10579324) (a531ff16-683f-4b3d-82a2-e8d74e5dec6d)
22:21:06 reviews: Job OK (a531ff16-683f-4b3d-82a2-e8d74e5dec6d)
22:21:06 Result is kept for 500 seconds
22:21:06 
22:21:06 *** Listening on chapters, profiles, reviews...
22:21:06 reviews: fanfic.jobs.crawl_reviews(10580160) (aeb77626-f547-4ca6-a092-e686dbd6c635)
22:22:09 reviews: Job OK (aeb77626-f547-4ca6-a092-e686dbd6c635)
22:22:09 Result is kept for 500 seconds
22:22:09 
22:22:09 *** Listening on chapters, profiles, reviews...
22:22:09 reviews: fanfic.jobs.crawl_reviews(10581959) (37cd11e0-a1bb-467b-9b4a-733b4f71c010)
22:22:22 reviews: Job OK (37cd11e0-a1bb-467b-9b4a-733b4f71c010)
22:22:22 Result is kept for 500 seconds
22:22:22 
22:22:22 *** Listening on chapters, profiles, reviews...
22:22:22 reviews: fanfic.jobs.crawl_reviews(10582851) (517f97c9-44ec-43a2-801f-93d9d0ac5938)
22:22:48 reviews: Job OK (517f97c9-44ec-43a2-801f-93d9d0ac5938)
22:22:48 Result is kept for 500 seconds
22:22:48 
22:22:48 *** Listening on chapters, profiles, reviews...
22:22:48 reviews: fanfic.jobs.crawl_reviews(10582964) (acc1fb95-6ed6-4dbe-bc40-8cd7f156fe25)
22:23:22 reviews: Job OK (acc1fb95-6ed6-4dbe-bc40-8cd7f156fe25)
22:23:22 Result is kept for 500 seconds
22:23:22 
22:23:22 *** Listening on chapters, profiles, reviews...
22:23:22 reviews: fanfic.jobs.crawl_reviews(10584042) (b2298fe1-3698-47d6-9983-4069925c51a5)
22:24:06 reviews: Job OK (b2298fe1-3698-47d6-9983-4069925c51a5)
22:24:06 Result is kept for 500 seconds
22:24:06 
22:24:06 *** Listening on chapters, profiles, reviews...
22:24:06 reviews: fanfic.jobs.crawl_reviews(10584705) (23c5bf7c-a1d9-4046-ad84-ccb4c181e385)
22:24:48 reviews: Job OK (23c5bf7c-a1d9-4046-ad84-ccb4c181e385)
22:24:48 Result is kept for 500 seconds
22:24:48 
22:24:48 *** Listening on chapters, profiles, reviews...
22:24:48 reviews: fanfic.jobs.crawl_reviews(10585184) (2e8052cb-a5ff-466e-9b22-dd50798716f1)
22:25:34 reviews: Job OK (2e8052cb-a5ff-466e-9b22-dd50798716f1)
22:25:34 Result is kept for 500 seconds
22:25:34 
22:25:34 *** Listening on chapters, profiles, reviews...
22:25:34 reviews: fanfic.jobs.crawl_reviews(10585412) (093da5eb-b49e-4a05-a2e0-20fc4153298c)
22:28:41 reviews: Job OK (093da5eb-b49e-4a05-a2e0-20fc4153298c)
22:28:41 Result is kept for 500 seconds
22:28:41 
22:28:41 *** Listening on chapters, profiles, reviews...
22:28:41 reviews: fanfic.jobs.crawl_reviews(10586380) (837f4630-0523-44d4-b485-07611dbbf4a6)
22:28:54 reviews: Job OK (837f4630-0523-44d4-b485-07611dbbf4a6)
22:28:54 Result is kept for 500 seconds
22:28:54 
22:28:54 *** Listening on chapters, profiles, reviews...
22:28:54 reviews: fanfic.jobs.crawl_reviews(10587788) (387d3ebd-8c47-441e-9e0b-d0a9aa23011d)
2017-02-07 22:29:00 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 06:29:00.798466', 10587788, 225218897, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2051884&amp;r ... (849 characters truncated) ... 2015</span> </small><div style="margin-top:5px">That was a bit fast, I love stalker stories since I\'m a big fan of Criminal Minds.</div></td>\n</tr>'), ('2017-02-08 06:29:00.798470', 10587788, 208191410, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5058697&amp;r ... (1019 characters truncated) ... it worried that Draco was going to keep the wife but I am so happy that it worked out happy for Draco and Hermione! Loved this fic!</div></td>\n</tr>'), ('2017-02-08 06:29:00.798473', 10587788, 207889032, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=833803&amp;rw ... (914 characters truncated) ... ="1411008745">9/17/2014</span> </small><div style="margin-top:5px">God, Hermione was insufferable until the end there. Great story.</div></td>\n</tr>'), ('2017-02-08 06:29:00.798475', 10587788, 207888330, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=833803&amp;rw ... (992 characters truncated) ...  Hermione\'s an idiot. Stubbornly deciding that dig your heels in when obviously you need to have a real conversation isn\'t noble!</div></td>\n</tr>'), ('2017-02-08 06:29:00.798477', 10587788, 207887939, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=833803&amp;rw ... (949 characters truncated) ... all><div style="margin-top:5px">Draco should have left his wife from day one. But if he does the right thing now, I\'ll forgve him.</div></td>\n</tr>'), ('2017-02-08 06:29:00.798478', 10587788, 207887391, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=833803&amp;rw ... (1085 characters truncated) ... life? COME ON DRACO! Either leave Hermione alone or leave your wife. Can\'t have both. It\'s extremely unfair to Hermione and Caro!</div></td>\n</tr>'), ('2017-02-08 06:29:00.798480', 10587788, 207886540, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=833803&amp;rw ... (971 characters truncated) ... -top:5px">OMG it\'s too early in the story for a \'happy ever after\' and that was so perfect I don\'t want it ruined! I\'m scared!</div></td>\n</tr>'), ('2017-02-08 06:29:00.798482', 10587788, 207448293, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4925593&amp;r ... (926 characters truncated) ...  I love it. I\'m surprised it hasn\'t had more reviews! I was just wondering how long Hermione was captured before she was rescued.</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-08 06:29:00.798522', 10587788, 205278309, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1979035&amp;r ... (903 characters truncated) ... ter 1 . <span data-xutime="1407024622">8/2/2014</span> </small><div style="margin-top:5px">Loveeeee ittt<br>\nWooowwww<br>\nMoreeee</div></td>\n</tr>'), ('2017-02-08 06:29:00.798524', 10587788, 205274986, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (562 characters truncated) ... "1407020476">8/2/2014</span> </small><div style="margin-top:5px">This is really good xxxx I hope there will be another chapter soon</div></td>\n</tr>'))]
22:29:00 reviews: Job OK (387d3ebd-8c47-441e-9e0b-d0a9aa23011d)
22:29:00 Result is kept for 500 seconds
22:29:00 
22:29:00 *** Listening on chapters, profiles, reviews...
22:29:00 reviews: fanfic.jobs.crawl_reviews(10588283) (882bad15-44b1-44dd-90e3-0c6707a7866d)
22:37:16 reviews: Job OK (882bad15-44b1-44dd-90e3-0c6707a7866d)
22:37:16 Result is kept for 500 seconds
22:37:16 
22:37:16 *** Listening on chapters, profiles, reviews...
22:37:16 reviews: fanfic.jobs.crawl_reviews(10590054) (2b3d42e6-c479-4889-8775-55cfcc784e31)
22:39:04 reviews: Job OK (2b3d42e6-c479-4889-8775-55cfcc784e31)
22:39:04 Result is kept for 500 seconds
22:39:04 
22:39:04 *** Listening on chapters, profiles, reviews...
22:39:04 reviews: fanfic.jobs.crawl_reviews(10591146) (3ed793a8-f467-4707-a126-177811815609)
22:39:27 reviews: Job OK (3ed793a8-f467-4707-a126-177811815609)
22:39:27 Result is kept for 500 seconds
22:39:27 
22:39:27 *** Listening on chapters, profiles, reviews...
22:39:27 reviews: fanfic.jobs.crawl_reviews(10591332) (f672725d-d0ed-4749-8952-003613e8baf0)
22:42:01 reviews: Job OK (f672725d-d0ed-4749-8952-003613e8baf0)
22:42:01 Result is kept for 500 seconds
22:42:01 
22:42:01 *** Listening on chapters, profiles, reviews...
22:42:01 reviews: fanfic.jobs.crawl_reviews(10593114) (0c3fe45c-bfa5-4ddd-9c41-a9cd1869d3cc)
22:46:51 reviews: Job OK (0c3fe45c-bfa5-4ddd-9c41-a9cd1869d3cc)
22:46:51 Result is kept for 500 seconds
22:46:51 
22:46:51 *** Listening on chapters, profiles, reviews...
22:46:51 reviews: fanfic.jobs.crawl_reviews(10593257) (ed4aa972-0936-4266-ac69-b35711ad6c56)
22:47:16 reviews: Job OK (ed4aa972-0936-4266-ac69-b35711ad6c56)
22:47:16 Result is kept for 500 seconds
22:47:16 
22:47:16 *** Listening on chapters, profiles, reviews...
22:47:16 reviews: fanfic.jobs.crawl_reviews(10594766) (045695f3-481a-4ccc-b3db-fc8b736e334f)
22:49:52 reviews: Job OK (045695f3-481a-4ccc-b3db-fc8b736e334f)
22:49:52 Result is kept for 500 seconds
22:49:52 
22:49:52 *** Listening on chapters, profiles, reviews...
22:49:52 reviews: fanfic.jobs.crawl_reviews(10595005) (1115fb08-2528-4a0f-a180-9d141be91042)
22:53:08 reviews: Job OK (1115fb08-2528-4a0f-a180-9d141be91042)
22:53:08 Result is kept for 500 seconds
22:53:08 Cleaning registries for queue: chapters
22:53:08 Cleaning registries for queue: profiles
22:53:08 Cleaning registries for queue: reviews
22:53:08 
22:53:08 *** Listening on chapters, profiles, reviews...
22:53:08 reviews: fanfic.jobs.crawl_reviews(10595347) (2f4ae288-9e54-4976-8097-5f5bf40c4000)
22:53:17 reviews: Job OK (2f4ae288-9e54-4976-8097-5f5bf40c4000)
22:53:17 Result is kept for 500 seconds
22:53:17 
22:53:17 *** Listening on chapters, profiles, reviews...
22:53:17 reviews: fanfic.jobs.crawl_reviews(10595466) (38dfea02-8189-46e1-b43b-4f44b0a9be89)
22:53:24 reviews: Job OK (38dfea02-8189-46e1-b43b-4f44b0a9be89)
22:53:24 Result is kept for 500 seconds
22:53:24 
22:53:24 *** Listening on chapters, profiles, reviews...
22:53:24 reviews: fanfic.jobs.crawl_reviews(10596224) (7dcc57b4-b308-45e3-8164-d8517b1209c4)
22:53:40 reviews: Job OK (7dcc57b4-b308-45e3-8164-d8517b1209c4)
22:53:40 Result is kept for 500 seconds
22:53:40 
22:53:40 *** Listening on chapters, profiles, reviews...
22:53:40 reviews: fanfic.jobs.crawl_reviews(10598729) (bd08b929-ac6c-4648-b0fc-b446308656ae)
22:54:57 reviews: Job OK (bd08b929-ac6c-4648-b0fc-b446308656ae)
22:54:57 Result is kept for 500 seconds
22:54:57 
22:54:57 *** Listening on chapters, profiles, reviews...
22:54:57 reviews: fanfic.jobs.crawl_reviews(10598791) (4a1b120c-4672-4d53-bff9-84f8f965c72a)
22:55:05 reviews: Job OK (4a1b120c-4672-4d53-bff9-84f8f965c72a)
22:55:05 Result is kept for 500 seconds
22:55:05 
22:55:05 *** Listening on chapters, profiles, reviews...
22:55:05 reviews: fanfic.jobs.crawl_reviews(10601229) (ab16978e-ac30-4a02-9b5e-5ea423fbdb80)
22:55:44 reviews: Job OK (ab16978e-ac30-4a02-9b5e-5ea423fbdb80)
22:55:44 Result is kept for 500 seconds
22:55:44 
22:55:44 *** Listening on chapters, profiles, reviews...
22:55:44 reviews: fanfic.jobs.crawl_reviews(10602908) (163e67c7-f79e-4d80-8c96-9d485b7807b4)
22:57:24 reviews: Job OK (163e67c7-f79e-4d80-8c96-9d485b7807b4)
22:57:24 Result is kept for 500 seconds
22:57:24 
22:57:24 *** Listening on chapters, profiles, reviews...
22:57:24 reviews: fanfic.jobs.crawl_reviews(10603506) (c019ccf7-96c6-4aab-a736-a26c85b31f17)
22:57:44 reviews: Job OK (c019ccf7-96c6-4aab-a736-a26c85b31f17)
22:57:44 Result is kept for 500 seconds
22:57:44 
22:57:44 *** Listening on chapters, profiles, reviews...
22:57:44 reviews: fanfic.jobs.crawl_reviews(10604132) (30caceb3-ae6a-4a72-89f1-b3a8633521b8)
22:58:11 reviews: Job OK (30caceb3-ae6a-4a72-89f1-b3a8633521b8)
22:58:11 Result is kept for 500 seconds
22:58:11 
22:58:11 *** Listening on chapters, profiles, reviews...
22:58:11 reviews: fanfic.jobs.crawl_reviews(10604318) (3eaf549d-0bec-4726-8aea-41b64d0715fd)
23:07:05 reviews: Job OK (3eaf549d-0bec-4726-8aea-41b64d0715fd)
23:07:05 Result is kept for 500 seconds
23:07:05 
23:07:05 *** Listening on chapters, profiles, reviews...
23:07:05 reviews: fanfic.jobs.crawl_reviews(10605272) (48312931-0c7c-47a5-b6a3-351836947cf5)
23:09:09 reviews: Job OK (48312931-0c7c-47a5-b6a3-351836947cf5)
23:09:09 Result is kept for 500 seconds
23:09:09 
23:09:09 *** Listening on chapters, profiles, reviews...
23:09:09 reviews: fanfic.jobs.crawl_reviews(10606894) (fc90915f-a912-4ff4-8feb-ec4a9f06e0aa)
23:09:15 reviews: Job OK (fc90915f-a912-4ff4-8feb-ec4a9f06e0aa)
23:09:15 Result is kept for 500 seconds
23:09:15 
23:09:15 *** Listening on chapters, profiles, reviews...
23:09:15 reviews: fanfic.jobs.crawl_reviews(10607433) (bcdc00aa-01ed-4fa1-b0c3-3d5a7db9af47)
23:17:45 reviews: Job OK (bcdc00aa-01ed-4fa1-b0c3-3d5a7db9af47)
23:17:45 Result is kept for 500 seconds
23:17:45 
23:17:45 *** Listening on chapters, profiles, reviews...
23:17:45 reviews: fanfic.jobs.crawl_reviews(10608932) (a0f429c5-088d-4639-9445-16f8b920c1a5)
23:18:17 reviews: Job OK (a0f429c5-088d-4639-9445-16f8b920c1a5)
23:18:17 Result is kept for 500 seconds
23:18:17 
23:18:17 *** Listening on chapters, profiles, reviews...
23:18:17 reviews: fanfic.jobs.crawl_reviews(10609073) (c622f8e9-bffe-48d9-af35-325dcba1d118)
23:18:34 reviews: Job OK (c622f8e9-bffe-48d9-af35-325dcba1d118)
23:18:34 Result is kept for 500 seconds
23:18:34 
23:18:34 *** Listening on chapters, profiles, reviews...
23:18:34 reviews: fanfic.jobs.crawl_reviews(10609689) (ebfa5669-c0cb-47d8-8049-3f690dc2369d)
23:19:46 reviews: Job OK (ebfa5669-c0cb-47d8-8049-3f690dc2369d)
23:19:46 Result is kept for 500 seconds
23:19:46 
23:19:46 *** Listening on chapters, profiles, reviews...
23:19:46 reviews: fanfic.jobs.crawl_reviews(10610353) (3b0947f2-ad59-458f-b3c7-a94b3d7bc659)
2017-02-07 23:19:51 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 07:19:51.473572', 10610353, 213568012, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2943021&amp;r ... (1073 characters truncated) ... e curtain". Haha. It kind of ads a while new meaning to that scene. I just hope you\'re aware that it should probably be changed. )</div></td>\n</tr>'), ('2017-02-08 07:19:51.473576', 10610353, 213465709, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (645 characters truncated) ... for writing again! Although it was a little hard, I still read the whole thing just because I was so excited for it :) Well Done xx</div></td>\n</tr>'), ('2017-02-08 07:19:51.473579', 10610353, 213011036, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (625 characters truncated) ... 5px">Something happened when you updated. I could barely read the chapter. Please post another chapter! What happened with dog boy?</div></td>\n</tr>'), ('2017-02-08 07:19:51.473581', 10610353, 212280385, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2939359&amp;r ... (1199 characters truncated) ... hat your story is bad. That\'s just my helpful critique, well my intention is to be helpful at sure if I actually am being helpful.</div></td>\n</tr>'), ('2017-02-08 07:19:51.473582', 10610353, 207497220, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (658 characters truncated) ... y! I really appreciate all the hard work that you put into this to keep in entertaining and updated regularly : ) again, Thankyou x</div></td>\n</tr>'), ('2017-02-08 07:19:51.473584', 10610353, 207497145, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (675 characters truncated) ... so great having a good story that is updated often! I really appreciate all your hard work, and I hope that you keep updating... xx</div></td>\n</tr>'), ('2017-02-08 07:19:51.473586', 10610353, 207270351, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6059313&amp;r ... (1318 characters truncated) ... story, and of course you do not have to change it, I just thought I should point it out to you. <br>\nThanks for such a great read!</div></td>\n</tr>'), ('2017-02-08 07:19:51.473588', 10610353, 206163532, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6017457&amp;r ... (805 characters truncated) ... ="color:gray">chapter 16 . <span data-xutime="1408272603">8/17/2014</span> </small><div style="margin-top:5px">Awesome, as usual :)</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-08 07:19:51.473616', 10610353, 205935272, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (525 characters truncated) ... :gray">chapter 6 . <span data-xutime="1407765199">8/11/2014</span> </small><div style="margin-top:5px">It\'s great. Pleas post soon</div></td>\n</tr>'), ('2017-02-08 07:19:51.473618', 10610353, 205821488, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5705584&amp;r ... (1073 characters truncated) ... ...you missed chapter four :((( i really hope you could update it, still, it\'s an amazing story, update soon! Can\'t wait for more</div></td>\n</tr>'))]
23:19:51 reviews: Job OK (3b0947f2-ad59-458f-b3c7-a94b3d7bc659)
23:19:51 Result is kept for 500 seconds
23:19:51 
23:19:51 *** Listening on chapters, profiles, reviews...
23:19:51 reviews: fanfic.jobs.crawl_reviews(10612133) (70d09ac2-9e48-40c5-9f96-bd7e555ddebe)
23:19:54 reviews: Job OK (70d09ac2-9e48-40c5-9f96-bd7e555ddebe)
23:19:54 Result is kept for 500 seconds
23:19:54 
23:19:54 *** Listening on chapters, profiles, reviews...
23:19:54 reviews: fanfic.jobs.crawl_reviews(10612141) (4657b343-5c15-4035-bcbd-53a30a8fe203)
23:21:57 reviews: Job OK (4657b343-5c15-4035-bcbd-53a30a8fe203)
23:21:57 Result is kept for 500 seconds
23:21:57 
23:21:57 *** Listening on chapters, profiles, reviews...
23:21:57 reviews: fanfic.jobs.crawl_reviews(10613420) (9444cc60-5e7e-4f55-977d-f96daa5fd741)
23:24:52 reviews: Job OK (9444cc60-5e7e-4f55-977d-f96daa5fd741)
23:24:52 Result is kept for 500 seconds
23:24:52 
23:24:52 *** Listening on chapters, profiles, reviews...
23:24:52 reviews: fanfic.jobs.crawl_reviews(10613492) (15a7b2ab-94ee-4dfe-90ac-8dcefe2e81a3)
23:25:11 reviews: Job OK (15a7b2ab-94ee-4dfe-90ac-8dcefe2e81a3)
23:25:11 Result is kept for 500 seconds
23:25:11 
23:25:11 *** Listening on chapters, profiles, reviews...
23:25:11 reviews: fanfic.jobs.crawl_reviews(10614352) (92e9d0a8-39c8-4c1e-b604-0effce7c5a04)
23:25:23 reviews: Job OK (92e9d0a8-39c8-4c1e-b604-0effce7c5a04)
23:25:23 Result is kept for 500 seconds
23:25:23 
23:25:23 *** Listening on chapters, profiles, reviews...
23:25:23 reviews: fanfic.jobs.crawl_reviews(10616975) (e9638e50-32e8-423e-a1e1-b5250821e14c)
23:29:07 reviews: Job OK (e9638e50-32e8-423e-a1e1-b5250821e14c)
23:29:07 Result is kept for 500 seconds
23:29:07 
23:29:07 *** Listening on chapters, profiles, reviews...
23:29:07 reviews: fanfic.jobs.crawl_reviews(10618552) (f4e88155-0796-4d03-b6a0-b24e86021027)
2017-02-07 23:29:08 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/10618552/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
23:29:08 reviews: Job OK (f4e88155-0796-4d03-b6a0-b24e86021027)
23:29:08 Result is kept for 500 seconds
23:29:08 
23:29:08 *** Listening on chapters, profiles, reviews...
23:29:08 reviews: fanfic.jobs.crawl_reviews(10618712) (6ecd30cb-d1ce-4eb8-accb-1359018a0b66)
23:29:14 reviews: Job OK (6ecd30cb-d1ce-4eb8-accb-1359018a0b66)
23:29:14 Result is kept for 500 seconds
23:29:14 
23:29:14 *** Listening on chapters, profiles, reviews...
23:29:14 reviews: fanfic.jobs.crawl_reviews(10619866) (ebb8a8a5-7f93-427a-9c23-889d6b4fcd2b)
23:29:31 reviews: Job OK (ebb8a8a5-7f93-427a-9c23-889d6b4fcd2b)
23:29:31 Result is kept for 500 seconds
23:29:31 
23:29:31 *** Listening on chapters, profiles, reviews...
23:29:31 reviews: fanfic.jobs.crawl_reviews(10620022) (1fa04d53-8351-4a5f-8a6e-94ac0a3dbcbb)
23:29:43 reviews: Job OK (1fa04d53-8351-4a5f-8a6e-94ac0a3dbcbb)
23:29:43 Result is kept for 500 seconds
23:29:43 
23:29:43 *** Listening on chapters, profiles, reviews...
23:29:43 reviews: fanfic.jobs.crawl_reviews(10621216) (e62432eb-e496-451c-aa97-e231d4dd4846)
23:30:27 reviews: Job OK (e62432eb-e496-451c-aa97-e231d4dd4846)
23:30:27 Result is kept for 500 seconds
23:30:27 
23:30:27 *** Listening on chapters, profiles, reviews...
23:30:27 reviews: fanfic.jobs.crawl_reviews(10622066) (94fc12e2-a35f-4e5d-b5cd-7c74fddbf821)
2017-02-07 23:30:31 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 07:30:31.964611', 10622066, 230426050, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (548 characters truncated) ... an data-xutime="1450281823">12/16/2015</span> </small><div style="margin-top:5px">Will Ron please kill Draco, he\'s such a scumbag.</div></td>\n</tr>'), ('2017-02-08 07:30:31.964615', 10622066, 230415223, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4664521&amp;r ... (962 characters truncated) ... xutime="1450252825">12/16/2015</span> </small><div style="margin-top:5px">Good chapter. Hope there will be more Hinny chapters too.</div></td>\n</tr>'), ('2017-02-08 07:30:31.964618', 10622066, 208256313, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2043964&amp;r ... (854 characters truncated) ... ter 10 . <span data-xutime="1411642291">9/25/2014</span> </small><div style="margin-top:5px">Excellent chapter and wonderful story.</div></td>\n</tr>'), ('2017-02-08 07:30:31.964620', 10622066, 208255705, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4664521&amp;r ... (1175 characters truncated) ... don\'t know if there is anyone in their families that has gray eyes. But that\'s not so important. Looking forward to next chapter.</div></td>\n</tr>'), ('2017-02-08 07:30:31.964622', 10622066, 207533478, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4664521&amp;r ... (992 characters truncated) ... span> </small><div style="margin-top:5px">Great chapter. Please tell me that nothing bad will happen to them. They suffered enough.</div></td>\n</tr>'), ('2017-02-08 07:30:31.964624', 10622066, 207344284, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4664521&amp;r ... (1085 characters truncated) ...  saw Dumbledore in canon. But here it looks like he didn\'t saw anyone. Shouldn\'t have someone told him that he was a horcrux too?</div></td>\n</tr>'), ('2017-02-08 07:30:31.964626', 10622066, 207271853, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2043964&amp;r ... (843 characters truncated) ... :gray">chapter 8 . <span data-xutime="1409982781">9/5/2014</span> </small><div style="margin-top:5px">Excellent couple of chapters.</div></td>\n</tr>'), ('2017-02-08 07:30:31.964628', 10622066, 207122552, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2043964&amp;r ... (883 characters truncated) ... 09726823">9/2/2014</span> </small><div style="margin-top:5px">Well written chapter. Poor Ginny poor Harry. Looking forward to more.</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-08 07:30:31.964664', 10622066, 206680525, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2043964&amp;r ... (958 characters truncated) ... ing this story. Can\'t wait to see his it all evolves. Poor Ginny how will she deal with everything? I hope Harry is there for her.</div></td>\n</tr>'), ('2017-02-08 07:30:31.964666', 10622066, 206114023, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (778 characters truncated) ... und Harry/Draco alot of it is Darry. You may also want to focus on your paragraphs, and add more Dialog. A beta may help with that.</div></td>\n</tr>'))]
23:30:31 reviews: Job OK (94fc12e2-a35f-4e5d-b5cd-7c74fddbf821)
23:30:31 Result is kept for 500 seconds
23:30:31 
23:30:31 *** Listening on chapters, profiles, reviews...
23:30:31 reviews: fanfic.jobs.crawl_reviews(10622306) (5ecf2fea-e261-4035-acf1-936ed21186be)
23:35:02 reviews: Job OK (5ecf2fea-e261-4035-acf1-936ed21186be)
23:35:02 Result is kept for 500 seconds
23:35:02 
23:35:02 *** Listening on chapters, profiles, reviews...
23:35:02 reviews: fanfic.jobs.crawl_reviews(10622307) (c5f1d463-4a87-4975-83e0-7c8aaed2bdfc)
23:35:36 reviews: Job OK (c5f1d463-4a87-4975-83e0-7c8aaed2bdfc)
23:35:36 Result is kept for 500 seconds
23:35:37 
23:35:37 *** Listening on chapters, profiles, reviews...
23:35:37 reviews: fanfic.jobs.crawl_reviews(10622357) (6b5e92ed-29ea-4aa5-8873-0691f75b73d2)
23:36:16 reviews: Job OK (6b5e92ed-29ea-4aa5-8873-0691f75b73d2)
23:36:16 Result is kept for 500 seconds
23:36:16 
23:36:16 *** Listening on chapters, profiles, reviews...
23:36:16 reviews: fanfic.jobs.crawl_reviews(10622703) (dd686df0-304f-4f68-8a1b-8035ccac2b7b)
23:37:10 reviews: Job OK (dd686df0-304f-4f68-8a1b-8035ccac2b7b)
23:37:10 Result is kept for 500 seconds
23:37:10 
23:37:10 *** Listening on chapters, profiles, reviews...
23:37:10 reviews: fanfic.jobs.crawl_reviews(10623014) (94f94808-b32a-4e96-b3e1-e4394fc0fce2)
23:38:51 reviews: Job OK (94f94808-b32a-4e96-b3e1-e4394fc0fce2)
23:38:51 Result is kept for 500 seconds
23:38:51 
23:38:51 *** Listening on chapters, profiles, reviews...
23:38:51 reviews: fanfic.jobs.crawl_reviews(10623630) (bb540183-9c9f-4877-8fa9-72c1dc246cd5)
2017-02-07 23:38:52 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/10623630/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
23:38:52 reviews: Job OK (bb540183-9c9f-4877-8fa9-72c1dc246cd5)
23:38:52 Result is kept for 500 seconds
23:38:52 
23:38:52 *** Listening on chapters, profiles, reviews...
23:38:52 reviews: fanfic.jobs.crawl_reviews(10623702) (6379bddf-02bf-41e9-86f4-bb896bf54956)
23:40:20 reviews: Job OK (6379bddf-02bf-41e9-86f4-bb896bf54956)
23:40:20 Result is kept for 500 seconds
23:40:20 
23:40:20 *** Listening on chapters, profiles, reviews...
23:40:20 reviews: fanfic.jobs.crawl_reviews(10624783) (4d5aa2ad-3b2c-428a-ab89-fc1c533bd4b1)
23:40:57 reviews: Job OK (4d5aa2ad-3b2c-428a-ab89-fc1c533bd4b1)
23:40:57 Result is kept for 500 seconds
23:40:57 
23:40:57 *** Listening on chapters, profiles, reviews...
23:40:57 reviews: fanfic.jobs.crawl_reviews(10625400) (9b01d934-30c7-4e9b-9e34-fe4450bca292)
23:41:31 reviews: Job OK (9b01d934-30c7-4e9b-9e34-fe4450bca292)
23:41:31 Result is kept for 500 seconds
23:41:31 
23:41:31 *** Listening on chapters, profiles, reviews...
23:41:31 reviews: fanfic.jobs.crawl_reviews(10625946) (16a1740b-f441-46bd-8626-c41bc3ece60c)
23:44:29 reviews: Job OK (16a1740b-f441-46bd-8626-c41bc3ece60c)
23:44:29 Result is kept for 500 seconds
23:44:29 
23:44:29 *** Listening on chapters, profiles, reviews...
23:44:29 reviews: fanfic.jobs.crawl_reviews(10626558) (1974c81e-e6c4-41e3-bd3c-3643cd49f73d)
23:44:49 reviews: Job OK (1974c81e-e6c4-41e3-bd3c-3643cd49f73d)
23:44:49 Result is kept for 500 seconds
23:44:49 
23:44:49 *** Listening on chapters, profiles, reviews...
23:44:49 reviews: fanfic.jobs.crawl_reviews(10627478) (07ba72a7-95f1-45bb-9489-92667f2a3745)
23:44:55 reviews: Job OK (07ba72a7-95f1-45bb-9489-92667f2a3745)
23:44:55 Result is kept for 500 seconds
23:44:55 
23:44:55 *** Listening on chapters, profiles, reviews...
23:44:55 reviews: fanfic.jobs.crawl_reviews(10628458) (85cff299-d0de-4209-ac67-3e5017f87d95)
23:45:26 reviews: Job OK (85cff299-d0de-4209-ac67-3e5017f87d95)
23:45:26 Result is kept for 500 seconds
23:45:26 
23:45:26 *** Listening on chapters, profiles, reviews...
23:45:26 reviews: fanfic.jobs.crawl_reviews(10629584) (ee020885-b133-4a22-8e97-53c9e53b68a3)
23:46:04 reviews: Job OK (ee020885-b133-4a22-8e97-53c9e53b68a3)
23:46:04 Result is kept for 500 seconds
23:46:04 
23:46:04 *** Listening on chapters, profiles, reviews...
23:46:04 reviews: fanfic.jobs.crawl_reviews(10629595) (f6723a64-a7e3-4368-8a4d-0a25571109f3)
23:46:24 reviews: Job OK (f6723a64-a7e3-4368-8a4d-0a25571109f3)
23:46:24 Result is kept for 500 seconds
23:46:24 
23:46:24 *** Listening on chapters, profiles, reviews...
23:46:24 reviews: fanfic.jobs.crawl_reviews(10630655) (e926ce07-0143-4bc1-88b5-e4816fa65f82)
2017-02-07 23:46:26 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/10630655/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
23:46:26 reviews: Job OK (e926ce07-0143-4bc1-88b5-e4816fa65f82)
23:46:26 Result is kept for 500 seconds
23:46:26 
23:46:26 *** Listening on chapters, profiles, reviews...
23:46:26 reviews: fanfic.jobs.crawl_reviews(10632180) (e4d8c7c9-7731-4841-a042-4456abcbba1c)
23:46:33 reviews: Job OK (e4d8c7c9-7731-4841-a042-4456abcbba1c)
23:46:33 Result is kept for 500 seconds
23:46:33 
23:46:33 *** Listening on chapters, profiles, reviews...
23:46:33 reviews: fanfic.jobs.crawl_reviews(10633074) (7b64e484-c66f-4a67-99d9-fba7ec3050fd)
23:47:12 reviews: Job OK (7b64e484-c66f-4a67-99d9-fba7ec3050fd)
23:47:12 Result is kept for 500 seconds
23:47:12 
23:47:12 *** Listening on chapters, profiles, reviews...
23:47:12 reviews: fanfic.jobs.crawl_reviews(10633321) (07ffc2eb-09ca-4b2b-abf3-28fba326f030)
23:47:22 reviews: Job OK (07ffc2eb-09ca-4b2b-abf3-28fba326f030)
23:47:22 Result is kept for 500 seconds
23:47:22 
23:47:22 *** Listening on chapters, profiles, reviews...
23:47:22 reviews: fanfic.jobs.crawl_reviews(10633819) (f2491931-62a8-4364-8fa6-06a1bb607b81)
23:51:10 reviews: Job OK (f2491931-62a8-4364-8fa6-06a1bb607b81)
23:51:10 Result is kept for 500 seconds
23:51:10 
23:51:10 *** Listening on chapters, profiles, reviews...
23:51:10 reviews: fanfic.jobs.crawl_reviews(10634552) (5a4b17b0-6ad8-4770-b16a-8f4b7ec3bc8d)
23:52:17 reviews: Job OK (5a4b17b0-6ad8-4770-b16a-8f4b7ec3bc8d)
23:52:17 Result is kept for 500 seconds
23:52:17 
23:52:17 *** Listening on chapters, profiles, reviews...
23:52:17 reviews: fanfic.jobs.crawl_reviews(10635297) (c44f285a-d2b5-4e9f-9703-7b8689219372)
23:52:34 reviews: Job OK (c44f285a-d2b5-4e9f-9703-7b8689219372)
23:52:34 Result is kept for 500 seconds
23:52:34 
23:52:34 *** Listening on chapters, profiles, reviews...
23:52:34 reviews: fanfic.jobs.crawl_reviews(10636076) (6164912d-601b-415c-9a9a-465425872786)
23:54:13 reviews: Job OK (6164912d-601b-415c-9a9a-465425872786)
23:54:13 Result is kept for 500 seconds
23:54:13 Cleaning registries for queue: chapters
23:54:13 Cleaning registries for queue: profiles
23:54:13 Cleaning registries for queue: reviews
23:54:13 
23:54:13 *** Listening on chapters, profiles, reviews...
23:54:13 reviews: fanfic.jobs.crawl_reviews(10636246) (86dc55ec-3259-4b3f-adbc-dfa2c8abce23)
23:55:30 reviews: Job OK (86dc55ec-3259-4b3f-adbc-dfa2c8abce23)
23:55:30 Result is kept for 500 seconds
23:55:30 
23:55:30 *** Listening on chapters, profiles, reviews...
23:55:30 reviews: fanfic.jobs.crawl_reviews(10636294) (366ec685-2ded-45f3-8b5f-a7e17714652b)
2017-02-07 23:55:35 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 07:55:35.877931', 10636294, 220863415, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (889 characters truncated) ... l style="color:gray">chapter 17 . <span data-xutime="1432742723">5/27/2015</span> </small><div style="margin-top:5px">Great chapter</div></td>\n</tr>'), ('2017-02-08 07:55:35.877936', 10636294, 217621732, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (728 characters truncated) ...  a huge Sirius and Remus shipper but I\'m sure you can pull it off. Anyway, I love this story and can\'t wait for the next chapter!</div></td>\n</tr>'), ('2017-02-08 07:55:35.877938', 10636294, 216861092, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (898 characters truncated) ... color:gray">chapter 16 . <span data-xutime="1425943774">3/9/2015</span> </small><div style="margin-top:5px">At least she is better!</div></td>\n</tr>'), ('2017-02-08 07:55:35.877940', 10636294, 216610214, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (667 characters truncated) ... tory. The character development and adherence to personality is spot on. I hope you update soon, I can wait! Keep up the good work!</div></td>\n</tr>'), ('2017-02-08 07:55:35.877953', 10636294, 216582861, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (881 characters truncated) ... >  <small style="color:gray">chapter 15 . <span data-xutime="1425485749">3/4/2015</span> </small><div style="margin-top:5px">Oh no!</div></td>\n</tr>'), ('2017-02-08 07:55:35.877955', 10636294, 213696045, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (529 characters truncated) ... y">chapter 14 . <span data-xutime="1420836591">1/9/2015</span> </small><div style="margin-top:5px">Amazing , please keep updating !</div></td>\n</tr>'), ('2017-02-08 07:55:35.877957', 10636294, 213587150, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (882 characters truncated) ...   <small style="color:gray">chapter 14 . <span data-xutime="1420646335">1/7/2015</span> </small><div style="margin-top:5px">Love it</div></td>\n</tr>'), ('2017-02-08 07:55:35.877959', 10636294, 212385151, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6349216&amp;r ... (948 characters truncated) ... 2014</span> </small><div style="margin-top:5px">back on this site for the first time in years...just read the whole thing. amazing!</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-08 07:55:35.877996', 10636294, 208157612, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (651 characters truncated) ... y. Please continue writing as soon as possible, I cant hardly wait for the next one :) Would love to read the rest of the story! :)</div></td>\n</tr>'), ('2017-02-08 07:55:35.877997', 10636294, 206412773, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2075004&amp;r ... (1064 characters truncated) ... sense interrupting the actual story. I don\'t understand why but it makes it nearly impossible to read which makes me really sad...</div></td>\n</tr>'))]
23:55:35 reviews: Job OK (366ec685-2ded-45f3-8b5f-a7e17714652b)
23:55:35 Result is kept for 500 seconds
23:55:35 
23:55:35 *** Listening on chapters, profiles, reviews...
23:55:35 reviews: fanfic.jobs.crawl_reviews(10638110) (895117d4-5a2b-44f7-a3b3-49f5b27cbf13)
23:58:32 reviews: Job OK (895117d4-5a2b-44f7-a3b3-49f5b27cbf13)
23:58:32 Result is kept for 500 seconds
23:58:32 
23:58:32 *** Listening on chapters, profiles, reviews...
23:58:32 reviews: fanfic.jobs.crawl_reviews(10638343) (2cfca4a2-cf18-4236-9ae9-e06bcd8e73c3)
23:59:42 reviews: Job OK (2cfca4a2-cf18-4236-9ae9-e06bcd8e73c3)
23:59:42 Result is kept for 500 seconds
23:59:42 
23:59:42 *** Listening on chapters, profiles, reviews...
23:59:42 reviews: fanfic.jobs.crawl_reviews(10638569) (cdab10c2-699a-4cee-8d95-bb4189bfe5ad)
00:00:01 reviews: Job OK (cdab10c2-699a-4cee-8d95-bb4189bfe5ad)
00:00:01 Result is kept for 500 seconds
00:00:01 
00:00:01 *** Listening on chapters, profiles, reviews...
00:00:01 reviews: fanfic.jobs.crawl_reviews(10638591) (262569c8-aad4-450a-9468-dfa7b984827f)
00:00:07 reviews: Job OK (262569c8-aad4-450a-9468-dfa7b984827f)
00:00:07 Result is kept for 500 seconds
00:00:07 
00:00:07 *** Listening on chapters, profiles, reviews...
00:00:07 reviews: fanfic.jobs.crawl_reviews(10642581) (63b4e586-24d2-4608-9fbd-4735b8ea26d3)
00:02:39 reviews: Job OK (63b4e586-24d2-4608-9fbd-4735b8ea26d3)
00:02:39 Result is kept for 500 seconds
00:02:39 
00:02:39 *** Listening on chapters, profiles, reviews...
00:02:39 reviews: fanfic.jobs.crawl_reviews(10642665) (1c6cc7bd-ceb4-4377-bf37-5e9964d107ac)
2017-02-08 00:02:45 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 08:02:45.541734', 10642665, 221068120, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6551343&amp;r ... (882 characters truncated) ... yle="color:gray">chapter 7 . <span data-xutime="1433090791">5/31/2015</span> </small><div style="margin-top:5px">I love this story!</div></td>\n</tr>'), ('2017-02-08 08:02:45.541739', 10642665, 220266110, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4460190&amp;r ... (1094 characters truncated) ... rt moving<br>\n<br>\nThanks by your great work<br>\nKeep writing<br>\n<br>\nPd: will be more story of Skazzy over the est of years?</div></td>\n</tr>'), ('2017-02-08 08:02:45.541742', 10642665, 220260609, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (940 characters truncated) ... I really liked it. . . Until she was sorted into Hufflepuff. Otherwise, great writing! I wish you the best of luck with your story!</div></td>\n</tr>'), ('2017-02-08 08:02:45.541744', 10642665, 220149113, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (549 characters truncated) ... n data-xutime="1431502645">5/13/2015</span> </small><div style="margin-top:5px">I hope Amity becomes a prefect when her time comes.</div></td>\n</tr>'), ('2017-02-08 08:02:45.541746', 10642665, 220051358, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4460190&amp;r ... (966 characters truncated) ... roach and with the Mistery-wizarths going nuts, couldnt they call Madame Bones to help?<br>\n<br>\nKeep working and thanks by share</div></td>\n</tr>'), ('2017-02-08 08:02:45.541748', 10642665, 219981308, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (783 characters truncated) ... last name so she called him nixie and then everyone called him nixie, nixie the pixie or pixie. Please make everyone call her nixie</div></td>\n</tr>'), ('2017-02-08 08:02:45.541751', 10642665, 219739803, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6488392&amp;r ... (789 characters truncated) ... tyle="color:gray">chapter 7 . <span data-xutime="1430785940">5/4/2015</span> </small><div style="margin-top:5px">I love this story!</div></td>\n</tr>'), ('2017-02-08 08:02:45.541753', 10642665, 208748081, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5700294&amp;r ... (1878 characters truncated) ... nough to post this but personally,I don\'t like Skazzy and she does not endear to me in any way - in fact, she makes me loathe her.</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-08 08:02:45.541792', 10642665, 207000208, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2293010&amp;r ... (1042 characters truncated) ... ts a bit like Tonks with her name. She is also rather ratty. I hope she is not in Slytherin. I also hope Mrs Weasley fixes her arm.</div></td>\n</tr>'), ('2017-02-08 08:02:45.541794', 10642665, 206594627, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (524 characters truncated) ... r:gray">chapter 1 . <span data-xutime="1408914857">8/24/2014</span> </small><div style="margin-top:5px">interesting please continue</div></td>\n</tr>'))]
00:02:45 reviews: Job OK (1c6cc7bd-ceb4-4377-bf37-5e9964d107ac)
00:02:45 Result is kept for 500 seconds
00:02:45 
00:02:45 *** Listening on chapters, profiles, reviews...
00:02:45 reviews: fanfic.jobs.crawl_reviews(10643009) (d1e494f6-c145-4a3e-bcb7-2f958272bb87)
00:03:30 reviews: Job OK (d1e494f6-c145-4a3e-bcb7-2f958272bb87)
00:03:30 Result is kept for 500 seconds
00:03:30 
00:03:30 *** Listening on chapters, profiles, reviews...
00:03:30 reviews: fanfic.jobs.crawl_reviews(10643541) (96a39b43-c784-46e2-97c8-a9f625ff3fd4)
00:03:50 reviews: Job OK (96a39b43-c784-46e2-97c8-a9f625ff3fd4)
00:03:50 Result is kept for 500 seconds
00:03:50 
00:03:50 *** Listening on chapters, profiles, reviews...
00:03:50 reviews: fanfic.jobs.crawl_reviews(10643948) (438a2624-74e3-480e-b065-64a47ade1dd5)
00:06:33 reviews: Job OK (438a2624-74e3-480e-b065-64a47ade1dd5)
00:06:33 Result is kept for 500 seconds
00:06:33 
00:06:33 *** Listening on chapters, profiles, reviews...
00:06:33 reviews: fanfic.jobs.crawl_reviews(10645463) (1c7057a1-2919-485e-8f13-48c13fe64807)
00:10:33 reviews: Job OK (1c7057a1-2919-485e-8f13-48c13fe64807)
00:10:33 Result is kept for 500 seconds
00:10:33 
00:10:33 *** Listening on chapters, profiles, reviews...
00:10:33 reviews: fanfic.jobs.crawl_reviews(10646983) (a2d2285c-107a-4481-96d5-7a4bb19b377c)
00:15:01 reviews: Job OK (a2d2285c-107a-4481-96d5-7a4bb19b377c)
00:15:01 Result is kept for 500 seconds
00:15:01 
00:15:01 *** Listening on chapters, profiles, reviews...
00:15:01 reviews: fanfic.jobs.crawl_reviews(10648774) (6eee0a2d-4560-4b19-b439-3db413a408ed)
00:18:35 reviews: Job OK (6eee0a2d-4560-4b19-b439-3db413a408ed)
00:18:35 Result is kept for 500 seconds
00:18:35 
00:18:35 *** Listening on chapters, profiles, reviews...
00:18:35 reviews: fanfic.jobs.crawl_reviews(10649604) (99210d5a-bcbf-4c34-ac99-c6257ab4c44e)
00:28:32 reviews: Job OK (99210d5a-bcbf-4c34-ac99-c6257ab4c44e)
00:28:32 Result is kept for 500 seconds
00:28:32 
00:28:32 *** Listening on chapters, profiles, reviews...
00:28:32 reviews: fanfic.jobs.crawl_reviews(10650469) (6170d7e8-962e-4938-9807-78ad2ff2d9a8)
00:29:17 reviews: Job OK (6170d7e8-962e-4938-9807-78ad2ff2d9a8)
00:29:17 Result is kept for 500 seconds
00:29:17 
00:29:17 *** Listening on chapters, profiles, reviews...
00:29:17 reviews: fanfic.jobs.crawl_reviews(10650881) (0dee4431-cdd2-42c5-9c20-dd44a2558b44)
2017-02-08 00:29:23 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 08:29:23.406392', 10650881, 207849426, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3847053&amp;r ... (956 characters truncated) ... /2014</span> </small><div style="margin-top:5px">Good chapter. So Sirius knows too then. I wonder when Harry will finally find out.</div></td>\n</tr>'), ('2017-02-08 08:29:23.406397', 10650881, 207792332, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3847053&amp;r ... (1077 characters truncated) ... the others. I\'ve been wondering, will the end of this be strictly canon or will Liza\'s presence cause any changes for the better?</div></td>\n</tr>'), ('2017-02-08 08:29:23.406399', 10650881, 207755860, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3847053&amp;r ... (988 characters truncated) ... "margin-top:5px">Good chapter. So, will the cat be out of the bag about Liza as well or will that be a revelation for another year?</div></td>\n</tr>'), ('2017-02-08 08:29:23.406401', 10650881, 207649252, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (665 characters truncated) ... olutely love this series and how you handle the plot and the different characters. Please keep writing, this is fricking wonderful!</div></td>\n</tr>'), ('2017-02-08 08:29:23.406403', 10650881, 207648328, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5537143&amp;r ... (874 characters truncated) ... a>  <small style="color:gray">chapter 11 . <span data-xutime="1410623541">9/13/2014</span> </small><div style="margin-top:5px">YAY!</div></td>\n</tr>'), ('2017-02-08 08:29:23.406405', 10650881, 207603648, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3847053&amp;r ... (930 characters truncated) ... a-xutime="1410546675">9/12/2014</span> </small><div style="margin-top:5px">Great chapter. Nice to see them all back together again.</div></td>\n</tr>'), ('2017-02-08 08:29:23.406407', 10650881, 207400509, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3847053&amp;r ... (1020 characters truncated) ... 'm glad you had Liza sticking with Hermione during all this. She really gets the short end of the stick through most of third year.</div></td>\n</tr>'), ('2017-02-08 08:29:23.406409', 10650881, 207222731, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3847053&amp;r ... (1061 characters truncated) ...  this. I\'ve always been a bit disappointed in Ron at this point personally. After all, this is Harry\'s life we\'re talking about.</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-08 08:29:23.406444', 10650881, 206863308, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3847053&amp;r ... (972 characters truncated) ... all><div style="margin-top:5px">Good chapter. Nice to know Liza isn\'t superstitious. I can\'t wait to see what Liza\'s boggart is.</div></td>\n</tr>'), ('2017-02-08 08:29:23.406446', 10650881, 206821436, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3847053&amp;r ... (942 characters truncated) ... 9270294">8/28/2014</span> </small><div style="margin-top:5px">Good chapter. Can\'t wait to see what Liza thinks of her new classes.</div></td>\n</tr>'))]
00:29:23 reviews: Job OK (0dee4431-cdd2-42c5-9c20-dd44a2558b44)
00:29:23 Result is kept for 500 seconds
00:29:23 
00:29:23 *** Listening on chapters, profiles, reviews...
00:29:23 reviews: fanfic.jobs.crawl_reviews(10653495) (7d0ec4f8-b381-4042-b10c-71fdf4cc8c5a)
00:33:14 reviews: Job OK (7d0ec4f8-b381-4042-b10c-71fdf4cc8c5a)
00:33:14 Result is kept for 500 seconds
00:33:14 
00:33:14 *** Listening on chapters, profiles, reviews...
00:33:14 reviews: fanfic.jobs.crawl_reviews(10654045) (3d04a5b8-09bb-4daa-a4c2-68be3e0eb0da)
00:35:27 reviews: Job OK (3d04a5b8-09bb-4daa-a4c2-68be3e0eb0da)
00:35:27 Result is kept for 500 seconds
00:35:27 
00:35:27 *** Listening on chapters, profiles, reviews...
00:35:27 reviews: fanfic.jobs.crawl_reviews(10654075) (4cce7096-feff-47f6-bd97-3c86fcc1d185)
00:35:59 reviews: Job OK (4cce7096-feff-47f6-bd97-3c86fcc1d185)
00:35:59 Result is kept for 500 seconds
00:35:59 
00:35:59 *** Listening on chapters, profiles, reviews...
00:35:59 reviews: fanfic.jobs.crawl_reviews(10654712) (48d63c01-cef5-4941-ba28-e09471aed13f)
00:49:39 reviews: Job OK (48d63c01-cef5-4941-ba28-e09471aed13f)
00:49:39 Result is kept for 500 seconds
00:49:39 
00:49:39 *** Listening on chapters, profiles, reviews...
00:49:39 reviews: fanfic.jobs.crawl_reviews(10655012) (a1064c9e-1d69-4d3a-b407-741fd28238ff)
00:50:56 reviews: Job OK (a1064c9e-1d69-4d3a-b407-741fd28238ff)
00:50:56 Result is kept for 500 seconds
00:50:56 
00:50:56 *** Listening on chapters, profiles, reviews...
00:50:56 reviews: fanfic.jobs.crawl_reviews(10655211) (ca22e239-7ba9-43ef-ace4-743f6705490c)
00:53:07 reviews: Job OK (ca22e239-7ba9-43ef-ace4-743f6705490c)
00:53:07 Result is kept for 500 seconds
00:53:07 
00:53:07 *** Listening on chapters, profiles, reviews...
00:53:07 reviews: fanfic.jobs.crawl_reviews(10656440) (5fd52440-9d47-48bb-a8be-0291bb63c064)
00:53:38 reviews: Job OK (5fd52440-9d47-48bb-a8be-0291bb63c064)
00:53:38 Result is kept for 500 seconds
00:53:38 
00:53:38 *** Listening on chapters, profiles, reviews...
00:53:38 reviews: fanfic.jobs.crawl_reviews(10658884) (9d59cd08-e8cc-4376-a8c2-75795bde39a2)
00:53:42 reviews: Job OK (9d59cd08-e8cc-4376-a8c2-75795bde39a2)
00:53:42 Result is kept for 500 seconds
00:53:42 
00:53:42 *** Listening on chapters, profiles, reviews...
00:53:42 reviews: fanfic.jobs.crawl_reviews(10658942) (33b89a65-af7c-4c9c-a737-59a318fa700f)
00:53:48 reviews: Job OK (33b89a65-af7c-4c9c-a737-59a318fa700f)
00:53:48 Result is kept for 500 seconds
00:53:48 
00:53:48 *** Listening on chapters, profiles, reviews...
00:53:48 reviews: fanfic.jobs.crawl_reviews(10659606) (7d8c7d90-329e-4fe1-9ae7-330268f6f58b)
00:54:14 reviews: Job OK (7d8c7d90-329e-4fe1-9ae7-330268f6f58b)
00:54:14 Result is kept for 500 seconds
00:54:14 Cleaning registries for queue: chapters
00:54:14 Cleaning registries for queue: profiles
00:54:14 Cleaning registries for queue: reviews
00:54:14 
00:54:14 *** Listening on chapters, profiles, reviews...
00:54:14 reviews: fanfic.jobs.crawl_reviews(10659632) (ddff3fb4-5ecb-4265-9c6f-3b355f1ccb31)
00:55:05 reviews: Job OK (ddff3fb4-5ecb-4265-9c6f-3b355f1ccb31)
00:55:05 Result is kept for 500 seconds
00:55:05 
00:55:05 *** Listening on chapters, profiles, reviews...
00:55:05 reviews: fanfic.jobs.crawl_reviews(10662226) (1323062b-040a-404b-9bcb-e7121f19cf0b)
2017-02-08 00:55:10 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 08:55:10.598847', 10662226, 210979757, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6287551&amp;r ... (1347 characters truncated) ... 're descriptive enough and your dialogue isn\'t too long or too short. I love your story so far and look forward to reading more! 3</div></td>\n</tr>'), ('2017-02-08 08:55:10.598852', 10662226, 210745486, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (599 characters truncated) ... ll><div style="margin-top:5px">I love this story so much! It is definitely one of my favorite fanfictions ever. Please update soon!</div></td>\n</tr>'), ('2017-02-08 08:55:10.598854', 10662226, 209837563, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1339 characters truncated) ... t that Ariana confides in Fred.<br>\n<br>\nANYWAY, now that I am done rambling, I love the story, andI cant wait for you to update!</div></td>\n</tr>'), ('2017-02-08 08:55:10.598856', 10662226, 208784716, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4380791&amp;r ... (1658 characters truncated) ...  her character traits in general? Either way, I\'m looking forward to Tentacles and Tattle-tales and I like where this is going. :)</div></td>\n</tr>'), ('2017-02-08 08:55:10.598858', 10662226, 208332998, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4380791&amp;r ... (1523 characters truncated) ... is Ariana\'s worst fear... just gathering facts.<br>\n<br>\nI love the plot! And you write so neatly, too! Keep up the good work ;)</div></td>\n</tr>'), ('2017-02-08 08:55:10.598860', 10662226, 208330825, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4380791&amp;r ... (1419 characters truncated) ... t exactly is wrong with Ariana\'s magic. Some sort of trauma it seems... <br>\n<br>\nLooking forward to more! Thanks for writing :)</div></td>\n</tr>'), ('2017-02-08 08:55:10.598862', 10662226, 208330124, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4380791&amp;r ... (1124 characters truncated) ... ng are quite nice. And I think you portray the professors Lupin and Snape perfectly canon-compliant! Looking forward to more now...</div></td>\n</tr>'), ('2017-02-08 08:55:10.598864', 10662226, 208329456, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4380791&amp;r ... (1000 characters truncated) ... njoyed! <br>\n<br>\nThank you for writing! You do an excellent job. Everything is very neat and tidy. I\'m looking forward to more!</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-08 08:55:10.598885', 10662226, 207428627, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (534 characters truncated) ... y">chapter 3 . <span data-xutime="1410055248">9/6/2014</span> </small><div style="margin-top:5px">Loved it! Write the next chapter!</div></td>\n</tr>'), ('2017-02-08 08:55:10.598886', 10662226, 207015003, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4279198&amp;r ... (877 characters truncated) ... </a>  <small style="color:gray">chapter 1 . <span data-xutime="1409576034">9/1/2014</span> </small><div style="margin-top:5px">nice</div></td>\n</tr>'))]
00:55:10 reviews: Job OK (1323062b-040a-404b-9bcb-e7121f19cf0b)
00:55:10 Result is kept for 500 seconds
00:55:10 
00:55:10 *** Listening on chapters, profiles, reviews...
00:55:10 reviews: fanfic.jobs.crawl_reviews(10662333) (e59db350-6a7f-4c6c-90f4-973ee25891a4)
00:55:32 reviews: Job OK (e59db350-6a7f-4c6c-90f4-973ee25891a4)
00:55:32 Result is kept for 500 seconds
00:55:32 
00:55:32 *** Listening on chapters, profiles, reviews...
00:55:32 reviews: fanfic.jobs.crawl_reviews(10662827) (c90d6ebf-5e37-4eec-8173-6a8777ff2044)
00:55:43 reviews: Job OK (c90d6ebf-5e37-4eec-8173-6a8777ff2044)
00:55:43 Result is kept for 500 seconds
00:55:43 
00:55:43 *** Listening on chapters, profiles, reviews...
00:55:43 reviews: fanfic.jobs.crawl_reviews(10662920) (bf204115-e1d6-42b8-8762-ea5a7ab8f428)
00:55:49 reviews: Job OK (bf204115-e1d6-42b8-8762-ea5a7ab8f428)
00:55:49 Result is kept for 500 seconds
00:55:49 
00:55:49 *** Listening on chapters, profiles, reviews...
00:55:49 reviews: fanfic.jobs.crawl_reviews(10663725) (5dfc44ca-7e1c-4133-8ec3-7ae11b10b54e)
00:56:16 reviews: Job OK (5dfc44ca-7e1c-4133-8ec3-7ae11b10b54e)
00:56:16 Result is kept for 500 seconds
00:56:16 
00:56:16 *** Listening on chapters, profiles, reviews...
00:56:16 reviews: fanfic.jobs.crawl_reviews(10664165) (66a070aa-120b-4642-855d-4b9c54972553)
00:56:26 reviews: Job OK (66a070aa-120b-4642-855d-4b9c54972553)
00:56:26 Result is kept for 500 seconds
00:56:26 
00:56:26 *** Listening on chapters, profiles, reviews...
00:56:26 reviews: fanfic.jobs.crawl_reviews(10667049) (cb3331bc-9b27-4c46-a381-2df549e8d290)
00:56:56 reviews: Job OK (cb3331bc-9b27-4c46-a381-2df549e8d290)
00:56:56 Result is kept for 500 seconds
00:56:56 
00:56:56 *** Listening on chapters, profiles, reviews...
00:56:56 reviews: fanfic.jobs.crawl_reviews(10667384) (3b7338df-9de7-4eb5-9113-d926fd3d5269)
00:57:24 reviews: Job OK (3b7338df-9de7-4eb5-9113-d926fd3d5269)
00:57:24 Result is kept for 500 seconds
00:57:24 
00:57:24 *** Listening on chapters, profiles, reviews...
00:57:24 reviews: fanfic.jobs.crawl_reviews(10667749) (99ff612a-67cb-4847-8465-8d4cb1533d23)
01:00:59 reviews: Job OK (99ff612a-67cb-4847-8465-8d4cb1533d23)
01:00:59 Result is kept for 500 seconds
01:00:59 
01:00:59 *** Listening on chapters, profiles, reviews...
01:00:59 reviews: fanfic.jobs.crawl_reviews(10667858) (eeebc81e-1b40-4f4a-8510-a37827ffc5c6)
01:01:27 reviews: Job OK (eeebc81e-1b40-4f4a-8510-a37827ffc5c6)
01:01:27 Result is kept for 500 seconds
01:01:27 
01:01:27 *** Listening on chapters, profiles, reviews...
01:01:27 reviews: fanfic.jobs.crawl_reviews(10667963) (c6f86e62-db92-4ae7-9860-344836072b86)
01:01:31 reviews: Job OK (c6f86e62-db92-4ae7-9860-344836072b86)
01:01:31 Result is kept for 500 seconds
01:01:31 
01:01:31 *** Listening on chapters, profiles, reviews...
01:01:31 reviews: fanfic.jobs.crawl_reviews(10668206) (3a4bc5a5-f9b7-496b-bfc3-1f70f83e3f2f)
01:04:06 reviews: Job OK (3a4bc5a5-f9b7-496b-bfc3-1f70f83e3f2f)
01:04:06 Result is kept for 500 seconds
01:04:06 
01:04:06 *** Listening on chapters, profiles, reviews...
01:04:06 reviews: fanfic.jobs.crawl_reviews(10668763) (357543d9-96e8-4315-ae36-507085a8e72d)
01:07:40 reviews: Job OK (357543d9-96e8-4315-ae36-507085a8e72d)
01:07:40 Result is kept for 500 seconds
01:07:40 
01:07:40 *** Listening on chapters, profiles, reviews...
01:07:40 reviews: fanfic.jobs.crawl_reviews(10669760) (40117dcd-fd97-4ddf-89f8-32f6d97472eb)
01:26:54 reviews: Job OK (40117dcd-fd97-4ddf-89f8-32f6d97472eb)
01:26:54 Result is kept for 500 seconds
01:26:54 
01:26:54 *** Listening on chapters, profiles, reviews...
01:26:54 reviews: fanfic.jobs.crawl_reviews(10670191) (46bf9725-93e3-4038-81f5-d17e35b1de50)
01:27:07 reviews: Job OK (46bf9725-93e3-4038-81f5-d17e35b1de50)
01:27:07 Result is kept for 500 seconds
01:27:07 
01:27:07 *** Listening on chapters, profiles, reviews...
01:27:07 reviews: fanfic.jobs.crawl_reviews(10670660) (ddc8f701-bee2-4c94-9b18-b868d18a68d6)
01:29:14 reviews: Job OK (ddc8f701-bee2-4c94-9b18-b868d18a68d6)
01:29:14 Result is kept for 500 seconds
01:29:14 
01:29:14 *** Listening on chapters, profiles, reviews...
01:29:14 reviews: fanfic.jobs.crawl_reviews(10671892) (36c5093b-74ec-46cc-b4fc-38e73ac34788)
01:29:23 reviews: Job OK (36c5093b-74ec-46cc-b4fc-38e73ac34788)
01:29:23 Result is kept for 500 seconds
01:29:23 
01:29:23 *** Listening on chapters, profiles, reviews...
01:29:23 reviews: fanfic.jobs.crawl_reviews(10672009) (13917822-c67d-4027-8861-572f888142da)
01:29:57 reviews: Job OK (13917822-c67d-4027-8861-572f888142da)
01:29:57 Result is kept for 500 seconds
01:29:57 
01:29:57 *** Listening on chapters, profiles, reviews...
01:29:57 reviews: fanfic.jobs.crawl_reviews(10672225) (309db3cf-6ee1-410d-bb6f-445a7b55c836)
2017-02-08 01:30:02 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 09:30:02.858590', 10672225, 244560152, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5600381&amp;r ... (1039 characters truncated) ... ews? This is actually really good! An OC who\'s not a blatant Sue, good descriptions, good prose...I could go on. Very nice. Kudos!</div></td>\n</tr>'), ('2017-02-08 09:30:02.858595', 10672225, 226159330, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3613806&amp;r ... (1079 characters truncated) ...  it. I hope you continue to update because I have fallen in love with the character you\'ve created and how you\'ve portrayed Draco</div></td>\n</tr>'), ('2017-02-08 09:30:02.858597', 10672225, 223245466, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5715974&amp;r ... (962 characters truncated) ... ="1436623706">7/11/2015</span> </small><div style="margin-top:5px">I love this book so much, seriously! Thank you for writing this!</div></td>\n</tr>'), ('2017-02-08 09:30:02.858599', 10672225, 217456812, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (598 characters truncated) ... pan> </small><div style="margin-top:5px">Once I started this story, I couldn\'t stop Reading :D can\'t wait for the next chapter :D</div></td>\n</tr>'), ('2017-02-08 09:30:02.858601', 10672225, 210428953, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1664539&amp;r ... (971 characters truncated) ... > </small><div style="margin-top:5px">What a cute story. I look forward to future chapters and delving further in to the characters</div></td>\n</tr>'), ('2017-02-08 09:30:02.858603', 10672225, 209451618, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4387482&amp;r ... (1027 characters truncated) ... story but I am not fully convinced yet. So I will keep my eye on this to see where this is going. Thank you for sharing your story.</div></td>\n</tr>'), ('2017-02-08 09:30:02.858605', 10672225, 209084213, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3380582&amp;r ... (1616 characters truncated) ... e else, and the positive spin on the darkest known house truly creates a wonderful new light of their untold story. Please read! :D</div></td>\n</tr>'), ('2017-02-08 09:30:02.858607', 10672225, 207861547, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5711454&amp;r ... (950 characters truncated) ... e is her last name, though i do find the name a little bit out of the ordinary? its fine though, its your story and i like the plot</div></td>\n</tr>')  ... displaying 10 of 18 total bound parameter sets ...  ('2017-02-08 09:30:02.858623', 10672225, 207861547, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5711454&amp;r ... (950 characters truncated) ... e is her last name, though i do find the name a little bit out of the ordinary? its fine though, its your story and i like the plot</div></td>\n</tr>'), ('2017-02-08 09:30:02.858625', 10672225, 207861518, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5711454&amp;r ... (959 characters truncated) ... \' but i guess its innovative. and there are a few punctuation problems, but overall its quite good. and i love how pansys in it :)</div></td>\n</tr>'))]
01:30:02 reviews: Job OK (309db3cf-6ee1-410d-bb6f-445a7b55c836)
01:30:02 Result is kept for 500 seconds
01:30:02 
01:30:02 *** Listening on chapters, profiles, reviews...
01:30:02 reviews: fanfic.jobs.crawl_reviews(10673510) (1bc5cdf8-21ab-44c5-93ca-0011535f8907)
01:30:11 reviews: Job OK (1bc5cdf8-21ab-44c5-93ca-0011535f8907)
01:30:11 Result is kept for 500 seconds
01:30:11 
01:30:11 *** Listening on chapters, profiles, reviews...
01:30:11 reviews: fanfic.jobs.crawl_reviews(10674176) (0c1fa69d-97c3-4f40-a018-a422ac8097b2)
01:30:27 reviews: Job OK (0c1fa69d-97c3-4f40-a018-a422ac8097b2)
01:30:27 Result is kept for 500 seconds
01:30:27 
01:30:27 *** Listening on chapters, profiles, reviews...
01:30:27 reviews: fanfic.jobs.crawl_reviews(10676097) (a69b5170-a99a-47b8-9708-2e976377fbb1)
01:30:44 reviews: Job OK (a69b5170-a99a-47b8-9708-2e976377fbb1)
01:30:44 Result is kept for 500 seconds
01:30:44 
01:30:44 *** Listening on chapters, profiles, reviews...
01:30:44 reviews: fanfic.jobs.crawl_reviews(10677106) (8c049bc0-6ed9-4816-8708-30988886bae5)
01:35:00 reviews: Job OK (8c049bc0-6ed9-4816-8708-30988886bae5)
01:35:00 Result is kept for 500 seconds
01:35:00 
01:35:00 *** Listening on chapters, profiles, reviews...
01:35:00 reviews: fanfic.jobs.crawl_reviews(10678016) (b6589bbe-9350-47f1-bdda-273daa3f8d99)
01:35:22 reviews: Job OK (b6589bbe-9350-47f1-bdda-273daa3f8d99)
01:35:22 Result is kept for 500 seconds
01:35:22 
01:35:22 *** Listening on chapters, profiles, reviews...
01:35:22 reviews: fanfic.jobs.crawl_reviews(10678226) (45b8f73d-a029-4a79-bade-53ef53017092)
01:35:34 reviews: Job OK (45b8f73d-a029-4a79-bade-53ef53017092)
01:35:34 Result is kept for 500 seconds
01:35:34 
01:35:34 *** Listening on chapters, profiles, reviews...
01:35:34 reviews: fanfic.jobs.crawl_reviews(10678294) (ae44f96e-1bb3-4719-862f-0d1966cb9e28)
01:40:16 reviews: Job OK (ae44f96e-1bb3-4719-862f-0d1966cb9e28)
01:40:16 Result is kept for 500 seconds
01:40:16 
01:40:16 *** Listening on chapters, profiles, reviews...
01:40:16 reviews: fanfic.jobs.crawl_reviews(10678678) (6b8cf994-e7c0-44e6-a34b-60d6363184d7)
01:41:50 reviews: Job OK (6b8cf994-e7c0-44e6-a34b-60d6363184d7)
01:41:50 Result is kept for 500 seconds
01:41:50 
01:41:50 *** Listening on chapters, profiles, reviews...
01:41:50 reviews: fanfic.jobs.crawl_reviews(10679026) (5e8a4a64-9157-4aab-b67f-466792753f75)
01:42:33 reviews: Job OK (5e8a4a64-9157-4aab-b67f-466792753f75)
01:42:33 Result is kept for 500 seconds
01:42:33 
01:42:33 *** Listening on chapters, profiles, reviews...
01:42:33 reviews: fanfic.jobs.crawl_reviews(10681251) (33bbac0b-af8f-4c43-bbd6-60e4ed0398fc)
01:52:28 reviews: Job OK (33bbac0b-af8f-4c43-bbd6-60e4ed0398fc)
01:52:28 Result is kept for 500 seconds
01:52:28 
01:52:28 *** Listening on chapters, profiles, reviews...
01:52:28 reviews: fanfic.jobs.crawl_reviews(10681358) (313e4856-98ec-4261-9e51-75c7b4a11126)
01:53:29 reviews: Job OK (313e4856-98ec-4261-9e51-75c7b4a11126)
01:53:29 Result is kept for 500 seconds
01:53:29 
01:53:29 *** Listening on chapters, profiles, reviews...
01:53:29 reviews: fanfic.jobs.crawl_reviews(10681543) (6261f840-53ba-492c-933d-6b2ac4516364)
01:53:46 reviews: Job OK (6261f840-53ba-492c-933d-6b2ac4516364)
01:53:46 Result is kept for 500 seconds
01:53:46 
01:53:46 *** Listening on chapters, profiles, reviews...
01:53:46 reviews: fanfic.jobs.crawl_reviews(10681795) (98ef2f72-ade8-482f-a676-abba03ec0501)
01:53:54 reviews: Job OK (98ef2f72-ade8-482f-a676-abba03ec0501)
01:53:54 Result is kept for 500 seconds
01:53:54 
01:53:54 *** Listening on chapters, profiles, reviews...
01:53:54 reviews: fanfic.jobs.crawl_reviews(10683869) (e960bc2d-6f13-4cd7-b838-10ff77bea0bb)
01:54:07 reviews: Job OK (e960bc2d-6f13-4cd7-b838-10ff77bea0bb)
01:54:07 Result is kept for 500 seconds
01:54:07 
01:54:07 *** Listening on chapters, profiles, reviews...
01:54:07 reviews: fanfic.jobs.crawl_reviews(10684778) (e6880a15-4612-4d19-bcb7-e289ef0c4aa6)
01:54:25 reviews: Job OK (e6880a15-4612-4d19-bcb7-e289ef0c4aa6)
01:54:25 Result is kept for 500 seconds
01:54:25 Cleaning registries for queue: chapters
01:54:25 Cleaning registries for queue: profiles
01:54:25 Cleaning registries for queue: reviews
01:54:25 
01:54:25 *** Listening on chapters, profiles, reviews...
01:54:25 reviews: fanfic.jobs.crawl_reviews(10684896) (22059934-2eb5-443e-9851-f1b0453986fc)
01:56:33 reviews: Job OK (22059934-2eb5-443e-9851-f1b0453986fc)
01:56:33 Result is kept for 500 seconds
01:56:33 
01:56:33 *** Listening on chapters, profiles, reviews...
01:56:33 reviews: fanfic.jobs.crawl_reviews(10685852) (7aeda649-15d1-459d-a875-64155c23f3a0)
02:09:50 reviews: Job OK (7aeda649-15d1-459d-a875-64155c23f3a0)
02:09:50 Result is kept for 500 seconds
02:09:50 
02:09:50 *** Listening on chapters, profiles, reviews...
02:09:50 reviews: fanfic.jobs.crawl_reviews(10688667) (bc9e03a6-f149-4edb-83ba-9f98d7c8306f)
02:12:49 reviews: Job OK (bc9e03a6-f149-4edb-83ba-9f98d7c8306f)
02:12:49 Result is kept for 500 seconds
02:12:49 
02:12:49 *** Listening on chapters, profiles, reviews...
02:12:49 reviews: fanfic.jobs.crawl_reviews(10689186) (8da2c6e6-0273-4688-b15c-274015560ff5)
02:14:22 reviews: Job OK (8da2c6e6-0273-4688-b15c-274015560ff5)
02:14:22 Result is kept for 500 seconds
02:14:22 
02:14:22 *** Listening on chapters, profiles, reviews...
02:14:22 reviews: fanfic.jobs.crawl_reviews(10689199) (f7ed5de6-f9f0-4951-9ffd-6bde5d456090)
02:14:27 reviews: Job OK (f7ed5de6-f9f0-4951-9ffd-6bde5d456090)
02:14:27 Result is kept for 500 seconds
02:14:27 
02:14:27 *** Listening on chapters, profiles, reviews...
02:14:27 reviews: fanfic.jobs.crawl_reviews(10689560) (ab509272-d333-470a-be18-96eebc407325)
2017-02-08 02:14:32 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 10:14:32.879957', 10689560, 209360648, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1018648&amp;r ... (866 characters truncated) ... 7/2014</span> </small><div style="margin-top:5px">Im intrigued by this story and where it will lead me. I can\'t wait to read more.</div></td>\n</tr>'), ('2017-02-08 10:14:32.879963', 10689560, 208550549, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4482576&amp;r ... (931 characters truncated) ... <span data-xutime="1412135117">9/30/2014</span> </small><div style="margin-top:5px">Love this story. But what is Draco\'s patronus?</div></td>\n</tr>'), ('2017-02-08 10:14:32.879965', 10689560, 208300918, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3402484&amp;r ... (1267 characters truncated) ... onship has been revealed it will be interesting to see it unfold. I hope Lucius doesn\'t muck things up for them. Or Ron, the twit.</div></td>\n</tr>'), ('2017-02-08 10:14:32.879967', 10689560, 208299904, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3402484&amp;r ... (1137 characters truncated) ... e two have already had enough sadness and loss in their lives. A fine romance with a long happy ending would be the kind way to go.</div></td>\n</tr>'), ('2017-02-08 10:14:32.879969', 10689560, 208029657, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (692 characters truncated) ...  ron will think, she should not care. <br>\ni wish she never dated ron in this story, would be much better, but well, not possible.</div></td>\n</tr>'), ('2017-02-08 10:14:32.879971', 10689560, 207971053, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (555 characters truncated) ... xutime="1411163778">9/19/2014</span> </small><div style="margin-top:5px">love this, it\'s amazing, can\'t wait for a new chapter :)</div></td>\n</tr>'), ('2017-02-08 10:14:32.879973', 10689560, 207860306, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6002207&amp;r ... (842 characters truncated) ... ime="1410963961">9/17/2014</span> </small><div style="margin-top:5px">I love this story and I can\'t wait to see what happens next.</div></td>\n</tr>'), ('2017-02-08 10:14:32.879975', 10689560, 207833084, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4536089&amp;r ... (869 characters truncated) ... ">9/16/2014</span> </small><div style="margin-top:5px">Anxiously waiting for Harry and Ron to find out that "John" is really Draco.</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-08 10:14:32.880003', 10689560, 207773385, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4536089&amp;r ... (1012 characters truncated) ... s growing(hopefully). <br>\n<br>\nRon causing drama at the end. I can only imagine that it\'ll accelerate to problems for Hermione.</div></td>\n</tr>'), ('2017-02-08 10:14:32.880005', 10689560, 207681778, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4536089&amp;r ... (840 characters truncated) ... <span data-xutime="1410670192">9/13/2014</span> </small><div style="margin-top:5px">Great chapter! Looking forward to reading more.</div></td>\n</tr>'))]
02:14:32 reviews: Job OK (ab509272-d333-470a-be18-96eebc407325)
02:14:32 Result is kept for 500 seconds
02:14:32 
02:14:32 *** Listening on chapters, profiles, reviews...
02:14:32 reviews: fanfic.jobs.crawl_reviews(10689655) (1d6a6052-8dca-4420-893e-28b8001a22b9)
02:15:40 reviews: Job OK (1d6a6052-8dca-4420-893e-28b8001a22b9)
02:15:40 Result is kept for 500 seconds
02:15:40 
02:15:40 *** Listening on chapters, profiles, reviews...
02:15:40 reviews: fanfic.jobs.crawl_reviews(10690435) (bb1c14f4-0dfd-4793-bd8f-c64cd8b2b90a)
02:19:01 reviews: Job OK (bb1c14f4-0dfd-4793-bd8f-c64cd8b2b90a)
02:19:01 Result is kept for 500 seconds
02:19:01 
02:19:01 *** Listening on chapters, profiles, reviews...
02:19:01 reviews: fanfic.jobs.crawl_reviews(10693423) (6e016f7b-931b-4ae6-aebc-bdf924884f97)
02:20:30 reviews: Job OK (6e016f7b-931b-4ae6-aebc-bdf924884f97)
02:20:30 Result is kept for 500 seconds
02:20:30 
02:20:30 *** Listening on chapters, profiles, reviews...
02:20:30 reviews: fanfic.jobs.crawl_reviews(10697365) (6fbe3cc2-3100-45b6-8d5b-60519d03b77b)
02:25:20 reviews: Job OK (6fbe3cc2-3100-45b6-8d5b-60519d03b77b)
02:25:20 Result is kept for 500 seconds
02:25:20 
02:25:20 *** Listening on chapters, profiles, reviews...
02:25:20 reviews: fanfic.jobs.crawl_reviews(10699172) (685eed5b-735c-4055-a970-c16a64a565b3)
02:25:34 reviews: Job OK (685eed5b-735c-4055-a970-c16a64a565b3)
02:25:34 Result is kept for 500 seconds
02:25:34 
02:25:34 *** Listening on chapters, profiles, reviews...
02:25:34 reviews: fanfic.jobs.crawl_reviews(10701068) (929a9b33-03fa-49f0-a857-8b26f2402184)
2017-02-08 02:25:38 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 10:25:38.688782', 10701068, 208907619, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5644982&amp;r ... (907 characters truncated) ... >chapter 18 . <span data-xutime="1412764482">10/8/2014</span> </small><div style="margin-top:5px">I hope you don\'t make John evil!</div></td>\n</tr>'), ('2017-02-08 10:25:38.688787', 10701068, 208852657, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (583 characters truncated) ... 14</span> </small><div style="margin-top:5px">I want Liza and George together John can\'t be perfect forever! Great writing though!</div></td>\n</tr>'), ('2017-02-08 10:25:38.688790', 10701068, 208286415, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4403642&amp;r ... (905 characters truncated) ...  11 . <span data-xutime="1411694541">9/25/2014</span> </small><div style="margin-top:5px">Wow it\'s really good love it update soon</div></td>\n</tr>'), ('2017-02-08 10:25:38.688792', 10701068, 208139876, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4403642&amp;r ... (946 characters truncated) ... 2014</span> </small><div style="margin-top:5px">Wow that\'s quick but I love your story I\'m hoping for a Liz and John romance haha</div></td>\n</tr>'), ('2017-02-08 10:25:38.688794', 10701068, 208907619, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5644982&amp;r ... (907 characters truncated) ... >chapter 18 . <span data-xutime="1412764482">10/8/2014</span> </small><div style="margin-top:5px">I hope you don\'t make John evil!</div></td>\n</tr>'), ('2017-02-08 10:25:38.688796', 10701068, 208852657, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (583 characters truncated) ... 14</span> </small><div style="margin-top:5px">I want Liza and George together John can\'t be perfect forever! Great writing though!</div></td>\n</tr>'), ('2017-02-08 10:25:38.688798', 10701068, 208286415, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4403642&amp;r ... (905 characters truncated) ...  11 . <span data-xutime="1411694541">9/25/2014</span> </small><div style="margin-top:5px">Wow it\'s really good love it update soon</div></td>\n</tr>'), ('2017-02-08 10:25:38.688800', 10701068, 208139876, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4403642&amp;r ... (946 characters truncated) ... 2014</span> </small><div style="margin-top:5px">Wow that\'s quick but I love your story I\'m hoping for a Liz and John romance haha</div></td>\n</tr>'))]
02:25:38 reviews: Job OK (929a9b33-03fa-49f0-a857-8b26f2402184)
02:25:38 Result is kept for 500 seconds
02:25:38 
02:25:38 *** Listening on chapters, profiles, reviews...
02:25:38 reviews: fanfic.jobs.crawl_reviews(10702396) (81466440-1807-44ab-b551-47472ee6ea04)
02:26:48 reviews: Job OK (81466440-1807-44ab-b551-47472ee6ea04)
02:26:48 Result is kept for 500 seconds
02:26:48 
02:26:48 *** Listening on chapters, profiles, reviews...
02:26:48 reviews: fanfic.jobs.crawl_reviews(10703055) (e4282b07-73e7-4da3-986b-6bd01c678dd0)
02:27:02 reviews: Job OK (e4282b07-73e7-4da3-986b-6bd01c678dd0)
02:27:02 Result is kept for 500 seconds
02:27:02 
02:27:02 *** Listening on chapters, profiles, reviews...
02:27:02 reviews: fanfic.jobs.crawl_reviews(10703712) (cbb8e70a-668a-4d2e-b727-5b15114a0072)
02:28:31 reviews: Job OK (cbb8e70a-668a-4d2e-b727-5b15114a0072)
02:28:31 Result is kept for 500 seconds
02:28:31 
02:28:31 *** Listening on chapters, profiles, reviews...
02:28:31 reviews: fanfic.jobs.crawl_reviews(10705988) (acd1b507-fbb1-4323-9542-c9461d73b169)
2017-02-08 02:28:36 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 10:28:36.289729', 10705988, 242541491, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5416318&amp;r ... (1116 characters truncated) ... w see how Tom could get her in his grip, step by step, its even scary sometimes. :) Well done and write us more such great stories!</div></td>\n</tr>'), ('2017-02-08 10:28:36.289733', 10705988, 239981591, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (640 characters truncated) ... HIS WAS FANTASTIC<br>\nAlso terrifying in a way but that\'s cool because it was so excellently written. Thanks so much for posting!</div></td>\n</tr>'), ('2017-02-08 10:28:36.289736', 10705988, 239975752, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (601 characters truncated) ... <div style="margin-top:5px">Welp. This just got dark. This fic is playing with my mind in the best way possible and I love/hate it.</div></td>\n</tr>'), ('2017-02-08 10:28:36.289738', 10705988, 239972196, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (595 characters truncated) ... mall><div style="margin-top:5px">I shouldn\'t be reading this, I really shouldn\'t, but it\'s too good. Thanks so much for posting!</div></td>\n</tr>'), ('2017-02-08 10:28:36.289740', 10705988, 236914399, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7608938&amp;r ... (951 characters truncated) ... 2016</span> </small><div style="margin-top:5px">Didn\'t you write this on another site? And did you go by the name Arrabella on it?</div></td>\n</tr>'), ('2017-02-08 10:28:36.289742', 10705988, 232584081, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7334147&amp;r ... (985 characters truncated) ... love it. Great complement to the canon Chamber of Secrets. I love Ginny\'s perspective. Evil Tom is lovely. Just a brilliant story!</div></td>\n</tr>'), ('2017-02-08 10:28:36.289743', 10705988, 222209582, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3769130&amp;r ... (1340 characters truncated) ... tand why people aren\'t congratulating you instead.<br>\nIn any case, if no-one else will, take it from me. This. Is. Truly. Great.</div></td>\n</tr>'), ('2017-02-08 10:28:36.289745', 10705988, 218666627, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (577 characters truncated) ... 13/2015</span> </small><div style="margin-top:5px">It\'s \'\'actually\'\' Ginevra, did you know? Still, I like it...I\'m reading XD</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-08 10:28:36.289782', 10705988, 208107889, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (559 characters truncated) ... ="1411384046">9/22/2014</span> </small><div style="margin-top:5px">"Virginia Mary Weasley" <br>\nGinevra Molly Weasley was her name</div></td>\n</tr>'), ('2017-02-08 10:28:36.289784', 10705988, 208107241, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (587 characters truncated) ... n> </small><div style="margin-top:5px">And Ginny\'s a little girl name. It\'s from Virginia<br>\nDid you know her mane was Ginevra?</div></td>\n</tr>'))]
02:28:36 reviews: Job OK (acd1b507-fbb1-4323-9542-c9461d73b169)
02:28:36 Result is kept for 500 seconds
02:28:36 
02:28:36 *** Listening on chapters, profiles, reviews...
02:28:36 reviews: fanfic.jobs.crawl_reviews(10706060) (5b9fca60-dcb6-45c4-9653-1faf182461de)
02:32:49 reviews: Job OK (5b9fca60-dcb6-45c4-9653-1faf182461de)
02:32:49 Result is kept for 500 seconds
02:32:49 
02:32:49 *** Listening on chapters, profiles, reviews...
02:32:49 reviews: fanfic.jobs.crawl_reviews(10707012) (8cf2b4cc-ca7d-4800-b150-724bbd912309)
02:34:25 reviews: Job OK (8cf2b4cc-ca7d-4800-b150-724bbd912309)
02:34:25 Result is kept for 500 seconds
02:34:25 
02:34:25 *** Listening on chapters, profiles, reviews...
02:34:25 reviews: fanfic.jobs.crawl_reviews(10708403) (3d8b87b2-8ca9-466e-902f-e807306064c5)
02:34:54 reviews: Job OK (3d8b87b2-8ca9-466e-902f-e807306064c5)
02:34:54 Result is kept for 500 seconds
02:34:54 
02:34:54 *** Listening on chapters, profiles, reviews...
02:34:54 reviews: fanfic.jobs.crawl_reviews(10709203) (4b809115-ba68-4e37-b134-639a99a647a9)
02:37:31 reviews: Job OK (4b809115-ba68-4e37-b134-639a99a647a9)
02:37:31 Result is kept for 500 seconds
02:37:31 
02:37:31 *** Listening on chapters, profiles, reviews...
02:37:31 reviews: fanfic.jobs.crawl_reviews(10709411) (92ab6144-ea11-4f2b-bd01-3b35a1b52bd3)
02:43:31 reviews: Job OK (92ab6144-ea11-4f2b-bd01-3b35a1b52bd3)
02:43:31 Result is kept for 500 seconds
02:43:31 
02:43:31 *** Listening on chapters, profiles, reviews...
02:43:31 reviews: fanfic.jobs.crawl_reviews(10710981) (d26fc8c8-5cba-48ca-b808-dd6750f53ce6)
02:53:42 reviews: Job OK (d26fc8c8-5cba-48ca-b808-dd6750f53ce6)
02:53:42 Result is kept for 500 seconds
02:53:42 
02:53:42 *** Listening on chapters, profiles, reviews...
02:53:42 reviews: fanfic.jobs.crawl_reviews(10712700) (2b5d5452-fd3f-42dd-a462-873e7f546160)
02:55:18 reviews: Job OK (2b5d5452-fd3f-42dd-a462-873e7f546160)
02:55:18 Result is kept for 500 seconds
02:55:18 Cleaning registries for queue: chapters
02:55:18 Cleaning registries for queue: profiles
02:55:18 Cleaning registries for queue: reviews
02:55:18 
02:55:18 *** Listening on chapters, profiles, reviews...
02:55:18 reviews: fanfic.jobs.crawl_reviews(10712904) (cca41ab9-ddcb-468f-8526-4e87b8a1fd6d)
02:58:10 reviews: Job OK (cca41ab9-ddcb-468f-8526-4e87b8a1fd6d)
02:58:10 Result is kept for 500 seconds
02:58:10 
02:58:10 *** Listening on chapters, profiles, reviews...
02:58:10 reviews: fanfic.jobs.crawl_reviews(10714307) (03102784-d0de-48f7-8080-d64868e3a79c)
2017-02-08 02:58:14 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 10:58:14.991359', 10714307, 230491135, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6228726&amp;r ... (860 characters truncated) ... 450413851">12/17/2015</span> </small><div style="margin-top:5px">Oooh! I\'ve absolutely loved this can\'t wait for the next 6 years</div></td>\n</tr>'), ('2017-02-08 10:58:14.991363', 10714307, 229238433, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4737745&amp;r ... (958 characters truncated) ... ><div style="margin-top:5px">okay, I totally called it! I knew Nax was still alive! I loved the story and can\'t wait to read more!</div></td>\n</tr>'), ('2017-02-08 10:58:14.991366', 10714307, 227150381, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7010061&amp;r ... (885 characters truncated) ... <small style="color:gray">chapter 13 . <span data-xutime="1443572022">9/29/2015</span> </small><div style="margin-top:5px">LOVE 13!</div></td>\n</tr>'), ('2017-02-08 10:58:14.991368', 10714307, 227146091, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7010061&amp;r ... (897 characters truncated) ... ="color:gray">chapter 9 . <span data-xutime="1443564820">9/29/2015</span> </small><div style="margin-top:5px">COOL THE MAUDERS MAP!</div></td>\n</tr>'), ('2017-02-08 10:58:14.991370', 10714307, 227141837, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7010061&amp;r ... (1277 characters truncated) ... ould be better than they sound! So far that is true for this story! Thanks idjt with a blue box!<br>\n...Thanks to you to universe!</div></td>\n</tr>'), ('2017-02-08 10:58:14.991371', 10714307, 226860412, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2236845&amp;r ... (1089 characters truncated) ... etty blunt thru the story that she wasn\'t as dead as we were told. Please come back with the following years soon. Regards Preeves</div></td>\n</tr>'), ('2017-02-08 10:58:14.991373', 10714307, 213263557, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5889677&amp;r ... (924 characters truncated) ... p:5px">This is really, really, really, really, really, really, really, really, really, really, really good! You should update soon!</div></td>\n</tr>'), ('2017-02-08 10:58:14.991375', 10714307, 212021895, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5257197&amp;r ... (1025 characters truncated) ... hen? <br>\n<br>\nAlso, your opinion on Dark Arts and inner mechanics of all this Bouncing Killing Curse debacle is somewhat absurd.</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-08 10:58:14.991410', 10714307, 208692825, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (647 characters truncated) ... her chapter. An don\'t worry about not having time. You update fairly often. Or at least more than most of the other authors I see.</div></td>\n</tr>'), ('2017-02-08 10:58:14.991412', 10714307, 208359536, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (684 characters truncated) ... 't care for stories that have plots focusing mainly around the OC\'s, but this is very well written and I will continue reading it.</div></td>\n</tr>'))]
02:58:15 reviews: Job OK (03102784-d0de-48f7-8080-d64868e3a79c)
02:58:15 Result is kept for 500 seconds
02:58:15 
02:58:15 *** Listening on chapters, profiles, reviews...
02:58:15 reviews: fanfic.jobs.crawl_reviews(10714712) (01d15694-6f70-43f2-b9a4-31db08d390f5)
02:58:54 reviews: Job OK (01d15694-6f70-43f2-b9a4-31db08d390f5)
02:58:54 Result is kept for 500 seconds
02:58:54 
02:58:54 *** Listening on chapters, profiles, reviews...
02:58:54 reviews: fanfic.jobs.crawl_reviews(10715120) (35123730-7511-4b7f-9b0e-4ca55a0ea063)
02:59:47 reviews: Job OK (35123730-7511-4b7f-9b0e-4ca55a0ea063)
02:59:47 Result is kept for 500 seconds
02:59:47 
02:59:47 *** Listening on chapters, profiles, reviews...
02:59:47 reviews: fanfic.jobs.crawl_reviews(10715813) (8aa01825-a579-4e9f-8342-7d4a30bed9ec)
03:10:50 reviews: Job OK (8aa01825-a579-4e9f-8342-7d4a30bed9ec)
03:10:50 Result is kept for 500 seconds
03:10:50 
03:10:50 *** Listening on chapters, profiles, reviews...
03:10:50 reviews: fanfic.jobs.crawl_reviews(10716023) (35662dca-7f08-4984-99ef-19340197b58c)
03:11:40 reviews: Job OK (35662dca-7f08-4984-99ef-19340197b58c)
03:11:40 Result is kept for 500 seconds
03:11:40 
03:11:40 *** Listening on chapters, profiles, reviews...
03:11:40 reviews: fanfic.jobs.crawl_reviews(10716547) (4d44606e-7154-41f1-8c60-f85a81100692)
03:13:22 reviews: Job OK (4d44606e-7154-41f1-8c60-f85a81100692)
03:13:22 Result is kept for 500 seconds
03:13:22 
03:13:22 *** Listening on chapters, profiles, reviews...
03:13:22 reviews: fanfic.jobs.crawl_reviews(10717408) (4269da7d-2701-4d6a-90e3-104b8cbdf84e)
03:14:29 reviews: Job OK (4269da7d-2701-4d6a-90e3-104b8cbdf84e)
03:14:29 Result is kept for 500 seconds
03:14:29 
03:14:29 *** Listening on chapters, profiles, reviews...
03:14:29 reviews: fanfic.jobs.crawl_reviews(10719519) (aeb3d8b8-6858-4f3e-a03e-6e4ef42c0a62)
03:14:43 reviews: Job OK (aeb3d8b8-6858-4f3e-a03e-6e4ef42c0a62)
03:14:43 Result is kept for 500 seconds
03:14:43 
03:14:43 *** Listening on chapters, profiles, reviews...
03:14:43 reviews: fanfic.jobs.crawl_reviews(10721004) (489a53ed-cca0-48ca-9295-8ecb6dce1a17)
03:16:27 reviews: Job OK (489a53ed-cca0-48ca-9295-8ecb6dce1a17)
03:16:27 Result is kept for 500 seconds
03:16:27 
03:16:27 *** Listening on chapters, profiles, reviews...
03:16:27 reviews: fanfic.jobs.crawl_reviews(10721707) (06895c66-4c92-4244-a4a5-391a4c01599b)
03:17:07 reviews: Job OK (06895c66-4c92-4244-a4a5-391a4c01599b)
03:17:07 Result is kept for 500 seconds
03:17:07 
03:17:07 *** Listening on chapters, profiles, reviews...
03:17:07 reviews: fanfic.jobs.crawl_reviews(10721818) (2878d5b6-d5c5-44b9-907d-7f2aa1f6cb9e)
03:17:42 reviews: Job OK (2878d5b6-d5c5-44b9-907d-7f2aa1f6cb9e)
03:17:42 Result is kept for 500 seconds
03:17:42 
03:17:42 *** Listening on chapters, profiles, reviews...
03:17:42 reviews: fanfic.jobs.crawl_reviews(10722414) (5d27fd4a-d9ee-4e35-ad60-1ec97066688a)
03:18:08 reviews: Job OK (5d27fd4a-d9ee-4e35-ad60-1ec97066688a)
03:18:08 Result is kept for 500 seconds
03:18:08 
03:18:08 *** Listening on chapters, profiles, reviews...
03:18:08 reviews: fanfic.jobs.crawl_reviews(10722504) (119b1966-f6d1-4412-8c02-9171b25f2afb)
03:18:59 reviews: Job OK (119b1966-f6d1-4412-8c02-9171b25f2afb)
03:18:59 Result is kept for 500 seconds
03:18:59 
03:18:59 *** Listening on chapters, profiles, reviews...
03:18:59 reviews: fanfic.jobs.crawl_reviews(10724291) (22dabb97-367a-480e-98dc-f1d57346c76c)
03:21:51 reviews: Job OK (22dabb97-367a-480e-98dc-f1d57346c76c)
03:21:51 Result is kept for 500 seconds
03:21:51 
03:21:51 *** Listening on chapters, profiles, reviews...
03:21:51 reviews: fanfic.jobs.crawl_reviews(10725322) (f552e74c-f95e-4f6f-9784-8f4afa31fd97)
03:23:08 reviews: Job OK (f552e74c-f95e-4f6f-9784-8f4afa31fd97)
03:23:08 Result is kept for 500 seconds
03:23:08 
03:23:08 *** Listening on chapters, profiles, reviews...
03:23:08 reviews: fanfic.jobs.crawl_reviews(10725372) (e5460205-ea2e-4c51-90e5-7915c23267e5)
03:23:50 reviews: Job OK (e5460205-ea2e-4c51-90e5-7915c23267e5)
03:23:50 Result is kept for 500 seconds
03:23:50 
03:23:50 *** Listening on chapters, profiles, reviews...
03:23:50 reviews: fanfic.jobs.crawl_reviews(10725654) (97c9694a-0815-4202-8ac8-23840cf7a0a4)
03:24:31 reviews: Job OK (97c9694a-0815-4202-8ac8-23840cf7a0a4)
03:24:31 Result is kept for 500 seconds
03:24:31 
03:24:31 *** Listening on chapters, profiles, reviews...
03:24:31 reviews: fanfic.jobs.crawl_reviews(10725967) (8c17a8a5-4c2e-4195-91a1-a59a2e8d88ba)
03:24:45 reviews: Job OK (8c17a8a5-4c2e-4195-91a1-a59a2e8d88ba)
03:24:45 Result is kept for 500 seconds
03:24:45 
03:24:45 *** Listening on chapters, profiles, reviews...
03:24:45 reviews: fanfic.jobs.crawl_reviews(10726678) (e5889637-5843-470c-a29d-c2059669d5be)
03:24:53 reviews: Job OK (e5889637-5843-470c-a29d-c2059669d5be)
03:24:53 Result is kept for 500 seconds
03:24:53 
03:24:53 *** Listening on chapters, profiles, reviews...
03:24:53 reviews: fanfic.jobs.crawl_reviews(10727210) (eb6c6904-2093-4a7c-a215-8f04e08cbb09)
03:25:15 reviews: Job OK (eb6c6904-2093-4a7c-a215-8f04e08cbb09)
03:25:15 Result is kept for 500 seconds
03:25:15 
03:25:15 *** Listening on chapters, profiles, reviews...
03:25:15 reviews: fanfic.jobs.crawl_reviews(10727388) (33b2c5f5-567b-46e4-8045-fafa700cc7f7)
03:26:40 reviews: Job OK (33b2c5f5-567b-46e4-8045-fafa700cc7f7)
03:26:40 Result is kept for 500 seconds
03:26:40 
03:26:40 *** Listening on chapters, profiles, reviews...
03:26:40 reviews: fanfic.jobs.crawl_reviews(10728064) (025692f1-10f3-413c-b17c-d568edb07c72)
03:29:37 reviews: Job OK (025692f1-10f3-413c-b17c-d568edb07c72)
03:29:37 Result is kept for 500 seconds
03:29:37 
03:29:37 *** Listening on chapters, profiles, reviews...
03:29:37 reviews: fanfic.jobs.crawl_reviews(10728191) (b08a615e-2de8-4d85-a2ea-cbe86b6a8850)
03:29:56 reviews: Job OK (b08a615e-2de8-4d85-a2ea-cbe86b6a8850)
03:29:56 Result is kept for 500 seconds
03:29:56 
03:29:56 *** Listening on chapters, profiles, reviews...
03:29:56 reviews: fanfic.jobs.crawl_reviews(10730663) (fef7b6e0-63c9-4ffc-9aca-f5ed3ecbd240)
03:30:26 reviews: Job OK (fef7b6e0-63c9-4ffc-9aca-f5ed3ecbd240)
03:30:26 Result is kept for 500 seconds
03:30:26 
03:30:26 *** Listening on chapters, profiles, reviews...
03:30:26 reviews: fanfic.jobs.crawl_reviews(10731091) (081f3c83-75c2-49a2-8811-d9b41bb09d81)
03:30:49 reviews: Job OK (081f3c83-75c2-49a2-8811-d9b41bb09d81)
03:30:49 Result is kept for 500 seconds
03:30:49 
03:30:49 *** Listening on chapters, profiles, reviews...
03:30:49 reviews: fanfic.jobs.crawl_reviews(10732826) (ccc38c7f-7054-4cf6-9af4-aeec4c548cc2)
2017-02-08 03:30:55 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 11:30:55.137450', 10732826, 210340866, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5246933&amp;r ... (777 characters truncated) ... l style="color:gray">chapter 1 . <span data-xutime="1415248417">11/5/2014</span> </small><div style="margin-top:5px">Grandchildren?</div></td>\n</tr>'), ('2017-02-08 11:30:55.137454', 10732826, 210340866, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5246933&amp;r ... (777 characters truncated) ... l style="color:gray">chapter 1 . <span data-xutime="1415248417">11/5/2014</span> </small><div style="margin-top:5px">Grandchildren?</div></td>\n</tr>'))]
03:30:55 reviews: Job OK (ccc38c7f-7054-4cf6-9af4-aeec4c548cc2)
03:30:55 Result is kept for 500 seconds
03:30:55 
03:30:55 *** Listening on chapters, profiles, reviews...
03:30:55 reviews: fanfic.jobs.crawl_reviews(10732913) (a70a6412-d8fe-47b2-8309-c6912c000541)
03:31:11 reviews: Job OK (a70a6412-d8fe-47b2-8309-c6912c000541)
03:31:11 Result is kept for 500 seconds
03:31:11 
03:31:11 *** Listening on chapters, profiles, reviews...
03:31:11 reviews: fanfic.jobs.crawl_reviews(10734283) (caf4d3e4-1313-40c0-b933-a6f694ef670a)
03:31:45 reviews: Job OK (caf4d3e4-1313-40c0-b933-a6f694ef670a)
03:31:45 Result is kept for 500 seconds
03:31:45 
03:31:45 *** Listening on chapters, profiles, reviews...
03:31:45 reviews: fanfic.jobs.crawl_reviews(10740878) (6ddf0666-9bb9-4e41-a678-3ecbc435232b)
03:31:50 reviews: Job OK (6ddf0666-9bb9-4e41-a678-3ecbc435232b)
03:31:50 Result is kept for 500 seconds
03:31:50 
03:31:50 *** Listening on chapters, profiles, reviews...
03:31:50 reviews: fanfic.jobs.crawl_reviews(10741076) (66e2b13f-3ff1-4ffc-856f-d2c9ccd37c8d)
03:32:14 reviews: Job OK (66e2b13f-3ff1-4ffc-856f-d2c9ccd37c8d)
03:32:14 Result is kept for 500 seconds
03:32:14 
03:32:14 *** Listening on chapters, profiles, reviews...
03:32:14 reviews: fanfic.jobs.crawl_reviews(10742291) (cc4cdda0-8192-4f0a-9c33-580e8186d580)
03:32:54 reviews: Job OK (cc4cdda0-8192-4f0a-9c33-580e8186d580)
03:32:54 Result is kept for 500 seconds
03:32:54 
03:32:54 *** Listening on chapters, profiles, reviews...
03:32:54 reviews: fanfic.jobs.crawl_reviews(10744268) (35d57791-8b2b-4616-9b8f-29a0c0970832)
03:35:00 reviews: Job OK (35d57791-8b2b-4616-9b8f-29a0c0970832)
03:35:00 Result is kept for 500 seconds
03:35:00 
03:35:00 *** Listening on chapters, profiles, reviews...
03:35:00 reviews: fanfic.jobs.crawl_reviews(10748108) (f7f6157e-5afd-4831-bd4c-ac7198f4ab32)
03:47:08 reviews: Job OK (f7f6157e-5afd-4831-bd4c-ac7198f4ab32)
03:47:08 Result is kept for 500 seconds
03:47:08 
03:47:08 *** Listening on chapters, profiles, reviews...
03:47:08 reviews: fanfic.jobs.crawl_reviews(10748762) (2cea279a-ad27-495c-a7cc-ccb78778898a)
03:47:38 reviews: Job OK (2cea279a-ad27-495c-a7cc-ccb78778898a)
03:47:38 Result is kept for 500 seconds
03:47:38 
03:47:38 *** Listening on chapters, profiles, reviews...
03:47:38 reviews: fanfic.jobs.crawl_reviews(10749860) (35f0ecd1-a1c6-4902-b09e-629029617a3e)
03:47:58 reviews: Job OK (35f0ecd1-a1c6-4902-b09e-629029617a3e)
03:47:58 Result is kept for 500 seconds
03:47:58 
03:47:58 *** Listening on chapters, profiles, reviews...
03:47:58 reviews: fanfic.jobs.crawl_reviews(10750182) (a0871fb2-302d-45cc-b39c-c20a52e91b4c)
03:48:25 reviews: Job OK (a0871fb2-302d-45cc-b39c-c20a52e91b4c)
03:48:25 Result is kept for 500 seconds
03:48:25 
03:48:25 *** Listening on chapters, profiles, reviews...
03:48:25 reviews: fanfic.jobs.crawl_reviews(10750578) (cf457b7c-68bb-4325-98c2-b3ba03fe6d0b)
03:49:04 reviews: Job OK (cf457b7c-68bb-4325-98c2-b3ba03fe6d0b)
03:49:04 Result is kept for 500 seconds
03:49:04 
03:49:04 *** Listening on chapters, profiles, reviews...
03:49:04 reviews: fanfic.jobs.crawl_reviews(10751447) (7fdfa7a5-caee-46dd-af37-64816979abfd)
04:00:08 reviews: Job OK (7fdfa7a5-caee-46dd-af37-64816979abfd)
04:00:08 Result is kept for 500 seconds
04:00:08 Cleaning registries for queue: chapters
04:00:08 Cleaning registries for queue: profiles
04:00:08 Cleaning registries for queue: reviews
04:00:08 
04:00:08 *** Listening on chapters, profiles, reviews...
04:00:08 reviews: fanfic.jobs.crawl_reviews(10751741) (a2156758-63ef-433d-a35d-eccf53599a44)
04:00:32 reviews: Job OK (a2156758-63ef-433d-a35d-eccf53599a44)
04:00:32 Result is kept for 500 seconds
04:00:32 
04:00:32 *** Listening on chapters, profiles, reviews...
04:00:32 reviews: fanfic.jobs.crawl_reviews(10752275) (54ad52e2-b7a6-489b-a30c-335a112d1ca7)
04:00:45 reviews: Job OK (54ad52e2-b7a6-489b-a30c-335a112d1ca7)
04:00:45 Result is kept for 500 seconds
04:00:45 
04:00:45 *** Listening on chapters, profiles, reviews...
04:00:45 reviews: fanfic.jobs.crawl_reviews(10752276) (0996e2f5-eb4f-4dbc-8405-b5a44a65a972)
04:01:48 reviews: Job OK (0996e2f5-eb4f-4dbc-8405-b5a44a65a972)
04:01:48 Result is kept for 500 seconds
04:01:48 
04:01:48 *** Listening on chapters, profiles, reviews...
04:01:48 reviews: fanfic.jobs.crawl_reviews(10752727) (70aceae1-303d-4c6f-9621-ca7c46a9cd89)
04:02:01 reviews: Job OK (70aceae1-303d-4c6f-9621-ca7c46a9cd89)
04:02:01 Result is kept for 500 seconds
04:02:01 
04:02:01 *** Listening on chapters, profiles, reviews...
04:02:01 reviews: fanfic.jobs.crawl_reviews(10753296) (3ea4cc4a-7a5b-4d19-9756-4464659a88c2)
04:03:09 reviews: Job OK (3ea4cc4a-7a5b-4d19-9756-4464659a88c2)
04:03:09 Result is kept for 500 seconds
04:03:09 
04:03:09 *** Listening on chapters, profiles, reviews...
04:03:09 reviews: fanfic.jobs.crawl_reviews(10754044) (c61cb367-acbf-4617-99db-663cb9ea2dc9)
04:03:50 reviews: Job OK (c61cb367-acbf-4617-99db-663cb9ea2dc9)
04:03:50 Result is kept for 500 seconds
04:03:50 
04:03:50 *** Listening on chapters, profiles, reviews...
04:03:50 reviews: fanfic.jobs.crawl_reviews(10754389) (896ff7a9-5f50-43a4-8faa-807bbf4d8134)
04:03:57 reviews: Job OK (896ff7a9-5f50-43a4-8faa-807bbf4d8134)
04:03:57 Result is kept for 500 seconds
04:03:57 
04:03:57 *** Listening on chapters, profiles, reviews...
04:03:57 reviews: fanfic.jobs.crawl_reviews(10754864) (15b5b976-b5ce-42e6-8c7f-5736ae4d584e)
04:04:27 reviews: Job OK (15b5b976-b5ce-42e6-8c7f-5736ae4d584e)
04:04:27 Result is kept for 500 seconds
04:04:27 
04:04:27 *** Listening on chapters, profiles, reviews...
04:04:27 reviews: fanfic.jobs.crawl_reviews(10756479) (d1c213a2-7467-4483-8371-15bbfc108227)
04:04:42 reviews: Job OK (d1c213a2-7467-4483-8371-15bbfc108227)
04:04:42 Result is kept for 500 seconds
04:04:42 
04:04:42 *** Listening on chapters, profiles, reviews...
04:04:42 reviews: fanfic.jobs.crawl_reviews(10757158) (5eb08e42-3ffe-4158-bb13-32c82678553f)
04:11:05 reviews: Job OK (5eb08e42-3ffe-4158-bb13-32c82678553f)
04:11:05 Result is kept for 500 seconds
04:11:05 
04:11:05 *** Listening on chapters, profiles, reviews...
04:11:05 reviews: fanfic.jobs.crawl_reviews(10758358) (b75cddfc-4c02-4229-9a10-416c871829d5)
04:14:02 reviews: Job OK (b75cddfc-4c02-4229-9a10-416c871829d5)
04:14:02 Result is kept for 500 seconds
04:14:02 
04:14:02 *** Listening on chapters, profiles, reviews...
04:14:02 reviews: fanfic.jobs.crawl_reviews(10762241) (96471add-c94b-4218-bd5f-cb1e9bb83061)
04:14:37 reviews: Job OK (96471add-c94b-4218-bd5f-cb1e9bb83061)
04:14:37 Result is kept for 500 seconds
04:14:37 
04:14:37 *** Listening on chapters, profiles, reviews...
04:14:37 reviews: fanfic.jobs.crawl_reviews(10762998) (7f7d1d73-766f-45df-8aa7-b53fe4414a60)
04:14:42 reviews: Job OK (7f7d1d73-766f-45df-8aa7-b53fe4414a60)
04:14:42 Result is kept for 500 seconds
04:14:42 
04:14:42 *** Listening on chapters, profiles, reviews...
04:14:42 reviews: fanfic.jobs.crawl_reviews(10764055) (3ba962c5-88b9-496c-aba4-0b31f4799a16)
04:15:01 reviews: Job OK (3ba962c5-88b9-496c-aba4-0b31f4799a16)
04:15:01 Result is kept for 500 seconds
04:15:01 
04:15:01 *** Listening on chapters, profiles, reviews...
04:15:01 reviews: fanfic.jobs.crawl_reviews(10764441) (b0481442-3407-452f-86ca-a841acd4a8d4)
04:16:54 reviews: Job OK (b0481442-3407-452f-86ca-a841acd4a8d4)
04:16:54 Result is kept for 500 seconds
04:16:54 
04:16:54 *** Listening on chapters, profiles, reviews...
04:16:54 reviews: fanfic.jobs.crawl_reviews(10765600) (fe96e04d-9a43-41ae-ac2d-461bdae9da64)
04:17:29 reviews: Job OK (fe96e04d-9a43-41ae-ac2d-461bdae9da64)
04:17:29 Result is kept for 500 seconds
04:17:29 
04:17:29 *** Listening on chapters, profiles, reviews...
04:17:29 reviews: fanfic.jobs.crawl_reviews(10766595) (0832d8ef-5611-4f6c-8f75-1bad859ceee6)
04:39:34 reviews: Job OK (0832d8ef-5611-4f6c-8f75-1bad859ceee6)
04:39:34 Result is kept for 500 seconds
04:39:34 
04:39:34 *** Listening on chapters, profiles, reviews...
04:39:34 reviews: fanfic.jobs.crawl_reviews(10767339) (9f2e5595-3421-4aeb-a833-5727f74db9d6)
04:41:44 reviews: Job OK (9f2e5595-3421-4aeb-a833-5727f74db9d6)
04:41:44 Result is kept for 500 seconds
04:41:44 
04:41:44 *** Listening on chapters, profiles, reviews...
04:41:44 reviews: fanfic.jobs.crawl_reviews(10767751) (e19a5bb7-f695-451b-b573-3193f6c1c2dd)
04:42:02 reviews: Job OK (e19a5bb7-f695-451b-b573-3193f6c1c2dd)
04:42:02 Result is kept for 500 seconds
04:42:02 
04:42:02 *** Listening on chapters, profiles, reviews...
04:42:02 reviews: fanfic.jobs.crawl_reviews(10770076) (17693f00-2fc7-4abf-9ea6-55c177a487bc)
04:42:26 reviews: Job OK (17693f00-2fc7-4abf-9ea6-55c177a487bc)
04:42:26 Result is kept for 500 seconds
04:42:26 
04:42:26 *** Listening on chapters, profiles, reviews...
04:42:26 reviews: fanfic.jobs.crawl_reviews(10770140) (7b912a3f-41d8-433e-bc6f-3254c50b5d02)
04:44:17 reviews: Job OK (7b912a3f-41d8-433e-bc6f-3254c50b5d02)
04:44:17 Result is kept for 500 seconds
04:44:17 
04:44:17 *** Listening on chapters, profiles, reviews...
04:44:17 reviews: fanfic.jobs.crawl_reviews(10770702) (ad9e2b06-930d-4781-8bf1-f16660287770)
04:47:18 reviews: Job OK (ad9e2b06-930d-4781-8bf1-f16660287770)
04:47:18 Result is kept for 500 seconds
04:47:18 
04:47:18 *** Listening on chapters, profiles, reviews...
04:47:18 reviews: fanfic.jobs.crawl_reviews(10771978) (6d8f0e88-7702-4a66-9d0f-36d0e46979d5)
04:47:45 reviews: Job OK (6d8f0e88-7702-4a66-9d0f-36d0e46979d5)
04:47:45 Result is kept for 500 seconds
04:47:45 
04:47:45 *** Listening on chapters, profiles, reviews...
04:47:45 reviews: fanfic.jobs.crawl_reviews(10772496) (6f1ac36f-8c49-48e7-95f9-0d44b141b51b)
05:30:29 reviews: Job OK (6f1ac36f-8c49-48e7-95f9-0d44b141b51b)
05:30:29 Result is kept for 500 seconds
05:30:29 Cleaning registries for queue: chapters
05:30:29 Cleaning registries for queue: profiles
05:30:29 Cleaning registries for queue: reviews
05:30:29 
05:30:29 *** Listening on chapters, profiles, reviews...
05:30:29 reviews: fanfic.jobs.crawl_reviews(10772859) (0632aac1-a6de-4a90-9a7a-b3a221b4680a)
05:31:02 reviews: Job OK (0632aac1-a6de-4a90-9a7a-b3a221b4680a)
05:31:02 Result is kept for 500 seconds
05:31:02 
05:31:02 *** Listening on chapters, profiles, reviews...
05:31:02 reviews: fanfic.jobs.crawl_reviews(10772920) (eefb4bcb-c3cb-431b-9783-52d6c2d86c05)
2017-02-08 05:31:06 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 13:31:06.892258', 10772920, 245445969, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (736 characters truncated) ... flows nicely and the story plot itself is interesting. I looooove this. Thank you for writing this. Hopefully you will continue! :)</div></td>\n</tr>'), ('2017-02-08 13:31:06.892263', 10772920, 229342566, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2681054&amp;r ... (921 characters truncated) ... 3 . <span data-xutime="1448045695">11/20/2015</span> </small><div style="margin-top:5px">Can\'t wait to find out what happens next.</div></td>\n</tr>'), ('2017-02-08 13:31:06.892265', 10772920, 216999050, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2745289&amp;r ... (1000 characters truncated) ... x">You\'re doing such a good job with the HP world. This is my first Draco series I\'ve read and I honestly love how your doing it.</div></td>\n</tr>'), ('2017-02-08 13:31:06.892267', 10772920, 216982938, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2745289&amp;r ... (1175 characters truncated) ... p her dream for him. Not to mention his little, "I have better options." On who he can marry. We all know what he\'s getting at. :)</div></td>\n</tr>'), ('2017-02-08 13:31:06.892269', 10772920, 213985649, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5577172&amp;r ... (1136 characters truncated) ...  tends to be difficult), if just perfect! Once again you\'ve garnered my attention and held my rapt attention. Now on to the third!</div></td>\n</tr>'), ('2017-02-08 13:31:06.892271', 10772920, 212197922, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (525 characters truncated) ... yle="color:gray">chapter 53 . <span data-xutime="1418446341">12/12/2014</span> </small><div style="margin-top:5px">On to Swan Song!</div></td>\n</tr>'), ('2017-02-08 13:31:06.892273', 10772920, 210855845, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6064386&amp;r ... (946 characters truncated) ... 014</span> </small><div style="margin-top:5px">I ike the idea that bellatrix is teasing him because Draco had a crush on Alvers. :D</div></td>\n</tr>'), ('2017-02-08 13:31:06.892275', 10772920, 245445969, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (736 characters truncated) ... flows nicely and the story plot itself is interesting. I looooove this. Thank you for writing this. Hopefully you will continue! :)</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-08 13:31:06.892284', 10772920, 212197922, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (525 characters truncated) ... yle="color:gray">chapter 53 . <span data-xutime="1418446341">12/12/2014</span> </small><div style="margin-top:5px">On to Swan Song!</div></td>\n</tr>'), ('2017-02-08 13:31:06.892286', 10772920, 210855845, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6064386&amp;r ... (946 characters truncated) ... 014</span> </small><div style="margin-top:5px">I ike the idea that bellatrix is teasing him because Draco had a crush on Alvers. :D</div></td>\n</tr>'))]
05:31:06 reviews: Job OK (eefb4bcb-c3cb-431b-9783-52d6c2d86c05)
05:31:06 Result is kept for 500 seconds
05:31:06 
05:31:06 *** Listening on chapters, profiles, reviews...
05:31:06 reviews: fanfic.jobs.crawl_reviews(10772957) (6cfd064c-51d4-449b-b45b-24aa64597689)
05:31:12 reviews: Job OK (6cfd064c-51d4-449b-b45b-24aa64597689)
05:31:12 Result is kept for 500 seconds
05:31:12 
05:31:12 *** Listening on chapters, profiles, reviews...
05:31:12 reviews: fanfic.jobs.crawl_reviews(10775467) (ce4c818a-aebe-4d43-b670-5b902a3750e6)
05:31:17 reviews: Job OK (ce4c818a-aebe-4d43-b670-5b902a3750e6)
05:31:17 Result is kept for 500 seconds
05:31:17 
05:31:17 *** Listening on chapters, profiles, reviews...
05:31:17 reviews: fanfic.jobs.crawl_reviews(10775872) (d067d082-9e59-4321-bb1e-0021c32320b0)
05:38:22 reviews: Job OK (d067d082-9e59-4321-bb1e-0021c32320b0)
05:38:22 Result is kept for 500 seconds
05:38:22 
05:38:22 *** Listening on chapters, profiles, reviews...
05:38:22 reviews: fanfic.jobs.crawl_reviews(10776004) (48d00a33-88e1-4ccc-a514-e6a6f231c5e9)
05:39:20 reviews: Job OK (48d00a33-88e1-4ccc-a514-e6a6f231c5e9)
05:39:20 Result is kept for 500 seconds
05:39:20 
05:39:20 *** Listening on chapters, profiles, reviews...
05:39:20 reviews: fanfic.jobs.crawl_reviews(10776550) (cf2c6a39-efc0-472e-8d3e-9abba7f1b55f)
05:40:26 reviews: Job OK (cf2c6a39-efc0-472e-8d3e-9abba7f1b55f)
05:40:26 Result is kept for 500 seconds
05:40:26 
05:40:26 *** Listening on chapters, profiles, reviews...
05:40:26 reviews: fanfic.jobs.crawl_reviews(10780158) (228df021-15c2-4ac1-a5c9-5cfece85a9ad)
05:41:13 reviews: Job OK (228df021-15c2-4ac1-a5c9-5cfece85a9ad)
05:41:13 Result is kept for 500 seconds
05:41:13 
05:41:13 *** Listening on chapters, profiles, reviews...
05:41:13 reviews: fanfic.jobs.crawl_reviews(10780168) (3e992395-e75e-4d8c-8bb1-6803d4aa8281)
05:41:40 reviews: Job OK (3e992395-e75e-4d8c-8bb1-6803d4aa8281)
05:41:40 Result is kept for 500 seconds
05:41:40 
05:41:40 *** Listening on chapters, profiles, reviews...
05:41:40 reviews: fanfic.jobs.crawl_reviews(10780451) (e1f96b97-e709-4909-8231-023a417ad564)
05:41:56 reviews: Job OK (e1f96b97-e709-4909-8231-023a417ad564)
05:41:56 Result is kept for 500 seconds
05:41:56 
05:41:56 *** Listening on chapters, profiles, reviews...
05:41:56 reviews: fanfic.jobs.crawl_reviews(10781599) (9c22b23c-b41a-4da7-a005-165aa05e5071)
05:46:26 reviews: Job OK (9c22b23c-b41a-4da7-a005-165aa05e5071)
05:46:26 Result is kept for 500 seconds
05:46:26 
05:46:26 *** Listening on chapters, profiles, reviews...
05:46:26 reviews: fanfic.jobs.crawl_reviews(10783649) (9ecf9a7f-ae19-4acc-bf30-b009b32dc870)
05:47:20 reviews: Job OK (9ecf9a7f-ae19-4acc-bf30-b009b32dc870)
05:47:20 Result is kept for 500 seconds
05:47:20 
05:47:20 *** Listening on chapters, profiles, reviews...
05:47:20 reviews: fanfic.jobs.crawl_reviews(10784457) (aaa947f5-7b24-4ae2-90e6-fcb5c807923a)
05:47:40 reviews: Job OK (aaa947f5-7b24-4ae2-90e6-fcb5c807923a)
05:47:40 Result is kept for 500 seconds
05:47:40 
05:47:40 *** Listening on chapters, profiles, reviews...
05:47:40 reviews: fanfic.jobs.crawl_reviews(10785637) (65e91559-8f72-41b1-8a44-d58ad20e99cd)
05:50:07 reviews: Job OK (65e91559-8f72-41b1-8a44-d58ad20e99cd)
05:50:07 Result is kept for 500 seconds
05:50:07 
05:50:07 *** Listening on chapters, profiles, reviews...
05:50:07 reviews: fanfic.jobs.crawl_reviews(10785698) (85c9f792-a4f7-4e27-ad1b-2af370b1a7e9)
05:50:32 reviews: Job OK (85c9f792-a4f7-4e27-ad1b-2af370b1a7e9)
05:50:32 Result is kept for 500 seconds
05:50:32 
05:50:32 *** Listening on chapters, profiles, reviews...
05:50:32 reviews: fanfic.jobs.crawl_reviews(10787004) (3fcb3498-cece-4435-83ed-db1a099d0c92)
05:50:45 reviews: Job OK (3fcb3498-cece-4435-83ed-db1a099d0c92)
05:50:45 Result is kept for 500 seconds
05:50:45 
05:50:45 *** Listening on chapters, profiles, reviews...
05:50:45 reviews: fanfic.jobs.crawl_reviews(10787301) (bd6b2594-98c2-476b-96e0-33e8d553b991)
05:55:12 reviews: Job OK (bd6b2594-98c2-476b-96e0-33e8d553b991)
05:55:12 Result is kept for 500 seconds
05:55:12 
05:55:12 *** Listening on chapters, profiles, reviews...
05:55:12 reviews: fanfic.jobs.crawl_reviews(10788510) (e061ad69-f2d4-44e2-8340-c2abe4534d97)
2017-02-08 05:55:17 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 13:55:17.662260', 10788510, 243189030, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1136438&amp;r ... (944 characters truncated) ... /span> </small><div style="margin-top:5px">This is still sitting in my reading portion because I hope one day it gets updated again</div></td>\n</tr>'), ('2017-02-08 13:55:17.662266', 10788510, 225235428, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1268249&amp;r ... (835 characters truncated) ... 541">8/17/2015</span> </small><div style="margin-top:5px">One down...but I wonder what else they will do while hanging out in 1971?</div></td>\n</tr>'), ('2017-02-08 13:55:17.662268', 10788510, 225234760, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1268249&amp;r ... (790 characters truncated) ... :gray">chapter 1 . <span data-xutime="1439870553">8/17/2015</span> </small><div style="margin-top:5px">Oh I like...very, very much!</div></td>\n</tr>'), ('2017-02-08 13:55:17.662270', 10788510, 223794917, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5386609&amp;r ... (808 characters truncated) ... or:gray">chapter 13 . <span data-xutime="1437505141">7/21/2015</span> </small><div style="margin-top:5px">Estou adorando a estória.</div></td>\n</tr>'), ('2017-02-08 13:55:17.662272', 10788510, 222566395, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5440622&amp;r ... (891 characters truncated) ...  style="color:gray">chapter 12 . <span data-xutime="1435544006">6/28/2015</span> </small><div style="margin-top:5px">Loving this! 3</div></td>\n</tr>'), ('2017-02-08 13:55:17.662274', 10788510, 221803585, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=749962&amp;rw ... (833 characters truncated) ... time="1434315366">6/14/2015</span> </small><div style="margin-top:5px">oh i love the interaction cant wait for the next installment</div></td>\n</tr>'), ('2017-02-08 13:55:17.662276', 10788510, 221802908, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=749962&amp;rw ... (858 characters truncated) ... 15</span> </small><div style="margin-top:5px">oh this is awesome but will harry remain as composed at seeing remus and sirius again</div></td>\n</tr>'), ('2017-02-08 13:55:17.662278', 10788510, 221802089, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=749962&amp;rw ... (812 characters truncated) ... er 8 . <span data-xutime="1434313207">6/14/2015</span> </small><div style="margin-top:5px">awesome using the elves is a better idea</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-08 13:55:17.662317', 10788510, 220973905, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=917358&amp;rw ... (934 characters truncated) ... 433">5/29/2015</span> </small><div style="margin-top:5px">Two weeks...would love every week its very good. Am ready for some Drarry</div></td>\n</tr>'), ('2017-02-08 13:55:17.662319', 10788510, 220954240, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4622308&amp;r ... (981 characters truncated) ... "margin-top:5px">Hello there, I was wondering do you plan to follow the pairings from the original story or will there be changes ?</div></td>\n</tr>'))]
05:55:17 reviews: Job OK (e061ad69-f2d4-44e2-8340-c2abe4534d97)
05:55:17 Result is kept for 500 seconds
05:55:17 
05:55:17 *** Listening on chapters, profiles, reviews...
05:55:17 reviews: fanfic.jobs.crawl_reviews(10788579) (25348faf-d275-465e-8066-6a2e8b46c333)
05:55:47 reviews: Job OK (25348faf-d275-465e-8066-6a2e8b46c333)
05:55:47 Result is kept for 500 seconds
05:55:47 
05:55:47 *** Listening on chapters, profiles, reviews...
05:55:47 reviews: fanfic.jobs.crawl_reviews(10788716) (69ad4c2c-823b-4495-99d5-99ce496f32db)
05:55:51 reviews: Job OK (69ad4c2c-823b-4495-99d5-99ce496f32db)
05:55:51 Result is kept for 500 seconds
05:55:51 
05:55:51 *** Listening on chapters, profiles, reviews...
05:55:51 reviews: fanfic.jobs.crawl_reviews(10788752) (e05e67ba-deeb-4eda-b9f9-04f5a15f8946)
05:56:05 reviews: Job OK (e05e67ba-deeb-4eda-b9f9-04f5a15f8946)
05:56:05 Result is kept for 500 seconds
05:56:05 
05:56:05 *** Listening on chapters, profiles, reviews...
05:56:05 reviews: fanfic.jobs.crawl_reviews(10789349) (0a591904-18b6-43db-a165-7ad3e8a6ce52)
05:57:36 reviews: Job OK (0a591904-18b6-43db-a165-7ad3e8a6ce52)
05:57:36 Result is kept for 500 seconds
05:57:36 
05:57:36 *** Listening on chapters, profiles, reviews...
05:57:36 reviews: fanfic.jobs.crawl_reviews(10789369) (670b5a1a-8a9b-4c65-bdec-66e1802dbe75)
05:57:50 reviews: Job OK (670b5a1a-8a9b-4c65-bdec-66e1802dbe75)
05:57:50 Result is kept for 500 seconds
05:57:50 
05:57:50 *** Listening on chapters, profiles, reviews...
05:57:50 reviews: fanfic.jobs.crawl_reviews(10790702) (c107993c-1e7a-4747-a38a-55bbd773f683)
05:59:39 reviews: Job OK (c107993c-1e7a-4747-a38a-55bbd773f683)
05:59:39 Result is kept for 500 seconds
05:59:39 
05:59:39 *** Listening on chapters, profiles, reviews...
05:59:39 reviews: fanfic.jobs.crawl_reviews(10791692) (8f2065a2-9346-41e1-af2f-49d4a49afbcf)
2017-02-08 05:59:44 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 13:59:44.816506', 10791692, 237075731, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4024771&amp;r ... (1322 characters truncated) ... ll be noticed.<br>\nAnyways I was happy to see your writing improve throughout the story. <br>\n<br>\nThank you for the great read.</div></td>\n</tr>'), ('2017-02-08 13:59:44.816510', 10791692, 218198922, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6394736&amp;r ... (901 characters truncated) ... y">chapter 5 . <span data-xutime="1428202441">4/4/2015</span> </small><div style="margin-top:5px">Nothing much about Harry and Cho?</div></td>\n</tr>'), ('2017-02-08 13:59:44.816513', 10791692, 217646901, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6394736&amp;r ... (881 characters truncated) ... all style="color:gray">chapter 4 . <span data-xutime="1427267623">3/25/2015</span> </small><div style="margin-top:5px">Update soon!</div></td>\n</tr>'), ('2017-02-08 13:59:44.816515', 10791692, 211983687, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (549 characters truncated) ... r 3 . <span data-xutime="1417894091">12/6/2014</span> </small><div style="margin-top:5px">plz update soon! i really like this story</div></td>\n</tr>'), ('2017-02-08 13:59:44.816517', 10791692, 211410597, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (537 characters truncated) ... hapter 3 . <span data-xutime="1417095354">11/27/2014</span> </small><div style="margin-top:5px">Please update! I love this so much!</div></td>\n</tr>'), ('2017-02-08 13:59:44.816518', 10791692, 211312573, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (539 characters truncated) ... er 1 . <span data-xutime="1416921346">11/25/2014</span> </small><div style="margin-top:5px">I love this fic and i hope u write more</div></td>\n</tr>'), ('2017-02-08 13:59:44.816520', 10791692, 210026193, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6248840&amp;r ... (1050 characters truncated) ... literally had to stop reading and fangirl XD And then the Adventures of Sherlock Holmes popped up and I died so yeah this is great!</div></td>\n</tr>'), ('2017-02-08 13:59:44.816522', 10791692, 237075731, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4024771&amp;r ... (1322 characters truncated) ... ll be noticed.<br>\nAnyways I was happy to see your writing improve throughout the story. <br>\n<br>\nThank you for the great read.</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-08 13:59:44.816532', 10791692, 211312573, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (539 characters truncated) ... er 1 . <span data-xutime="1416921346">11/25/2014</span> </small><div style="margin-top:5px">I love this fic and i hope u write more</div></td>\n</tr>'), ('2017-02-08 13:59:44.816533', 10791692, 210026193, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6248840&amp;r ... (1050 characters truncated) ... literally had to stop reading and fangirl XD And then the Adventures of Sherlock Holmes popped up and I died so yeah this is great!</div></td>\n</tr>'))]
05:59:44 reviews: Job OK (8f2065a2-9346-41e1-af2f-49d4a49afbcf)
05:59:44 Result is kept for 500 seconds
05:59:44 
05:59:44 *** Listening on chapters, profiles, reviews...
05:59:44 reviews: fanfic.jobs.crawl_reviews(10791885) (021bd884-6657-4e3f-861f-1ae5c5ed7528)
06:00:08 reviews: Job OK (021bd884-6657-4e3f-861f-1ae5c5ed7528)
06:00:08 Result is kept for 500 seconds
06:00:08 
06:00:08 *** Listening on chapters, profiles, reviews...
06:00:08 reviews: fanfic.jobs.crawl_reviews(10792737) (d69be622-c9dc-4c22-acfd-2bd98d81ae38)
06:00:28 reviews: Job OK (d69be622-c9dc-4c22-acfd-2bd98d81ae38)
06:00:28 Result is kept for 500 seconds
06:00:28 
06:00:28 *** Listening on chapters, profiles, reviews...
06:00:28 reviews: fanfic.jobs.crawl_reviews(10794986) (e9edc18b-cd5c-4d44-9aa6-80e39e4ffd76)
06:00:54 reviews: Job OK (e9edc18b-cd5c-4d44-9aa6-80e39e4ffd76)
06:00:54 Result is kept for 500 seconds
06:00:54 
06:00:54 *** Listening on chapters, profiles, reviews...
06:00:54 reviews: fanfic.jobs.crawl_reviews(10795545) (ade99bc8-29d0-4374-a0a4-8018e74d0290)
2017-02-08 06:00:58 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:00:58.970421', 10795545, 231132813, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2548838&amp;r ... (1055 characters truncated) ... and deals with students so well. Might be funny if Dumbledore or the Dumbledore portrait had a chat with Maurice about things... :)</div></td>\n</tr>'), ('2017-02-08 14:00:58.970426', 10795545, 231059252, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2548838&amp;r ... (1762 characters truncated) ...  it out yet, but it makes me happy to see more diversity with your characters and have one I can relate to more (and Ambrose too!).</div></td>\n</tr>'), ('2017-02-08 14:00:58.970428', 10795545, 219797113, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=477880&amp;rw ... (958 characters truncated) ...  considered part of the Heritage series? You used to have a list of all the books and their sub series\'... so was curious. Thanks.</div></td>\n</tr>'), ('2017-02-08 14:00:58.970430', 10795545, 219797030, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=477880&amp;rw ... (1038 characters truncated) ... nd I look forward to more! I love these books! Have read the series about... ahh... 4 times now I think. Maybe 3. But, anyway, yay!</div></td>\n</tr>'), ('2017-02-08 14:00:58.970432', 10795545, 210254958, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (523 characters truncated) ... or:gray">chapter 1 . <span data-xutime="1415105090">11/4/2014</span> </small><div style="margin-top:5px">So great to have you back!</div></td>\n</tr>'), ('2017-02-08 14:00:58.970434', 10795545, 231132813, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2548838&amp;r ... (1055 characters truncated) ... and deals with students so well. Might be funny if Dumbledore or the Dumbledore portrait had a chat with Maurice about things... :)</div></td>\n</tr>'), ('2017-02-08 14:00:58.970436', 10795545, 231059252, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2548838&amp;r ... (1762 characters truncated) ...  it out yet, but it makes me happy to see more diversity with your characters and have one I can relate to more (and Ambrose too!).</div></td>\n</tr>'), ('2017-02-08 14:00:58.970438', 10795545, 219797113, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=477880&amp;rw ... (958 characters truncated) ...  considered part of the Heritage series? You used to have a list of all the books and their sub series\'... so was curious. Thanks.</div></td>\n</tr>'), ('2017-02-08 14:00:58.970440', 10795545, 219797030, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=477880&amp;rw ... (1038 characters truncated) ... nd I look forward to more! I love these books! Have read the series about... ahh... 4 times now I think. Maybe 3. But, anyway, yay!</div></td>\n</tr>'), ('2017-02-08 14:00:58.970441', 10795545, 210254958, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (523 characters truncated) ... or:gray">chapter 1 . <span data-xutime="1415105090">11/4/2014</span> </small><div style="margin-top:5px">So great to have you back!</div></td>\n</tr>'))]
06:00:58 reviews: Job OK (ade99bc8-29d0-4374-a0a4-8018e74d0290)
06:00:58 Result is kept for 500 seconds
06:00:59 
06:00:59 *** Listening on chapters, profiles, reviews...
06:00:59 reviews: fanfic.jobs.crawl_reviews(10795820) (e57dd6cd-1252-46df-b0bc-2658b2a3ea1a)
06:01:08 reviews: Job OK (e57dd6cd-1252-46df-b0bc-2658b2a3ea1a)
06:01:08 Result is kept for 500 seconds
06:01:08 
06:01:08 *** Listening on chapters, profiles, reviews...
06:01:08 reviews: fanfic.jobs.crawl_reviews(10797119) (75b307fd-0120-4b48-936c-f7408df1922f)
2017-02-08 06:01:12 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:01:12.960629', 10797119, 224073661, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5644982&amp;r ... (910 characters truncated) ... er 31 . <span data-xutime="1437939827">7/26/2015</span> </small><div style="margin-top:5px">I hope John and Liza get back together.</div></td>\n</tr>'), ('2017-02-08 14:01:12.960633', 10797119, 223468131, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (1044 characters truncated) ... l you I really love your stories! Finally the secret is out, i hope Harry will not to be too angry with Liza. Update soon ciao ciao</div></td>\n</tr>'), ('2017-02-08 14:01:12.960635', 10797119, 223381584, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5644982&amp;r ... (920 characters truncated) ... pan data-xutime="1436838901">7/13/2015</span> </small><div style="margin-top:5px">Harry kind of a jerk during The Order of Phoenix.</div></td>\n</tr>'), ('2017-02-08 14:01:12.960637', 10797119, 223288506, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2293010&amp;r ... (882 characters truncated) ... argin-top:5px">And honestly, after Harry, I would\'ve possibly picked Dean.<br>\nI always thought it should have been Dean as well.</div></td>\n</tr>'), ('2017-02-08 14:01:12.960639', 10797119, 223285496, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2293010&amp;r ... (1093 characters truncated) ... e way she said that. After all if she had realised the rat was living too long Peter may have been caught and Sirius would be free.</div></td>\n</tr>'), ('2017-02-08 14:01:12.960641', 10797119, 210390159, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4403642&amp;r ... (871 characters truncated) ... mall style="color:gray">chapter 4 . <span data-xutime="1415339290">11/6/2014</span> </small><div style="margin-top:5px">Wow love it</div></td>\n</tr>'), ('2017-02-08 14:01:12.960643', 10797119, 210136863, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4403642&amp;r ... (874 characters truncated) ... l style="color:gray">chapter 2 . <span data-xutime="1414915501">11/2/2014</span> </small><div style="margin-top:5px">Yay! I love it</div></td>\n</tr>'), ('2017-02-08 14:01:12.960645', 10797119, 224073661, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5644982&amp;r ... (910 characters truncated) ... er 31 . <span data-xutime="1437939827">7/26/2015</span> </small><div style="margin-top:5px">I hope John and Liza get back together.</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-08 14:01:12.960655', 10797119, 210390159, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4403642&amp;r ... (871 characters truncated) ... mall style="color:gray">chapter 4 . <span data-xutime="1415339290">11/6/2014</span> </small><div style="margin-top:5px">Wow love it</div></td>\n</tr>'), ('2017-02-08 14:01:12.960656', 10797119, 210136863, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4403642&amp;r ... (874 characters truncated) ... l style="color:gray">chapter 2 . <span data-xutime="1414915501">11/2/2014</span> </small><div style="margin-top:5px">Yay! I love it</div></td>\n</tr>'))]
06:01:12 reviews: Job OK (75b307fd-0120-4b48-936c-f7408df1922f)
06:01:12 Result is kept for 500 seconds
06:01:12 
06:01:12 *** Listening on chapters, profiles, reviews...
06:01:12 reviews: fanfic.jobs.crawl_reviews(10800001) (fb12ba5a-045b-4330-b520-54c7b15f0a99)
06:01:45 reviews: Job OK (fb12ba5a-045b-4330-b520-54c7b15f0a99)
06:01:45 Result is kept for 500 seconds
06:01:45 
06:01:45 *** Listening on chapters, profiles, reviews...
06:01:45 reviews: fanfic.jobs.crawl_reviews(10800946) (8179d02e-2cb6-4577-903b-87fabcd08f75)
06:02:12 reviews: Job OK (8179d02e-2cb6-4577-903b-87fabcd08f75)
06:02:12 Result is kept for 500 seconds
06:02:12 
06:02:12 *** Listening on chapters, profiles, reviews...
06:02:12 reviews: fanfic.jobs.crawl_reviews(10802022) (ad13989c-6f2a-48ce-a9d3-18177724af33)
06:02:59 reviews: Job OK (ad13989c-6f2a-48ce-a9d3-18177724af33)
06:02:59 Result is kept for 500 seconds
06:02:59 
06:02:59 *** Listening on chapters, profiles, reviews...
06:02:59 reviews: fanfic.jobs.crawl_reviews(10802789) (d00318de-6f4e-4ed5-b9bc-432a6b8d7ed5)
2017-02-08 06:03:04 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:03:04.622011', 10802789, 219155156, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6646678&amp;r ... (936 characters truncated) ... xutime="1429768366">4/22/2015</span> </small><div style="margin-top:5px">This was incredible I cried and laughed loved all of it :)</div></td>\n</tr>'), ('2017-02-08 14:03:04.622015', 10802789, 214078455, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6254893&amp;r ... (1007 characters truncated) ... it I know this is a completed story but I just felt the need to re read it again :)<br>\nlove your work as always :) keep it up LB.</div></td>\n</tr>'), ('2017-02-08 14:03:04.622018', 10802789, 219155156, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6646678&amp;r ... (936 characters truncated) ... xutime="1429768366">4/22/2015</span> </small><div style="margin-top:5px">This was incredible I cried and laughed loved all of it :)</div></td>\n</tr>'), ('2017-02-08 14:03:04.622020', 10802789, 214078455, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6254893&amp;r ... (1007 characters truncated) ... it I know this is a completed story but I just felt the need to re read it again :)<br>\nlove your work as always :) keep it up LB.</div></td>\n</tr>'))]
06:03:04 reviews: Job OK (d00318de-6f4e-4ed5-b9bc-432a6b8d7ed5)
06:03:04 Result is kept for 500 seconds
06:03:04 
06:03:04 *** Listening on chapters, profiles, reviews...
06:03:04 reviews: fanfic.jobs.crawl_reviews(10803030) (6f0ce4df-9987-4843-8c68-11283c9930a2)
06:03:53 reviews: Job OK (6f0ce4df-9987-4843-8c68-11283c9930a2)
06:03:53 Result is kept for 500 seconds
06:03:53 
06:03:53 *** Listening on chapters, profiles, reviews...
06:03:53 reviews: fanfic.jobs.crawl_reviews(10803107) (00b9b665-2481-4724-929b-8290e63c8bbb)
06:03:58 reviews: Job OK (00b9b665-2481-4724-929b-8290e63c8bbb)
06:03:58 Result is kept for 500 seconds
06:03:58 
06:03:58 *** Listening on chapters, profiles, reviews...
06:03:58 reviews: fanfic.jobs.crawl_reviews(10803321) (e621cd2a-d550-4f3e-84ec-834b51296203)
06:04:26 reviews: Job OK (e621cd2a-d550-4f3e-84ec-834b51296203)
06:04:26 Result is kept for 500 seconds
06:04:26 
06:04:26 *** Listening on chapters, profiles, reviews...
06:04:26 reviews: fanfic.jobs.crawl_reviews(10804018) (5dcc04ae-321c-41df-b7a3-608aab4998e9)
06:05:03 reviews: Job OK (5dcc04ae-321c-41df-b7a3-608aab4998e9)
06:05:03 Result is kept for 500 seconds
06:05:03 
06:05:03 *** Listening on chapters, profiles, reviews...
06:05:03 reviews: fanfic.jobs.crawl_reviews(10804207) (0d359603-2e65-401d-84fd-305eac03cd8c)
2017-02-08 06:05:07 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:05:07.107800', 10804207, 238516125, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (809 characters truncated) ... is older painted persona to be that of a knight from the 11th or 12th century.<br>\n<br>\nDefinitely interested on reading more. :)</div></td>\n</tr>'), ('2017-02-08 14:05:07.107804', 10804207, 212376963, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6191075&amp;r ... (1185 characters truncated) ... ne. And I have a theory that the fair haired woman is Helga Hufflepuff. Please update so I can find out if my theory is correct. ;)</div></td>\n</tr>'), ('2017-02-08 14:05:07.107806', 10804207, 210652928, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1746253&amp;r ... (840 characters truncated) ... ="1415768552">11/11/2014</span> </small><div style="margin-top:5px">Interesting introduction. I\'m looking forward to reading more.</div></td>\n</tr>'), ('2017-02-08 14:05:07.107808', 10804207, 238516125, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (809 characters truncated) ... is older painted persona to be that of a knight from the 11th or 12th century.<br>\n<br>\nDefinitely interested on reading more. :)</div></td>\n</tr>'), ('2017-02-08 14:05:07.107810', 10804207, 212376963, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6191075&amp;r ... (1185 characters truncated) ... ne. And I have a theory that the fair haired woman is Helga Hufflepuff. Please update so I can find out if my theory is correct. ;)</div></td>\n</tr>'), ('2017-02-08 14:05:07.107812', 10804207, 210652928, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1746253&amp;r ... (840 characters truncated) ... ="1415768552">11/11/2014</span> </small><div style="margin-top:5px">Interesting introduction. I\'m looking forward to reading more.</div></td>\n</tr>'))]
06:05:07 reviews: Job OK (0d359603-2e65-401d-84fd-305eac03cd8c)
06:05:07 Result is kept for 500 seconds
06:05:07 
06:05:07 *** Listening on chapters, profiles, reviews...
06:05:07 reviews: fanfic.jobs.crawl_reviews(10806083) (489e7014-6c44-444f-9a28-c227fd774d88)
2017-02-08 06:05:13 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:05:13.038278', 10806083, 234905012, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6171472&amp;r ... (976 characters truncated) ... mall><div style="margin-top:5px">I just binge read this fucking and I honestly love your style do much and cannot wait for the rest</div></td>\n</tr>'), ('2017-02-08 14:05:13.038283', 10806083, 225735829, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (545 characters truncated) ... span data-xutime="1440571050">8/25/2015</span> </small><div style="margin-top:5px">yes pleeease continue it i love this fic so much</div></td>\n</tr>'), ('2017-02-08 14:05:13.038286', 10806083, 225679917, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4217196&amp;r ... (861 characters truncated) ... utime="1440641797">8/26/2015</span> </small><div style="margin-top:5px">I really love this and I hope you will continue writing it!</div></td>\n</tr>'), ('2017-02-08 14:05:13.038288', 10806083, 225646830, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4470783&amp;r ... (869 characters truncated) ... e="1440583502">8/26/2015</span> </small><div style="margin-top:5px">You should definitley finish it! 4 more chapters sounds perfect</div></td>\n</tr>'), ('2017-02-08 14:05:13.038290', 10806083, 224885676, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4470783&amp;r ... (843 characters truncated) ... apter 8 . <span data-xutime="1439257374">8/10/2015</span> </small><div style="margin-top:5px">i love this story please continue it!</div></td>\n</tr>'), ('2017-02-08 14:05:13.038292', 10806083, 223589224, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (818 characters truncated) ... no activities, I would be very upset that there was finally an event, but I wasn\'t allowed to go. Besides, it\'s so middle school!</div></td>\n</tr>'), ('2017-02-08 14:05:13.038294', 10806083, 223563945, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (685 characters truncated) ... lly stating that you don\'t own Harry Potter. Great story, although a little bittersweet. Their ending was the first canon chapter.</div></td>\n</tr>'), ('2017-02-08 14:05:13.038296', 10806083, 223456851, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6236144&amp;r ... (797 characters truncated) ... <small style="color:gray">chapter 8 . <span data-xutime="1436957727">7/15/2015</span> </small><div style="margin-top:5px">its close</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-08 14:05:13.038344', 10806083, 210762745, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5512249&amp;r ... (946 characters truncated) ...  3 . <span data-xutime="1415975433">11/14/2014</span> </small><div style="margin-top:5px">Good... Might deserve an honorary mention</div></td>\n</tr>'), ('2017-02-08 14:05:13.038347', 10806083, 210754674, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5512249&amp;r ... (1275 characters truncated) ...  Prize 2014. I am going to see your story further if it is worth nomination. For info search Fanfiction Booker Prize 2014 in the c2</div></td>\n</tr>'))]
06:05:13 reviews: Job OK (489e7014-6c44-444f-9a28-c227fd774d88)
06:05:13 Result is kept for 500 seconds
06:05:13 
06:05:13 *** Listening on chapters, profiles, reviews...
06:05:13 reviews: fanfic.jobs.crawl_reviews(10806123) (42965d9a-08c3-4e99-8b85-af9468bc54e6)
2017-02-08 06:05:18 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:05:18.709239', 10806123, 239122761, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8011005&amp;r ... (912 characters truncated) ... px">I love this. This is one of my favorite stories. I need you to write more. I want to know what will happen to the black sisters</div></td>\n</tr>'), ('2017-02-08 14:05:18.709244', 10806123, 239122761, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8011005&amp;r ... (912 characters truncated) ... px">I love this. This is one of my favorite stories. I need you to write more. I want to know what will happen to the black sisters</div></td>\n</tr>'))]
06:05:18 reviews: Job OK (42965d9a-08c3-4e99-8b85-af9468bc54e6)
06:05:18 Result is kept for 500 seconds
06:05:18 
06:05:18 *** Listening on chapters, profiles, reviews...
06:05:18 reviews: fanfic.jobs.crawl_reviews(10807718) (fb9ec2de-5f14-4bde-b083-ced0e55a4ff1)
06:10:33 reviews: Job OK (fb9ec2de-5f14-4bde-b083-ced0e55a4ff1)
06:10:33 Result is kept for 500 seconds
06:10:33 
06:10:33 *** Listening on chapters, profiles, reviews...
06:10:33 reviews: fanfic.jobs.crawl_reviews(10808012) (860de100-b92e-45c2-b7fb-6abb1112b03e)
06:11:51 reviews: Job OK (860de100-b92e-45c2-b7fb-6abb1112b03e)
06:11:51 Result is kept for 500 seconds
06:11:51 
06:11:51 *** Listening on chapters, profiles, reviews...
06:11:51 reviews: fanfic.jobs.crawl_reviews(10808106) (b52f96c4-7a03-4fcf-bcef-f3a95a80deca)
06:14:34 reviews: Job OK (b52f96c4-7a03-4fcf-bcef-f3a95a80deca)
06:14:34 Result is kept for 500 seconds
06:14:34 
06:14:34 *** Listening on chapters, profiles, reviews...
06:14:34 reviews: fanfic.jobs.crawl_reviews(10808355) (1d56adae-7fa6-42bd-8d22-3a5da6424c0b)
06:16:43 reviews: Job OK (1d56adae-7fa6-42bd-8d22-3a5da6424c0b)
06:16:43 Result is kept for 500 seconds
06:16:43 
06:16:43 *** Listening on chapters, profiles, reviews...
06:16:43 reviews: fanfic.jobs.crawl_reviews(10808489) (b2a6ebfe-d377-4b39-87c1-b03c8008993c)
06:17:09 reviews: Job OK (b2a6ebfe-d377-4b39-87c1-b03c8008993c)
06:17:09 Result is kept for 500 seconds
06:17:09 
06:17:09 *** Listening on chapters, profiles, reviews...
06:17:09 reviews: fanfic.jobs.crawl_reviews(10809701) (88d35750-551f-49a6-9ce6-ac6b7685fe79)
06:19:04 reviews: Job OK (88d35750-551f-49a6-9ce6-ac6b7685fe79)
06:19:04 Result is kept for 500 seconds
06:19:04 
06:19:04 *** Listening on chapters, profiles, reviews...
06:19:04 reviews: fanfic.jobs.crawl_reviews(10811055) (777d5ba3-c492-49d5-a9f0-0f00645049fd)
06:19:22 reviews: Job OK (777d5ba3-c492-49d5-a9f0-0f00645049fd)
06:19:22 Result is kept for 500 seconds
06:19:22 
06:19:22 *** Listening on chapters, profiles, reviews...
06:19:22 reviews: fanfic.jobs.crawl_reviews(10811493) (2a4578d4-3b51-44d4-a8b8-6358aa2c55c1)
06:19:39 reviews: Job OK (2a4578d4-3b51-44d4-a8b8-6358aa2c55c1)
06:19:39 Result is kept for 500 seconds
06:19:39 
06:19:39 *** Listening on chapters, profiles, reviews...
06:19:39 reviews: fanfic.jobs.crawl_reviews(10812333) (e9a377aa-ad14-42ec-b30b-c356f6b5ccab)
06:20:46 reviews: Job OK (e9a377aa-ad14-42ec-b30b-c356f6b5ccab)
06:20:46 Result is kept for 500 seconds
06:20:46 
06:20:46 *** Listening on chapters, profiles, reviews...
06:20:46 reviews: fanfic.jobs.crawl_reviews(10812653) (d9d1e707-3dd5-4906-89b7-78bf29197fd5)
2017-02-08 06:20:51 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:20:51.874797', 10812653, 230186570, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2732055&amp;r ... (883 characters truncated) ... ter 3 . <span data-xutime="1449793326">12/10/2015</span> </small><div style="margin-top:5px">Wonderful story, thanks for posting :)</div></td>\n</tr>'), ('2017-02-08 14:20:51.874802', 10812653, 230177203, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2732055&amp;r ... (971 characters truncated) ... 5px">I have to say, your French is not half bad, even with it being insults ;) I loove this story so much! 3 Thank you for posting!</div></td>\n</tr>'), ('2017-02-08 14:20:51.874804', 10812653, 228926051, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1631886&amp;r ... (935 characters truncated) ... 1/10/2015</span> </small><div style="margin-top:5px">I LOVE this. I have always loved Severus and I hope that this story continues.</div></td>\n</tr>'), ('2017-02-08 14:20:51.874806', 10812653, 228296477, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4189865&amp;r ... (907 characters truncated) ... ter 3 . <span data-xutime="1445898267">10/26/2015</span> </small><div style="margin-top:5px">This is brilliant so far! Update soon!</div></td>\n</tr>'), ('2017-02-08 14:20:51.874808', 10812653, 228269121, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4448012&amp;r ... (890 characters truncated) ... hapter 3 . <span data-xutime="1445840115">10/25/2015</span> </small><div style="margin-top:5px">I can\'t wait for the next chapter.</div></td>\n</tr>'), ('2017-02-08 14:20:51.874810', 10812653, 223008787, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=317278&amp;rw ... (912 characters truncated) ... me="1436247979">7/6/2015</span> </small><div style="margin-top:5px">I love this! Great ideas and good story line! Please post more!</div></td>\n</tr>'), ('2017-02-08 14:20:51.874812', 10812653, 221231135, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (567 characters truncated) ... 181354">6/1/2015</span> </small><div style="margin-top:5px">Very nice. Though I hope you take less than a year to update this time.</div></td>\n</tr>'), ('2017-02-08 14:20:51.874814', 10812653, 220270356, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (541 characters truncated) ... er 2 . <span data-xutime="1431554555">5/13/2015</span> </small><div style="margin-top:5px">Please update,your story is magnificent.</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-08 14:20:51.874850', 10812653, 213823052, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (579 characters truncated) ... 2015</span> </small><div style="margin-top:5px">This is waaaaaY too addicting!<br>\n<br>\nWaiting patiently for your next update :*</div></td>\n</tr>'), ('2017-02-08 14:20:51.874852', 10812653, 211216093, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (591 characters truncated) ... 4</span> </small><div style="margin-top:5px">I quite like the tenseness of this story it makes it interesting I wanna read more! :D</div></td>\n</tr>'))]
06:20:51 reviews: Job OK (d9d1e707-3dd5-4906-89b7-78bf29197fd5)
06:20:51 Result is kept for 500 seconds
06:20:51 
06:20:51 *** Listening on chapters, profiles, reviews...
06:20:51 reviews: fanfic.jobs.crawl_reviews(10812901) (d77c8db6-23ef-4b88-9269-4fad2f2651f0)
06:25:35 reviews: Job OK (d77c8db6-23ef-4b88-9269-4fad2f2651f0)
06:25:35 Result is kept for 500 seconds
06:25:35 
06:25:35 *** Listening on chapters, profiles, reviews...
06:25:35 reviews: fanfic.jobs.crawl_reviews(10813349) (ebe93e89-f3cf-4fbd-8a52-bd13a08e5297)
06:26:00 reviews: Job OK (ebe93e89-f3cf-4fbd-8a52-bd13a08e5297)
06:26:00 Result is kept for 500 seconds
06:26:00 
06:26:00 *** Listening on chapters, profiles, reviews...
06:26:00 reviews: fanfic.jobs.crawl_reviews(10813512) (9eebb191-ef5c-4030-9853-c909eefeb933)
06:27:15 reviews: Job OK (9eebb191-ef5c-4030-9853-c909eefeb933)
06:27:15 Result is kept for 500 seconds
06:27:15 
06:27:15 *** Listening on chapters, profiles, reviews...
06:27:15 reviews: fanfic.jobs.crawl_reviews(10813793) (940ed534-3f45-4161-9476-687b695e072e)
06:27:26 reviews: Job OK (940ed534-3f45-4161-9476-687b695e072e)
06:27:26 Result is kept for 500 seconds
06:27:26 
06:27:26 *** Listening on chapters, profiles, reviews...
06:27:26 reviews: fanfic.jobs.crawl_reviews(10819923) (05764241-6921-4e51-b34e-4371ff1b81e6)
06:27:53 reviews: Job OK (05764241-6921-4e51-b34e-4371ff1b81e6)
06:27:53 Result is kept for 500 seconds
06:27:53 
06:27:53 *** Listening on chapters, profiles, reviews...
06:27:53 reviews: fanfic.jobs.crawl_reviews(10819991) (75d30a79-44f6-4105-b728-5c176a7439ab)
06:27:58 reviews: Job OK (75d30a79-44f6-4105-b728-5c176a7439ab)
06:27:58 Result is kept for 500 seconds
06:27:58 
06:27:58 *** Listening on chapters, profiles, reviews...
06:27:58 reviews: fanfic.jobs.crawl_reviews(10820093) (c85498c0-fff4-48bf-8833-b1a407312719)
06:28:35 reviews: Job OK (c85498c0-fff4-48bf-8833-b1a407312719)
06:28:35 Result is kept for 500 seconds
06:28:35 
06:28:35 *** Listening on chapters, profiles, reviews...
06:28:35 reviews: fanfic.jobs.crawl_reviews(10821508) (570dc70b-6702-4816-86dc-b05307449cef)
06:29:22 reviews: Job OK (570dc70b-6702-4816-86dc-b05307449cef)
06:29:22 Result is kept for 500 seconds
06:29:22 
06:29:22 *** Listening on chapters, profiles, reviews...
06:29:22 reviews: fanfic.jobs.crawl_reviews(10822825) (384ef96d-ad75-413f-985f-a7d6a1ff8d82)
06:30:47 reviews: Job OK (384ef96d-ad75-413f-985f-a7d6a1ff8d82)
06:30:47 Result is kept for 500 seconds
06:30:47 Cleaning registries for queue: chapters
06:30:47 Cleaning registries for queue: profiles
06:30:47 Cleaning registries for queue: reviews
06:30:47 
06:30:47 *** Listening on chapters, profiles, reviews...
06:30:47 reviews: fanfic.jobs.crawl_reviews(10822887) (534e5b78-d422-45b5-b870-872370136b18)
06:31:00 reviews: Job OK (534e5b78-d422-45b5-b870-872370136b18)
06:31:00 Result is kept for 500 seconds
06:31:00 
06:31:00 *** Listening on chapters, profiles, reviews...
06:31:00 reviews: fanfic.jobs.crawl_reviews(10824482) (eb2ae992-7fa2-429f-aab0-9837442f6932)
06:31:05 reviews: Job OK (eb2ae992-7fa2-429f-aab0-9837442f6932)
06:31:05 Result is kept for 500 seconds
06:31:05 
06:31:05 *** Listening on chapters, profiles, reviews...
06:31:05 reviews: fanfic.jobs.crawl_reviews(10825905) (8e20847f-1363-47f3-a972-d04ed549c747)
06:32:09 reviews: Job OK (8e20847f-1363-47f3-a972-d04ed549c747)
06:32:09 Result is kept for 500 seconds
06:32:09 
06:32:09 *** Listening on chapters, profiles, reviews...
06:32:09 reviews: fanfic.jobs.crawl_reviews(10826702) (32f754a0-c0da-4be6-9c3f-dea550b76cdc)
06:33:03 reviews: Job OK (32f754a0-c0da-4be6-9c3f-dea550b76cdc)
06:33:03 Result is kept for 500 seconds
06:33:03 
06:33:03 *** Listening on chapters, profiles, reviews...
06:33:03 reviews: fanfic.jobs.crawl_reviews(10826727) (1e84506e-7a7b-4a0f-86b7-f380c96cb65c)
06:34:28 reviews: Job OK (1e84506e-7a7b-4a0f-86b7-f380c96cb65c)
06:34:28 Result is kept for 500 seconds
06:34:28 
06:34:28 *** Listening on chapters, profiles, reviews...
06:34:28 reviews: fanfic.jobs.crawl_reviews(10827546) (b2142487-a733-4d22-95df-f49c8682066b)
06:34:41 reviews: Job OK (b2142487-a733-4d22-95df-f49c8682066b)
06:34:41 Result is kept for 500 seconds
06:34:41 
06:34:41 *** Listening on chapters, profiles, reviews...
06:34:41 reviews: fanfic.jobs.crawl_reviews(10827744) (510270e6-c301-492d-b5e4-7dfe9a3c2749)
06:35:32 reviews: Job OK (510270e6-c301-492d-b5e4-7dfe9a3c2749)
06:35:32 Result is kept for 500 seconds
06:35:32 
06:35:32 *** Listening on chapters, profiles, reviews...
06:35:32 reviews: fanfic.jobs.crawl_reviews(10829577) (ce2ac154-abfa-4b7a-8a0b-c246d8b0e500)
06:35:36 reviews: Job OK (ce2ac154-abfa-4b7a-8a0b-c246d8b0e500)
06:35:36 Result is kept for 500 seconds
06:35:36 
06:35:36 *** Listening on chapters, profiles, reviews...
06:35:36 reviews: fanfic.jobs.crawl_reviews(10829993) (d9b8bbe5-8ad2-4127-b1da-a4d6c674095f)
2017-02-08 06:35:42 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:35:42.836373', 10829993, 236112601, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6236144&amp;r ... (964 characters truncated) ... ly and its nowe because they actually like each other well lily does and james loves lily too much tension needs to happen soon lol</div></td>\n</tr>'), ('2017-02-08 14:35:42.836377', 10829993, 232898023, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7093096&amp;r ... (1225 characters truncated) ... rs though.<br>\nNever stop writing this is brilliant. I hope u update soon because this is amazing I need more and more.<br>\nAlyia</div></td>\n</tr>'), ('2017-02-08 14:35:42.836379', 10829993, 229635181, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4705827&amp;r ... (832 characters truncated) ... n data-xutime="1448665510">11/27/2015</span> </small><div style="margin-top:5px">I love this story and I can\'t wait to read moreee</div></td>\n</tr>'), ('2017-02-08 14:35:42.836381', 10829993, 229252082, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6228726&amp;r ... (882 characters truncated) ... /span> </small><div style="margin-top:5px">Really enjoyed this so far looking forward to more updates and seeing blackinnon develop</div></td>\n</tr>'), ('2017-02-08 14:35:42.836383', 10829993, 228160285, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (616 characters truncated) ... gin-top:5px">THIS IS GREAT! CAN U PLEASE ADD MORE TO I\'M IN YOUR VEINS STORY? PRETTY PLEASE WITH SPRINKLES AND FROSTING AND CAKE !</div></td>\n</tr>'), ('2017-02-08 14:35:42.836385', 10829993, 228158018, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (519 characters truncated) ... "color:gray">chapter 10 . <span data-xutime="1445630730">10/23/2015</span> </small><div style="margin-top:5px">Are you writing mor?</div></td>\n</tr>'), ('2017-02-08 14:35:42.836387', 10829993, 225958833, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6284699&amp;r ... (825 characters truncated) ... r 8 . <span data-xutime="1441237642">9/2/2015</span> </small><div style="margin-top:5px">I hope the dad leaves the mom with Marlene</div></td>\n</tr>'), ('2017-02-08 14:35:42.836389', 10829993, 224348221, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6228726&amp;r ... (917 characters truncated) ... :5px">Really enjoyed this so far, just wandering if you\'ll be updating anytime soon! And if you still plan on going up until 1981?</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-08 14:35:42.836413', 10829993, 213207217, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (770 characters truncated) ... en more. Also aside from Jily, Blackinnon is my another otp. So this story is a triple bonus for me.<br>\nCan\'t wait to read more.</div></td>\n</tr>'), ('2017-02-08 14:35:42.836415', 10829993, 213070092, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (503 characters truncated) ... st <small style="color:gray">chapter 6 . <span data-xutime="1419900279">12/29/2014</span> </small><div style="margin-top:5px">More!</div></td>\n</tr>'))]
06:35:42 reviews: Job OK (d9b8bbe5-8ad2-4127-b1da-a4d6c674095f)
06:35:42 Result is kept for 500 seconds
06:35:42 
06:35:42 *** Listening on chapters, profiles, reviews...
06:35:42 reviews: fanfic.jobs.crawl_reviews(10831223) (152221eb-a706-4a85-a207-77af1a7a3105)
06:37:09 reviews: Job OK (152221eb-a706-4a85-a207-77af1a7a3105)
06:37:09 Result is kept for 500 seconds
06:37:09 
06:37:09 *** Listening on chapters, profiles, reviews...
06:37:09 reviews: fanfic.jobs.crawl_reviews(10831723) (f8d894fd-51bb-48e9-9b93-c7c414427119)
06:44:39 reviews: Job OK (f8d894fd-51bb-48e9-9b93-c7c414427119)
06:44:39 Result is kept for 500 seconds
06:44:39 
06:44:39 *** Listening on chapters, profiles, reviews...
06:44:39 reviews: fanfic.jobs.crawl_reviews(10832262) (978e2040-b15d-4331-97b9-5bce3cf0fd3f)
06:46:53 reviews: Job OK (978e2040-b15d-4331-97b9-5bce3cf0fd3f)
06:46:53 Result is kept for 500 seconds
06:46:53 
06:46:53 *** Listening on chapters, profiles, reviews...
06:46:53 reviews: fanfic.jobs.crawl_reviews(10832862) (d3ca200f-95ed-48ea-ae1f-462887913990)
06:47:31 reviews: Job OK (d3ca200f-95ed-48ea-ae1f-462887913990)
06:47:31 Result is kept for 500 seconds
06:47:31 
06:47:31 *** Listening on chapters, profiles, reviews...
06:47:31 reviews: fanfic.jobs.crawl_reviews(10834818) (00473aa2-8792-46bb-8b3e-c4ed819fcf49)
06:47:37 reviews: Job OK (00473aa2-8792-46bb-8b3e-c4ed819fcf49)
06:47:37 Result is kept for 500 seconds
06:47:37 
06:47:37 *** Listening on chapters, profiles, reviews...
06:47:37 reviews: fanfic.jobs.crawl_reviews(10835128) (f3b739d2-d2bc-4323-ba3e-ff3f4b91c93a)
06:48:02 reviews: Job OK (f3b739d2-d2bc-4323-ba3e-ff3f4b91c93a)
06:48:02 Result is kept for 500 seconds
06:48:02 
06:48:02 *** Listening on chapters, profiles, reviews...
06:48:02 reviews: fanfic.jobs.crawl_reviews(10836079) (46b52148-102c-4dc8-b645-a60eddd7667c)
06:49:17 reviews: Job OK (46b52148-102c-4dc8-b645-a60eddd7667c)
06:49:17 Result is kept for 500 seconds
06:49:17 
06:49:17 *** Listening on chapters, profiles, reviews...
06:49:17 reviews: fanfic.jobs.crawl_reviews(10837621) (163bd8cb-0e72-436c-8e89-b2743109053b)
2017-02-08 06:49:21 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:49:21.611819', 10837621, 229728862, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3797291&amp;r ... (1300 characters truncated) ...  I mean come on the future wife of harry and the only time she is important besides being a love interest is when she is possessed?</div></td>\n</tr>'), ('2017-02-08 14:49:21.611824', 10837621, 218647250, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1852524&amp;r ... (1094 characters truncated) ... ay that you are a wonderful writer and I love your stories. I could not stop reading and look forward to the rest of Romi\'s story.</div></td>\n</tr>'), ('2017-02-08 14:49:21.611826', 10837621, 229728862, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3797291&amp;r ... (1300 characters truncated) ...  I mean come on the future wife of harry and the only time she is important besides being a love interest is when she is possessed?</div></td>\n</tr>'), ('2017-02-08 14:49:21.611828', 10837621, 218647250, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1852524&amp;r ... (1094 characters truncated) ... ay that you are a wonderful writer and I love your stories. I could not stop reading and look forward to the rest of Romi\'s story.</div></td>\n</tr>'))]
06:49:21 reviews: Job OK (163bd8cb-0e72-436c-8e89-b2743109053b)
06:49:21 Result is kept for 500 seconds
06:49:21 
06:49:21 *** Listening on chapters, profiles, reviews...
06:49:21 reviews: fanfic.jobs.crawl_reviews(10837680) (dfc8d380-fe0c-4f02-bb6d-3dd30649376c)
2017-02-08 06:49:25 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:49:25.521274', 10837680, 244427977, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (768 characters truncated) ... e reviews, it\'s absolutely fantastic. I\'m hoping you update soon, waiting for months for a new chapter is rather painful lmao. Xx</div></td>\n</tr>'), ('2017-02-08 14:49:25.521278', 10837680, 243159326, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1506695&amp;r ... (942 characters truncated) ... my and good that Kreacher is out of the picture but I\'m surprised they didn\'t ask him about the hidden goods. Thanks for sharing!</div></td>\n</tr>'), ('2017-02-08 14:49:25.521281', 10837680, 243158604, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1506695&amp;r ... (917 characters truncated) ... n-top:5px">I like the fact that some people are actually starting to defend Harry and help in keeping him safe. Thanks for sharing!</div></td>\n</tr>'), ('2017-02-08 14:49:25.521283', 10837680, 243154756, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1506695&amp;r ... (898 characters truncated) ... l><div style="margin-top:5px">Fun interaction between Amy and Sirius not to mention the help she is giving him. Thanks for sharing!</div></td>\n</tr>'), ('2017-02-08 14:49:25.521285', 10837680, 243152787, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1506695&amp;r ... (882 characters truncated) ... 6</span> </small><div style="margin-top:5px">The Order seems to be in a great deal of disorder. Fun chapter and thanks for sharing!</div></td>\n</tr>'), ('2017-02-08 14:49:25.521287', 10837680, 243152259, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1506695&amp;r ... (886 characters truncated) ... pan> </small><div style="margin-top:5px">Great chapter and Severus really did need a beatdown for his comments. Thanks for sharing!</div></td>\n</tr>'), ('2017-02-08 14:49:25.521288', 10837680, 243151787, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1506695&amp;r ... (852 characters truncated) ... -xutime="1477054899">10/21/2016</span> </small><div style="margin-top:5px">Nice bit of kidnapping for the trio. Thanks for sharing!</div></td>\n</tr>'), ('2017-02-08 14:49:25.521290', 10837680, 243151539, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1506695&amp;r ... (870 characters truncated) ... 2">10/21/2016</span> </small><div style="margin-top:5px">Looks like Sirius has some assistance with Harry, lol. Thanks for sharing!</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-08 14:49:25.521326', 10837680, 223594083, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3364922&amp;r ... (1248 characters truncated) ... en they get back, isn\'t he? That\'s what her bad feeling is. D:<br>\nPlease update soon, I really love this story!<br>\n- Angel. X</div></td>\n</tr>'), ('2017-02-08 14:49:25.521328', 10837680, 221556669, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (801 characters truncated) ... oyfriend treat her like shit. <br>\n<br>\noh and the pairing I want is Amy &amp; Sirius...if she can stop acting like a weak loser.</div></td>\n</tr>'))]
06:49:25 reviews: Job OK (dfc8d380-fe0c-4f02-bb6d-3dd30649376c)
06:49:25 Result is kept for 500 seconds
06:49:25 
06:49:25 *** Listening on chapters, profiles, reviews...
06:49:25 reviews: fanfic.jobs.crawl_reviews(10839331) (0bc5f3de-45ee-4b7d-bed6-739e7913c1f9)
2017-02-08 06:49:30 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:49:30.376892', 10839331, 213394547, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6357025&amp;r ... (929 characters truncated) ...  data-xutime="1420360497">1/4/2015</span> </small><div style="margin-top:5px">This story deserves way more reviews but it\'s great!</div></td>\n</tr>'), ('2017-02-08 14:49:30.376897', 10839331, 212435105, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4508095&amp;r ... (918 characters truncated) ... pter 1 . <span data-xutime="1418855450">12/17/2014</span> </small><div style="margin-top:5px">Great chapter. Very well<br>\nWritten</div></td>\n</tr>'), ('2017-02-08 14:49:30.376899', 10839331, 211463236, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1046 characters truncated) ... he doesn\'t undo it because she doesn\'t love him anymore (Severus Evans dies &amp; while comforting her Lily &amp; James have sex)</div></td>\n</tr>'), ('2017-02-08 14:49:30.376902', 10839331, 211105472, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5442394&amp;r ... (890 characters truncated) ... olor:gray">chapter 1 . <span data-xutime="1416561105">11/21/2014</span> </small><div style="margin-top:5px">Wow, this is brilliant!</div></td>\n</tr>'), ('2017-02-08 14:49:30.376904', 10839331, 213394547, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6357025&amp;r ... (929 characters truncated) ...  data-xutime="1420360497">1/4/2015</span> </small><div style="margin-top:5px">This story deserves way more reviews but it\'s great!</div></td>\n</tr>'), ('2017-02-08 14:49:30.376907', 10839331, 212435105, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4508095&amp;r ... (918 characters truncated) ... pter 1 . <span data-xutime="1418855450">12/17/2014</span> </small><div style="margin-top:5px">Great chapter. Very well<br>\nWritten</div></td>\n</tr>'), ('2017-02-08 14:49:30.376909', 10839331, 211463236, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1046 characters truncated) ... he doesn\'t undo it because she doesn\'t love him anymore (Severus Evans dies &amp; while comforting her Lily &amp; James have sex)</div></td>\n</tr>'), ('2017-02-08 14:49:30.376911', 10839331, 211105472, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5442394&amp;r ... (890 characters truncated) ... olor:gray">chapter 1 . <span data-xutime="1416561105">11/21/2014</span> </small><div style="margin-top:5px">Wow, this is brilliant!</div></td>\n</tr>'))]
06:49:30 reviews: Job OK (0bc5f3de-45ee-4b7d-bed6-739e7913c1f9)
06:49:30 Result is kept for 500 seconds
06:49:30 
06:49:30 *** Listening on chapters, profiles, reviews...
06:49:30 reviews: fanfic.jobs.crawl_reviews(10839413) (cca4008f-8e8b-4a2f-ba15-66aa0c2ef5b7)
06:50:52 reviews: Job OK (cca4008f-8e8b-4a2f-ba15-66aa0c2ef5b7)
06:50:52 Result is kept for 500 seconds
06:50:52 
06:50:52 *** Listening on chapters, profiles, reviews...
06:50:52 reviews: fanfic.jobs.crawl_reviews(10841213) (44aadc41-3a0f-47fa-b233-762a80a47692)
2017-02-08 06:50:56 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 14:50:56.528924', 10841213, 237648521, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4724150&amp;r ... (908 characters truncated) ... apter 9 . <span data-xutime="1464827078">6/1/2016</span> </small><div style="margin-top:5px">Girl u should name her Jess 0.0<br>\n-</div></td>\n</tr>'), ('2017-02-08 14:50:56.528928', 10841213, 237128981, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7779011&amp;r ... (1156 characters truncated) ... e books/movies. I hope he just stays away. Lol talk about a big surprise for Hermione\'s parents! Can\'t wait for the next chapter!</div></td>\n</tr>'), ('2017-02-08 14:50:56.528930', 10841213, 231284932, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5984521&amp;r ... (954 characters truncated) ...  besides The Martyr (not sure why i waited so long) but I\'ve enjoyed it so far and I look forward to whenever you can update again</div></td>\n</tr>'), ('2017-02-08 14:50:56.528932', 10841213, 227094778, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (604 characters truncated) ...  style="margin-top:5px">love it! definetelly keep it up i\'m looking forward to more and seriously why is hermione paired with ron?</div></td>\n</tr>'), ('2017-02-08 14:50:56.528934', 10841213, 227014775, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3273768&amp;r ... (987 characters truncated) ... 5px">This chapter was great! I am currently crying from cuteness and the bit of sadness in this update. My heart has been squished.</div></td>\n</tr>'), ('2017-02-08 14:50:56.528936', 10841213, 224837108, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1300456&amp;r ... (962 characters truncated) ... style="margin-top:5px">Love this story I really hope you update the story it\'s really good and I can\'t wait for the next chapter.</div></td>\n</tr>'), ('2017-02-08 14:50:56.528938', 10841213, 222687718, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3273768&amp;r ... (1038 characters truncated) ... ng with laughter and then realization when I thought back to Hermione running to the bathroom. I have tears now, all good I promise</div></td>\n</tr>'), ('2017-02-08 14:50:56.528940', 10841213, 219058004, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3485399&amp;r ... (796 characters truncated) ... ="color:gray">chapter 6 . <span data-xutime="1429596683">4/20/2015</span> </small><div style="margin-top:5px">Great story so far :)</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-08 14:50:56.528969', 10841213, 214091453, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6231095&amp;r ... (884 characters truncated) ... ="color:gray">chapter 5 . <span data-xutime="1421459876">1/16/2015</span> </small><div style="margin-top:5px">I bet it was Harry...</div></td>\n</tr>'), ('2017-02-08 14:50:56.528970', 10841213, 211503938, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2585450&amp;r ... (970 characters truncated) ... e="margin-top:5px">I love this pairing and your other story. HATE Ron and Hermione together, I can\'t wait to see were this goes :)</div></td>\n</tr>'))]
06:50:56 reviews: Job OK (44aadc41-3a0f-47fa-b233-762a80a47692)
06:50:56 Result is kept for 500 seconds
06:50:56 
06:50:56 *** Listening on chapters, profiles, reviews...
06:50:56 reviews: fanfic.jobs.crawl_reviews(10842514) (2fea0f55-a70f-4666-b8e2-bb1aa167e069)
06:51:12 reviews: Job OK (2fea0f55-a70f-4666-b8e2-bb1aa167e069)
06:51:12 Result is kept for 500 seconds
06:51:12 
06:51:12 *** Listening on chapters, profiles, reviews...
06:51:12 reviews: fanfic.jobs.crawl_reviews(10843405) (268bf1d6-1963-4a83-9145-ec188576ac9b)
06:52:34 reviews: Job OK (268bf1d6-1963-4a83-9145-ec188576ac9b)
06:52:34 Result is kept for 500 seconds
06:52:34 
06:52:34 *** Listening on chapters, profiles, reviews...
06:52:34 reviews: fanfic.jobs.crawl_reviews(10845084) (cbe71cb1-1f8c-4df8-b273-8f464cd4b3e7)
06:53:07 reviews: Job OK (cbe71cb1-1f8c-4df8-b273-8f464cd4b3e7)
06:53:07 Result is kept for 500 seconds
06:53:07 
06:53:07 *** Listening on chapters, profiles, reviews...
06:53:07 reviews: fanfic.jobs.crawl_reviews(10845230) (ea909b80-2acc-4edd-afc9-b30082370fe4)
06:53:47 reviews: Job OK (ea909b80-2acc-4edd-afc9-b30082370fe4)
06:53:47 Result is kept for 500 seconds
06:53:47 
06:53:47 *** Listening on chapters, profiles, reviews...
06:53:47 reviews: fanfic.jobs.crawl_reviews(10845351) (9d328b54-d9a7-472f-92bb-84c8256f6843)
06:55:00 reviews: Job OK (9d328b54-d9a7-472f-92bb-84c8256f6843)
06:55:00 Result is kept for 500 seconds
06:55:00 
06:55:00 *** Listening on chapters, profiles, reviews...
06:55:00 reviews: fanfic.jobs.crawl_reviews(10847087) (ed128b35-8578-4708-87e5-9113d4e868fe)
06:56:20 reviews: Job OK (ed128b35-8578-4708-87e5-9113d4e868fe)
06:56:20 Result is kept for 500 seconds
06:56:20 
06:56:20 *** Listening on chapters, profiles, reviews...
06:56:20 reviews: fanfic.jobs.crawl_reviews(10848170) (2abef114-7bc5-4da3-a47c-19d933cafc44)
06:56:35 reviews: Job OK (2abef114-7bc5-4da3-a47c-19d933cafc44)
06:56:35 Result is kept for 500 seconds
06:56:35 
06:56:35 *** Listening on chapters, profiles, reviews...
06:56:35 reviews: fanfic.jobs.crawl_reviews(10848788) (0d1c89c0-aeca-403c-bc6f-d5f4db90a898)
06:56:41 reviews: Job OK (0d1c89c0-aeca-403c-bc6f-d5f4db90a898)
06:56:41 Result is kept for 500 seconds
06:56:41 
06:56:41 *** Listening on chapters, profiles, reviews...
06:56:41 reviews: fanfic.jobs.crawl_reviews(10851278) (56e6f175-f591-47c2-936a-3a7615d6541a)
06:59:19 reviews: Job OK (56e6f175-f591-47c2-936a-3a7615d6541a)
06:59:19 Result is kept for 500 seconds
06:59:19 
06:59:19 *** Listening on chapters, profiles, reviews...
06:59:19 reviews: fanfic.jobs.crawl_reviews(10852146) (c72d9e0c-9868-48a9-b278-225e70a7391e)
07:00:31 reviews: Job OK (c72d9e0c-9868-48a9-b278-225e70a7391e)
07:00:31 Result is kept for 500 seconds
07:00:31 
07:00:31 *** Listening on chapters, profiles, reviews...
07:00:31 reviews: fanfic.jobs.crawl_reviews(10852858) (ab5833af-4ecc-4d5b-8e2b-243eb370e385)
07:00:37 reviews: Job OK (ab5833af-4ecc-4d5b-8e2b-243eb370e385)
07:00:37 Result is kept for 500 seconds
07:00:37 
07:00:37 *** Listening on chapters, profiles, reviews...
07:00:37 reviews: fanfic.jobs.crawl_reviews(10853759) (267e66fd-b338-40fe-8284-455399b0938b)
07:01:04 reviews: Job OK (267e66fd-b338-40fe-8284-455399b0938b)
07:01:04 Result is kept for 500 seconds
07:01:04 
07:01:04 *** Listening on chapters, profiles, reviews...
07:01:04 reviews: fanfic.jobs.crawl_reviews(10854886) (c5a83d17-97af-47e5-80a7-6ff20ee8c9f2)
07:02:01 reviews: Job OK (c5a83d17-97af-47e5-80a7-6ff20ee8c9f2)
07:02:01 Result is kept for 500 seconds
07:02:01 
07:02:01 *** Listening on chapters, profiles, reviews...
07:02:01 reviews: fanfic.jobs.crawl_reviews(10855152) (2af04313-7c83-4dcb-87bb-2f14cc253bf7)
07:02:18 reviews: Job OK (2af04313-7c83-4dcb-87bb-2f14cc253bf7)
07:02:18 Result is kept for 500 seconds
07:02:18 
07:02:18 *** Listening on chapters, profiles, reviews...
07:02:18 reviews: fanfic.jobs.crawl_reviews(10855282) (8e16373f-14e9-479e-8739-811a9f568e85)
07:04:59 reviews: Job OK (8e16373f-14e9-479e-8739-811a9f568e85)
07:04:59 Result is kept for 500 seconds
07:04:59 
07:04:59 *** Listening on chapters, profiles, reviews...
07:04:59 reviews: fanfic.jobs.crawl_reviews(10855732) (b13eb23f-1d02-4728-92da-8a8aae1a72f5)
07:05:03 reviews: Job OK (b13eb23f-1d02-4728-92da-8a8aae1a72f5)
07:05:03 Result is kept for 500 seconds
07:05:03 
07:05:03 *** Listening on chapters, profiles, reviews...
07:05:03 reviews: fanfic.jobs.crawl_reviews(10856186) (b86e45a9-4100-4488-b579-e3338f91af7c)
07:05:24 reviews: Job OK (b86e45a9-4100-4488-b579-e3338f91af7c)
07:05:24 Result is kept for 500 seconds
07:05:24 
07:05:24 *** Listening on chapters, profiles, reviews...
07:05:24 reviews: fanfic.jobs.crawl_reviews(10856625) (43eb9c74-692d-4ac8-af67-8134b4f18a1e)
07:06:54 reviews: Job OK (43eb9c74-692d-4ac8-af67-8134b4f18a1e)
07:06:54 Result is kept for 500 seconds
07:06:54 
07:06:54 *** Listening on chapters, profiles, reviews...
07:06:54 reviews: fanfic.jobs.crawl_reviews(10857053) (04bb9179-98d6-4e5a-86f6-67334a5cfbb1)
07:08:28 reviews: Job OK (04bb9179-98d6-4e5a-86f6-67334a5cfbb1)
07:08:28 Result is kept for 500 seconds
07:08:28 
07:08:28 *** Listening on chapters, profiles, reviews...
07:08:28 reviews: fanfic.jobs.crawl_reviews(10858061) (7ea4d42f-7340-47f6-9ad1-c047bcedc848)
07:12:15 reviews: Job OK (7ea4d42f-7340-47f6-9ad1-c047bcedc848)
07:12:15 Result is kept for 500 seconds
07:12:15 
07:12:15 *** Listening on chapters, profiles, reviews...
07:12:15 reviews: fanfic.jobs.crawl_reviews(10858869) (125bdb61-a169-42ba-959c-be33ecb7c017)
07:12:50 reviews: Job OK (125bdb61-a169-42ba-959c-be33ecb7c017)
07:12:50 Result is kept for 500 seconds
07:12:50 
07:12:50 *** Listening on chapters, profiles, reviews...
07:12:50 reviews: fanfic.jobs.crawl_reviews(10859310) (ae123d28-5a14-41be-a238-44d2995cf846)
07:17:33 reviews: Job OK (ae123d28-5a14-41be-a238-44d2995cf846)
07:17:33 Result is kept for 500 seconds
07:17:33 
07:17:33 *** Listening on chapters, profiles, reviews...
07:17:33 reviews: fanfic.jobs.crawl_reviews(10859632) (f7096c22-3679-40c6-acc0-db7961440a57)
07:17:44 reviews: Job OK (f7096c22-3679-40c6-acc0-db7961440a57)
07:17:44 Result is kept for 500 seconds
07:17:44 
07:17:44 *** Listening on chapters, profiles, reviews...
07:17:44 reviews: fanfic.jobs.crawl_reviews(10860882) (210dfc70-85e6-43cd-b98d-f6699071c654)
07:18:33 reviews: Job OK (210dfc70-85e6-43cd-b98d-f6699071c654)
07:18:33 Result is kept for 500 seconds
07:18:33 
07:18:33 *** Listening on chapters, profiles, reviews...
07:18:33 reviews: fanfic.jobs.crawl_reviews(10861658) (b8d5730b-436f-4579-8751-e596560b4f18)
07:19:33 reviews: Job OK (b8d5730b-436f-4579-8751-e596560b4f18)
07:19:33 Result is kept for 500 seconds
07:19:33 
07:19:33 *** Listening on chapters, profiles, reviews...
07:19:33 reviews: fanfic.jobs.crawl_reviews(10861887) (b1dcb8f8-a92a-48df-b5e9-a1d2a3191be8)
07:20:26 reviews: Job OK (b1dcb8f8-a92a-48df-b5e9-a1d2a3191be8)
07:20:26 Result is kept for 500 seconds
07:20:26 
07:20:26 *** Listening on chapters, profiles, reviews...
07:20:26 reviews: fanfic.jobs.crawl_reviews(10862218) (38b88c0b-f291-41f3-a324-431a75083330)
07:20:38 reviews: Job OK (38b88c0b-f291-41f3-a324-431a75083330)
07:20:38 Result is kept for 500 seconds
07:20:38 
07:20:38 *** Listening on chapters, profiles, reviews...
07:20:38 reviews: fanfic.jobs.crawl_reviews(10863050) (717130c5-25c1-4d7f-b65e-fd4c74062731)
07:21:08 reviews: Job OK (717130c5-25c1-4d7f-b65e-fd4c74062731)
07:21:08 Result is kept for 500 seconds
07:21:08 
07:21:08 *** Listening on chapters, profiles, reviews...
07:21:08 reviews: fanfic.jobs.crawl_reviews(10869468) (d8e033d3-7392-4799-93ff-4f1ad8330f94)
07:21:33 reviews: Job OK (d8e033d3-7392-4799-93ff-4f1ad8330f94)
07:21:33 Result is kept for 500 seconds
07:21:33 
07:21:33 *** Listening on chapters, profiles, reviews...
07:21:33 reviews: fanfic.jobs.crawl_reviews(10872999) (5d2be5ca-7520-4300-8731-745c5a3a4765)
07:24:44 reviews: Job OK (5d2be5ca-7520-4300-8731-745c5a3a4765)
07:24:44 Result is kept for 500 seconds
07:24:44 
07:24:44 *** Listening on chapters, profiles, reviews...
07:24:44 reviews: fanfic.jobs.crawl_reviews(10874153) (f16a3501-df17-4f44-b9ca-fa64ca28fb3c)
07:29:27 reviews: Job OK (f16a3501-df17-4f44-b9ca-fa64ca28fb3c)
07:29:27 Result is kept for 500 seconds
07:29:27 
07:29:27 *** Listening on chapters, profiles, reviews...
07:29:27 reviews: fanfic.jobs.crawl_reviews(10874874) (e2f728e7-b692-4390-b223-df77059d003f)
07:29:48 reviews: Job OK (e2f728e7-b692-4390-b223-df77059d003f)
07:29:48 Result is kept for 500 seconds
07:29:48 
07:29:48 *** Listening on chapters, profiles, reviews...
07:29:48 reviews: fanfic.jobs.crawl_reviews(10874972) (2a516d60-e8b7-41cd-ac3e-dad32fe1a166)
07:30:21 reviews: Job OK (2a516d60-e8b7-41cd-ac3e-dad32fe1a166)
07:30:21 Result is kept for 500 seconds
07:30:21 
07:30:21 *** Listening on chapters, profiles, reviews...
07:30:21 reviews: fanfic.jobs.crawl_reviews(10875366) (df646e99-1c07-498f-9049-be7c8f666d3a)
07:30:45 reviews: Job OK (df646e99-1c07-498f-9049-be7c8f666d3a)
07:30:45 Result is kept for 500 seconds
07:30:45 
07:30:45 *** Listening on chapters, profiles, reviews...
07:30:45 reviews: fanfic.jobs.crawl_reviews(10875538) (16e5f463-d189-4b1d-9a37-ba1fe0644983)
07:31:24 reviews: Job OK (16e5f463-d189-4b1d-9a37-ba1fe0644983)
07:31:24 Result is kept for 500 seconds
07:31:24 Cleaning registries for queue: chapters
07:31:24 Cleaning registries for queue: profiles
07:31:24 Cleaning registries for queue: reviews
07:31:24 
07:31:24 *** Listening on chapters, profiles, reviews...
07:31:24 reviews: fanfic.jobs.crawl_reviews(10876612) (038dcb57-8a44-4882-bc60-38ff7490178b)
07:31:30 reviews: Job OK (038dcb57-8a44-4882-bc60-38ff7490178b)
07:31:30 Result is kept for 500 seconds
07:31:30 
07:31:30 *** Listening on chapters, profiles, reviews...
07:31:30 reviews: fanfic.jobs.crawl_reviews(10877134) (31f95df7-c2ac-48a8-b905-16520065cf6e)
07:33:06 reviews: Job OK (31f95df7-c2ac-48a8-b905-16520065cf6e)
07:33:06 Result is kept for 500 seconds
07:33:06 
07:33:06 *** Listening on chapters, profiles, reviews...
07:33:06 reviews: fanfic.jobs.crawl_reviews(10877265) (e0193c36-c48f-4aa4-8266-d5f7d0f3fbd6)
07:36:54 reviews: Job OK (e0193c36-c48f-4aa4-8266-d5f7d0f3fbd6)
07:36:54 Result is kept for 500 seconds
07:36:54 
07:36:54 *** Listening on chapters, profiles, reviews...
07:36:54 reviews: fanfic.jobs.crawl_reviews(10878096) (4be302b2-a170-4e05-b42e-a71a3058add9)
07:37:23 reviews: Job OK (4be302b2-a170-4e05-b42e-a71a3058add9)
07:37:23 Result is kept for 500 seconds
07:37:23 
07:37:23 *** Listening on chapters, profiles, reviews...
07:37:23 reviews: fanfic.jobs.crawl_reviews(10878558) (3d27fcbe-c011-4003-8494-9d69af02711b)
07:38:05 reviews: Job OK (3d27fcbe-c011-4003-8494-9d69af02711b)
07:38:05 Result is kept for 500 seconds
07:38:05 
07:38:05 *** Listening on chapters, profiles, reviews...
07:38:05 reviews: fanfic.jobs.crawl_reviews(10879527) (2a73fbdd-09c5-43cd-b49f-5b46317fcf26)
07:38:21 reviews: Job OK (2a73fbdd-09c5-43cd-b49f-5b46317fcf26)
07:38:21 Result is kept for 500 seconds
07:38:21 
07:38:21 *** Listening on chapters, profiles, reviews...
07:38:21 reviews: fanfic.jobs.crawl_reviews(10880013) (e64ddc30-5ecb-44a8-bc1c-078f5a9f99fd)
2017-02-08 07:38:26 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 15:38:26.875251', 10880013, 237075539, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (715 characters truncated) ... sense, too. <br>\n<br>\nRewrite this as a HG/VK story and I bet you that you\'ll have more followers, hits, favorites, and reviews.</div></td>\n</tr>'), ('2017-02-08 15:38:26.875255', 10880013, 232463229, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3698412&amp;r ... (1249 characters truncated) ... esently beta for which is 7, and real life and finding time to read for fun! But I know you can find someone from the list to help!</div></td>\n</tr>'), ('2017-02-08 15:38:26.875257', 10880013, 231135062, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (539 characters truncated) ...  14 . <span data-xutime="1451461122">12/29/2015</span> </small><div style="margin-top:5px">Do a Viktor and Hermione story...PLEASE!</div></td>\n</tr>'), ('2017-02-08 15:38:26.875259', 10880013, 222337063, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5526018&amp;r ... (905 characters truncated) ... or:gray">chapter 14 . <span data-xutime="1435175360">6/24/2015</span> </small><div style="margin-top:5px">I couldn\'t stop laughing</div></td>\n</tr>'), ('2017-02-08 15:38:26.875261', 10880013, 215497414, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2202893&amp;r ... (1063 characters truncated) ... and really sweet. It was really well written and had enough description to make the story interesting without making it to full on.</div></td>\n</tr>'), ('2017-02-08 15:38:26.875263', 10880013, 213385913, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6164507&amp;r ... (953 characters truncated) ... 4">1/3/2015</span> </small><div style="margin-top:5px">I love that you gave narcissa a heart, i think she did do a lot out of love.</div></td>\n</tr>'), ('2017-02-08 15:38:26.875265', 10880013, 213270573, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2144560&amp;r ... (865 characters truncated) ... 1/2/2015</span> </small><div style="margin-top:5px">Please update faster I really love this story. I was looking for it ever where.</div></td>\n</tr>'), ('2017-02-08 15:38:26.875267', 10880013, 213060712, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (537 characters truncated) ... er 8 . <span data-xutime="1419715490">12/27/2014</span> </small><div style="margin-top:5px">incancerus ties people up, doesnt burn.</div></td>\n</tr>')  ... displaying 10 of 18 total bound parameter sets ...  ('2017-02-08 15:38:26.875283', 10880013, 213060712, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (537 characters truncated) ... er 8 . <span data-xutime="1419715490">12/27/2014</span> </small><div style="margin-top:5px">incancerus ties people up, doesnt burn.</div></td>\n</tr>'), ('2017-02-08 15:38:26.875285', 10880013, 212042660, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4063896&amp;r ... (914 characters truncated) ... op:5px">I really like this and can\'t wait to read more. I love the Sleeping Beauty curse and Hermione with someone other than Ron.</div></td>\n</tr>'))]
07:38:26 reviews: Job OK (e64ddc30-5ecb-44a8-bc1c-078f5a9f99fd)
07:38:26 Result is kept for 500 seconds
07:38:26 
07:38:26 *** Listening on chapters, profiles, reviews...
07:38:26 reviews: fanfic.jobs.crawl_reviews(10881233) (93bb95bc-53a0-479c-b5bc-b43c9ebc26e6)
07:39:13 reviews: Job OK (93bb95bc-53a0-479c-b5bc-b43c9ebc26e6)
07:39:13 Result is kept for 500 seconds
07:39:13 
07:39:13 *** Listening on chapters, profiles, reviews...
07:39:13 reviews: fanfic.jobs.crawl_reviews(10882802) (2e1fd283-9ee2-4b8e-8d62-8e0764993740)
07:39:33 reviews: Job OK (2e1fd283-9ee2-4b8e-8d62-8e0764993740)
07:39:33 Result is kept for 500 seconds
07:39:33 
07:39:33 *** Listening on chapters, profiles, reviews...
07:39:33 reviews: fanfic.jobs.crawl_reviews(10884685) (c04e024d-7c8b-42ea-a57d-6cff0d3f0f09)
07:39:57 reviews: Job OK (c04e024d-7c8b-42ea-a57d-6cff0d3f0f09)
07:39:57 Result is kept for 500 seconds
07:39:57 
07:39:57 *** Listening on chapters, profiles, reviews...
07:39:57 reviews: fanfic.jobs.crawl_reviews(10885586) (3e3cb320-f544-4bd6-9c92-da2c98560146)
07:40:23 reviews: Job OK (3e3cb320-f544-4bd6-9c92-da2c98560146)
07:40:23 Result is kept for 500 seconds
07:40:23 
07:40:23 *** Listening on chapters, profiles, reviews...
07:40:23 reviews: fanfic.jobs.crawl_reviews(10885678) (d873b7e8-3baf-4457-8b60-825936c3fcb3)
07:41:15 reviews: Job OK (d873b7e8-3baf-4457-8b60-825936c3fcb3)
07:41:15 Result is kept for 500 seconds
07:41:15 
07:41:15 *** Listening on chapters, profiles, reviews...
07:41:15 reviews: fanfic.jobs.crawl_reviews(10885819) (a55cb2fe-5ecb-4a86-a1f7-9db5ac3e0640)
2017-02-08 07:41:17 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/10885819/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
07:41:17 reviews: Job OK (a55cb2fe-5ecb-4a86-a1f7-9db5ac3e0640)
07:41:17 Result is kept for 500 seconds
07:41:17 
07:41:17 *** Listening on chapters, profiles, reviews...
07:41:17 reviews: fanfic.jobs.crawl_reviews(10887844) (2fad1788-d85b-4a9a-8649-c364c1ccc626)
07:42:15 reviews: Job OK (2fad1788-d85b-4a9a-8649-c364c1ccc626)
07:42:15 Result is kept for 500 seconds
07:42:15 
07:42:15 *** Listening on chapters, profiles, reviews...
07:42:15 reviews: fanfic.jobs.crawl_reviews(10887878) (01b2dde0-48d8-4f65-8dc6-8aeff1aa9886)
07:42:45 reviews: Job OK (01b2dde0-48d8-4f65-8dc6-8aeff1aa9886)
07:42:45 Result is kept for 500 seconds
07:42:45 
07:42:45 *** Listening on chapters, profiles, reviews...
07:42:45 reviews: fanfic.jobs.crawl_reviews(10888918) (e15a3a8f-d82c-4510-b3ad-13f86656bb9b)
07:43:02 reviews: Job OK (e15a3a8f-d82c-4510-b3ad-13f86656bb9b)
07:43:02 Result is kept for 500 seconds
07:43:02 
07:43:02 *** Listening on chapters, profiles, reviews...
07:43:02 reviews: fanfic.jobs.crawl_reviews(10888928) (97b32790-f923-48f7-ac3a-76b6953752dc)
07:43:54 reviews: Job OK (97b32790-f923-48f7-ac3a-76b6953752dc)
07:43:54 Result is kept for 500 seconds
07:43:54 
07:43:54 *** Listening on chapters, profiles, reviews...
07:43:54 reviews: fanfic.jobs.crawl_reviews(10890018) (26cd84f4-98c2-47ec-af83-6c3d4365a512)
07:44:55 reviews: Job OK (26cd84f4-98c2-47ec-af83-6c3d4365a512)
07:44:55 Result is kept for 500 seconds
07:44:55 
07:44:55 *** Listening on chapters, profiles, reviews...
07:44:55 reviews: fanfic.jobs.crawl_reviews(10891502) (97e61b3b-fc24-48c6-91a6-e4a1c2da5c8a)
2017-02-08 07:45:01 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 15:45:01.445992', 10891502, 221390143, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3118674&amp;r ... (999 characters truncated) ...  read love to see Harry and Jamie together should be intresting her twin should be more supportive please put her and Harry tighter</div></td>\n</tr>'), ('2017-02-08 15:45:01.445996', 10891502, 219606099, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (541 characters truncated) ... 7 . <span data-xutime="1430543262">5/1/2015</span> </small><div style="margin-top:5px">Can\'t wait for the next one...damn Kingsley</div></td>\n</tr>'), ('2017-02-08 15:45:01.445998', 10891502, 217624320, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5623263&amp;r ... (815 characters truncated) ... ter 17 . <span data-xutime="1427233866">3/24/2015</span> </small><div style="margin-top:5px">great chapter. looking forward to PoA.</div></td>\n</tr>'), ('2017-02-08 15:45:01.446000', 10891502, 215672398, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5623263&amp;r ... (853 characters truncated) ... ">2/15/2015</span> </small><div style="margin-top:5px">great chapter. I liked the family history. it was sad but still interesting.</div></td>\n</tr>'), ('2017-02-08 15:45:01.446002', 10891502, 215616237, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5623263&amp;r ... (789 characters truncated) ... ll style="color:gray">chapter 14 . <span data-xutime="1423938547">2/14/2015</span> </small><div style="margin-top:5px">good chapter</div></td>\n</tr>'), ('2017-02-08 15:45:01.446004', 10891502, 215577075, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5623263&amp;r ... (952 characters truncated) ... ing the first story and it is a good story. looking forward to more. However, the name of this chapter doesn\'t really fit does it?</div></td>\n</tr>'), ('2017-02-08 15:45:01.446006', 10891502, 215194370, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5603375&amp;r ... (899 characters truncated) ... r 11 . <span data-xutime="1423187751">2/5/2015</span> </small><div style="margin-top:5px">Jamie called it. She knew the whole time.</div></td>\n</tr>'), ('2017-02-08 15:45:01.446008', 10891502, 214975566, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (510 characters truncated) ... l style="color:gray">chapter 10 . <span data-xutime="1422827999">2/1/2015</span> </small><div style="margin-top:5px">Please update!</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-08 15:45:01.446032', 10891502, 212558541, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2381031&amp;r ... (1149 characters truncated) ... st changed the name. Are you going to do ANYTHING differently? Or is there something that you\'re building up to? *crosses fingers*</div></td>\n</tr>'), ('2017-02-08 15:45:01.446034', 10891502, 212537410, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5603375&amp;r ... (991 characters truncated) ... h snap. Lol<br>\n<br>\nI noticed a minor typo. The rant on the polynucleotide by Hermione. You said turn the three of us. Not four.</div></td>\n</tr>'))]
07:45:01 reviews: Job OK (97e61b3b-fc24-48c6-91a6-e4a1c2da5c8a)
07:45:01 Result is kept for 500 seconds
07:45:01 
07:45:01 *** Listening on chapters, profiles, reviews...
07:45:01 reviews: fanfic.jobs.crawl_reviews(10891906) (5b17b674-6a02-45f8-bdb0-be3feb74fc45)
07:45:20 reviews: Job OK (5b17b674-6a02-45f8-bdb0-be3feb74fc45)
07:45:20 Result is kept for 500 seconds
07:45:20 
07:45:20 *** Listening on chapters, profiles, reviews...
07:45:20 reviews: fanfic.jobs.crawl_reviews(10892504) (122dbd25-fa40-4eff-a39d-2e9e88b993f6)
2017-02-08 07:45:25 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 15:45:25.811554', 10892504, 225978419, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7089807&amp;r ... (852 characters truncated) ...  1 . <span data-xutime="1441270130">9/3/2015</span> </small><div style="margin-top:5px">5*! This is so superior to typical fanfics!</div></td>\n</tr>'), ('2017-02-08 15:45:25.811558', 10892504, 225978419, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7089807&amp;r ... (852 characters truncated) ...  1 . <span data-xutime="1441270130">9/3/2015</span> </small><div style="margin-top:5px">5*! This is so superior to typical fanfics!</div></td>\n</tr>'))]
07:45:25 reviews: Job OK (122dbd25-fa40-4eff-a39d-2e9e88b993f6)
07:45:25 Result is kept for 500 seconds
07:45:25 
07:45:25 *** Listening on chapters, profiles, reviews...
07:45:25 reviews: fanfic.jobs.crawl_reviews(10893097) (2f469777-6822-4506-b6f7-fbdb4e5163cb)
2017-02-08 07:45:31 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 15:45:31.202624', 10893097, 244392650, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7525920&amp;r ... (1035 characters truncated) ... ry is so amazing and has been the only haven from my family for a good week now. You have a true talent and I can\'t wait for more.</div></td>\n</tr>'), ('2017-02-08 15:45:31.202629', 10893097, 226209059, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7090134&amp;r ... (915 characters truncated) ... time="1441707115">9/8/2015</span> </small><div style="margin-top:5px">I really really really really love this story so far !*happy*</div></td>\n</tr>'), ('2017-02-08 15:45:31.202631', 10893097, 217904974, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (505 characters truncated) ...  <small style="color:gray">chapter 9 . <span data-xutime="1427548106">3/28/2015</span> </small><div style="margin-top:5px">Love it!</div></td>\n</tr>'), ('2017-02-08 15:45:31.202633', 10893097, 214866360, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6369890&amp;r ... (805 characters truncated) ... olor:gray">chapter 2 . <span data-xutime="1422670967">1/30/2015</span> </small><div style="margin-top:5px">Really interesting story</div></td>\n</tr>'), ('2017-02-08 15:45:31.202635', 10893097, 214409604, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2671931&amp;r ... (1128 characters truncated) ...  how he is portrayed in many fanfics and I love seeing different takes on a characters personality.<br>\nCan\'t wait for chapter 7!</div></td>\n</tr>'), ('2017-02-08 15:45:31.202637', 10893097, 213385144, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4825774&amp;r ... (951 characters truncated) ... </span> </small><div style="margin-top:5px">Poor elf. My mind is now reeling with names XD how about Diffy? That sounds cool. -Cat.</div></td>\n</tr>'), ('2017-02-08 15:45:31.202639', 10893097, 213026862, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4825774&amp;r ... (1065 characters truncated) ... hile munching on chocolate* silver ain\'t that strange a thing to be allergic to... I can\'t wear silver cause I\'m allergic. -Cat.</div></td>\n</tr>'), ('2017-02-08 15:45:31.202641', 10893097, 213023071, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4825774&amp;r ... (1013 characters truncated) ...  Mauraders XD yes! I\'m not sure if anyone else is gonna point out that Sirius called Remus "Rem" but I found that endearing. -Cat.</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-08 15:45:31.202668', 10893097, 212435908, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (639 characters truncated) ...  It\'s not often that you find a story with high quality grammar AND plotline- please update soon, you\'re really very talented xxx</div></td>\n</tr>'), ('2017-02-08 15:45:31.202670', 10893097, 212335314, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4182593&amp;r ... (906 characters truncated) ... le="color:gray">chapter 1 . <span data-xutime="1418683871">12/15/2014</span> </small><div style="margin-top:5px">Love it already :)</div></td>\n</tr>'))]
07:45:31 reviews: Job OK (2f469777-6822-4506-b6f7-fbdb4e5163cb)
07:45:31 Result is kept for 500 seconds
07:45:31 
07:45:31 *** Listening on chapters, profiles, reviews...
07:45:31 reviews: fanfic.jobs.crawl_reviews(10893362) (19a491de-a790-4b99-8408-3aea6983669c)
07:45:43 reviews: Job OK (19a491de-a790-4b99-8408-3aea6983669c)
07:45:43 Result is kept for 500 seconds
07:45:43 
07:45:43 *** Listening on chapters, profiles, reviews...
07:45:43 reviews: fanfic.jobs.crawl_reviews(10893473) (8ebbf4ce-fd02-47f6-873d-4fb73e1ee16d)
07:46:14 reviews: Job OK (8ebbf4ce-fd02-47f6-873d-4fb73e1ee16d)
07:46:14 Result is kept for 500 seconds
07:46:14 
07:46:14 *** Listening on chapters, profiles, reviews...
07:46:14 reviews: fanfic.jobs.crawl_reviews(10894505) (95f78fb8-74be-4393-a50b-fa9452f7df9d)
07:46:50 reviews: Job OK (95f78fb8-74be-4393-a50b-fa9452f7df9d)
07:46:50 Result is kept for 500 seconds
07:46:50 
07:46:50 *** Listening on chapters, profiles, reviews...
07:46:50 reviews: fanfic.jobs.crawl_reviews(10894554) (eeed9fda-92f1-459d-a5fe-383004ed73af)
07:46:55 reviews: Job OK (eeed9fda-92f1-459d-a5fe-383004ed73af)
07:46:55 Result is kept for 500 seconds
07:46:55 
07:46:55 *** Listening on chapters, profiles, reviews...
07:46:55 reviews: fanfic.jobs.crawl_reviews(10896635) (d45186a5-9102-4ba2-a2da-a00a13b0f8cc)
07:47:29 reviews: Job OK (d45186a5-9102-4ba2-a2da-a00a13b0f8cc)
07:47:29 Result is kept for 500 seconds
07:47:29 
07:47:29 *** Listening on chapters, profiles, reviews...
07:47:29 reviews: fanfic.jobs.crawl_reviews(10896701) (fe7d007e-712e-4ec4-9359-00ad37a795ad)
2017-02-08 07:47:34 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 15:47:34.468561', 10896701, 244489463, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4517054&amp;r ... (1077 characters truncated) ... und a friend<br>\n<br>\nAkso that there are more parselmouths in hogwarts , congrats.<br>\n<br>\nOther than that, see you next time</div></td>\n</tr>'), ('2017-02-08 15:47:34.468566', 10896701, 243241555, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6892532&amp;r ... (832 characters truncated) ... n data-xutime="1477277789">10/23/2016</span> </small><div style="margin-top:5px">I think this chapter killed me a little bit inside</div></td>\n</tr>'), ('2017-02-08 15:47:34.468568', 10896701, 242039849, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4517054&amp;r ... (1020 characters truncated) ... ng you.<br>\n<br>\nContinue this. Is not often we see an Original Male Character in a Harry potter fanfic.<br>\n<br>\nSo pleaseeeer</div></td>\n</tr>'), ('2017-02-08 15:47:34.468570', 10896701, 222966626, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6720532&amp;r ... (1041 characters truncated) ... de Octavius Weasley as a vampire. The character is interesting( or at least you made him interesting).<br>\nSo...I like your story.</div></td>\n</tr>'), ('2017-02-08 15:47:34.468572', 10896701, 220939963, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4262023&amp;r ... (1057 characters truncated) ... tisfy me for like a day. Or longer if I have to. But, pretty please wrote more!<br>\nThis isn\'t just gonna be HP\'s 2nd yr, right?</div></td>\n</tr>'), ('2017-02-08 15:47:34.468574', 10896701, 220912162, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4262023&amp;r ... (1092 characters truncated) ... 't date the totally awesome Parselmouth. I\'d try anyway.<br>\nThat\'s the worst!<br>\nLove your story. Love nick. And more please.</div></td>\n</tr>'), ('2017-02-08 15:47:34.468576', 10896701, 220891267, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4262023&amp;r ... (927 characters truncated) ... r 7 . <span data-xutime="1432783329">5/27/2015</span> </small><div style="margin-top:5px">I thought Faerie was a bird for a second.</div></td>\n</tr>'), ('2017-02-08 15:47:34.468578', 10896701, 220890266, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4262023&amp;r ... (1032 characters truncated) ... re! *squeals*<br>\nBut, I swear Nick all of a sudden speak better English than I do and it\'s my first language. What\'s with that?</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-08 15:47:34.468617', 10896701, 212522368, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4262023&amp;r ... (936 characters truncated) ... an data-xutime="1419014533">12/19/2014</span> </small><div style="margin-top:5px">How come Nick speaks basically just parseltongue?</div></td>\n</tr>'), ('2017-02-08 15:47:34.468618', 10896701, 212487604, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5511303&amp;r ... (1019 characters truncated) ...  must be so hard to speak a language that you\'ve never spoken before, especially when your native language is basically out-lawed.</div></td>\n</tr>'))]
07:47:34 reviews: Job OK (fe7d007e-712e-4ec4-9359-00ad37a795ad)
07:47:34 Result is kept for 500 seconds
07:47:34 
07:47:34 *** Listening on chapters, profiles, reviews...
07:47:34 reviews: fanfic.jobs.crawl_reviews(10900107) (ba2ad12e-8090-45f3-b185-60c032de16c9)
07:48:09 reviews: Job OK (ba2ad12e-8090-45f3-b185-60c032de16c9)
07:48:09 Result is kept for 500 seconds
07:48:09 
07:48:09 *** Listening on chapters, profiles, reviews...
07:48:09 reviews: fanfic.jobs.crawl_reviews(10900898) (9fe2d2d5-4fe2-450f-803b-2b09da16bd2f)
07:48:15 reviews: Job OK (9fe2d2d5-4fe2-450f-803b-2b09da16bd2f)
07:48:15 Result is kept for 500 seconds
07:48:15 
07:48:15 *** Listening on chapters, profiles, reviews...
07:48:15 reviews: fanfic.jobs.crawl_reviews(10901274) (131916f4-eae0-47b3-a63d-9c7e35ec556e)
2017-02-08 07:48:21 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 15:48:21.181583', 10901274, 235218456, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (574 characters truncated) ... >4/3/2016</span> </small><div style="margin-top:5px">holy crap this is one chapter lol xD <br>\nyou\'re great but i didnt read this</div></td>\n</tr>'), ('2017-02-08 15:48:21.181588', 10901274, 224289806, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6610796&amp;r ... (896 characters truncated) ... "1438276742">7/30/2015</span> </small><div style="margin-top:5px">You SERIOUSLY NEED to get this in acceptable-length chapters dude</div></td>\n</tr>'), ('2017-02-08 15:48:21.181590', 10901274, 235218456, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (574 characters truncated) ... >4/3/2016</span> </small><div style="margin-top:5px">holy crap this is one chapter lol xD <br>\nyou\'re great but i didnt read this</div></td>\n</tr>'), ('2017-02-08 15:48:21.181592', 10901274, 224289806, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6610796&amp;r ... (896 characters truncated) ... "1438276742">7/30/2015</span> </small><div style="margin-top:5px">You SERIOUSLY NEED to get this in acceptable-length chapters dude</div></td>\n</tr>'))]
07:48:21 reviews: Job OK (131916f4-eae0-47b3-a63d-9c7e35ec556e)
07:48:21 Result is kept for 500 seconds
07:48:21 
07:48:21 *** Listening on chapters, profiles, reviews...
07:48:21 reviews: fanfic.jobs.crawl_reviews(10901705) (141711f4-e918-47b8-a3e5-c37a5c317151)
07:49:29 reviews: Job OK (141711f4-e918-47b8-a3e5-c37a5c317151)
07:49:29 Result is kept for 500 seconds
07:49:29 
07:49:29 *** Listening on chapters, profiles, reviews...
07:49:29 reviews: fanfic.jobs.crawl_reviews(10903539) (f7e48708-d7bb-41a4-ba18-ea5a8ca6f0a8)
07:50:29 reviews: Job OK (f7e48708-d7bb-41a4-ba18-ea5a8ca6f0a8)
07:50:29 Result is kept for 500 seconds
07:50:29 
07:50:29 *** Listening on chapters, profiles, reviews...
07:50:29 reviews: fanfic.jobs.crawl_reviews(10905633) (87984d38-45ba-4ac6-9fed-b90a74a1ea04)
07:56:18 reviews: Job OK (87984d38-45ba-4ac6-9fed-b90a74a1ea04)
07:56:18 Result is kept for 500 seconds
07:56:18 
07:56:18 *** Listening on chapters, profiles, reviews...
07:56:18 reviews: fanfic.jobs.crawl_reviews(10905816) (16557aca-b73f-4584-8a23-cea81021bf41)
07:56:29 reviews: Job OK (16557aca-b73f-4584-8a23-cea81021bf41)
07:56:29 Result is kept for 500 seconds
07:56:29 
07:56:29 *** Listening on chapters, profiles, reviews...
07:56:29 reviews: fanfic.jobs.crawl_reviews(10907266) (c46ab6f0-c04e-47f5-a64e-bbaecfd10699)
07:56:34 reviews: Job OK (c46ab6f0-c04e-47f5-a64e-bbaecfd10699)
07:56:34 Result is kept for 500 seconds
07:56:34 
07:56:34 *** Listening on chapters, profiles, reviews...
07:56:34 reviews: fanfic.jobs.crawl_reviews(10907649) (ae038f13-5740-4a30-a145-5bb4a76f37dc)
07:57:18 reviews: Job OK (ae038f13-5740-4a30-a145-5bb4a76f37dc)
07:57:18 Result is kept for 500 seconds
07:57:18 
07:57:18 *** Listening on chapters, profiles, reviews...
07:57:18 reviews: fanfic.jobs.crawl_reviews(10908080) (06f15546-8879-46d8-814c-ce123b1d16dd)
07:57:27 reviews: Job OK (06f15546-8879-46d8-814c-ce123b1d16dd)
07:57:27 Result is kept for 500 seconds
07:57:27 
07:57:27 *** Listening on chapters, profiles, reviews...
07:57:27 reviews: fanfic.jobs.crawl_reviews(10908505) (75701357-de2d-46f4-bdb5-c6342e8cfb0f)
07:58:34 reviews: Job OK (75701357-de2d-46f4-bdb5-c6342e8cfb0f)
07:58:34 Result is kept for 500 seconds
07:58:34 
07:58:34 *** Listening on chapters, profiles, reviews...
07:58:34 reviews: fanfic.jobs.crawl_reviews(10909016) (95f54202-910a-406c-a2b7-31a3581f1a6d)
2017-02-08 07:58:36 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/10909016/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
07:58:36 reviews: Job OK (95f54202-910a-406c-a2b7-31a3581f1a6d)
07:58:36 Result is kept for 500 seconds
07:58:36 
07:58:36 *** Listening on chapters, profiles, reviews...
07:58:36 reviews: fanfic.jobs.crawl_reviews(10909799) (8b79e58d-e20d-4901-bf59-d1dc2bd2f9a8)
07:59:29 reviews: Job OK (8b79e58d-e20d-4901-bf59-d1dc2bd2f9a8)
07:59:29 Result is kept for 500 seconds
07:59:29 
07:59:29 *** Listening on chapters, profiles, reviews...
07:59:29 reviews: fanfic.jobs.crawl_reviews(10911754) (ca551d93-a4a2-40dd-8812-6d08af0c05bb)
2017-02-08 07:59:34 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 15:59:34.282796', 10911754, 237359448, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7886610&amp;r ... (788 characters truncated) ... ll style="color:gray">chapter 19 . <span data-xutime="1464213109">5/25/2016</span> </small><div style="margin-top:5px">Tantilising.</div></td>\n</tr>'), ('2017-02-08 15:59:34.282800', 10911754, 219758861, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4603738&amp;r ... (859 characters truncated) ... 2015</span> </small><div style="margin-top:5px">Wow, unexpected of Rory! And Professor Avisana still had to give out detention.. :D</div></td>\n</tr>'), ('2017-02-08 15:59:34.282803', 10911754, 219719051, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1010 characters truncated) ... sister is now twelve and has had a boyfriend for over a year and the most they have done is hold hands and go on dates and stuff :D</div></td>\n</tr>'), ('2017-02-08 15:59:34.282805', 10911754, 219704421, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4603738&amp;r ... (1061 characters truncated) ... tory, otherwise I wouldn\'t have kept on reading it until now :P So please continue writing (and preferably more than once a month)</div></td>\n</tr>'), ('2017-02-08 15:59:34.282807', 10911754, 216232760, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5577499&amp;r ... (923 characters truncated) ... o very excited when i saw there was a second year, i really can t wait for the rest of the story, its really funny and intriguing !</div></td>\n</tr>'), ('2017-02-08 15:59:34.282809', 10911754, 237359448, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7886610&amp;r ... (788 characters truncated) ... ll style="color:gray">chapter 19 . <span data-xutime="1464213109">5/25/2016</span> </small><div style="margin-top:5px">Tantilising.</div></td>\n</tr>'), ('2017-02-08 15:59:34.282810', 10911754, 219758861, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4603738&amp;r ... (859 characters truncated) ... 2015</span> </small><div style="margin-top:5px">Wow, unexpected of Rory! And Professor Avisana still had to give out detention.. :D</div></td>\n</tr>'), ('2017-02-08 15:59:34.282812', 10911754, 219719051, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1010 characters truncated) ... sister is now twelve and has had a boyfriend for over a year and the most they have done is hold hands and go on dates and stuff :D</div></td>\n</tr>'), ('2017-02-08 15:59:34.282814', 10911754, 219704421, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4603738&amp;r ... (1061 characters truncated) ... tory, otherwise I wouldn\'t have kept on reading it until now :P So please continue writing (and preferably more than once a month)</div></td>\n</tr>'), ('2017-02-08 15:59:34.282816', 10911754, 216232760, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5577499&amp;r ... (923 characters truncated) ... o very excited when i saw there was a second year, i really can t wait for the rest of the story, its really funny and intriguing !</div></td>\n</tr>'))]
07:59:34 reviews: Job OK (ca551d93-a4a2-40dd-8812-6d08af0c05bb)
07:59:34 Result is kept for 500 seconds
07:59:34 
07:59:34 *** Listening on chapters, profiles, reviews...
07:59:34 reviews: fanfic.jobs.crawl_reviews(10913312) (1889fc39-c43f-4c6d-a93e-ec67405a52bf)
07:59:47 reviews: Job OK (1889fc39-c43f-4c6d-a93e-ec67405a52bf)
07:59:47 Result is kept for 500 seconds
07:59:47 
07:59:47 *** Listening on chapters, profiles, reviews...
07:59:47 reviews: fanfic.jobs.crawl_reviews(10913326) (d6379d6c-4a3c-4ca6-8ba5-b4aa8f894394)
2017-02-08 07:59:52 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 15:59:52.511536', 10913326, 225641473, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7079509&amp;r ... (880 characters truncated) ... </small><div style="margin-top:5px">This is an amazing twist to the HP stories! I love it and can\'t wait to see what happens next!</div></td>\n</tr>'), ('2017-02-08 15:59:52.511540', 10913326, 222968144, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (530 characters truncated) ... >chapter 12 . <span data-xutime="1436021151">7/4/2015</span> </small><div style="margin-top:5px">I loved reading every bit of this!</div></td>\n</tr>'), ('2017-02-08 15:59:52.511542', 10913326, 216859946, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4976773&amp;r ... (1039 characters truncated) ... disappointed I was when I went to got to the next chapter and then saw there wasn\'t one. Update soon, this is a really good story!</div></td>\n</tr>'), ('2017-02-08 15:59:52.511544', 10913326, 214685531, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5322247&amp;r ... (862 characters truncated) ... 1/27/2015</span> </small><div style="margin-top:5px">great story ! i am impatient to know what dumbledore is gonna show to marjella</div></td>\n</tr>'), ('2017-02-08 15:59:52.511546', 10913326, 213673908, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2413946&amp;r ... (926 characters truncated) ...  5 . <span data-xutime="1420792476">1/9/2015</span> </small><div style="margin-top:5px">Please update soon can\'t wait to read more</div></td>\n</tr>'), ('2017-02-08 15:59:52.511548', 10913326, 213537979, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1013 characters truncated) ... next chapter. <br>\nPlease keep on writing! <br>\n(Not to mention, it is amazing to have a female twist on the Harry Potter story).</div></td>\n</tr>'), ('2017-02-08 15:59:52.511550', 10913326, 225641473, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7079509&amp;r ... (880 characters truncated) ... </small><div style="margin-top:5px">This is an amazing twist to the HP stories! I love it and can\'t wait to see what happens next!</div></td>\n</tr>'), ('2017-02-08 15:59:52.511552', 10913326, 222968144, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (530 characters truncated) ... >chapter 12 . <span data-xutime="1436021151">7/4/2015</span> </small><div style="margin-top:5px">I loved reading every bit of this!</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-08 15:59:52.511558', 10913326, 213673908, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2413946&amp;r ... (926 characters truncated) ...  5 . <span data-xutime="1420792476">1/9/2015</span> </small><div style="margin-top:5px">Please update soon can\'t wait to read more</div></td>\n</tr>'), ('2017-02-08 15:59:52.511559', 10913326, 213537979, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1013 characters truncated) ... next chapter. <br>\nPlease keep on writing! <br>\n(Not to mention, it is amazing to have a female twist on the Harry Potter story).</div></td>\n</tr>'))]
07:59:52 reviews: Job OK (d6379d6c-4a3c-4ca6-8ba5-b4aa8f894394)
07:59:52 Result is kept for 500 seconds
07:59:52 
07:59:52 *** Listening on chapters, profiles, reviews...
07:59:52 reviews: fanfic.jobs.crawl_reviews(10914042) (29a7772d-43d9-4533-a546-8e132522719c)
08:10:27 reviews: Job OK (29a7772d-43d9-4533-a546-8e132522719c)
08:10:27 Result is kept for 500 seconds
08:10:27 
08:10:27 *** Listening on chapters, profiles, reviews...
08:10:27 reviews: fanfic.jobs.crawl_reviews(10917272) (b8bc0400-d91a-48ba-a7b2-cce016667337)
08:16:49 reviews: Job OK (b8bc0400-d91a-48ba-a7b2-cce016667337)
08:16:49 Result is kept for 500 seconds
08:16:49 
08:16:49 *** Listening on chapters, profiles, reviews...
08:16:49 reviews: fanfic.jobs.crawl_reviews(10917469) (0a314f38-5577-4f6f-94bc-7ffac24e739a)
08:16:57 reviews: Job OK (0a314f38-5577-4f6f-94bc-7ffac24e739a)
08:16:57 Result is kept for 500 seconds
08:16:57 
08:16:57 *** Listening on chapters, profiles, reviews...
08:16:57 reviews: fanfic.jobs.crawl_reviews(10917925) (aeeefc5f-0911-4f61-b23b-8c1eaafdcf89)
08:17:50 reviews: Job OK (aeeefc5f-0911-4f61-b23b-8c1eaafdcf89)
08:17:50 Result is kept for 500 seconds
08:17:50 
08:17:50 *** Listening on chapters, profiles, reviews...
08:17:50 reviews: fanfic.jobs.crawl_reviews(10920321) (6d3c8e86-334f-4ca4-b600-ec2cb0edb04b)
08:19:39 reviews: Job OK (6d3c8e86-334f-4ca4-b600-ec2cb0edb04b)
08:19:39 Result is kept for 500 seconds
08:19:39 
08:19:39 *** Listening on chapters, profiles, reviews...
08:19:39 reviews: fanfic.jobs.crawl_reviews(10920395) (1d9e2b3b-521f-4d4d-b9ca-c8f6ae509920)
08:19:53 reviews: Job OK (1d9e2b3b-521f-4d4d-b9ca-c8f6ae509920)
08:19:53 Result is kept for 500 seconds
08:19:53 
08:19:53 *** Listening on chapters, profiles, reviews...
08:19:53 reviews: fanfic.jobs.crawl_reviews(10920785) (f7f14529-a829-425d-9192-649d1c336d99)
08:20:28 reviews: Job OK (f7f14529-a829-425d-9192-649d1c336d99)
08:20:28 Result is kept for 500 seconds
08:20:28 
08:20:28 *** Listening on chapters, profiles, reviews...
08:20:28 reviews: fanfic.jobs.crawl_reviews(10921430) (93eff400-a25c-4b04-9521-7e6d6b155b08)
08:20:36 reviews: Job OK (93eff400-a25c-4b04-9521-7e6d6b155b08)
08:20:36 Result is kept for 500 seconds
08:20:36 
08:20:36 *** Listening on chapters, profiles, reviews...
08:20:36 reviews: fanfic.jobs.crawl_reviews(10922077) (a8ca1ce2-04dd-4af8-ba70-a52535839822)
08:23:10 reviews: Job OK (a8ca1ce2-04dd-4af8-ba70-a52535839822)
08:23:10 Result is kept for 500 seconds
08:23:10 
08:23:10 *** Listening on chapters, profiles, reviews...
08:23:10 reviews: fanfic.jobs.crawl_reviews(10923228) (36c1316a-6ab6-4ac1-957d-d145080ae766)
08:24:24 reviews: Job OK (36c1316a-6ab6-4ac1-957d-d145080ae766)
08:24:24 Result is kept for 500 seconds
08:24:24 
08:24:24 *** Listening on chapters, profiles, reviews...
08:24:24 reviews: fanfic.jobs.crawl_reviews(10923582) (a40993f0-3691-4485-8667-8f60621a10a4)
2017-02-08 08:24:25 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/10923582/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
08:24:25 reviews: Job OK (a40993f0-3691-4485-8667-8f60621a10a4)
08:24:25 Result is kept for 500 seconds
08:24:25 
08:24:25 *** Listening on chapters, profiles, reviews...
08:24:25 reviews: fanfic.jobs.crawl_reviews(10923871) (9638b5dc-b0fb-448a-b612-d86d0bc5cd51)
08:24:58 reviews: Job OK (9638b5dc-b0fb-448a-b612-d86d0bc5cd51)
08:24:58 Result is kept for 500 seconds
08:24:58 
08:24:58 *** Listening on chapters, profiles, reviews...
08:24:58 reviews: fanfic.jobs.crawl_reviews(10923980) (db864520-937e-405a-9677-3a5e176b4de9)
08:25:42 reviews: Job OK (db864520-937e-405a-9677-3a5e176b4de9)
08:25:42 Result is kept for 500 seconds
08:25:42 
08:25:42 *** Listening on chapters, profiles, reviews...
08:25:42 reviews: fanfic.jobs.crawl_reviews(10924355) (53572cac-f875-4bc3-8f69-f5b3390fe6e5)
08:27:19 reviews: Job OK (53572cac-f875-4bc3-8f69-f5b3390fe6e5)
08:27:19 Result is kept for 500 seconds
08:27:19 
08:27:19 *** Listening on chapters, profiles, reviews...
08:27:19 reviews: fanfic.jobs.crawl_reviews(10925049) (6edf4294-194e-42b5-82aa-26f4933c15f4)
08:27:52 reviews: Job OK (6edf4294-194e-42b5-82aa-26f4933c15f4)
08:27:52 Result is kept for 500 seconds
08:27:52 
08:27:52 *** Listening on chapters, profiles, reviews...
08:27:52 reviews: fanfic.jobs.crawl_reviews(10926003) (b83c8874-2df2-42fa-bfd2-75d85038eee6)
2017-02-08 08:27:57 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 16:27:57.634386', 10926003, 225560273, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1262641&amp;r ... (1122 characters truncated) ... ago you wrote this or if it is your first story. I mean no offence but seriously I honestly couldn\'t read more than one paragraph!</div></td>\n</tr>'), ('2017-02-08 16:27:57.634390', 10926003, 224836007, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=705691&amp;rw ... (902 characters truncated) ... op:5px">I\'m sorry, if the format is like this (with all the -) i cant read any further. Its HORRIBLE formatting! And hurts my head</div></td>\n</tr>'), ('2017-02-08 16:27:57.634393', 10926003, 216863914, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6604161&amp;r ... (864 characters truncated) ... >3/9/2015</span> </small><div style="margin-top:5px">Oh God, this woman is a bitch!<br>\nI hope someone saves Snape...<br>\nKisses!</div></td>\n</tr>'), ('2017-02-08 16:27:57.634395', 10926003, 216863747, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6604161&amp;r ... (836 characters truncated) ... an data-xutime="1425947145">3/9/2015</span> </small><div style="margin-top:5px">New reader, just loving your Fanfic...<br>\nKisses!</div></td>\n</tr>'), ('2017-02-08 16:27:57.634397', 10926003, 216417851, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (527 characters truncated) ... ray">chapter 1 . <span data-xutime="1425222915">3/1/2015</span> </small><div style="margin-top:5px">U shud upload it in wattpad too</div></td>\n</tr>'), ('2017-02-08 16:27:57.634399', 10926003, 216373263, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6570138&amp;r ... (841 characters truncated) ... an data-xutime="1425153666">2/28/2015</span> </small><div style="margin-top:5px">I am a new reader, I am just loving your Fanfic...</div></td>\n</tr>'), ('2017-02-08 16:27:57.634400', 10926003, 216366636, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6566345&amp;r ... (856 characters truncated) ... 43">2/28/2015</span> </small><div style="margin-top:5px">I think Audrey could kill this Tobias...<br>\nI am enjoying this Fanfic...</div></td>\n</tr>'), ('2017-02-08 16:27:57.634402', 10926003, 216366548, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6566345&amp;r ... (854 characters truncated) ... 3305">2/28/2015</span> </small><div style="margin-top:5px">Yoy explained very well why Snape could be Hermione\'s uncle... Go on...</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-08 16:27:57.634426', 10926003, 215993360, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6277431&amp;r ... (1000 characters truncated) ... nk English is not your first language? You really need to get a beta reader, I\'m afraid it doesn\'t make much sense at the moment.</div></td>\n</tr>'), ('2017-02-08 16:27:57.634428', 10926003, 213155140, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (710 characters truncated) ... aps read it out loud and then you will see what I mean? I like the idea, but as it stands, it doesn\'t make a huge amount of sense.</div></td>\n</tr>'))]
08:27:57 reviews: Job OK (b83c8874-2df2-42fa-bfd2-75d85038eee6)
08:27:57 Result is kept for 500 seconds
08:27:57 
08:27:57 *** Listening on chapters, profiles, reviews...
08:27:57 reviews: fanfic.jobs.crawl_reviews(10928739) (9e4041f0-ebe2-4448-a12d-21543813f224)
08:28:57 reviews: Job OK (9e4041f0-ebe2-4448-a12d-21543813f224)
08:28:57 Result is kept for 500 seconds
08:28:57 
08:28:57 *** Listening on chapters, profiles, reviews...
08:28:57 reviews: fanfic.jobs.crawl_reviews(10929355) (a892308f-2811-4e48-953d-19300acd02ab)
08:29:21 reviews: Job OK (a892308f-2811-4e48-953d-19300acd02ab)
08:29:21 Result is kept for 500 seconds
08:29:21 
08:29:21 *** Listening on chapters, profiles, reviews...
08:29:21 reviews: fanfic.jobs.crawl_reviews(10929919) (f6e24482-633d-4d0d-b36e-6272158c5e40)
08:29:25 reviews: Job OK (f6e24482-633d-4d0d-b36e-6272158c5e40)
08:29:25 Result is kept for 500 seconds
08:29:25 
08:29:25 *** Listening on chapters, profiles, reviews...
08:29:25 reviews: fanfic.jobs.crawl_reviews(10932567) (6bc80ad7-61f9-4f0d-ac48-63812d03afd7)
08:29:53 reviews: Job OK (6bc80ad7-61f9-4f0d-ac48-63812d03afd7)
08:29:53 Result is kept for 500 seconds
08:29:53 
08:29:53 *** Listening on chapters, profiles, reviews...
08:29:53 reviews: fanfic.jobs.crawl_reviews(10933898) (1907d308-d9db-4ff1-bf71-b9834f3406be)
08:29:59 reviews: Job OK (1907d308-d9db-4ff1-bf71-b9834f3406be)
08:29:59 Result is kept for 500 seconds
08:29:59 
08:29:59 *** Listening on chapters, profiles, reviews...
08:29:59 reviews: fanfic.jobs.crawl_reviews(10934052) (25786ad3-7359-4c8c-9cac-b7f7b29fe93f)
2017-02-08 08:30:04 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 16:30:04.326665', 10934052, 239602378, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=816775&amp;rw ... (960 characters truncated) ... ">7/18/2016</span> </small><div style="margin-top:5px">I like! But now I have to read Order of Merlin again to refresh my memory :)</div></td>\n</tr>'), ('2017-02-08 16:30:04.326670', 10934052, 229949911, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (638 characters truncated) ... gize, I thought the review would be tied to a specific chapter. The comment about \'Insure\' is referring to the end of Chapter 01.</div></td>\n</tr>'), ('2017-02-08 16:30:04.326672', 10934052, 229949817, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (632 characters truncated) ...  thought you\'d appreciate knowing that \'Insure\' is actually spelled \'Ensure\' when you use it the paragraph third from the end.</div></td>\n</tr>'), ('2017-02-08 16:30:04.326674', 10934052, 213669318, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (518 characters truncated) ... yle="color:gray">chapter 43 . <span data-xutime="1420783759">1/8/2015</span> </small><div style="margin-top:5px">Wonderful story :)</div></td>\n</tr>'), ('2017-02-08 16:30:04.326676', 10934052, 213508534, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (576 characters truncated) ... ">1/5/2015</span> </small><div style="margin-top:5px">You have the paragraph about harry costing gwen 2 gallons twice in chapter 8.</div></td>\n</tr>'), ('2017-02-08 16:30:04.326678', 10934052, 213319857, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (702 characters truncated) ... y awaiting the sequel. I am so glad you are continuing your daughters legacy. I am rereading The Order of the Merlin first though:)</div></td>\n</tr>'), ('2017-02-08 16:30:04.326680', 10934052, 213318695, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (714 characters truncated) ... ing like this with my kids and i thank God everyday for them. You have a strength i admire and your daughters spirit will carry on.</div></td>\n</tr>'), ('2017-02-08 16:30:04.326682', 10934052, 239602378, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=816775&amp;rw ... (960 characters truncated) ... ">7/18/2016</span> </small><div style="margin-top:5px">I like! But now I have to read Order of Merlin again to refresh my memory :)</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-08 16:30:04.326692', 10934052, 213319857, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (702 characters truncated) ... y awaiting the sequel. I am so glad you are continuing your daughters legacy. I am rereading The Order of the Merlin first though:)</div></td>\n</tr>'), ('2017-02-08 16:30:04.326693', 10934052, 213318695, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (714 characters truncated) ... ing like this with my kids and i thank God everyday for them. You have a strength i admire and your daughters spirit will carry on.</div></td>\n</tr>'))]
08:30:04 reviews: Job OK (25786ad3-7359-4c8c-9cac-b7f7b29fe93f)
08:30:04 Result is kept for 500 seconds
08:30:04 
08:30:04 *** Listening on chapters, profiles, reviews...
08:30:04 reviews: fanfic.jobs.crawl_reviews(10937871) (901dac62-a4f5-4b34-a994-74a9bd97ebc1)
08:41:43 reviews: Job OK (901dac62-a4f5-4b34-a994-74a9bd97ebc1)
08:41:43 Result is kept for 500 seconds
08:41:43 Cleaning registries for queue: chapters
08:41:43 Cleaning registries for queue: profiles
08:41:43 Cleaning registries for queue: reviews
08:41:43 
08:41:43 *** Listening on chapters, profiles, reviews...
08:41:43 reviews: fanfic.jobs.crawl_reviews(10938974) (fff46409-cbaa-4f45-9b36-635d227363e7)
08:45:09 reviews: Job OK (fff46409-cbaa-4f45-9b36-635d227363e7)
08:45:09 Result is kept for 500 seconds
08:45:09 
08:45:09 *** Listening on chapters, profiles, reviews...
08:45:09 reviews: fanfic.jobs.crawl_reviews(10939050) (d1d8b389-af87-4889-bda4-985785cc4064)
08:45:35 reviews: Job OK (d1d8b389-af87-4889-bda4-985785cc4064)
08:45:35 Result is kept for 500 seconds
08:45:35 
08:45:35 *** Listening on chapters, profiles, reviews...
08:45:35 reviews: fanfic.jobs.crawl_reviews(10939132) (7f932920-422e-40f6-869b-b6f9a25eae6f)
08:47:08 reviews: Job OK (7f932920-422e-40f6-869b-b6f9a25eae6f)
08:47:08 Result is kept for 500 seconds
08:47:08 
08:47:08 *** Listening on chapters, profiles, reviews...
08:47:08 reviews: fanfic.jobs.crawl_reviews(10939232) (fcb3cd23-71fa-40c0-85e0-37c2b2d3c6d8)
08:47:29 reviews: Job OK (fcb3cd23-71fa-40c0-85e0-37c2b2d3c6d8)
08:47:29 Result is kept for 500 seconds
08:47:29 
08:47:29 *** Listening on chapters, profiles, reviews...
08:47:29 reviews: fanfic.jobs.crawl_reviews(10940622) (35df6fd2-1a1e-4203-91b3-bc9cbe1b4f43)
08:48:10 reviews: Job OK (35df6fd2-1a1e-4203-91b3-bc9cbe1b4f43)
08:48:10 Result is kept for 500 seconds
08:48:10 
08:48:10 *** Listening on chapters, profiles, reviews...
08:48:10 reviews: fanfic.jobs.crawl_reviews(10941638) (442d31e5-2038-4726-843b-467a77006a87)
08:50:23 reviews: Job OK (442d31e5-2038-4726-843b-467a77006a87)
08:50:23 Result is kept for 500 seconds
08:50:23 
08:50:23 *** Listening on chapters, profiles, reviews...
08:50:23 reviews: fanfic.jobs.crawl_reviews(10941685) (94f34813-b49e-4f2f-88a3-11249dec2940)
08:50:40 reviews: Job OK (94f34813-b49e-4f2f-88a3-11249dec2940)
08:50:40 Result is kept for 500 seconds
08:50:40 
08:50:40 *** Listening on chapters, profiles, reviews...
08:50:40 reviews: fanfic.jobs.crawl_reviews(10942056) (b048c3ef-dc28-4d89-a884-2df3431ee4df)
08:53:18 reviews: Job OK (b048c3ef-dc28-4d89-a884-2df3431ee4df)
08:53:18 Result is kept for 500 seconds
08:53:18 
08:53:18 *** Listening on chapters, profiles, reviews...
08:53:18 reviews: fanfic.jobs.crawl_reviews(10942218) (700e3e70-e1c0-4f7e-803d-74d05f351384)
08:53:46 reviews: Job OK (700e3e70-e1c0-4f7e-803d-74d05f351384)
08:53:46 Result is kept for 500 seconds
08:53:46 
08:53:46 *** Listening on chapters, profiles, reviews...
08:53:46 reviews: fanfic.jobs.crawl_reviews(10943551) (a3c9e7e3-5ce1-43b9-930e-8596af4c1f1c)
08:57:53 reviews: Job OK (a3c9e7e3-5ce1-43b9-930e-8596af4c1f1c)
08:57:53 Result is kept for 500 seconds
08:57:53 
08:57:53 *** Listening on chapters, profiles, reviews...
08:57:53 reviews: fanfic.jobs.crawl_reviews(10943604) (a3c9be30-8e04-48a2-a43a-e20ff0b3b16a)
08:58:03 reviews: Job OK (a3c9be30-8e04-48a2-a43a-e20ff0b3b16a)
08:58:03 Result is kept for 500 seconds
08:58:03 
08:58:03 *** Listening on chapters, profiles, reviews...
08:58:03 reviews: fanfic.jobs.crawl_reviews(10943725) (46444f5f-2e65-49ec-8ad8-53ae47f7d0a2)
08:58:41 reviews: Job OK (46444f5f-2e65-49ec-8ad8-53ae47f7d0a2)
08:58:41 Result is kept for 500 seconds
08:58:41 
08:58:41 *** Listening on chapters, profiles, reviews...
08:58:41 reviews: fanfic.jobs.crawl_reviews(10945260) (a20126ec-1921-490e-9e89-0ad4b24880dd)
09:00:10 reviews: Job OK (a20126ec-1921-490e-9e89-0ad4b24880dd)
09:00:10 Result is kept for 500 seconds
09:00:10 
09:00:10 *** Listening on chapters, profiles, reviews...
09:00:10 reviews: fanfic.jobs.crawl_reviews(10945346) (b5133f3f-7021-4e4a-b689-40dfd1acc228)
09:00:15 reviews: Job OK (b5133f3f-7021-4e4a-b689-40dfd1acc228)
09:00:15 Result is kept for 500 seconds
09:00:15 
09:00:15 *** Listening on chapters, profiles, reviews...
09:00:15 reviews: fanfic.jobs.crawl_reviews(10945906) (4ddd0e5c-de3a-47cf-a8a2-c4cdfac4d0ca)
09:00:20 reviews: Job OK (4ddd0e5c-de3a-47cf-a8a2-c4cdfac4d0ca)
09:00:20 Result is kept for 500 seconds
09:00:20 
09:00:20 *** Listening on chapters, profiles, reviews...
09:00:20 reviews: fanfic.jobs.crawl_reviews(10946104) (84c96b06-ff0c-49e4-881b-ff28fd9089a1)
09:00:53 reviews: Job OK (84c96b06-ff0c-49e4-881b-ff28fd9089a1)
09:00:53 Result is kept for 500 seconds
09:00:53 
09:00:53 *** Listening on chapters, profiles, reviews...
09:00:53 reviews: fanfic.jobs.crawl_reviews(10946650) (42a63b06-adc7-4e97-8412-d7d476953fdb)
09:03:24 reviews: Job OK (42a63b06-adc7-4e97-8412-d7d476953fdb)
09:03:24 Result is kept for 500 seconds
09:03:24 
09:03:24 *** Listening on chapters, profiles, reviews...
09:03:24 reviews: fanfic.jobs.crawl_reviews(10947156) (4a6d979b-fe50-461d-bf67-98c3ff8e572c)
09:04:55 reviews: Job OK (4a6d979b-fe50-461d-bf67-98c3ff8e572c)
09:04:55 Result is kept for 500 seconds
09:04:55 
09:04:55 *** Listening on chapters, profiles, reviews...
09:04:55 reviews: fanfic.jobs.crawl_reviews(10948151) (59e50951-0c13-43f6-90c6-ddf85152979c)
09:06:44 reviews: Job OK (59e50951-0c13-43f6-90c6-ddf85152979c)
09:06:44 Result is kept for 500 seconds
09:06:44 
09:06:44 *** Listening on chapters, profiles, reviews...
09:06:44 reviews: fanfic.jobs.crawl_reviews(10948484) (50e49f60-71e9-40df-b732-9bbac6a9c374)
09:10:07 reviews: Job OK (50e49f60-71e9-40df-b732-9bbac6a9c374)
09:10:07 Result is kept for 500 seconds
09:10:07 
09:10:07 *** Listening on chapters, profiles, reviews...
09:10:07 reviews: fanfic.jobs.crawl_reviews(10948894) (0f33589b-19c2-47d3-8690-b1b2b89ed6df)
09:10:13 reviews: Job OK (0f33589b-19c2-47d3-8690-b1b2b89ed6df)
09:10:13 Result is kept for 500 seconds
09:10:13 
09:10:13 *** Listening on chapters, profiles, reviews...
09:10:13 reviews: fanfic.jobs.crawl_reviews(10949983) (8f59be45-6bfc-4de8-bb98-bf30591200ef)
09:10:23 reviews: Job OK (8f59be45-6bfc-4de8-bb98-bf30591200ef)
09:10:23 Result is kept for 500 seconds
09:10:23 
09:10:23 *** Listening on chapters, profiles, reviews...
09:10:23 reviews: fanfic.jobs.crawl_reviews(10949984) (94713326-6244-4d58-8f99-81c349246e50)
09:10:38 reviews: Job OK (94713326-6244-4d58-8f99-81c349246e50)
09:10:38 Result is kept for 500 seconds
09:10:38 
09:10:38 *** Listening on chapters, profiles, reviews...
09:10:38 reviews: fanfic.jobs.crawl_reviews(10950365) (8871e169-6a6f-4be7-9fd4-6db7011c4611)
09:11:11 reviews: Job OK (8871e169-6a6f-4be7-9fd4-6db7011c4611)
09:11:11 Result is kept for 500 seconds
09:11:11 
09:11:11 *** Listening on chapters, profiles, reviews...
09:11:11 reviews: fanfic.jobs.crawl_reviews(10951693) (a673c7d4-e84f-4cd3-96ff-a415b00cdd73)
09:11:19 reviews: Job OK (a673c7d4-e84f-4cd3-96ff-a415b00cdd73)
09:11:19 Result is kept for 500 seconds
09:11:19 
09:11:19 *** Listening on chapters, profiles, reviews...
09:11:19 reviews: fanfic.jobs.crawl_reviews(10953184) (5c05b8aa-ce43-4e30-9af5-30811e02af86)
09:11:35 reviews: Job OK (5c05b8aa-ce43-4e30-9af5-30811e02af86)
09:11:35 Result is kept for 500 seconds
09:11:35 
09:11:35 *** Listening on chapters, profiles, reviews...
09:11:35 reviews: fanfic.jobs.crawl_reviews(10954658) (ac615430-ce47-40f1-a685-9ffae1e8b34f)
09:12:53 reviews: Job OK (ac615430-ce47-40f1-a685-9ffae1e8b34f)
09:12:53 Result is kept for 500 seconds
09:12:53 
09:12:53 *** Listening on chapters, profiles, reviews...
09:12:53 reviews: fanfic.jobs.crawl_reviews(10954786) (365dfd93-4805-425a-99f0-a547cc455fd0)
09:13:20 reviews: Job OK (365dfd93-4805-425a-99f0-a547cc455fd0)
09:13:20 Result is kept for 500 seconds
09:13:20 
09:13:20 *** Listening on chapters, profiles, reviews...
09:13:20 reviews: fanfic.jobs.crawl_reviews(10957180) (9f16a7f7-a052-462f-8a86-669b447e47a8)
09:13:47 reviews: Job OK (9f16a7f7-a052-462f-8a86-669b447e47a8)
09:13:47 Result is kept for 500 seconds
09:13:47 
09:13:47 *** Listening on chapters, profiles, reviews...
09:13:47 reviews: fanfic.jobs.crawl_reviews(10957834) (56aa01cd-d8fb-4030-8cb2-9b5a48a16c8e)
09:14:23 reviews: Job OK (56aa01cd-d8fb-4030-8cb2-9b5a48a16c8e)
09:14:23 Result is kept for 500 seconds
09:14:23 
09:14:23 *** Listening on chapters, profiles, reviews...
09:14:23 reviews: fanfic.jobs.crawl_reviews(10960462) (31d59607-0219-42e6-bab9-ed84d0a965bc)
09:14:43 reviews: Job OK (31d59607-0219-42e6-bab9-ed84d0a965bc)
09:14:43 Result is kept for 500 seconds
09:14:43 
09:14:43 *** Listening on chapters, profiles, reviews...
09:14:43 reviews: fanfic.jobs.crawl_reviews(10962500) (12914d43-60b5-4b3b-a3bc-5d57c852f865)
09:22:19 reviews: Job OK (12914d43-60b5-4b3b-a3bc-5d57c852f865)
09:22:19 Result is kept for 500 seconds
09:22:19 
09:22:19 *** Listening on chapters, profiles, reviews...
09:22:19 reviews: fanfic.jobs.crawl_reviews(10962769) (c2c1687d-cda6-4e89-926c-e238820671b5)
09:22:24 reviews: Job OK (c2c1687d-cda6-4e89-926c-e238820671b5)
09:22:24 Result is kept for 500 seconds
09:22:24 
09:22:24 *** Listening on chapters, profiles, reviews...
09:22:24 reviews: fanfic.jobs.crawl_reviews(10963743) (7b1e3edc-b51d-4722-ad2c-bc07f4d44930)
09:22:57 reviews: Job OK (7b1e3edc-b51d-4722-ad2c-bc07f4d44930)
09:22:57 Result is kept for 500 seconds
09:22:57 
09:22:57 *** Listening on chapters, profiles, reviews...
09:22:57 reviews: fanfic.jobs.crawl_reviews(10965962) (5384cfd2-15c1-41f4-9a02-26d0349a1273)
09:25:39 reviews: Job OK (5384cfd2-15c1-41f4-9a02-26d0349a1273)
09:25:39 Result is kept for 500 seconds
09:25:39 
09:25:39 *** Listening on chapters, profiles, reviews...
09:25:39 reviews: fanfic.jobs.crawl_reviews(10967905) (add417c2-62d7-49a0-aa52-0aa2701cd3be)
09:27:51 reviews: Job OK (add417c2-62d7-49a0-aa52-0aa2701cd3be)
09:27:51 Result is kept for 500 seconds
09:27:51 
09:27:51 *** Listening on chapters, profiles, reviews...
09:27:51 reviews: fanfic.jobs.crawl_reviews(10968595) (471259b3-ca2b-46b7-914e-105853e289dc)
09:28:04 reviews: Job OK (471259b3-ca2b-46b7-914e-105853e289dc)
09:28:04 Result is kept for 500 seconds
09:28:04 
09:28:04 *** Listening on chapters, profiles, reviews...
09:28:04 reviews: fanfic.jobs.crawl_reviews(10969482) (b93d0bfb-a688-40ae-af50-e4caf8bb62e3)
09:29:03 reviews: Job OK (b93d0bfb-a688-40ae-af50-e4caf8bb62e3)
09:29:03 Result is kept for 500 seconds
09:29:03 
09:29:03 *** Listening on chapters, profiles, reviews...
09:29:03 reviews: fanfic.jobs.crawl_reviews(10969609) (0edadc2a-7cb9-4ca8-ad0a-ff8fb6d5d9c5)
09:30:29 reviews: Job OK (0edadc2a-7cb9-4ca8-ad0a-ff8fb6d5d9c5)
09:30:29 Result is kept for 500 seconds
09:30:29 
09:30:29 *** Listening on chapters, profiles, reviews...
09:30:29 reviews: fanfic.jobs.crawl_reviews(10969817) (1dee28d8-acf6-4a1e-bba6-8ab1e49d0b33)
09:32:18 reviews: Job OK (1dee28d8-acf6-4a1e-bba6-8ab1e49d0b33)
09:32:18 Result is kept for 500 seconds
09:32:18 
09:32:18 *** Listening on chapters, profiles, reviews...
09:32:18 reviews: fanfic.jobs.crawl_reviews(10970008) (90bbad24-e5f8-4bd4-b25c-fd600eaa19f7)
09:32:45 reviews: Job OK (90bbad24-e5f8-4bd4-b25c-fd600eaa19f7)
09:32:45 Result is kept for 500 seconds
09:32:45 
09:32:45 *** Listening on chapters, profiles, reviews...
09:32:45 reviews: fanfic.jobs.crawl_reviews(10971508) (7447da04-1154-4c49-92c2-26765ea070c5)
09:33:55 reviews: Job OK (7447da04-1154-4c49-92c2-26765ea070c5)
09:33:55 Result is kept for 500 seconds
09:33:55 
09:33:55 *** Listening on chapters, profiles, reviews...
09:33:55 reviews: fanfic.jobs.crawl_reviews(10972919) (e6392562-890f-4bb9-b3f1-cadbedaa4aea)
09:40:30 reviews: Job OK (e6392562-890f-4bb9-b3f1-cadbedaa4aea)
09:40:30 Result is kept for 500 seconds
09:40:30 
09:40:30 *** Listening on chapters, profiles, reviews...
09:40:30 reviews: fanfic.jobs.crawl_reviews(10978114) (58df0fa8-625e-4920-942a-b3f8ceda98bf)
09:41:01 reviews: Job OK (58df0fa8-625e-4920-942a-b3f8ceda98bf)
09:41:01 Result is kept for 500 seconds
09:41:01 
09:41:01 *** Listening on chapters, profiles, reviews...
09:41:01 reviews: fanfic.jobs.crawl_reviews(10980394) (e73c06d5-5074-4a1a-8d4f-aae759200da8)
2017-02-08 09:41:06 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 17:41:06.603676', 10980394, 228635107, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1488154&amp;r ... (905 characters truncated) ... gray">chapter 38 . <span data-xutime="1446580458">11/3/2015</span> </small><div style="margin-top:5px">Ok this is epic...very epic.</div></td>\n</tr>'), ('2017-02-08 17:41:06.603680', 10980394, 228634095, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1488154&amp;r ... (891 characters truncated) ...  style="color:gray">chapter 37 . <span data-xutime="1446578522">11/3/2015</span> </small><div style="margin-top:5px">Good story o.o</div></td>\n</tr>'), ('2017-02-08 17:41:06.603682', 10980394, 228618926, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1488154&amp;r ... (1256 characters truncated) ... against deatheaters...with the right tools..a Harry that gave up magic...lucius Malloy vs sniper rifle...ha. voldemort vs landmine.</div></td>\n</tr>'), ('2017-02-08 17:41:06.603684', 10980394, 228570342, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1488154&amp;r ... (896 characters truncated) ... e="color:gray">chapter 33 . <span data-xutime="1446446693">11/1/2015</span> </small><div style="margin-top:5px">also a good one o.o</div></td>\n</tr>'), ('2017-02-08 17:41:06.603686', 10980394, 228542161, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1396752&amp;r ... (1019 characters truncated) ... ntinue this story i like it and i like to see where this story is gone and what is going to happen next please update when you can.</div></td>\n</tr>'), ('2017-02-08 17:41:06.603688', 10980394, 228539827, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1488154&amp;r ... (962 characters truncated) ... 15</span> </small><div style="margin-top:5px">...Ok WHY wasnt this a series?This is EPIC...<br>\n<br>\nAlso, Indomitable Maelstrom?</div></td>\n</tr>'), ('2017-02-08 17:41:06.603690', 10980394, 228530865, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5147509&amp;r ... (949 characters truncated) ... ">11/1/2015</span> </small><div style="margin-top:5px">holy hell i love this! i hope you do this as a continued story! its amazing!</div></td>\n</tr>'), ('2017-02-08 17:41:06.603692', 10980394, 228525590, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1488154&amp;r ... (1007 characters truncated) ... >for a about \'New Roots?\' you know..littleroot town and the fact hes basically in a new life?<br>\n<br>\nNot bad for a story btw.</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-08 17:41:06.603724', 10980394, 214187320, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1488154&amp;r ... (891 characters truncated) ...  style="color:gray">chapter 3 . <span data-xutime="1421610737">1/18/2015</span> </small><div style="margin-top:5px">I enjoyed this.</div></td>\n</tr>'), ('2017-02-08 17:41:06.603725', 10980394, 214185946, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1488154&amp;r ... (933 characters truncated) ... -xutime="1421608977">1/18/2015</span> </small><div style="margin-top:5px">...is it me,or was that mayor just an ass?in any story...</div></td>\n</tr>'))]
09:41:06 reviews: Job OK (e73c06d5-5074-4a1a-8d4f-aae759200da8)
09:41:06 Result is kept for 500 seconds
09:41:06 
09:41:06 *** Listening on chapters, profiles, reviews...
09:41:06 reviews: fanfic.jobs.crawl_reviews(10980864) (9e39675b-86ba-4cc2-aba6-40505266de87)
09:41:12 reviews: Job OK (9e39675b-86ba-4cc2-aba6-40505266de87)
09:41:12 Result is kept for 500 seconds
09:41:12 
09:41:12 *** Listening on chapters, profiles, reviews...
09:41:12 reviews: fanfic.jobs.crawl_reviews(10981449) (8fcc82ec-9945-42fe-a8db-2c9b12d3d1e1)
09:43:23 reviews: Job OK (8fcc82ec-9945-42fe-a8db-2c9b12d3d1e1)
09:43:23 Result is kept for 500 seconds
09:43:23 Cleaning registries for queue: chapters
09:43:23 Cleaning registries for queue: profiles
09:43:23 Cleaning registries for queue: reviews
09:43:23 
09:43:23 *** Listening on chapters, profiles, reviews...
09:43:23 reviews: fanfic.jobs.crawl_reviews(10981919) (92bea3f6-907d-467b-be83-f50d963e210e)
09:44:02 reviews: Job OK (92bea3f6-907d-467b-be83-f50d963e210e)
09:44:02 Result is kept for 500 seconds
09:44:02 
09:44:02 *** Listening on chapters, profiles, reviews...
09:44:02 reviews: fanfic.jobs.crawl_reviews(10982675) (3920d736-8074-4d03-9ebe-bc535da69b4d)
09:45:42 reviews: Job OK (3920d736-8074-4d03-9ebe-bc535da69b4d)
09:45:42 Result is kept for 500 seconds
09:45:42 
09:45:42 *** Listening on chapters, profiles, reviews...
09:45:42 reviews: fanfic.jobs.crawl_reviews(10983098) (8b9d8c95-582d-4174-8ab2-0885bab2c64d)
09:49:41 reviews: Job OK (8b9d8c95-582d-4174-8ab2-0885bab2c64d)
09:49:41 Result is kept for 500 seconds
09:49:41 
09:49:41 *** Listening on chapters, profiles, reviews...
09:49:41 reviews: fanfic.jobs.crawl_reviews(10983696) (f78bbe4d-e7af-41be-add1-55a8eace27ed)
09:50:10 reviews: Job OK (f78bbe4d-e7af-41be-add1-55a8eace27ed)
09:50:10 Result is kept for 500 seconds
09:50:10 
09:50:10 *** Listening on chapters, profiles, reviews...
09:50:10 reviews: fanfic.jobs.crawl_reviews(10983841) (b63317f8-4912-4a48-960b-a04d4e928506)
09:50:29 reviews: Job OK (b63317f8-4912-4a48-960b-a04d4e928506)
09:50:29 Result is kept for 500 seconds
09:50:29 
09:50:29 *** Listening on chapters, profiles, reviews...
09:50:29 reviews: fanfic.jobs.crawl_reviews(10984095) (e2eaa9d8-572c-482a-ae11-76fe5939f071)
09:50:49 reviews: Job OK (e2eaa9d8-572c-482a-ae11-76fe5939f071)
09:50:49 Result is kept for 500 seconds
09:50:49 
09:50:49 *** Listening on chapters, profiles, reviews...
09:50:49 reviews: fanfic.jobs.crawl_reviews(10984503) (d7be5f9c-4f95-4547-b965-5a82c78c9e8a)
09:50:54 reviews: Job OK (d7be5f9c-4f95-4547-b965-5a82c78c9e8a)
09:50:54 Result is kept for 500 seconds
09:50:54 
09:50:54 *** Listening on chapters, profiles, reviews...
09:50:54 reviews: fanfic.jobs.crawl_reviews(10984969) (fd479155-9b8c-4182-8584-9f59053b7af4)
09:52:36 reviews: Job OK (fd479155-9b8c-4182-8584-9f59053b7af4)
09:52:36 Result is kept for 500 seconds
09:52:36 
09:52:36 *** Listening on chapters, profiles, reviews...
09:52:36 reviews: fanfic.jobs.crawl_reviews(10986827) (470a7557-4080-40b6-849d-1a58f9825abe)
09:53:08 reviews: Job OK (470a7557-4080-40b6-849d-1a58f9825abe)
09:53:08 Result is kept for 500 seconds
09:53:08 
09:53:08 *** Listening on chapters, profiles, reviews...
09:53:08 reviews: fanfic.jobs.crawl_reviews(10987651) (77c60226-f968-4b3d-b690-f037ccdd3be4)
09:53:35 reviews: Job OK (77c60226-f968-4b3d-b690-f037ccdd3be4)
09:53:35 Result is kept for 500 seconds
09:53:35 
09:53:35 *** Listening on chapters, profiles, reviews...
09:53:35 reviews: fanfic.jobs.crawl_reviews(10987741) (bb27ce01-9f16-447f-b313-6162ce633eb3)
09:54:38 reviews: Job OK (bb27ce01-9f16-447f-b313-6162ce633eb3)
09:54:38 Result is kept for 500 seconds
09:54:39 
09:54:39 *** Listening on chapters, profiles, reviews...
09:54:39 reviews: fanfic.jobs.crawl_reviews(10988263) (edfa88b1-ef56-46cd-944b-328df0922dd2)
09:54:47 reviews: Job OK (edfa88b1-ef56-46cd-944b-328df0922dd2)
09:54:47 Result is kept for 500 seconds
09:54:47 
09:54:47 *** Listening on chapters, profiles, reviews...
09:54:47 reviews: fanfic.jobs.crawl_reviews(10988610) (50150a67-0520-4a8f-adb7-b4aa142249e2)
09:55:06 reviews: Job OK (50150a67-0520-4a8f-adb7-b4aa142249e2)
09:55:06 Result is kept for 500 seconds
09:55:06 
09:55:06 *** Listening on chapters, profiles, reviews...
09:55:06 reviews: fanfic.jobs.crawl_reviews(10990219) (003113a3-7a38-403b-9863-6568942c7cff)
09:55:45 reviews: Job OK (003113a3-7a38-403b-9863-6568942c7cff)
09:55:45 Result is kept for 500 seconds
09:55:45 
09:55:45 *** Listening on chapters, profiles, reviews...
09:55:45 reviews: fanfic.jobs.crawl_reviews(10990515) (ce8720fd-fe57-4c6d-9716-23d535b27880)
09:55:50 reviews: Job OK (ce8720fd-fe57-4c6d-9716-23d535b27880)
09:55:50 Result is kept for 500 seconds
09:55:50 
09:55:50 *** Listening on chapters, profiles, reviews...
09:55:50 reviews: fanfic.jobs.crawl_reviews(10990939) (46a2e3b9-dbd3-4044-8bab-8ee400d64ee8)
09:57:06 reviews: Job OK (46a2e3b9-dbd3-4044-8bab-8ee400d64ee8)
09:57:06 Result is kept for 500 seconds
09:57:06 
09:57:06 *** Listening on chapters, profiles, reviews...
09:57:06 reviews: fanfic.jobs.crawl_reviews(10991214) (15c1a246-8a71-49dc-a2ca-1ec8b3cc5937)
09:59:31 reviews: Job OK (15c1a246-8a71-49dc-a2ca-1ec8b3cc5937)
09:59:31 Result is kept for 500 seconds
09:59:31 
09:59:31 *** Listening on chapters, profiles, reviews...
09:59:31 reviews: fanfic.jobs.crawl_reviews(10991501) (7e8ea351-1da5-43c8-bca4-f60cd2a038cc)
10:06:27 reviews: Job OK (7e8ea351-1da5-43c8-bca4-f60cd2a038cc)
10:06:27 Result is kept for 500 seconds
10:06:27 
10:06:27 *** Listening on chapters, profiles, reviews...
10:06:27 reviews: fanfic.jobs.crawl_reviews(10992918) (8a046eae-642e-4645-9cc2-7dd92b86a6ca)
10:06:39 reviews: Job OK (8a046eae-642e-4645-9cc2-7dd92b86a6ca)
10:06:39 Result is kept for 500 seconds
10:06:39 
10:06:39 *** Listening on chapters, profiles, reviews...
10:06:39 reviews: fanfic.jobs.crawl_reviews(10994557) (f1f16364-73c0-467e-933c-830d6738daaa)
10:07:51 reviews: Job OK (f1f16364-73c0-467e-933c-830d6738daaa)
10:07:51 Result is kept for 500 seconds
10:07:51 
10:07:51 *** Listening on chapters, profiles, reviews...
10:07:51 reviews: fanfic.jobs.crawl_reviews(10996537) (dac70887-c8bb-44fa-acb2-dd2ef70446e2)
10:11:01 reviews: Job OK (dac70887-c8bb-44fa-acb2-dd2ef70446e2)
10:11:01 Result is kept for 500 seconds
10:11:01 
10:11:01 *** Listening on chapters, profiles, reviews...
10:11:01 reviews: fanfic.jobs.crawl_reviews(11000351) (bc78c5d9-3289-4191-9411-d21b27817b10)
10:11:58 reviews: Job OK (bc78c5d9-3289-4191-9411-d21b27817b10)
10:11:58 Result is kept for 500 seconds
10:11:58 
10:11:58 *** Listening on chapters, profiles, reviews...
10:11:58 reviews: fanfic.jobs.crawl_reviews(11000973) (bb42e20d-e86f-4565-817d-7022d8e34310)
10:13:01 reviews: Job OK (bb42e20d-e86f-4565-817d-7022d8e34310)
10:13:01 Result is kept for 500 seconds
10:13:01 
10:13:01 *** Listening on chapters, profiles, reviews...
10:13:01 reviews: fanfic.jobs.crawl_reviews(11001164) (32792e76-c8d5-46c6-b96a-0f440aecfd96)
10:14:40 reviews: Job OK (32792e76-c8d5-46c6-b96a-0f440aecfd96)
10:14:40 Result is kept for 500 seconds
10:14:40 
10:14:40 *** Listening on chapters, profiles, reviews...
10:14:40 reviews: fanfic.jobs.crawl_reviews(11002763) (efbf2e82-f27e-46aa-971d-3127242f3ab5)
10:16:17 reviews: Job OK (efbf2e82-f27e-46aa-971d-3127242f3ab5)
10:16:17 Result is kept for 500 seconds
10:16:17 
10:16:17 *** Listening on chapters, profiles, reviews...
10:16:17 reviews: fanfic.jobs.crawl_reviews(11002862) (2724ae66-5198-46f5-bdda-5744c33e531e)
10:17:32 reviews: Job OK (2724ae66-5198-46f5-bdda-5744c33e531e)
10:17:32 Result is kept for 500 seconds
10:17:32 
10:17:32 *** Listening on chapters, profiles, reviews...
10:17:32 reviews: fanfic.jobs.crawl_reviews(11003456) (b7b3b987-b53c-4588-bdb2-d1674b7e4241)
10:18:40 reviews: Job OK (b7b3b987-b53c-4588-bdb2-d1674b7e4241)
10:18:40 Result is kept for 500 seconds
10:18:40 
10:18:40 *** Listening on chapters, profiles, reviews...
10:18:40 reviews: fanfic.jobs.crawl_reviews(11003905) (738be971-50d5-4c4a-bde2-693281eb47cc)
10:18:54 reviews: Job OK (738be971-50d5-4c4a-bde2-693281eb47cc)
10:18:54 Result is kept for 500 seconds
10:18:54 
10:18:54 *** Listening on chapters, profiles, reviews...
10:18:54 reviews: fanfic.jobs.crawl_reviews(11004556) (df9d7160-1046-40e7-9f8c-b69102c31bbf)
10:19:19 reviews: Job OK (df9d7160-1046-40e7-9f8c-b69102c31bbf)
10:19:19 Result is kept for 500 seconds
10:19:19 
10:19:19 *** Listening on chapters, profiles, reviews...
10:19:19 reviews: fanfic.jobs.crawl_reviews(11005721) (6d114dab-9a43-431b-8640-8006c8e73424)
10:21:17 reviews: Job OK (6d114dab-9a43-431b-8640-8006c8e73424)
10:21:17 Result is kept for 500 seconds
10:21:17 
10:21:17 *** Listening on chapters, profiles, reviews...
10:21:17 reviews: fanfic.jobs.crawl_reviews(11006135) (cd8eee1d-ecc1-42de-bf16-2e523f98fc4e)
10:21:33 reviews: Job OK (cd8eee1d-ecc1-42de-bf16-2e523f98fc4e)
10:21:33 Result is kept for 500 seconds
10:21:33 
10:21:33 *** Listening on chapters, profiles, reviews...
10:21:33 reviews: fanfic.jobs.crawl_reviews(11007018) (ee9116c5-cc69-4669-85c4-656a27948b39)
10:23:41 reviews: Job OK (ee9116c5-cc69-4669-85c4-656a27948b39)
10:23:41 Result is kept for 500 seconds
10:23:41 
10:23:41 *** Listening on chapters, profiles, reviews...
10:23:41 reviews: fanfic.jobs.crawl_reviews(11007271) (9284bc5c-a42f-4b9f-a9d5-b419ece8bfce)
10:24:45 reviews: Job OK (9284bc5c-a42f-4b9f-a9d5-b419ece8bfce)
10:24:45 Result is kept for 500 seconds
10:24:45 
10:24:45 *** Listening on chapters, profiles, reviews...
10:24:45 reviews: fanfic.jobs.crawl_reviews(11007630) (d39345bd-4f9e-4e92-b226-f044d1497adf)
10:24:51 reviews: Job OK (d39345bd-4f9e-4e92-b226-f044d1497adf)
10:24:51 Result is kept for 500 seconds
10:24:51 
10:24:51 *** Listening on chapters, profiles, reviews...
10:24:51 reviews: fanfic.jobs.crawl_reviews(11007767) (64aab2e5-c73a-4d33-bdc9-fe17146c820b)
10:26:32 reviews: Job OK (64aab2e5-c73a-4d33-bdc9-fe17146c820b)
10:26:32 Result is kept for 500 seconds
10:26:32 
10:26:32 *** Listening on chapters, profiles, reviews...
10:26:32 reviews: fanfic.jobs.crawl_reviews(11008683) (7011bdb4-0368-40df-94b7-c3bbe2fbd33e)
10:27:17 reviews: Job OK (7011bdb4-0368-40df-94b7-c3bbe2fbd33e)
10:27:17 Result is kept for 500 seconds
10:27:17 
10:27:17 *** Listening on chapters, profiles, reviews...
10:27:17 reviews: fanfic.jobs.crawl_reviews(11009412) (f8469dc3-4aa1-42c1-9573-7f19f7ca46be)
10:29:43 reviews: Job OK (f8469dc3-4aa1-42c1-9573-7f19f7ca46be)
10:29:43 Result is kept for 500 seconds
10:29:43 
10:29:43 *** Listening on chapters, profiles, reviews...
10:29:43 reviews: fanfic.jobs.crawl_reviews(11010694) (4d15631d-1cfa-4653-8824-ed0c5da6f144)
10:30:41 reviews: Job OK (4d15631d-1cfa-4653-8824-ed0c5da6f144)
10:30:41 Result is kept for 500 seconds
10:30:41 
10:30:41 *** Listening on chapters, profiles, reviews...
10:30:41 reviews: fanfic.jobs.crawl_reviews(11012622) (26ce3419-2b9d-4c17-a1ac-9c8e74793ce6)
10:32:12 reviews: Job OK (26ce3419-2b9d-4c17-a1ac-9c8e74793ce6)
10:32:12 Result is kept for 500 seconds
10:32:12 
10:32:12 *** Listening on chapters, profiles, reviews...
10:32:12 reviews: fanfic.jobs.crawl_reviews(11012992) (acd088e0-436b-4d7a-b88e-7887ed561ced)
10:32:58 reviews: Job OK (acd088e0-436b-4d7a-b88e-7887ed561ced)
10:32:58 Result is kept for 500 seconds
10:32:58 
10:32:58 *** Listening on chapters, profiles, reviews...
10:32:58 reviews: fanfic.jobs.crawl_reviews(11013430) (97f97cc8-7a77-476f-87dc-6a316026ba9f)
10:33:42 reviews: Job OK (97f97cc8-7a77-476f-87dc-6a316026ba9f)
10:33:42 Result is kept for 500 seconds
10:33:42 
10:33:42 *** Listening on chapters, profiles, reviews...
10:33:42 reviews: fanfic.jobs.crawl_reviews(11015763) (f6392223-3355-4642-8bfc-bae91dc72e7e)
10:33:55 reviews: Job OK (f6392223-3355-4642-8bfc-bae91dc72e7e)
10:33:55 Result is kept for 500 seconds
10:33:55 
10:33:55 *** Listening on chapters, profiles, reviews...
10:33:55 reviews: fanfic.jobs.crawl_reviews(11015768) (e7563c7f-353f-4bd0-8760-a535505e9d5a)
10:34:28 reviews: Job OK (e7563c7f-353f-4bd0-8760-a535505e9d5a)
10:34:28 Result is kept for 500 seconds
10:34:28 
10:34:28 *** Listening on chapters, profiles, reviews...
10:34:28 reviews: fanfic.jobs.crawl_reviews(11016545) (fd42c1d5-0294-4036-ab99-a421b5259acc)
10:37:46 reviews: Job OK (fd42c1d5-0294-4036-ab99-a421b5259acc)
10:37:46 Result is kept for 500 seconds
10:37:46 
10:37:46 *** Listening on chapters, profiles, reviews...
10:37:46 reviews: fanfic.jobs.crawl_reviews(11017178) (343e7558-2b06-4a02-a5f9-7fe4933b00d3)
10:38:21 reviews: Job OK (343e7558-2b06-4a02-a5f9-7fe4933b00d3)
10:38:21 Result is kept for 500 seconds
10:38:21 
10:38:21 *** Listening on chapters, profiles, reviews...
10:38:21 reviews: fanfic.jobs.crawl_reviews(11017846) (06c5d2aa-7569-4db1-b3bd-b6f65774958c)
10:39:00 reviews: Job OK (06c5d2aa-7569-4db1-b3bd-b6f65774958c)
10:39:00 Result is kept for 500 seconds
10:39:00 
10:39:00 *** Listening on chapters, profiles, reviews...
10:39:00 reviews: fanfic.jobs.crawl_reviews(11020234) (b033f86b-99e5-4ade-9ff5-7c2a7b7b9a94)
10:39:05 reviews: Job OK (b033f86b-99e5-4ade-9ff5-7c2a7b7b9a94)
10:39:05 Result is kept for 500 seconds
10:39:05 
10:39:05 *** Listening on chapters, profiles, reviews...
10:39:05 reviews: fanfic.jobs.crawl_reviews(11021509) (810264fa-ed27-4d0e-b02c-807e38e704fe)
10:40:03 reviews: Job OK (810264fa-ed27-4d0e-b02c-807e38e704fe)
10:40:03 Result is kept for 500 seconds
10:40:03 
10:40:03 *** Listening on chapters, profiles, reviews...
10:40:03 reviews: fanfic.jobs.crawl_reviews(11021726) (ea09c9e8-dc78-49e8-9c6d-8d606b8c15ee)
10:40:47 reviews: Job OK (ea09c9e8-dc78-49e8-9c6d-8d606b8c15ee)
10:40:47 Result is kept for 500 seconds
10:40:47 
10:40:47 *** Listening on chapters, profiles, reviews...
10:40:47 reviews: fanfic.jobs.crawl_reviews(11022385) (c20e5898-0751-48d5-aa1a-ad706569c426)
10:42:57 reviews: Job OK (c20e5898-0751-48d5-aa1a-ad706569c426)
10:42:57 Result is kept for 500 seconds
10:42:57 
10:42:57 *** Listening on chapters, profiles, reviews...
10:42:57 reviews: fanfic.jobs.crawl_reviews(11022932) (b087cbbe-7e8e-4cae-b09c-22b4446d3bd6)
10:44:18 reviews: Job OK (b087cbbe-7e8e-4cae-b09c-22b4446d3bd6)
10:44:18 Result is kept for 500 seconds
10:44:18 Cleaning registries for queue: chapters
10:44:18 Cleaning registries for queue: profiles
10:44:18 Cleaning registries for queue: reviews
10:44:18 
10:44:18 *** Listening on chapters, profiles, reviews...
10:44:18 reviews: fanfic.jobs.crawl_reviews(11023445) (a875af82-19b4-4bd9-aced-7d0a9c9f9a99)
10:45:17 reviews: Job OK (a875af82-19b4-4bd9-aced-7d0a9c9f9a99)
10:45:17 Result is kept for 500 seconds
10:45:17 
10:45:17 *** Listening on chapters, profiles, reviews...
10:45:17 reviews: fanfic.jobs.crawl_reviews(11024205) (e8705ecd-063e-43fd-bb8d-789748a18534)
10:47:03 reviews: Job OK (e8705ecd-063e-43fd-bb8d-789748a18534)
10:47:03 Result is kept for 500 seconds
10:47:03 
10:47:03 *** Listening on chapters, profiles, reviews...
10:47:03 reviews: fanfic.jobs.crawl_reviews(11024720) (c12adead-3549-40ba-8e24-909bda9a271b)
10:47:40 reviews: Job OK (c12adead-3549-40ba-8e24-909bda9a271b)
10:47:40 Result is kept for 500 seconds
10:47:40 
10:47:40 *** Listening on chapters, profiles, reviews...
10:47:40 reviews: fanfic.jobs.crawl_reviews(11027125) (729a44e4-69a7-4a22-b657-45eb3a7d8150)
11:04:11 reviews: Job OK (729a44e4-69a7-4a22-b657-45eb3a7d8150)
11:04:11 Result is kept for 500 seconds
11:04:11 
11:04:11 *** Listening on chapters, profiles, reviews...
11:04:11 reviews: fanfic.jobs.crawl_reviews(11027712) (06eb52fe-45c7-4874-812b-b37eefe13a0f)
11:05:15 reviews: Job OK (06eb52fe-45c7-4874-812b-b37eefe13a0f)
11:05:15 Result is kept for 500 seconds
11:05:15 
11:05:15 *** Listening on chapters, profiles, reviews...
11:05:15 reviews: fanfic.jobs.crawl_reviews(11029147) (73b57388-97c7-4825-8182-5b4b184994e9)
11:06:46 reviews: Job OK (73b57388-97c7-4825-8182-5b4b184994e9)
11:06:46 Result is kept for 500 seconds
11:06:46 
11:06:46 *** Listening on chapters, profiles, reviews...
11:06:46 reviews: fanfic.jobs.crawl_reviews(11030566) (f9d42376-ad7b-47bd-bf4f-dfa97da19a11)
11:06:59 reviews: Job OK (f9d42376-ad7b-47bd-bf4f-dfa97da19a11)
11:06:59 Result is kept for 500 seconds
11:06:59 
11:06:59 *** Listening on chapters, profiles, reviews...
11:06:59 reviews: fanfic.jobs.crawl_reviews(11031294) (06248801-9faf-4534-bcdb-3fd954289473)
11:08:25 reviews: Job OK (06248801-9faf-4534-bcdb-3fd954289473)
11:08:25 Result is kept for 500 seconds
11:08:25 
11:08:25 *** Listening on chapters, profiles, reviews...
11:08:25 reviews: fanfic.jobs.crawl_reviews(11032082) (a21f454d-dd9e-41e7-b0e9-11dd2834c3ba)
11:08:53 reviews: Job OK (a21f454d-dd9e-41e7-b0e9-11dd2834c3ba)
11:08:53 Result is kept for 500 seconds
11:08:53 
11:08:53 *** Listening on chapters, profiles, reviews...
11:08:53 reviews: fanfic.jobs.crawl_reviews(11033185) (dcb467ea-2d92-4f2a-bbe0-766ab5ae6e8a)
11:08:56 reviews: Job OK (dcb467ea-2d92-4f2a-bbe0-766ab5ae6e8a)
11:08:56 Result is kept for 500 seconds
11:08:56 
11:08:56 *** Listening on chapters, profiles, reviews...
11:08:56 reviews: fanfic.jobs.crawl_reviews(11033216) (6ff63ad2-44b4-40b8-8384-3c0af813ed02)
11:09:08 reviews: Job OK (6ff63ad2-44b4-40b8-8384-3c0af813ed02)
11:09:08 Result is kept for 500 seconds
11:09:08 
11:09:08 *** Listening on chapters, profiles, reviews...
11:09:08 reviews: fanfic.jobs.crawl_reviews(11033616) (d43a9213-f2e8-4660-83de-ce5144b27003)
11:36:48 reviews: Job OK (d43a9213-f2e8-4660-83de-ce5144b27003)
11:36:48 Result is kept for 500 seconds
11:36:48 
11:36:48 *** Listening on chapters, profiles, reviews...
11:36:48 reviews: fanfic.jobs.crawl_reviews(11033708) (25fbd74b-6763-4cdf-86ee-03ecf1882d1c)
11:36:57 reviews: Job OK (25fbd74b-6763-4cdf-86ee-03ecf1882d1c)
11:36:57 Result is kept for 500 seconds
11:36:57 
11:36:57 *** Listening on chapters, profiles, reviews...
11:36:57 reviews: fanfic.jobs.crawl_reviews(11033811) (ab9069c8-b1ce-4512-b871-547198c0039d)
11:37:26 reviews: Job OK (ab9069c8-b1ce-4512-b871-547198c0039d)
11:37:26 Result is kept for 500 seconds
11:37:26 
11:37:26 *** Listening on chapters, profiles, reviews...
11:37:26 reviews: fanfic.jobs.crawl_reviews(11035459) (89086d4f-76ab-4a16-922d-402499d3622d)
11:40:07 reviews: Job OK (89086d4f-76ab-4a16-922d-402499d3622d)
11:40:07 Result is kept for 500 seconds
11:40:07 
11:40:07 *** Listening on chapters, profiles, reviews...
11:40:07 reviews: fanfic.jobs.crawl_reviews(11035814) (8de9e725-3998-430d-8ce4-8bd32dedede1)
11:44:57 reviews: Job OK (8de9e725-3998-430d-8ce4-8bd32dedede1)
11:44:57 Result is kept for 500 seconds
11:44:57 Cleaning registries for queue: chapters
11:44:57 Cleaning registries for queue: profiles
11:44:57 Cleaning registries for queue: reviews
11:44:57 
11:44:57 *** Listening on chapters, profiles, reviews...
11:44:57 reviews: fanfic.jobs.crawl_reviews(11037069) (b4fe3203-de7c-4072-992e-492a4e432323)
11:46:27 reviews: Job OK (b4fe3203-de7c-4072-992e-492a4e432323)
11:46:27 Result is kept for 500 seconds
11:46:27 
11:46:27 *** Listening on chapters, profiles, reviews...
11:46:27 reviews: fanfic.jobs.crawl_reviews(11037264) (6b8f8f71-7290-493d-94bd-117546b9440e)
11:46:36 reviews: Job OK (6b8f8f71-7290-493d-94bd-117546b9440e)
11:46:36 Result is kept for 500 seconds
11:46:36 
11:46:36 *** Listening on chapters, profiles, reviews...
11:46:36 reviews: fanfic.jobs.crawl_reviews(11038036) (b8ec2347-f6af-44d7-99d2-bb199381819e)
11:46:47 reviews: Job OK (b8ec2347-f6af-44d7-99d2-bb199381819e)
11:46:47 Result is kept for 500 seconds
11:46:47 
11:46:47 *** Listening on chapters, profiles, reviews...
11:46:47 reviews: fanfic.jobs.crawl_reviews(11039196) (8f44f399-9ee2-4889-bd16-6d1accce36e2)
11:47:22 reviews: Job OK (8f44f399-9ee2-4889-bd16-6d1accce36e2)
11:47:22 Result is kept for 500 seconds
11:47:22 
11:47:22 *** Listening on chapters, profiles, reviews...
11:47:22 reviews: fanfic.jobs.crawl_reviews(11042648) (722208ac-719a-4b73-8167-094f9b04f192)
11:47:30 reviews: Job OK (722208ac-719a-4b73-8167-094f9b04f192)
11:47:30 Result is kept for 500 seconds
11:47:30 
11:47:30 *** Listening on chapters, profiles, reviews...
11:47:30 reviews: fanfic.jobs.crawl_reviews(11042696) (900d0467-a268-4e12-9c45-ecd82a3cd44c)
11:51:32 reviews: Job OK (900d0467-a268-4e12-9c45-ecd82a3cd44c)
11:51:32 Result is kept for 500 seconds
11:51:32 
11:51:32 *** Listening on chapters, profiles, reviews...
11:51:32 reviews: fanfic.jobs.crawl_reviews(11044882) (3ccd2d5f-73eb-4f2f-a19e-5861dce62e74)
11:54:21 reviews: Job OK (3ccd2d5f-73eb-4f2f-a19e-5861dce62e74)
11:54:21 Result is kept for 500 seconds
11:54:21 
11:54:21 *** Listening on chapters, profiles, reviews...
11:54:21 reviews: fanfic.jobs.crawl_reviews(11046560) (b41c46c9-b568-4d0a-92ec-636265a518b1)
11:54:26 reviews: Job OK (b41c46c9-b568-4d0a-92ec-636265a518b1)
11:54:26 Result is kept for 500 seconds
11:54:26 
11:54:26 *** Listening on chapters, profiles, reviews...
11:54:26 reviews: fanfic.jobs.crawl_reviews(11047720) (c90fc94c-92f3-4979-b53e-f6adb0655bc6)
11:58:51 reviews: Job OK (c90fc94c-92f3-4979-b53e-f6adb0655bc6)
11:58:51 Result is kept for 500 seconds
11:58:51 
11:58:51 *** Listening on chapters, profiles, reviews...
11:58:51 reviews: fanfic.jobs.crawl_reviews(11047955) (2ddc100c-58e7-48a0-9737-18a221480f34)
12:10:48 reviews: Job OK (2ddc100c-58e7-48a0-9737-18a221480f34)
12:10:48 Result is kept for 500 seconds
12:10:48 
12:10:48 *** Listening on chapters, profiles, reviews...
12:10:48 reviews: fanfic.jobs.crawl_reviews(11048322) (c67381d8-beed-40ed-afae-c3e316ee3143)
12:11:27 reviews: Job OK (c67381d8-beed-40ed-afae-c3e316ee3143)
12:11:27 Result is kept for 500 seconds
12:11:27 
12:11:27 *** Listening on chapters, profiles, reviews...
12:11:27 reviews: fanfic.jobs.crawl_reviews(11051612) (79c9153a-0ada-4290-a75b-a15ddc7682f8)
12:13:09 reviews: Job OK (79c9153a-0ada-4290-a75b-a15ddc7682f8)
12:13:09 Result is kept for 500 seconds
12:13:09 
12:13:09 *** Listening on chapters, profiles, reviews...
12:13:09 reviews: fanfic.jobs.crawl_reviews(11052059) (9d1785af-77fe-47e2-b0d6-b7789708377b)
12:13:48 reviews: Job OK (9d1785af-77fe-47e2-b0d6-b7789708377b)
12:13:48 Result is kept for 500 seconds
12:13:48 
12:13:48 *** Listening on chapters, profiles, reviews...
12:13:48 reviews: fanfic.jobs.crawl_reviews(11053807) (21883904-32a5-4d51-8237-596d1d461988)
12:20:07 reviews: Job OK (21883904-32a5-4d51-8237-596d1d461988)
12:20:07 Result is kept for 500 seconds
12:20:07 
12:20:07 *** Listening on chapters, profiles, reviews...
12:20:07 reviews: fanfic.jobs.crawl_reviews(11053992) (bbd9e012-ec3e-4757-bf0f-4728b852ee84)
12:24:20 reviews: Job OK (bbd9e012-ec3e-4757-bf0f-4728b852ee84)
12:24:20 Result is kept for 500 seconds
12:24:20 
12:24:20 *** Listening on chapters, profiles, reviews...
12:24:20 reviews: fanfic.jobs.crawl_reviews(11054453) (33e58edd-668d-4586-8aef-0e14363e6466)
12:25:51 reviews: Job OK (33e58edd-668d-4586-8aef-0e14363e6466)
12:25:51 Result is kept for 500 seconds
12:25:51 
12:25:51 *** Listening on chapters, profiles, reviews...
12:25:51 reviews: fanfic.jobs.crawl_reviews(11054843) (95ab95b4-2a54-412f-b00c-b2771b81b5a6)
12:27:23 reviews: Job OK (95ab95b4-2a54-412f-b00c-b2771b81b5a6)
12:27:23 Result is kept for 500 seconds
12:27:23 
12:27:23 *** Listening on chapters, profiles, reviews...
12:27:23 reviews: fanfic.jobs.crawl_reviews(11055804) (afdc68b2-0b87-4d68-b902-7e927bdd10d3)
2017-02-08 12:27:29 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 20:27:29.287244', 11055804, 216327392, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3298228&amp;r ... (1068 characters truncated) ... lking about he would be shocked and horrified (if he wasn\'t made to forget it).<br>\n<br>\nShe really hates Daphne, and I love it.</div></td>\n</tr>'), ('2017-02-08 20:27:29.287249', 11055804, 216327152, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3298228&amp;r ... (1124 characters truncated) ... upid. She clearly wanted smacked around some more.<br>\n<br>\nMore morals than sleeping with a Gryffindor? That\'s not saying much.</div></td>\n</tr>'), ('2017-02-08 20:27:29.287251', 11055804, 216326849, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3298228&amp;r ... (1259 characters truncated) ... nd wears cute little aprons. The only reason it\'s working out so perfectly now is because her life depends on keeping him pleased.</div></td>\n</tr>'), ('2017-02-08 20:27:29.287253', 11055804, 216326747, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3298228&amp;r ... (1103 characters truncated) ... wering his affection on her. You can tell he really loved Lily, and now he\'s trying his best to pretend that she came back to him.</div></td>\n</tr>'), ('2017-02-08 20:27:29.287255', 11055804, 216326540, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3298228&amp;r ... (1052 characters truncated) ... o strangle her a little. I\'d tell her to toughen up, but yeah. She is who she is, and I suppose her life depends on her obedience.</div></td>\n</tr>'), ('2017-02-08 20:27:29.287257', 11055804, 215817098, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3298228&amp;r ... (943 characters truncated) ... 424230803">2/17/2015</span> </small><div style="margin-top:5px">She\'s never had a period?! Pregnant?!<br>\n<br>\nImma kill Lucius.</div></td>\n</tr>'), ('2017-02-08 20:27:29.287259', 11055804, 215817004, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3298228&amp;r ... (1001 characters truncated) ... :5px">He\'s projecting Lily onto her. That\'s why he seems to love her so desperately (and is paying so much for her). Poor Lilith.</div></td>\n</tr>'), ('2017-02-08 20:27:29.287261', 11055804, 215816898, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3298228&amp;r ... (1017 characters truncated) ... e that neither Draco nor Blaise is deserving of the coveted Slytherin Sex God title. Our favorite gloomy professor has already won.</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-08 20:27:29.287285', 11055804, 215816627, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3298228&amp;r ... (1033 characters truncated) ... >\n<br>\n"They aren\'t used to talking to Slytherin girls. Or Slytherins. Or girls." Explains a lot.<br>\n<br>\nL.M. needs stabbed.</div></td>\n</tr>'), ('2017-02-08 20:27:29.287287', 11055804, 215816412, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3298228&amp;r ... (973 characters truncated) ... small><div style="margin-top:5px">She\'s a "wife of the night". Rough way to go. I wonder who her boss is and who she\'s servicing.</div></td>\n</tr>'))]
12:27:29 reviews: Job OK (afdc68b2-0b87-4d68-b902-7e927bdd10d3)
12:27:29 Result is kept for 500 seconds
12:27:29 
12:27:29 *** Listening on chapters, profiles, reviews...
12:27:29 reviews: fanfic.jobs.crawl_reviews(11057753) (a1eaf408-490b-42f1-a98c-b70bce9729d7)
12:27:56 reviews: Job OK (a1eaf408-490b-42f1-a98c-b70bce9729d7)
12:27:56 Result is kept for 500 seconds
12:27:56 
12:27:56 *** Listening on chapters, profiles, reviews...
12:27:56 reviews: fanfic.jobs.crawl_reviews(11058594) (ba5cd8bc-7d99-4133-9023-2d640fff30e4)
12:28:56 reviews: Job OK (ba5cd8bc-7d99-4133-9023-2d640fff30e4)
12:28:56 Result is kept for 500 seconds
12:28:56 
12:28:56 *** Listening on chapters, profiles, reviews...
12:28:56 reviews: fanfic.jobs.crawl_reviews(11059561) (a39a15cc-90dc-47a5-a358-ad8d839b8360)
12:29:45 reviews: Job OK (a39a15cc-90dc-47a5-a358-ad8d839b8360)
12:29:45 Result is kept for 500 seconds
12:29:45 
12:29:45 *** Listening on chapters, profiles, reviews...
12:29:45 reviews: fanfic.jobs.crawl_reviews(11059859) (177f76d9-0dd6-498a-bdb1-6bdf10283c19)
12:31:02 reviews: Job OK (177f76d9-0dd6-498a-bdb1-6bdf10283c19)
12:31:02 Result is kept for 500 seconds
12:31:02 
12:31:02 *** Listening on chapters, profiles, reviews...
12:31:02 reviews: fanfic.jobs.crawl_reviews(11061236) (45ab9f09-5f39-4bcf-9616-afac5750256a)
12:32:29 reviews: Job OK (45ab9f09-5f39-4bcf-9616-afac5750256a)
12:32:29 Result is kept for 500 seconds
12:32:29 
12:32:29 *** Listening on chapters, profiles, reviews...
12:32:29 reviews: fanfic.jobs.crawl_reviews(11064026) (f2fe2277-9f1b-4119-bab3-3d7c332b68f8)
12:32:46 reviews: Job OK (f2fe2277-9f1b-4119-bab3-3d7c332b68f8)
12:32:46 Result is kept for 500 seconds
12:32:46 
12:32:46 *** Listening on chapters, profiles, reviews...
12:32:46 reviews: fanfic.jobs.crawl_reviews(11064905) (ca2acc9a-fd40-4441-ab9f-d034c5a04ddf)
12:33:20 reviews: Job OK (ca2acc9a-fd40-4441-ab9f-d034c5a04ddf)
12:33:20 Result is kept for 500 seconds
12:33:20 
12:33:20 *** Listening on chapters, profiles, reviews...
12:33:20 reviews: fanfic.jobs.crawl_reviews(11068482) (bb0fd152-0ad9-433f-8d78-653940ff9d69)
12:34:45 reviews: Job OK (bb0fd152-0ad9-433f-8d78-653940ff9d69)
12:34:45 Result is kept for 500 seconds
12:34:45 
12:34:45 *** Listening on chapters, profiles, reviews...
12:34:45 reviews: fanfic.jobs.crawl_reviews(11070027) (a7778107-f3c9-4a92-a1d4-a77b6f8c3bf8)
12:35:37 reviews: Job OK (a7778107-f3c9-4a92-a1d4-a77b6f8c3bf8)
12:35:37 Result is kept for 500 seconds
12:35:37 
12:35:37 *** Listening on chapters, profiles, reviews...
12:35:37 reviews: fanfic.jobs.crawl_reviews(11071452) (084728fe-169a-48c5-ba72-864af8376da2)
12:35:46 reviews: Job OK (084728fe-169a-48c5-ba72-864af8376da2)
12:35:46 Result is kept for 500 seconds
12:35:46 
12:35:46 *** Listening on chapters, profiles, reviews...
12:35:46 reviews: fanfic.jobs.crawl_reviews(11071872) (a21205ac-1252-4598-9b07-0fc25738b8ef)
12:40:19 reviews: Job OK (a21205ac-1252-4598-9b07-0fc25738b8ef)
12:40:19 Result is kept for 500 seconds
12:40:19 
12:40:19 *** Listening on chapters, profiles, reviews...
12:40:19 reviews: fanfic.jobs.crawl_reviews(11073447) (923b82a0-2ad1-46d8-9417-2a5284dc96d5)
12:41:53 reviews: Job OK (923b82a0-2ad1-46d8-9417-2a5284dc96d5)
12:41:53 Result is kept for 500 seconds
12:41:53 
12:41:53 *** Listening on chapters, profiles, reviews...
12:41:53 reviews: fanfic.jobs.crawl_reviews(11073746) (ea571b2e-4207-4a71-81ff-bcc1b9d90e5e)
12:43:08 reviews: Job OK (ea571b2e-4207-4a71-81ff-bcc1b9d90e5e)
12:43:08 Result is kept for 500 seconds
12:43:08 
12:43:08 *** Listening on chapters, profiles, reviews...
12:43:08 reviews: fanfic.jobs.crawl_reviews(11074633) (c31c6c64-42b6-41ab-b1ce-2b321d0a897f)
12:43:17 reviews: Job OK (c31c6c64-42b6-41ab-b1ce-2b321d0a897f)
12:43:17 Result is kept for 500 seconds
12:43:17 
12:43:17 *** Listening on chapters, profiles, reviews...
12:43:17 reviews: fanfic.jobs.crawl_reviews(11075305) (ba75701b-8a07-4bc3-a20f-13073ee849ae)
12:43:27 reviews: Job OK (ba75701b-8a07-4bc3-a20f-13073ee849ae)
12:43:27 Result is kept for 500 seconds
12:43:27 
12:43:27 *** Listening on chapters, profiles, reviews...
12:43:27 reviews: fanfic.jobs.crawl_reviews(11075422) (e1f7aa5b-5382-4077-acae-5388533d23ca)
12:44:01 reviews: Job OK (e1f7aa5b-5382-4077-acae-5388533d23ca)
12:44:01 Result is kept for 500 seconds
12:44:01 
12:44:01 *** Listening on chapters, profiles, reviews...
12:44:01 reviews: fanfic.jobs.crawl_reviews(11076516) (dc395abb-3a6a-423d-9c46-96d3c41f422f)
12:44:50 reviews: Job OK (dc395abb-3a6a-423d-9c46-96d3c41f422f)
12:44:50 Result is kept for 500 seconds
12:44:50 
12:44:50 *** Listening on chapters, profiles, reviews...
12:44:50 reviews: fanfic.jobs.crawl_reviews(11078156) (d12c914b-95c8-4f34-b274-d9778b8d8f89)
2017-02-08 12:44:55 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 20:44:55.241711', 11078156, 235912373, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (536 characters truncated) ... ter 24 . <span data-xutime="1461120389">4/19/2016</span> </small><div style="margin-top:5px">Omggggg. I Love this fic. Need more! 3</div></td>\n</tr>'), ('2017-02-08 20:44:55.241715', 11078156, 232448469, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5790533&amp;r ... (778 characters truncated) ...   <small style="color:gray">chapter 24 . <span data-xutime="1454166657">1/30/2016</span> </small><div style="margin-top:5px">Update</div></td>\n</tr>'), ('2017-02-08 20:44:55.241718', 11078156, 220550619, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1943562&amp;r ... (894 characters truncated) ... color:gray">chapter 24 . <span data-xutime="1432203791">5/21/2015</span> </small><div style="margin-top:5px">That was super cute :)</div></td>\n</tr>'), ('2017-02-08 20:44:55.241720', 11078156, 218491133, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (551 characters truncated) ... n data-xutime="1428666021">4/10/2015</span> </small><div style="margin-top:5px">your story is amazing. it just started. its amazing</div></td>\n</tr>'), ('2017-02-08 20:44:55.241722', 11078156, 217396418, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4554359&amp;r ... (2326 characters truncated) ... know how everything happened in Meredith\'s mind. So... we\'ll see! <br>\n<br>\nI wish you well for your future writings! <br>\nDNP</div></td>\n</tr>'), ('2017-02-08 20:44:55.241724', 11078156, 216705397, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4078574&amp;r ... (1087 characters truncated) ...  about their life afterwards. I love Mer and James. It\'s so cute and beautiful and I love James\'s voice. One of my favorite fics.</div></td>\n</tr>'), ('2017-02-08 20:44:55.241726', 11078156, 216695919, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4078574&amp;r ... (972 characters truncated) ... > </small><div style="margin-top:5px">Oh my I love how Rose and Reid and Lily and Scorpius (my OTP) got together and James and Mer!</div></td>\n</tr>'), ('2017-02-08 20:44:55.241727', 11078156, 216671249, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (611 characters truncated) ... "margin-top:5px">Oh my gosh I loved this. I liked the Scorlily that you put in there as well. Congrats on making such a good story.</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-08 20:44:55.241755', 11078156, 216398226, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (611 characters truncated) ... le="margin-top:5px">Awesome story. I love your portrayal of James and the relationship between James and Harry. Please update soon!</div></td>\n</tr>'), ('2017-02-08 20:44:55.241757', 11078156, 216321906, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6375211&amp;r ... (951 characters truncated) ... me="1425064302">2/27/2015</span> </small><div style="margin-top:5px">! What? You can\'t stop HERE?! This is amazing please continue</div></td>\n</tr>'))]
12:44:55 reviews: Job OK (d12c914b-95c8-4f34-b274-d9778b8d8f89)
12:44:55 Result is kept for 500 seconds
12:44:55 
12:44:55 *** Listening on chapters, profiles, reviews...
12:44:55 reviews: fanfic.jobs.crawl_reviews(11079134) (aac4ee07-1568-4904-8d87-95337c461fcb)
12:49:31 reviews: Job OK (aac4ee07-1568-4904-8d87-95337c461fcb)
12:49:31 Result is kept for 500 seconds
12:49:31 Cleaning registries for queue: chapters
12:49:31 Cleaning registries for queue: profiles
12:49:31 Cleaning registries for queue: reviews
12:49:31 
12:49:31 *** Listening on chapters, profiles, reviews...
12:49:31 reviews: fanfic.jobs.crawl_reviews(11079921) (e96e9d0a-9981-489c-9b75-998c2870ffa9)
12:49:49 reviews: Job OK (e96e9d0a-9981-489c-9b75-998c2870ffa9)
12:49:49 Result is kept for 500 seconds
12:49:49 
12:49:49 *** Listening on chapters, profiles, reviews...
12:49:49 reviews: fanfic.jobs.crawl_reviews(11080542) (a38f3559-5469-48d2-9433-ae05cde7fc77)
12:54:14 reviews: Job OK (a38f3559-5469-48d2-9433-ae05cde7fc77)
12:54:14 Result is kept for 500 seconds
12:54:14 
12:54:14 *** Listening on chapters, profiles, reviews...
12:54:14 reviews: fanfic.jobs.crawl_reviews(11081737) (bbbe9d4d-0601-4c06-8aa7-25dba02b9b83)
12:54:58 reviews: Job OK (bbbe9d4d-0601-4c06-8aa7-25dba02b9b83)
12:54:58 Result is kept for 500 seconds
12:54:58 
12:54:58 *** Listening on chapters, profiles, reviews...
12:54:58 reviews: fanfic.jobs.crawl_reviews(11082627) (f3b48951-e2e7-4120-91a9-2cc113e37329)
12:56:14 reviews: Job OK (f3b48951-e2e7-4120-91a9-2cc113e37329)
12:56:14 Result is kept for 500 seconds
12:56:14 
12:56:14 *** Listening on chapters, profiles, reviews...
12:56:14 reviews: fanfic.jobs.crawl_reviews(11083193) (460fb5bd-0532-4528-926d-ff3600da2921)
12:56:29 reviews: Job OK (460fb5bd-0532-4528-926d-ff3600da2921)
12:56:29 Result is kept for 500 seconds
12:56:29 
12:56:29 *** Listening on chapters, profiles, reviews...
12:56:29 reviews: fanfic.jobs.crawl_reviews(11083743) (10a2367b-cfdc-4d6a-a420-8b85f5d72f83)
12:56:42 reviews: Job OK (10a2367b-cfdc-4d6a-a420-8b85f5d72f83)
12:56:42 Result is kept for 500 seconds
12:56:42 
12:56:42 *** Listening on chapters, profiles, reviews...
12:56:42 reviews: fanfic.jobs.crawl_reviews(11084551) (c1577258-82c4-484d-b5d6-7106831f2ff7)
12:57:45 reviews: Job OK (c1577258-82c4-484d-b5d6-7106831f2ff7)
12:57:45 Result is kept for 500 seconds
12:57:45 
12:57:45 *** Listening on chapters, profiles, reviews...
12:57:45 reviews: fanfic.jobs.crawl_reviews(11085295) (37928abf-2bc8-4f41-a182-7add3c898dd1)
13:01:18 reviews: Job OK (37928abf-2bc8-4f41-a182-7add3c898dd1)
13:01:18 Result is kept for 500 seconds
13:01:18 
13:01:18 *** Listening on chapters, profiles, reviews...
13:01:18 reviews: fanfic.jobs.crawl_reviews(11086545) (4b5ba05c-dad9-4c20-8a44-6e12806e01f0)
13:01:43 reviews: Job OK (4b5ba05c-dad9-4c20-8a44-6e12806e01f0)
13:01:43 Result is kept for 500 seconds
13:01:43 
13:01:43 *** Listening on chapters, profiles, reviews...
13:01:43 reviews: fanfic.jobs.crawl_reviews(11088081) (50165360-10d8-4775-bb45-bac01ef4427e)
13:02:23 reviews: Job OK (50165360-10d8-4775-bb45-bac01ef4427e)
13:02:23 Result is kept for 500 seconds
13:02:23 
13:02:23 *** Listening on chapters, profiles, reviews...
13:02:23 reviews: fanfic.jobs.crawl_reviews(11088456) (41b3763a-8bc9-4e69-b546-5010b9b1108d)
13:03:13 reviews: Job OK (41b3763a-8bc9-4e69-b546-5010b9b1108d)
13:03:13 Result is kept for 500 seconds
13:03:13 
13:03:13 *** Listening on chapters, profiles, reviews...
13:03:13 reviews: fanfic.jobs.crawl_reviews(11090065) (ed11afdc-61c4-4351-bfbc-1984cf97e538)
13:03:48 reviews: Job OK (ed11afdc-61c4-4351-bfbc-1984cf97e538)
13:03:48 Result is kept for 500 seconds
13:03:48 
13:03:48 *** Listening on chapters, profiles, reviews...
13:03:48 reviews: fanfic.jobs.crawl_reviews(11090445) (36c4cdb4-a5e2-46dc-9a1f-79b384e47960)
13:04:19 reviews: Job OK (36c4cdb4-a5e2-46dc-9a1f-79b384e47960)
13:04:19 Result is kept for 500 seconds
13:04:19 
13:04:19 *** Listening on chapters, profiles, reviews...
13:04:19 reviews: fanfic.jobs.crawl_reviews(11092196) (30e6448d-16d8-4a0b-8f03-ede10a2475c8)
13:05:28 reviews: Job OK (30e6448d-16d8-4a0b-8f03-ede10a2475c8)
13:05:28 Result is kept for 500 seconds
13:05:28 
13:05:28 *** Listening on chapters, profiles, reviews...
13:05:28 reviews: fanfic.jobs.crawl_reviews(11092730) (5215c9ce-7b1c-4e10-b2a9-38dffa1867fa)
13:05:41 reviews: Job OK (5215c9ce-7b1c-4e10-b2a9-38dffa1867fa)
13:05:41 Result is kept for 500 seconds
13:05:41 
13:05:41 *** Listening on chapters, profiles, reviews...
13:05:41 reviews: fanfic.jobs.crawl_reviews(11093159) (577dc9f1-7398-4458-aa89-2170c7225391)
13:08:29 reviews: Job OK (577dc9f1-7398-4458-aa89-2170c7225391)
13:08:29 Result is kept for 500 seconds
13:08:29 
13:08:29 *** Listening on chapters, profiles, reviews...
13:08:29 reviews: fanfic.jobs.crawl_reviews(11093767) (029302fa-4a6e-4ad5-976c-8cf938ede616)
13:08:37 reviews: Job OK (029302fa-4a6e-4ad5-976c-8cf938ede616)
13:08:37 Result is kept for 500 seconds
13:08:37 
13:08:37 *** Listening on chapters, profiles, reviews...
13:08:37 reviews: fanfic.jobs.crawl_reviews(11094811) (df291511-33a4-4ad0-a671-1dd3a94723d7)
13:08:52 reviews: Job OK (df291511-33a4-4ad0-a671-1dd3a94723d7)
13:08:52 Result is kept for 500 seconds
13:08:52 
13:08:52 *** Listening on chapters, profiles, reviews...
13:08:52 reviews: fanfic.jobs.crawl_reviews(11094954) (18a242cd-8792-4e6a-be73-a14ec87becfd)
13:09:40 reviews: Job OK (18a242cd-8792-4e6a-be73-a14ec87becfd)
13:09:40 Result is kept for 500 seconds
13:09:40 
13:09:40 *** Listening on chapters, profiles, reviews...
13:09:40 reviews: fanfic.jobs.crawl_reviews(11094962) (1ae3b011-ea7d-4fca-b4ed-e31354e743bf)
13:10:17 reviews: Job OK (1ae3b011-ea7d-4fca-b4ed-e31354e743bf)
13:10:17 Result is kept for 500 seconds
13:10:17 
13:10:17 *** Listening on chapters, profiles, reviews...
13:10:17 reviews: fanfic.jobs.crawl_reviews(11096786) (e9d3cab5-e83f-4212-a1c4-7457f9b3d4b9)
13:10:43 reviews: Job OK (e9d3cab5-e83f-4212-a1c4-7457f9b3d4b9)
13:10:43 Result is kept for 500 seconds
13:10:43 
13:10:43 *** Listening on chapters, profiles, reviews...
13:10:43 reviews: fanfic.jobs.crawl_reviews(11096958) (55bb0a9a-92e1-4348-8da3-c446ee017a44)
13:10:51 reviews: Job OK (55bb0a9a-92e1-4348-8da3-c446ee017a44)
13:10:51 Result is kept for 500 seconds
13:10:51 
13:10:51 *** Listening on chapters, profiles, reviews...
13:10:51 reviews: fanfic.jobs.crawl_reviews(11098295) (d62aa2be-2672-4c82-b760-234726e5f3dc)
13:11:08 reviews: Job OK (d62aa2be-2672-4c82-b760-234726e5f3dc)
13:11:08 Result is kept for 500 seconds
13:11:08 
13:11:08 *** Listening on chapters, profiles, reviews...
13:11:08 reviews: fanfic.jobs.crawl_reviews(11099388) (3bf8501b-e539-4cee-9ad4-44c8dedd0a7d)
13:13:44 reviews: Job OK (3bf8501b-e539-4cee-9ad4-44c8dedd0a7d)
13:13:44 Result is kept for 500 seconds
13:13:44 
13:13:44 *** Listening on chapters, profiles, reviews...
13:13:44 reviews: fanfic.jobs.crawl_reviews(11101615) (780a98c9-14e2-438b-a2cf-0b9f28bde5b1)
13:14:00 reviews: Job OK (780a98c9-14e2-438b-a2cf-0b9f28bde5b1)
13:14:00 Result is kept for 500 seconds
13:14:00 
13:14:00 *** Listening on chapters, profiles, reviews...
13:14:00 reviews: fanfic.jobs.crawl_reviews(11105625) (7ba6d1d9-38e4-47fb-9969-f64410785f97)
13:14:25 reviews: Job OK (7ba6d1d9-38e4-47fb-9969-f64410785f97)
13:14:25 Result is kept for 500 seconds
13:14:25 
13:14:25 *** Listening on chapters, profiles, reviews...
13:14:25 reviews: fanfic.jobs.crawl_reviews(11106332) (1b949198-2107-4bbe-b01c-9ace42b3b848)
13:15:04 reviews: Job OK (1b949198-2107-4bbe-b01c-9ace42b3b848)
13:15:04 Result is kept for 500 seconds
13:15:04 
13:15:04 *** Listening on chapters, profiles, reviews...
13:15:04 reviews: fanfic.jobs.crawl_reviews(11106724) (b6ce4259-cc78-4aef-b036-4ff11fbb004f)
2017-02-08 13:15:08 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 21:15:08.571767', 11106724, 219496911, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (661 characters truncated) ... put the taboo on "Voldemort" because he intended to be known as "Lord Voldemort". It\'s the dropping of "Lord" that pissed him off.</div></td>\n</tr>'), ('2017-02-08 21:15:08.571771', 11106724, 218859515, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6391406&amp;r ... (844 characters truncated) ... utime="1429275211">4/17/2015</span> </small><div style="margin-top:5px">It\'s getting better and better :) I don\'t want it to end!</div></td>\n</tr>'), ('2017-02-08 21:15:08.571774', 11106724, 217764839, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6391406&amp;r ... (867 characters truncated) ... 2015</span> </small><div style="margin-top:5px">Looking forward to the next chapter xx<br>\nI really like this story :) keep it up!</div></td>\n</tr>'), ('2017-02-08 21:15:08.571776', 11106724, 219496911, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (661 characters truncated) ... put the taboo on "Voldemort" because he intended to be known as "Lord Voldemort". It\'s the dropping of "Lord" that pissed him off.</div></td>\n</tr>'), ('2017-02-08 21:15:08.571778', 11106724, 218859515, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6391406&amp;r ... (844 characters truncated) ... utime="1429275211">4/17/2015</span> </small><div style="margin-top:5px">It\'s getting better and better :) I don\'t want it to end!</div></td>\n</tr>'), ('2017-02-08 21:15:08.571780', 11106724, 217764839, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6391406&amp;r ... (867 characters truncated) ... 2015</span> </small><div style="margin-top:5px">Looking forward to the next chapter xx<br>\nI really like this story :) keep it up!</div></td>\n</tr>'))]
13:15:08 reviews: Job OK (b6ce4259-cc78-4aef-b036-4ff11fbb004f)
13:15:08 Result is kept for 500 seconds
13:15:08 
13:15:08 *** Listening on chapters, profiles, reviews...
13:15:08 reviews: fanfic.jobs.crawl_reviews(11107016) (0d0d1c85-1f78-480c-aa45-54227cc7de8a)
2017-02-08 13:15:14 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 21:15:14.384291', 11107016, 230344984, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (510 characters truncated) ... ll style="color:gray">chapter 14 . <span data-xutime="1450118604">12/14/2015</span> </small><div style="margin-top:5px">Good story!</div></td>\n</tr>'), ('2017-02-08 21:15:14.384296', 11107016, 223300693, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4345533&amp;r ... (2689 characters truncated) ...  tolerate him. Anyway, thank you for such a great story! I am always looking forward to more.<br>\n<br>\nAll the best!<br>\nAGN1988</div></td>\n</tr>'), ('2017-02-08 21:15:14.384299', 11107016, 223053219, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4038718&amp;r ... (1486 characters truncated) ... sing chapter?<br>\n<br>\nAs I said, I love your work so far, you are a beautiful story teller and writer, I just want to know more!</div></td>\n</tr>'), ('2017-02-08 21:15:14.384301', 11107016, 230344984, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (510 characters truncated) ... ll style="color:gray">chapter 14 . <span data-xutime="1450118604">12/14/2015</span> </small><div style="margin-top:5px">Good story!</div></td>\n</tr>'), ('2017-02-08 21:15:14.384304', 11107016, 223300693, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4345533&amp;r ... (2689 characters truncated) ...  tolerate him. Anyway, thank you for such a great story! I am always looking forward to more.<br>\n<br>\nAll the best!<br>\nAGN1988</div></td>\n</tr>'), ('2017-02-08 21:15:14.384306', 11107016, 223053219, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4038718&amp;r ... (1486 characters truncated) ... sing chapter?<br>\n<br>\nAs I said, I love your work so far, you are a beautiful story teller and writer, I just want to know more!</div></td>\n</tr>'))]
13:15:14 reviews: Job OK (0d0d1c85-1f78-480c-aa45-54227cc7de8a)
13:15:14 Result is kept for 500 seconds
13:15:14 
13:15:14 *** Listening on chapters, profiles, reviews...
13:15:14 reviews: fanfic.jobs.crawl_reviews(11107199) (d460d28e-924e-4a54-9015-2f1ecaf88af3)
13:15:44 reviews: Job OK (d460d28e-924e-4a54-9015-2f1ecaf88af3)
13:15:44 Result is kept for 500 seconds
13:15:44 
13:15:44 *** Listening on chapters, profiles, reviews...
13:15:44 reviews: fanfic.jobs.crawl_reviews(11107234) (f6c0f6f9-aba6-49cb-855a-d5cd97b90d55)
13:16:44 reviews: Job OK (f6c0f6f9-aba6-49cb-855a-d5cd97b90d55)
13:16:44 Result is kept for 500 seconds
13:16:44 
13:16:44 *** Listening on chapters, profiles, reviews...
13:16:44 reviews: fanfic.jobs.crawl_reviews(11107717) (09131708-1506-4c5b-bf39-d0baa8c2f4b3)
13:17:51 reviews: Job OK (09131708-1506-4c5b-bf39-d0baa8c2f4b3)
13:17:51 Result is kept for 500 seconds
13:17:51 
13:17:51 *** Listening on chapters, profiles, reviews...
13:17:51 reviews: fanfic.jobs.crawl_reviews(11111392) (66d9d1bc-847a-40e7-99c2-0aaccbfa840d)
13:18:08 reviews: Job OK (66d9d1bc-847a-40e7-99c2-0aaccbfa840d)
13:18:08 Result is kept for 500 seconds
13:18:08 
13:18:08 *** Listening on chapters, profiles, reviews...
13:18:08 reviews: fanfic.jobs.crawl_reviews(11111790) (11d6f570-0f88-4d24-8931-322b3a3cc358)
13:18:40 reviews: Job OK (11d6f570-0f88-4d24-8931-322b3a3cc358)
13:18:40 Result is kept for 500 seconds
13:18:40 
13:18:40 *** Listening on chapters, profiles, reviews...
13:18:40 reviews: fanfic.jobs.crawl_reviews(11111990) (0d0f8f01-9d4c-4f9a-ba11-f6a00b9843c4)
13:22:29 reviews: Job OK (0d0f8f01-9d4c-4f9a-ba11-f6a00b9843c4)
13:22:29 Result is kept for 500 seconds
13:22:29 
13:22:29 *** Listening on chapters, profiles, reviews...
13:22:29 reviews: fanfic.jobs.crawl_reviews(11113209) (c90f4b51-0ef7-409c-9082-590374199d14)
13:23:10 reviews: Job OK (c90f4b51-0ef7-409c-9082-590374199d14)
13:23:10 Result is kept for 500 seconds
13:23:10 
13:23:10 *** Listening on chapters, profiles, reviews...
13:23:10 reviews: fanfic.jobs.crawl_reviews(11113392) (9dcc99c9-f42f-4bbe-9267-c819ea3277a6)
13:23:27 reviews: Job OK (9dcc99c9-f42f-4bbe-9267-c819ea3277a6)
13:23:27 Result is kept for 500 seconds
13:23:27 
13:23:27 *** Listening on chapters, profiles, reviews...
13:23:27 reviews: fanfic.jobs.crawl_reviews(11115094) (5b92c90e-368b-4ce4-9c96-4a718995a40d)
13:24:20 reviews: Job OK (5b92c90e-368b-4ce4-9c96-4a718995a40d)
13:24:20 Result is kept for 500 seconds
13:24:20 
13:24:20 *** Listening on chapters, profiles, reviews...
13:24:20 reviews: fanfic.jobs.crawl_reviews(11116167) (497131ad-5dc2-45c5-9ad3-e3c2d833e918)
13:24:36 reviews: Job OK (497131ad-5dc2-45c5-9ad3-e3c2d833e918)
13:24:36 Result is kept for 500 seconds
13:24:36 
13:24:36 *** Listening on chapters, profiles, reviews...
13:24:36 reviews: fanfic.jobs.crawl_reviews(11116929) (502d8dbf-949c-44a3-a3e1-63b9e4f54e5c)
13:25:19 reviews: Job OK (502d8dbf-949c-44a3-a3e1-63b9e4f54e5c)
13:25:19 Result is kept for 500 seconds
13:25:19 
13:25:19 *** Listening on chapters, profiles, reviews...
13:25:19 reviews: fanfic.jobs.crawl_reviews(11116978) (ff303c13-9622-4d7c-9eb8-9c9035567610)
13:27:56 reviews: Job OK (ff303c13-9622-4d7c-9eb8-9c9035567610)
13:27:56 Result is kept for 500 seconds
13:27:56 
13:27:56 *** Listening on chapters, profiles, reviews...
13:27:56 reviews: fanfic.jobs.crawl_reviews(11117811) (92a60058-ded8-4b0b-ad1d-dd8292d24d3e)
13:28:39 reviews: Job OK (92a60058-ded8-4b0b-ad1d-dd8292d24d3e)
13:28:39 Result is kept for 500 seconds
13:28:39 
13:28:39 *** Listening on chapters, profiles, reviews...
13:28:39 reviews: fanfic.jobs.crawl_reviews(11118152) (e59ac3c0-70e8-4952-9ecd-430ed4626bf9)
13:30:13 reviews: Job OK (e59ac3c0-70e8-4952-9ecd-430ed4626bf9)
13:30:13 Result is kept for 500 seconds
13:30:13 
13:30:13 *** Listening on chapters, profiles, reviews...
13:30:13 reviews: fanfic.jobs.crawl_reviews(11120079) (c819c6f2-5bd9-4534-a69f-e243ee3b88c2)
13:32:46 reviews: Job OK (c819c6f2-5bd9-4534-a69f-e243ee3b88c2)
13:32:46 Result is kept for 500 seconds
13:32:46 
13:32:46 *** Listening on chapters, profiles, reviews...
13:32:46 reviews: fanfic.jobs.crawl_reviews(11120716) (74c120e8-a953-4992-a3ed-aa77b3d965ec)
13:33:28 reviews: Job OK (74c120e8-a953-4992-a3ed-aa77b3d965ec)
13:33:28 Result is kept for 500 seconds
13:33:28 
13:33:28 *** Listening on chapters, profiles, reviews...
13:33:28 reviews: fanfic.jobs.crawl_reviews(11121849) (31d80f4f-d3b2-468c-a74b-873f376f3f2f)
13:34:47 reviews: Job OK (31d80f4f-d3b2-468c-a74b-873f376f3f2f)
13:34:47 Result is kept for 500 seconds
13:34:47 
13:34:47 *** Listening on chapters, profiles, reviews...
13:34:47 reviews: fanfic.jobs.crawl_reviews(11122506) (5fb6eae9-0945-43c0-8874-4c974e26ac98)
13:35:22 reviews: Job OK (5fb6eae9-0945-43c0-8874-4c974e26ac98)
13:35:22 Result is kept for 500 seconds
13:35:22 
13:35:22 *** Listening on chapters, profiles, reviews...
13:35:22 reviews: fanfic.jobs.crawl_reviews(11122569) (130e87ca-4462-46d2-ad45-ac4acf116acc)
13:35:47 reviews: Job OK (130e87ca-4462-46d2-ad45-ac4acf116acc)
13:35:47 Result is kept for 500 seconds
13:35:47 
13:35:47 *** Listening on chapters, profiles, reviews...
13:35:47 reviews: fanfic.jobs.crawl_reviews(11122643) (4c5bb913-f444-4ba5-b6d4-4e4ac67885a2)
13:36:39 reviews: Job OK (4c5bb913-f444-4ba5-b6d4-4e4ac67885a2)
13:36:39 Result is kept for 500 seconds
13:36:39 
13:36:39 *** Listening on chapters, profiles, reviews...
13:36:39 reviews: fanfic.jobs.crawl_reviews(11123742) (05303a1b-cdf0-484d-b57f-8e57e6f2e7ca)
13:50:22 reviews: Job OK (05303a1b-cdf0-484d-b57f-8e57e6f2e7ca)
13:50:22 Result is kept for 500 seconds
13:50:23 Cleaning registries for queue: chapters
13:50:23 Cleaning registries for queue: profiles
13:50:23 Cleaning registries for queue: reviews
13:50:23 
13:50:23 *** Listening on chapters, profiles, reviews...
13:50:23 reviews: fanfic.jobs.crawl_reviews(11125116) (8d2e7587-d340-401b-acc5-69ec9c0394b0)
13:50:48 reviews: Job OK (8d2e7587-d340-401b-acc5-69ec9c0394b0)
13:50:48 Result is kept for 500 seconds
13:50:48 
13:50:48 *** Listening on chapters, profiles, reviews...
13:50:48 reviews: fanfic.jobs.crawl_reviews(11125187) (b5b9f668-4f20-43ee-bcd6-d063a7d2a4d6)
13:50:56 reviews: Job OK (b5b9f668-4f20-43ee-bcd6-d063a7d2a4d6)
13:50:56 Result is kept for 500 seconds
13:50:56 
13:50:56 *** Listening on chapters, profiles, reviews...
13:50:56 reviews: fanfic.jobs.crawl_reviews(11125620) (713b6933-9e74-43c3-b56b-77363c03e859)
13:55:02 reviews: Job OK (713b6933-9e74-43c3-b56b-77363c03e859)
13:55:02 Result is kept for 500 seconds
13:55:02 
13:55:02 *** Listening on chapters, profiles, reviews...
13:55:02 reviews: fanfic.jobs.crawl_reviews(11126195) (1d8a1d90-36bf-4d6c-a0bf-924cd799ad8a)
13:58:56 reviews: Job OK (1d8a1d90-36bf-4d6c-a0bf-924cd799ad8a)
13:58:56 Result is kept for 500 seconds
13:58:56 
13:58:56 *** Listening on chapters, profiles, reviews...
13:58:56 reviews: fanfic.jobs.crawl_reviews(11126344) (79a0e639-164d-4539-af2b-7a4df4962f76)
13:59:45 reviews: Job OK (79a0e639-164d-4539-af2b-7a4df4962f76)
13:59:45 Result is kept for 500 seconds
13:59:45 
13:59:45 *** Listening on chapters, profiles, reviews...
13:59:45 reviews: fanfic.jobs.crawl_reviews(11127426) (98cbf1a3-8892-418a-932a-8e0148d605e3)
13:59:57 reviews: Job OK (98cbf1a3-8892-418a-932a-8e0148d605e3)
13:59:57 Result is kept for 500 seconds
13:59:57 
13:59:57 *** Listening on chapters, profiles, reviews...
13:59:57 reviews: fanfic.jobs.crawl_reviews(11128669) (9adff8d1-3071-427c-895c-d7d1e9a9975a)
14:00:16 reviews: Job OK (9adff8d1-3071-427c-895c-d7d1e9a9975a)
14:00:16 Result is kept for 500 seconds
14:00:16 
14:00:16 *** Listening on chapters, profiles, reviews...
14:00:16 reviews: fanfic.jobs.crawl_reviews(11128883) (fb81b928-43e2-4b6f-8cd4-76638d1b9d49)
14:01:03 reviews: Job OK (fb81b928-43e2-4b6f-8cd4-76638d1b9d49)
14:01:03 Result is kept for 500 seconds
14:01:03 
14:01:03 *** Listening on chapters, profiles, reviews...
14:01:03 reviews: fanfic.jobs.crawl_reviews(11129273) (df7e62f7-fab4-450e-926d-ccf95350674b)
14:06:52 reviews: Job OK (df7e62f7-fab4-450e-926d-ccf95350674b)
14:06:52 Result is kept for 500 seconds
14:06:52 
14:06:52 *** Listening on chapters, profiles, reviews...
14:06:52 reviews: fanfic.jobs.crawl_reviews(11130205) (e9441c8e-be64-413b-81f9-2200c0cde586)
14:07:23 reviews: Job OK (e9441c8e-be64-413b-81f9-2200c0cde586)
14:07:23 Result is kept for 500 seconds
14:07:23 
14:07:23 *** Listening on chapters, profiles, reviews...
14:07:23 reviews: fanfic.jobs.crawl_reviews(11131240) (17d086c5-ae0f-4040-af0b-3b50df3ea6dc)
14:10:07 reviews: Job OK (17d086c5-ae0f-4040-af0b-3b50df3ea6dc)
14:10:07 Result is kept for 500 seconds
14:10:07 
14:10:07 *** Listening on chapters, profiles, reviews...
14:10:07 reviews: fanfic.jobs.crawl_reviews(11131988) (b1bee2a9-aec1-45c3-b726-45a99a8e40b4)
14:14:05 reviews: Job OK (b1bee2a9-aec1-45c3-b726-45a99a8e40b4)
14:14:05 Result is kept for 500 seconds
14:14:05 
14:14:05 *** Listening on chapters, profiles, reviews...
14:14:05 reviews: fanfic.jobs.crawl_reviews(11132010) (29ec3732-135d-4a42-b66f-f4a2eb16d41a)
14:14:33 reviews: Job OK (29ec3732-135d-4a42-b66f-f4a2eb16d41a)
14:14:33 Result is kept for 500 seconds
14:14:33 
14:14:33 *** Listening on chapters, profiles, reviews...
14:14:33 reviews: fanfic.jobs.crawl_reviews(11132624) (340948b9-4df0-4123-8f54-6e6553d77779)
14:22:24 reviews: Job OK (340948b9-4df0-4123-8f54-6e6553d77779)
14:22:24 Result is kept for 500 seconds
14:22:24 
14:22:24 *** Listening on chapters, profiles, reviews...
14:22:24 reviews: fanfic.jobs.crawl_reviews(11132697) (0cd90af7-3ff0-47d2-ab91-f14cbf67554d)
14:22:29 reviews: Job OK (0cd90af7-3ff0-47d2-ab91-f14cbf67554d)
14:22:29 Result is kept for 500 seconds
14:22:29 
14:22:29 *** Listening on chapters, profiles, reviews...
14:22:29 reviews: fanfic.jobs.crawl_reviews(11133389) (9e2d1f89-9a61-4bde-aad2-e12f40e72714)
14:25:28 reviews: Job OK (9e2d1f89-9a61-4bde-aad2-e12f40e72714)
14:25:28 Result is kept for 500 seconds
14:25:28 
14:25:28 *** Listening on chapters, profiles, reviews...
14:25:28 reviews: fanfic.jobs.crawl_reviews(11133456) (b1686994-fa93-4a3e-ac74-4a5856215810)
14:25:44 reviews: Job OK (b1686994-fa93-4a3e-ac74-4a5856215810)
14:25:44 Result is kept for 500 seconds
14:25:44 
14:25:44 *** Listening on chapters, profiles, reviews...
14:25:44 reviews: fanfic.jobs.crawl_reviews(11134969) (557195d3-056a-43aa-8fc1-0981cc9ea2b6)
14:26:03 reviews: Job OK (557195d3-056a-43aa-8fc1-0981cc9ea2b6)
14:26:03 Result is kept for 500 seconds
14:26:03 
14:26:03 *** Listening on chapters, profiles, reviews...
14:26:03 reviews: fanfic.jobs.crawl_reviews(11135243) (284f6c06-029d-44b8-bc78-0a8bccc6f91f)
14:26:59 reviews: Job OK (284f6c06-029d-44b8-bc78-0a8bccc6f91f)
14:26:59 Result is kept for 500 seconds
14:26:59 
14:26:59 *** Listening on chapters, profiles, reviews...
14:26:59 reviews: fanfic.jobs.crawl_reviews(11137445) (f6c2ef81-475b-43a6-ade8-d01e521c57d0)
14:27:24 reviews: Job OK (f6c2ef81-475b-43a6-ade8-d01e521c57d0)
14:27:24 Result is kept for 500 seconds
14:27:24 
14:27:24 *** Listening on chapters, profiles, reviews...
14:27:24 reviews: fanfic.jobs.crawl_reviews(11138258) (2fb381d6-2f26-4645-af55-27062a834c2d)
14:27:34 reviews: Job OK (2fb381d6-2f26-4645-af55-27062a834c2d)
14:27:34 Result is kept for 500 seconds
14:27:34 
14:27:34 *** Listening on chapters, profiles, reviews...
14:27:34 reviews: fanfic.jobs.crawl_reviews(11139302) (a7e46def-2b78-4fa9-87e5-f4c3d0294045)
14:34:18 reviews: Job OK (a7e46def-2b78-4fa9-87e5-f4c3d0294045)
14:34:18 Result is kept for 500 seconds
14:34:18 
14:34:18 *** Listening on chapters, profiles, reviews...
14:34:18 reviews: fanfic.jobs.crawl_reviews(11139574) (78738f3b-61dc-40d9-b759-9f7921f01b82)
14:34:23 reviews: Job OK (78738f3b-61dc-40d9-b759-9f7921f01b82)
14:34:23 Result is kept for 500 seconds
14:34:23 
14:34:23 *** Listening on chapters, profiles, reviews...
14:34:23 reviews: fanfic.jobs.crawl_reviews(11142998) (501c5279-2122-4fad-9eb1-345ef39fbe99)
14:35:21 reviews: Job OK (501c5279-2122-4fad-9eb1-345ef39fbe99)
14:35:21 Result is kept for 500 seconds
14:35:21 
14:35:21 *** Listening on chapters, profiles, reviews...
14:35:21 reviews: fanfic.jobs.crawl_reviews(11144535) (4c113843-216b-4f45-9604-375fda988c29)
14:35:55 reviews: Job OK (4c113843-216b-4f45-9604-375fda988c29)
14:35:55 Result is kept for 500 seconds
14:35:55 
14:35:55 *** Listening on chapters, profiles, reviews...
14:35:55 reviews: fanfic.jobs.crawl_reviews(11144735) (df0776c1-e948-4d0a-a560-5134bb33b028)
14:36:12 reviews: Job OK (df0776c1-e948-4d0a-a560-5134bb33b028)
14:36:12 Result is kept for 500 seconds
14:36:12 
14:36:12 *** Listening on chapters, profiles, reviews...
14:36:12 reviews: fanfic.jobs.crawl_reviews(11145369) (e4d7a1d2-501b-4c68-b796-1b6d6ffd1e96)
14:36:48 reviews: Job OK (e4d7a1d2-501b-4c68-b796-1b6d6ffd1e96)
14:36:48 Result is kept for 500 seconds
14:36:48 
14:36:48 *** Listening on chapters, profiles, reviews...
14:36:48 reviews: fanfic.jobs.crawl_reviews(11147731) (6e68b1bd-8626-489b-b761-cbf2c6c76842)
14:37:34 reviews: Job OK (6e68b1bd-8626-489b-b761-cbf2c6c76842)
14:37:34 Result is kept for 500 seconds
14:37:34 
14:37:34 *** Listening on chapters, profiles, reviews...
14:37:34 reviews: fanfic.jobs.crawl_reviews(11149320) (4e5da584-fb6d-4a45-b346-85e00fabc3a2)
14:39:58 reviews: Job OK (4e5da584-fb6d-4a45-b346-85e00fabc3a2)
14:39:58 Result is kept for 500 seconds
14:39:58 
14:39:58 *** Listening on chapters, profiles, reviews...
14:39:58 reviews: fanfic.jobs.crawl_reviews(11149377) (3a24131a-acf9-482f-9647-f37b6c3a08ba)
14:52:43 reviews: Job OK (3a24131a-acf9-482f-9647-f37b6c3a08ba)
14:52:43 Result is kept for 500 seconds
14:52:43 Cleaning registries for queue: chapters
14:52:43 Cleaning registries for queue: profiles
14:52:43 Cleaning registries for queue: reviews
14:52:43 
14:52:43 *** Listening on chapters, profiles, reviews...
14:52:43 reviews: fanfic.jobs.crawl_reviews(11149946) (57d88d40-c0a3-4957-98b4-a55b52c9a2aa)
14:53:17 reviews: Job OK (57d88d40-c0a3-4957-98b4-a55b52c9a2aa)
14:53:17 Result is kept for 500 seconds
14:53:17 
14:53:17 *** Listening on chapters, profiles, reviews...
14:53:17 reviews: fanfic.jobs.crawl_reviews(11150124) (5721ec42-82fb-4cc5-bacf-2ac90c4242c9)
2017-02-08 14:53:23 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 22:53:23.187467', 11150124, 241938690, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8122706&amp;r ... (862 characters truncated) ... /span> </small><div style="margin-top:5px">This was a super cute story. Thanks so much for writing, always love seeing a rare pair.</div></td>\n</tr>'), ('2017-02-08 22:53:23.187471', 11150124, 230663857, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=868756&amp;rw ... (1008 characters truncated) ... ove. I want more. The bonding the meeting of Petunia and Servues. Just love the story.<br>\n<br>\nThank You for writing this story.</div></td>\n</tr>'), ('2017-02-08 22:53:23.187474', 11150124, 230430406, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=868756&amp;rw ... (1187 characters truncated) ... ce to each other.<br>\n<br>\nWhat ever you do. I want to say Thank you for creating a lovely romance story for a very rare pairing.</div></td>\n</tr>'), ('2017-02-08 22:53:23.187476', 11150124, 230058211, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=868756&amp;rw ... (896 characters truncated) ... er 17 . <span data-xutime="1449524025">12/7/2015</span> </small><div style="margin-top:5px">Great chapter. Harry fighting for love.</div></td>\n</tr>'), ('2017-02-08 22:53:23.187478', 11150124, 229325162, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (614 characters truncated) ...  style="margin-top:5px">a very amusing pairing. and a very cute story.<br>\ni hope you will post some capters soon ;)<br>\n<br>\nlg</div></td>\n</tr>'), ('2017-02-08 22:53:23.187479', 11150124, 229303614, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=868756&amp;rw ... (879 characters truncated) ... color:gray">chapter 13 . <span data-xutime="1447957168">11/19/2015</span> </small><div style="margin-top:5px">What a great chapter.</div></td>\n</tr>'), ('2017-02-08 22:53:23.187481', 11150124, 229297916, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3799655&amp;r ... (953 characters truncated) ... 15</span> </small><div style="margin-top:5px">I don\'t get how this only has one review? I mean this is one utterly gorgeous story.</div></td>\n</tr>'), ('2017-02-08 22:53:23.187483', 11150124, 219922174, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (600 characters truncated) ...  style="margin-top:5px">Very interesting story. You have a very unusual ideas. We are happy to read the next chapter of this story.</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-08 22:53:23.187496', 11150124, 229297916, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3799655&amp;r ... (953 characters truncated) ... 15</span> </small><div style="margin-top:5px">I don\'t get how this only has one review? I mean this is one utterly gorgeous story.</div></td>\n</tr>'), ('2017-02-08 22:53:23.187498', 11150124, 219922174, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (600 characters truncated) ...  style="margin-top:5px">Very interesting story. You have a very unusual ideas. We are happy to read the next chapter of this story.</div></td>\n</tr>'))]
14:53:23 reviews: Job OK (5721ec42-82fb-4cc5-bacf-2ac90c4242c9)
14:53:23 Result is kept for 500 seconds
14:53:23 
14:53:23 *** Listening on chapters, profiles, reviews...
14:53:23 reviews: fanfic.jobs.crawl_reviews(11151311) (87b6884c-baac-444a-951c-46eab362e00d)
2017-02-08 14:53:28 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 22:53:28.665124', 11151311, 243592208, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7941029&amp;r ... (849 characters truncated) ... /2016</span> </small><div style="margin-top:5px">Aug 1,2015 to Nov 3,2016. Still waiting for a completion of this magnificent tale!</div></td>\n</tr>'), ('2017-02-08 22:53:28.665128', 11151311, 239119103, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6625124&amp;r ... (896 characters truncated) ... hapter 57 . <span data-xutime="1467878705">7/7/2016</span> </small><div style="margin-top:5px">Its almost been a year please update</div></td>\n</tr>'), ('2017-02-08 22:53:28.665131', 11151311, 239092994, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (557 characters truncated) ... utime="1467655848">7/4/2016</span> </small><div style="margin-top:5px">This is an amazing story. I truly hope you can continue this</div></td>\n</tr>'), ('2017-02-08 22:53:28.665133', 11151311, 234260580, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (667 characters truncated) ... erful, and I love everything you\'ve done with it.<br>\n<br>\nTake as long as you need with the hiatus, this fic is worth any wait.</div></td>\n</tr>'), ('2017-02-08 22:53:28.665135', 11151311, 233096455, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2184704&amp;r ... (950 characters truncated) ... 4/2016</span> </small><div style="margin-top:5px">This story is quite good, i\'m kinda surprised with so little of reviews you got.</div></td>\n</tr>'), ('2017-02-08 22:53:28.665137', 11151311, 231244261, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (761 characters truncated) ... d. also drop the prologue/an - readers might get bored with it and not go on, which is a shame since this story deserves to be read</div></td>\n</tr>'), ('2017-02-08 22:53:28.665138', 11151311, 231244203, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (526 characters truncated) ... gray">chapter 1 . <span data-xutime="1451658710">1/1/2016</span> </small><div style="margin-top:5px">this sounds really interesting</div></td>\n</tr>'), ('2017-02-08 22:53:28.665140', 11151311, 225872628, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2051884&amp;r ... (1170 characters truncated) ... x then? There are quite a few Tomione fans who will mistake this story for something it is not, the clarification would be welcome.</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-08 22:53:28.665180', 11151311, 218265253, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3361413&amp;r ... (1034 characters truncated) ... l. Honestly. I loved it and I\'m going to wait for the next update. You have a gift in writing. Sibling!Tomione is quite good, lol.</div></td>\n</tr>'), ('2017-02-08 22:53:28.665181', 11151311, 218079973, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (527 characters truncated) ... ray">chapter 16 . <span data-xutime="1427836025">3/31/2015</span> </small><div style="margin-top:5px">Cool! Will this be completed?</div></td>\n</tr>'))]
14:53:28 reviews: Job OK (87b6884c-baac-444a-951c-46eab362e00d)
14:53:28 Result is kept for 500 seconds
14:53:28 
14:53:28 *** Listening on chapters, profiles, reviews...
14:53:28 reviews: fanfic.jobs.crawl_reviews(11151528) (3fbe4bd4-15fa-4710-af89-c83fa9432d56)
14:54:35 reviews: Job OK (3fbe4bd4-15fa-4710-af89-c83fa9432d56)
14:54:35 Result is kept for 500 seconds
14:54:35 
14:54:35 *** Listening on chapters, profiles, reviews...
14:54:35 reviews: fanfic.jobs.crawl_reviews(11153333) (f64ba1cd-bf35-49b0-a338-43db6f160ea9)
15:17:11 reviews: Job OK (f64ba1cd-bf35-49b0-a338-43db6f160ea9)
15:17:11 Result is kept for 500 seconds
15:17:11 
15:17:11 *** Listening on chapters, profiles, reviews...
15:17:11 reviews: fanfic.jobs.crawl_reviews(11153404) (1e086aa0-a03f-408b-979a-dbe0c81dd781)
15:17:33 reviews: Job OK (1e086aa0-a03f-408b-979a-dbe0c81dd781)
15:17:33 Result is kept for 500 seconds
15:17:33 
15:17:33 *** Listening on chapters, profiles, reviews...
15:17:33 reviews: fanfic.jobs.crawl_reviews(11155084) (52a4bf60-3981-4efc-b46d-c5cb2de7c78a)
15:18:53 reviews: Job OK (52a4bf60-3981-4efc-b46d-c5cb2de7c78a)
15:18:53 Result is kept for 500 seconds
15:18:53 
15:18:53 *** Listening on chapters, profiles, reviews...
15:18:53 reviews: fanfic.jobs.crawl_reviews(11155261) (7185fbe0-0bd5-44cd-a872-50474e53c6e0)
15:19:11 reviews: Job OK (7185fbe0-0bd5-44cd-a872-50474e53c6e0)
15:19:11 Result is kept for 500 seconds
15:19:11 
15:19:11 *** Listening on chapters, profiles, reviews...
15:19:11 reviews: fanfic.jobs.crawl_reviews(11155989) (c9b0eb54-8525-468a-afec-7dba84e7e58e)
15:20:24 reviews: Job OK (c9b0eb54-8525-468a-afec-7dba84e7e58e)
15:20:24 Result is kept for 500 seconds
15:20:24 
15:20:24 *** Listening on chapters, profiles, reviews...
15:20:24 reviews: fanfic.jobs.crawl_reviews(11156269) (317e483b-6d1b-450b-9cee-13faef282dd5)
15:21:18 reviews: Job OK (317e483b-6d1b-450b-9cee-13faef282dd5)
15:21:18 Result is kept for 500 seconds
15:21:18 
15:21:18 *** Listening on chapters, profiles, reviews...
15:21:18 reviews: fanfic.jobs.crawl_reviews(11156760) (febaa246-4a73-4417-82f0-a9553c1d8614)
15:21:50 reviews: Job OK (febaa246-4a73-4417-82f0-a9553c1d8614)
15:21:50 Result is kept for 500 seconds
15:21:50 
15:21:50 *** Listening on chapters, profiles, reviews...
15:21:50 reviews: fanfic.jobs.crawl_reviews(11157887) (60bf3d89-b769-4ff4-84a7-96719cda082d)
15:21:55 reviews: Job OK (60bf3d89-b769-4ff4-84a7-96719cda082d)
15:21:55 Result is kept for 500 seconds
15:21:55 
15:21:55 *** Listening on chapters, profiles, reviews...
15:21:55 reviews: fanfic.jobs.crawl_reviews(11158185) (d5da4c8a-93db-4a30-a8bb-dbbc10d0fe08)
15:22:25 reviews: Job OK (d5da4c8a-93db-4a30-a8bb-dbbc10d0fe08)
15:22:25 Result is kept for 500 seconds
15:22:25 
15:22:25 *** Listening on chapters, profiles, reviews...
15:22:25 reviews: fanfic.jobs.crawl_reviews(11158834) (97288be2-df62-4824-a75e-89631afdc447)
15:22:41 reviews: Job OK (97288be2-df62-4824-a75e-89631afdc447)
15:22:41 Result is kept for 500 seconds
15:22:41 
15:22:41 *** Listening on chapters, profiles, reviews...
15:22:41 reviews: fanfic.jobs.crawl_reviews(11160031) (941fffac-0c44-446e-9e40-76e54efb3ff5)
15:23:21 reviews: Job OK (941fffac-0c44-446e-9e40-76e54efb3ff5)
15:23:21 Result is kept for 500 seconds
15:23:21 
15:23:21 *** Listening on chapters, profiles, reviews...
15:23:21 reviews: fanfic.jobs.crawl_reviews(11160509) (ee0dce99-4e76-448c-bc89-c67d78913bf3)
15:26:04 reviews: Job OK (ee0dce99-4e76-448c-bc89-c67d78913bf3)
15:26:04 Result is kept for 500 seconds
15:26:04 
15:26:04 *** Listening on chapters, profiles, reviews...
15:26:04 reviews: fanfic.jobs.crawl_reviews(11160558) (79b61911-ac6c-4202-9ac6-a0eb256dc339)
15:26:10 reviews: Job OK (79b61911-ac6c-4202-9ac6-a0eb256dc339)
15:26:10 Result is kept for 500 seconds
15:26:10 
15:26:10 *** Listening on chapters, profiles, reviews...
15:26:10 reviews: fanfic.jobs.crawl_reviews(11160991) (e7161aa3-3e7b-4040-9379-174b29adea49)
15:38:40 reviews: Job OK (e7161aa3-3e7b-4040-9379-174b29adea49)
15:38:40 Result is kept for 500 seconds
15:38:40 
15:38:40 *** Listening on chapters, profiles, reviews...
15:38:40 reviews: fanfic.jobs.crawl_reviews(11164421) (04854a88-6149-4e9c-ac9e-adec2feb4f9b)
15:38:51 reviews: Job OK (04854a88-6149-4e9c-ac9e-adec2feb4f9b)
15:38:51 Result is kept for 500 seconds
15:38:51 
15:38:51 *** Listening on chapters, profiles, reviews...
15:38:51 reviews: fanfic.jobs.crawl_reviews(11164642) (4ab3de2e-90be-4222-82b0-af31e2eb7b19)
2017-02-08 15:38:56 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-08 23:38:56.500550', 11164642, 234551754, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5594904&amp;r ... (974 characters truncated) ... </small><div style="margin-top:5px">I found your story and I love reading it. I can\'t wait to read the sequel. Please update soon.</div></td>\n</tr>'), ('2017-02-08 23:38:56.500554', 11164642, 234538537, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1429891&amp;r ... (945 characters truncated) ... ="1458400691">3/19/2016</span> </small><div style="margin-top:5px">Great chapter and story so far please continue this story soon..</div></td>\n</tr>'), ('2017-02-08 23:38:56.500557', 11164642, 232466125, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7500424&amp;r ... (937 characters truncated) ... a-xutime="1454199825">1/30/2016</span> </small><div style="margin-top:5px">Essa é uma das melhores historias femharry que eu já li.</div></td>\n</tr>'), ('2017-02-08 23:38:56.500559', 11164642, 229755346, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (504 characters truncated) ...  <small style="color:gray">chapter 1 . <span data-xutime="1448728342">11/28/2015</span> </small><div style="margin-top:5px">awesome</div></td>\n</tr>'), ('2017-02-08 23:38:56.500561', 11164642, 218269836, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6371924&amp;r ... (957 characters truncated) ... time="1428314384">4/6/2015</span> </small><div style="margin-top:5px">Really enjoying this, I can\'t wait to see what happens next!</div></td>\n</tr>'), ('2017-02-08 23:38:56.500562', 11164642, 218249964, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4776001&amp;r ... (966 characters truncated) ... 5</span> </small><div style="margin-top:5px">I love how quickly you update. I also love how the story builds up. Great job, really.</div></td>\n</tr>'), ('2017-02-08 23:38:56.500564', 11164642, 218245795, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5627367&amp;r ... (951 characters truncated) ... 7 . <span data-xutime="1428277816">4/5/2015</span> </small><div style="margin-top:5px">That headline bringing back memories, Snape?</div></td>\n</tr>'), ('2017-02-08 23:38:56.500566', 11164642, 218244158, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5627367&amp;r ... (1013 characters truncated) ... v style="margin-top:5px">I like how Andrew is a Slytherin but I\'m curious to when Michael will join the story or if he\'s a squibp</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-08 23:38:56.500590', 11164642, 218243215, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5627367&amp;r ... (947 characters truncated) ... ter 1 . <span data-xutime="1428274526">4/5/2015</span> </small><div style="margin-top:5px">Hmm... Curious to see what happens next!</div></td>\n</tr>'), ('2017-02-08 23:38:56.500592', 11164642, 218242576, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4776001&amp;r ... (978 characters truncated) ... all><div style="margin-top:5px">Very interesting take on "The Girl-Who-Lived". I look forwards to seeing the outcome of this story.</div></td>\n</tr>'))]
15:38:56 reviews: Job OK (4ab3de2e-90be-4222-82b0-af31e2eb7b19)
15:38:56 Result is kept for 500 seconds
15:38:56 
15:38:56 *** Listening on chapters, profiles, reviews...
15:38:56 reviews: fanfic.jobs.crawl_reviews(11164675) (e123dd3d-6892-4927-bd05-19191e3b6728)
15:39:26 reviews: Job OK (e123dd3d-6892-4927-bd05-19191e3b6728)
15:39:26 Result is kept for 500 seconds
15:39:26 
15:39:26 *** Listening on chapters, profiles, reviews...
15:39:26 reviews: fanfic.jobs.crawl_reviews(11166683) (bb623216-cac3-4f19-a567-366538db0ac7)
15:39:39 reviews: Job OK (bb623216-cac3-4f19-a567-366538db0ac7)
15:39:39 Result is kept for 500 seconds
15:39:39 
15:39:39 *** Listening on chapters, profiles, reviews...
15:39:39 reviews: fanfic.jobs.crawl_reviews(11167557) (5d82e78d-8fcd-423a-a2e0-c509546852ee)
15:39:44 reviews: Job OK (5d82e78d-8fcd-423a-a2e0-c509546852ee)
15:39:44 Result is kept for 500 seconds
15:39:44 
15:39:44 *** Listening on chapters, profiles, reviews...
15:39:44 reviews: fanfic.jobs.crawl_reviews(11167912) (03c2520f-9250-44b4-ad5a-f8096f4162c0)
15:40:15 reviews: Job OK (03c2520f-9250-44b4-ad5a-f8096f4162c0)
15:40:15 Result is kept for 500 seconds
15:40:15 
15:40:15 *** Listening on chapters, profiles, reviews...
15:40:15 reviews: fanfic.jobs.crawl_reviews(11169360) (63519ed5-8132-43f5-a3bd-131fcc38732b)
15:40:24 reviews: Job OK (63519ed5-8132-43f5-a3bd-131fcc38732b)
15:40:24 Result is kept for 500 seconds
15:40:24 
15:40:24 *** Listening on chapters, profiles, reviews...
15:40:24 reviews: fanfic.jobs.crawl_reviews(11170935) (f168c9e2-6f3e-419e-80dc-fbe4f9b0fc5c)
15:40:38 reviews: Job OK (f168c9e2-6f3e-419e-80dc-fbe4f9b0fc5c)
15:40:38 Result is kept for 500 seconds
15:40:38 
15:40:38 *** Listening on chapters, profiles, reviews...
15:40:38 reviews: fanfic.jobs.crawl_reviews(11171295) (549b1aa6-fbdd-4bb1-95ef-45c1a1827f1d)
15:41:33 reviews: Job OK (549b1aa6-fbdd-4bb1-95ef-45c1a1827f1d)
15:41:33 Result is kept for 500 seconds
15:41:33 
15:41:33 *** Listening on chapters, profiles, reviews...
15:41:33 reviews: fanfic.jobs.crawl_reviews(11171612) (b6d072da-18d1-4a60-aa9c-2f73d8c3728b)
15:42:52 reviews: Job OK (b6d072da-18d1-4a60-aa9c-2f73d8c3728b)
15:42:52 Result is kept for 500 seconds
15:42:52 
15:42:52 *** Listening on chapters, profiles, reviews...
15:42:52 reviews: fanfic.jobs.crawl_reviews(11171862) (72e4e761-a8de-4cd2-a3ba-84aea8f11fce)
15:43:01 reviews: Job OK (72e4e761-a8de-4cd2-a3ba-84aea8f11fce)
15:43:01 Result is kept for 500 seconds
15:43:01 
15:43:01 *** Listening on chapters, profiles, reviews...
15:43:01 reviews: fanfic.jobs.crawl_reviews(11172757) (6aced198-6ce1-485c-b5ec-b598173bb24f)
15:43:29 reviews: Job OK (6aced198-6ce1-485c-b5ec-b598173bb24f)
15:43:29 Result is kept for 500 seconds
15:43:29 
15:43:29 *** Listening on chapters, profiles, reviews...
15:43:29 reviews: fanfic.jobs.crawl_reviews(11172955) (e73d540a-91e1-441e-912e-2af96f95324a)
15:56:21 reviews: Job OK (e73d540a-91e1-441e-912e-2af96f95324a)
15:56:21 Result is kept for 500 seconds
15:56:21 Cleaning registries for queue: chapters
15:56:21 Cleaning registries for queue: profiles
15:56:21 Cleaning registries for queue: reviews
15:56:21 
15:56:21 *** Listening on chapters, profiles, reviews...
15:56:21 reviews: fanfic.jobs.crawl_reviews(11173524) (929c1957-cc8b-4c3d-a675-1b3a7e0b5a6e)
16:07:24 reviews: Job OK (929c1957-cc8b-4c3d-a675-1b3a7e0b5a6e)
16:07:24 Result is kept for 500 seconds
16:07:24 
16:07:24 *** Listening on chapters, profiles, reviews...
16:07:24 reviews: fanfic.jobs.crawl_reviews(11173708) (b11ec3df-7bcd-43b9-9964-6bdceb03b609)
16:07:41 reviews: Job OK (b11ec3df-7bcd-43b9-9964-6bdceb03b609)
16:07:41 Result is kept for 500 seconds
16:07:41 
16:07:41 *** Listening on chapters, profiles, reviews...
16:07:41 reviews: fanfic.jobs.crawl_reviews(11173866) (5a21d0c4-753f-4f99-a235-f127f384409c)
16:09:13 reviews: Job OK (5a21d0c4-753f-4f99-a235-f127f384409c)
16:09:13 Result is kept for 500 seconds
16:09:13 
16:09:13 *** Listening on chapters, profiles, reviews...
16:09:13 reviews: fanfic.jobs.crawl_reviews(11174940) (a82dd772-23ba-4329-9ff8-0fc2fb65ad7a)
16:10:07 reviews: Job OK (a82dd772-23ba-4329-9ff8-0fc2fb65ad7a)
16:10:07 Result is kept for 500 seconds
16:10:07 
16:10:07 *** Listening on chapters, profiles, reviews...
16:10:07 reviews: fanfic.jobs.crawl_reviews(11175022) (8a507171-1b95-482d-ba01-54658d1bf6b1)
16:10:15 reviews: Job OK (8a507171-1b95-482d-ba01-54658d1bf6b1)
16:10:15 Result is kept for 500 seconds
16:10:15 
16:10:15 *** Listening on chapters, profiles, reviews...
16:10:15 reviews: fanfic.jobs.crawl_reviews(11175032) (55257c66-6a6b-4946-afe2-dbea30bef559)
16:10:27 reviews: Job OK (55257c66-6a6b-4946-afe2-dbea30bef559)
16:10:27 Result is kept for 500 seconds
16:10:27 
16:10:27 *** Listening on chapters, profiles, reviews...
16:10:27 reviews: fanfic.jobs.crawl_reviews(11176505) (78ffeee7-ac42-4e79-9ba8-2b5625085a0d)
16:12:09 reviews: Job OK (78ffeee7-ac42-4e79-9ba8-2b5625085a0d)
16:12:09 Result is kept for 500 seconds
16:12:09 
16:12:09 *** Listening on chapters, profiles, reviews...
16:12:09 reviews: fanfic.jobs.crawl_reviews(11176758) (d30a776a-3b0e-4123-ae22-413917d23b5b)
16:12:43 reviews: Job OK (d30a776a-3b0e-4123-ae22-413917d23b5b)
16:12:43 Result is kept for 500 seconds
16:12:43 
16:12:43 *** Listening on chapters, profiles, reviews...
16:12:43 reviews: fanfic.jobs.crawl_reviews(11177957) (5c06bdb1-d9a3-4307-b6d0-b3a9d1f8890f)
16:12:52 reviews: Job OK (5c06bdb1-d9a3-4307-b6d0-b3a9d1f8890f)
16:12:52 Result is kept for 500 seconds
16:12:52 
16:12:52 *** Listening on chapters, profiles, reviews...
16:12:52 reviews: fanfic.jobs.crawl_reviews(11179450) (93d8d9d2-05f5-4315-b920-adbf814a1629)
16:13:58 reviews: Job OK (93d8d9d2-05f5-4315-b920-adbf814a1629)
16:13:58 Result is kept for 500 seconds
16:13:58 
16:13:58 *** Listening on chapters, profiles, reviews...
16:13:58 reviews: fanfic.jobs.crawl_reviews(11179863) (be295be0-9723-403b-bce2-c883fd325cd1)
16:14:36 reviews: Job OK (be295be0-9723-403b-bce2-c883fd325cd1)
16:14:36 Result is kept for 500 seconds
16:14:36 
16:14:36 *** Listening on chapters, profiles, reviews...
16:14:36 reviews: fanfic.jobs.crawl_reviews(11180009) (4ba7f07a-d181-4390-8545-0e49b9214081)
16:14:41 reviews: Job OK (4ba7f07a-d181-4390-8545-0e49b9214081)
16:14:41 Result is kept for 500 seconds
16:14:41 
16:14:41 *** Listening on chapters, profiles, reviews...
16:14:41 reviews: fanfic.jobs.crawl_reviews(11180088) (f7071e2b-9b13-4591-8f76-c03e63316c1b)
16:19:16 reviews: Job OK (f7071e2b-9b13-4591-8f76-c03e63316c1b)
16:19:16 Result is kept for 500 seconds
16:19:16 
16:19:16 *** Listening on chapters, profiles, reviews...
16:19:16 reviews: fanfic.jobs.crawl_reviews(11180094) (af82ba54-1812-4df9-98d7-811168aa3d59)
2017-02-08 16:19:21 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 00:19:21.186099', 11180094, 244540812, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (769 characters truncated) ... le more than a plot device, but you tied poor Sirius and Remus in knots before we finally got a happy ending.<br>\n<br>\nThank you.</div></td>\n</tr>'), ('2017-02-09 00:19:21.186104', 11180094, 243031535, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1301978&amp;r ... (991 characters truncated) ... ead them (great way to spend part of my vacation) and appreciate the way you handled the very touchy issues of sexuality and abuse.</div></td>\n</tr>'), ('2017-02-09 00:19:21.186106', 11180094, 228790382, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6937291&amp;r ... (1280 characters truncated) ... cially loved the part with teddys gender identity and the acceptance of all houses. Thank you for such a wonderfully written fanfic</div></td>\n</tr>'), ('2017-02-09 00:19:21.186109', 11180094, 223564590, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1064 characters truncated) ... l write some more chapters or at least other wolfstar fanfiction one day. <br>\nCongratulations for this story and have a nice day.</div></td>\n</tr>'), ('2017-02-09 00:19:21.186111', 11180094, 244540812, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (769 characters truncated) ... le more than a plot device, but you tied poor Sirius and Remus in knots before we finally got a happy ending.<br>\n<br>\nThank you.</div></td>\n</tr>'), ('2017-02-09 00:19:21.186113', 11180094, 243031535, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1301978&amp;r ... (991 characters truncated) ... ead them (great way to spend part of my vacation) and appreciate the way you handled the very touchy issues of sexuality and abuse.</div></td>\n</tr>'), ('2017-02-09 00:19:21.186114', 11180094, 228790382, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6937291&amp;r ... (1280 characters truncated) ... cially loved the part with teddys gender identity and the acceptance of all houses. Thank you for such a wonderfully written fanfic</div></td>\n</tr>'), ('2017-02-09 00:19:21.186116', 11180094, 223564590, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1064 characters truncated) ... l write some more chapters or at least other wolfstar fanfiction one day. <br>\nCongratulations for this story and have a nice day.</div></td>\n</tr>'))]
16:19:21 reviews: Job OK (af82ba54-1812-4df9-98d7-811168aa3d59)
16:19:21 Result is kept for 500 seconds
16:19:21 
16:19:21 *** Listening on chapters, profiles, reviews...
16:19:21 reviews: fanfic.jobs.crawl_reviews(11180696) (7531690d-bde4-43d2-864e-9c497fc31dc7)
2017-02-08 16:19:22 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/11180696/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
16:19:22 reviews: Job OK (7531690d-bde4-43d2-864e-9c497fc31dc7)
16:19:22 Result is kept for 500 seconds
16:19:22 
16:19:22 *** Listening on chapters, profiles, reviews...
16:19:22 reviews: fanfic.jobs.crawl_reviews(11182251) (8f939088-957f-40c8-b7c3-9b81d48a8297)
16:20:08 reviews: Job OK (8f939088-957f-40c8-b7c3-9b81d48a8297)
16:20:08 Result is kept for 500 seconds
16:20:08 
16:20:08 *** Listening on chapters, profiles, reviews...
16:20:08 reviews: fanfic.jobs.crawl_reviews(11182721) (ade7aabd-4af9-4c34-b3d0-0e44cd81abc6)
16:20:33 reviews: Job OK (ade7aabd-4af9-4c34-b3d0-0e44cd81abc6)
16:20:33 Result is kept for 500 seconds
16:20:33 
16:20:33 *** Listening on chapters, profiles, reviews...
16:20:33 reviews: fanfic.jobs.crawl_reviews(11183017) (964f61a1-9280-4783-9114-dd2a298c58ab)
16:20:39 reviews: Job OK (964f61a1-9280-4783-9114-dd2a298c58ab)
16:20:39 Result is kept for 500 seconds
16:20:39 
16:20:39 *** Listening on chapters, profiles, reviews...
16:20:39 reviews: fanfic.jobs.crawl_reviews(11183615) (f16a7103-60e6-49d1-aab2-1608f9771723)
2017-02-08 16:20:45 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 00:20:45.575429', 11183615, 243137695, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6253345&amp;r ... (940 characters truncated) ... le="margin-top:5px">Dude (to me dude is a universal word) this story is awsome please please post the next chapter I love the story</div></td>\n</tr>'), ('2017-02-09 00:20:45.575433', 11183615, 219906246, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=920624&amp;rw ... (857 characters truncated) ...  . <span data-xutime="1431084300">5/8/2015</span> </small><div style="margin-top:5px">I hope this isn\'t going to be a bashing fic.</div></td>\n</tr>'), ('2017-02-09 00:20:45.575435', 11183615, 219905554, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=920624&amp;rw ... (879 characters truncated) ... 1431082449">5/8/2015</span> </small><div style="margin-top:5px">Ahahahaha, depend on McGonagall? The woman is useless in the books.</div></td>\n</tr>'), ('2017-02-09 00:20:45.575437', 11183615, 219867236, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1014341&amp;r ... (1072 characters truncated) ... e is spiked with a love potion, or something like that. Dumbles is really going to get it.<br>\n<br>\nI can\'t wait for chapter 12!</div></td>\n</tr>'), ('2017-02-09 00:20:45.575439', 11183615, 219279557, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1949217&amp;r ... (957 characters truncated) ... ata-xutime="1430002972">4/25/2015</span> </small><div style="margin-top:5px">You\'re going to get yourself kill old man update soon</div></td>\n</tr>'), ('2017-02-09 00:20:45.575441', 11183615, 218922315, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1949217&amp;r ... (1095 characters truncated) ... nd between them. He also doesn\'t know Harry can throw off the Imperious curse at will if he knew it might be different update soon</div></td>\n</tr>'), ('2017-02-09 00:20:45.575443', 11183615, 218832825, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5622563&amp;r ... (1261 characters truncated) ...  to a problem, not a clue to something. There\'s just a lot of things that don\'t make sense but would be fixed with a line or two.</div></td>\n</tr>'), ('2017-02-09 00:20:45.575445', 11183615, 218824423, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1949217&amp;r ... (1048 characters truncated) ... ries to break the bond he\'ll wind up killing them. He may have to change the laws just to prevent that from happening. update soon</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-09 00:20:45.575465', 11183615, 218740496, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (636 characters truncated) ... , a few little typos here and there, but i\'m impressed, and cant wait to read more, so pull your finger out, and continue writing.</div></td>\n</tr>'), ('2017-02-09 00:20:45.575467', 11183615, 218723349, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1949217&amp;r ... (1050 characters truncated) ... en one soulmate out there. Who else is his soulmate? Susan bones, Daphne greengrass Tracy Davis Luna Lovegood who knows update soon</div></td>\n</tr>'))]
16:20:45 reviews: Job OK (f16a7103-60e6-49d1-aab2-1608f9771723)
16:20:45 Result is kept for 500 seconds
16:20:45 
16:20:45 *** Listening on chapters, profiles, reviews...
16:20:45 reviews: fanfic.jobs.crawl_reviews(11183956) (add6c207-e9d2-48a9-8d7d-514937edadcf)
16:20:50 reviews: Job OK (add6c207-e9d2-48a9-8d7d-514937edadcf)
16:20:50 Result is kept for 500 seconds
16:20:50 
16:20:50 *** Listening on chapters, profiles, reviews...
16:20:50 reviews: fanfic.jobs.crawl_reviews(11184839) (f99beccf-348e-440a-b361-89707db53a43)
16:20:58 reviews: Job OK (f99beccf-348e-440a-b361-89707db53a43)
16:20:58 Result is kept for 500 seconds
16:20:58 
16:20:58 *** Listening on chapters, profiles, reviews...
16:20:58 reviews: fanfic.jobs.crawl_reviews(11185107) (d1e97162-75b7-46ab-add1-d7b3c01458fd)
16:24:36 reviews: Job OK (d1e97162-75b7-46ab-add1-d7b3c01458fd)
16:24:36 Result is kept for 500 seconds
16:24:36 
16:24:36 *** Listening on chapters, profiles, reviews...
16:24:36 reviews: fanfic.jobs.crawl_reviews(11185748) (672b2189-3674-4241-b1fe-a00b112fbf80)
16:24:41 reviews: Job OK (672b2189-3674-4241-b1fe-a00b112fbf80)
16:24:41 Result is kept for 500 seconds
16:24:41 
16:24:41 *** Listening on chapters, profiles, reviews...
16:24:41 reviews: fanfic.jobs.crawl_reviews(11187498) (30b7b5ee-6bd9-4d89-89a4-5beb85b6422c)
16:25:06 reviews: Job OK (30b7b5ee-6bd9-4d89-89a4-5beb85b6422c)
16:25:06 Result is kept for 500 seconds
16:25:06 
16:25:06 *** Listening on chapters, profiles, reviews...
16:25:06 reviews: fanfic.jobs.crawl_reviews(11187797) (5e0ab359-0170-4d34-b9b5-66cad30b7811)
2017-02-08 16:25:11 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 00:25:11.815996', 11187797, 226225800, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5110618&amp;r ... (926 characters truncated) ... e="1441741134">9/8/2015</span> </small><div style="margin-top:5px">i cant wait for it, i wanna read more XD i love your writing btw</div></td>\n</tr>'), ('2017-02-09 00:25:11.816001', 11187797, 224689843, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5036799&amp;r ... (999 characters truncated) ... div style="margin-top:5px">Not gonna lie, I sort of freaked out at first. Because I was just reading it and bam everything changed.</div></td>\n</tr>'), ('2017-02-09 00:25:11.816003', 11187797, 223197849, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1081 characters truncated) ... g an 8th year... wasn\'t 7 years enough?<br>\nReally looking forward to the sequel. I absolutely NEED to know what happens next! :)</div></td>\n</tr>'), ('2017-02-09 00:25:11.816005', 11187797, 222552910, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5834083&amp;r ... (1150 characters truncated) ... gled just to put out 20 000 words and I was still complaining about not having much reviews.**sighs and realizes what a brat I am**</div></td>\n</tr>'), ('2017-02-09 00:25:11.816007', 11187797, 222552740, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5834083&amp;r ... (893 characters truncated) ... e="margin-top:5px">Holy smackerels! Did you just update like 15 chapters at the same time? My inbox was flooded! You do write fast!</div></td>\n</tr>'), ('2017-02-09 00:25:11.816009', 11187797, 219625911, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6540330&amp;r ... (883 characters truncated) ... tyle="color:gray">chapter 1 . <span data-xutime="1430601582">5/2/2015</span> </small><div style="margin-top:5px">This is awesome :D</div></td>\n</tr>'), ('2017-02-09 00:25:11.816011', 11187797, 219543261, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (514 characters truncated) ... tyle="color:gray">chapter 18 . <span data-xutime="1430276103">4/28/2015</span> </small><div style="margin-top:5px">Please update!\'</div></td>\n</tr>'), ('2017-02-09 00:25:11.816013', 11187797, 219291916, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (556 characters truncated) ... me="1429952939">4/25/2015</span> </small><div style="margin-top:5px">Send help. More I need more. Feed me mother, quench my thirst.</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-09 00:25:11.816037', 11187797, 219289407, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5834083&amp;r ... (787 characters truncated) ...   <small style="color:gray">chapter 1 . <span data-xutime="1430017313">4/25/2015</span> </small><div style="margin-top:5px">wowsers</div></td>\n</tr>'), ('2017-02-09 00:25:11.816039', 11187797, 219234233, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=275530&amp;rw ... (962 characters truncated) ... style="margin-top:5px">I can\'t believe that no one has reviewed yet!? I absolutely love this story and can\'t wait to read more :)</div></td>\n</tr>'))]
16:25:11 reviews: Job OK (5e0ab359-0170-4d34-b9b5-66cad30b7811)
16:25:11 Result is kept for 500 seconds
16:25:11 
16:25:11 *** Listening on chapters, profiles, reviews...
16:25:11 reviews: fanfic.jobs.crawl_reviews(11188380) (455d47d1-3a53-4c62-891e-b09f7c6daeb1)
16:26:20 reviews: Job OK (455d47d1-3a53-4c62-891e-b09f7c6daeb1)
16:26:20 Result is kept for 500 seconds
16:26:20 
16:26:20 *** Listening on chapters, profiles, reviews...
16:26:20 reviews: fanfic.jobs.crawl_reviews(11189003) (4afb625a-e1fb-4227-aad7-caeffbbaab89)
16:27:58 reviews: Job OK (4afb625a-e1fb-4227-aad7-caeffbbaab89)
16:27:58 Result is kept for 500 seconds
16:27:58 
16:27:58 *** Listening on chapters, profiles, reviews...
16:27:58 reviews: fanfic.jobs.crawl_reviews(11189160) (ac87cae6-e65a-4973-a4af-b1a53d6eda50)
16:29:45 reviews: Job OK (ac87cae6-e65a-4973-a4af-b1a53d6eda50)
16:29:45 Result is kept for 500 seconds
16:29:45 
16:29:45 *** Listening on chapters, profiles, reviews...
16:29:45 reviews: fanfic.jobs.crawl_reviews(11189271) (d0f867bb-6605-41d3-b43d-875a565f7fd7)
16:31:32 reviews: Job OK (d0f867bb-6605-41d3-b43d-875a565f7fd7)
16:31:32 Result is kept for 500 seconds
16:31:32 
16:31:32 *** Listening on chapters, profiles, reviews...
16:31:32 reviews: fanfic.jobs.crawl_reviews(11190361) (d957d99e-914c-45df-8347-04b5d2c8045d)
16:31:43 reviews: Job OK (d957d99e-914c-45df-8347-04b5d2c8045d)
16:31:43 Result is kept for 500 seconds
16:31:43 
16:31:43 *** Listening on chapters, profiles, reviews...
16:31:43 reviews: fanfic.jobs.crawl_reviews(11190718) (882823a3-ebd5-4203-a678-5ba058817dd8)
16:35:38 reviews: Job OK (882823a3-ebd5-4203-a678-5ba058817dd8)
16:35:38 Result is kept for 500 seconds
16:35:38 
16:35:38 *** Listening on chapters, profiles, reviews...
16:35:38 reviews: fanfic.jobs.crawl_reviews(11191117) (d2cd8bdd-9716-40bd-a23f-6e20248348b0)
16:36:59 reviews: Job OK (d2cd8bdd-9716-40bd-a23f-6e20248348b0)
16:36:59 Result is kept for 500 seconds
16:36:59 
16:36:59 *** Listening on chapters, profiles, reviews...
16:36:59 reviews: fanfic.jobs.crawl_reviews(11191235) (63fb62af-ac34-4d1f-9859-bfed97d55e94)
17:01:33 reviews: Job OK (63fb62af-ac34-4d1f-9859-bfed97d55e94)
17:01:33 Result is kept for 500 seconds
17:01:33 Cleaning registries for queue: chapters
17:01:33 Cleaning registries for queue: profiles
17:01:33 Cleaning registries for queue: reviews
17:01:33 
17:01:33 *** Listening on chapters, profiles, reviews...
17:01:33 reviews: fanfic.jobs.crawl_reviews(11191296) (fbb296ad-c1a3-4a79-ac7a-25567640616c)
17:05:23 reviews: Job OK (fbb296ad-c1a3-4a79-ac7a-25567640616c)
17:05:23 Result is kept for 500 seconds
17:05:23 
17:05:23 *** Listening on chapters, profiles, reviews...
17:05:23 reviews: fanfic.jobs.crawl_reviews(11196963) (b77b173c-355f-4457-b1a6-9b2b96fc9a88)
17:07:27 reviews: Job OK (b77b173c-355f-4457-b1a6-9b2b96fc9a88)
17:07:27 Result is kept for 500 seconds
17:07:27 
17:07:27 *** Listening on chapters, profiles, reviews...
17:07:27 reviews: fanfic.jobs.crawl_reviews(11198081) (6b91b1b5-69c9-4e69-89df-7d9134e44dfd)
17:07:47 reviews: Job OK (6b91b1b5-69c9-4e69-89df-7d9134e44dfd)
17:07:47 Result is kept for 500 seconds
17:07:47 
17:07:47 *** Listening on chapters, profiles, reviews...
17:07:47 reviews: fanfic.jobs.crawl_reviews(11202532) (5ebdfdda-d28a-4e28-9931-46b96810991a)
17:08:34 reviews: Job OK (5ebdfdda-d28a-4e28-9931-46b96810991a)
17:08:34 Result is kept for 500 seconds
17:08:34 
17:08:34 *** Listening on chapters, profiles, reviews...
17:08:34 reviews: fanfic.jobs.crawl_reviews(11202692) (f000ed70-740b-42d0-9cd9-42f8b2e9fb48)
17:08:44 reviews: Job OK (f000ed70-740b-42d0-9cd9-42f8b2e9fb48)
17:08:44 Result is kept for 500 seconds
17:08:44 
17:08:44 *** Listening on chapters, profiles, reviews...
17:08:44 reviews: fanfic.jobs.crawl_reviews(11203354) (7375e33d-8ac3-44f4-953b-c418ab0caaf7)
17:09:45 reviews: Job OK (7375e33d-8ac3-44f4-953b-c418ab0caaf7)
17:09:45 Result is kept for 500 seconds
17:09:45 
17:09:45 *** Listening on chapters, profiles, reviews...
17:09:45 reviews: fanfic.jobs.crawl_reviews(11205574) (d116bd59-1dcb-4480-88ea-846b6f83f20c)
2017-02-08 17:09:49 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 01:09:49.084781', 11205574, 233120306, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (612 characters truncated) ... yle="margin-top:5px">i really like this story and I think you\'ve done great job with it. I definitely hope you\'ll continue it! :)</div></td>\n</tr>'), ('2017-02-09 01:09:49.084785', 11205574, 224223603, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2756027&amp;r ... (1613 characters truncated) ... ring things in it, it\'s just a thing that I always imagined Dumbledore would do! <br>\n<br>\nLooking forwards to the next chapter!</div></td>\n</tr>'), ('2017-02-09 01:09:49.084788', 11205574, 223718547, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2756027&amp;r ... (3021 characters truncated) ... ork with the plan, so it\'s just a suggestion. <br>\n<br>\nBut yeah... I am really looking forward to the continuation to this fic!</div></td>\n</tr>'), ('2017-02-09 01:09:49.084790', 11205574, 223280095, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (592 characters truncated) ... </small><div style="margin-top:5px">I think basil holding Ginny hostage could be a good opportunity for some character development.</div></td>\n</tr>'), ('2017-02-09 01:09:49.084792', 11205574, 221643178, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6831652&amp;r ... (860 characters truncated) ... 434043294">6/11/2015</span> </small><div style="margin-top:5px">Interesting story! But what happened to Colin? Did he even survive?</div></td>\n</tr>'), ('2017-02-09 01:09:49.084794', 11205574, 221230179, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2756027&amp;r ... (2281 characters truncated) ...  be racists, that\'s such a natural translation to the non-magical world.)<br>\n<br>\n(Sorry about the long and late review... :( )</div></td>\n</tr>'), ('2017-02-09 01:09:49.084796', 11205574, 220612680, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2756027&amp;r ... (1079 characters truncated) ... ors. <br>\nI really like it, and am so excited for it to continue and develop more plot! <br>\n(Also, I hope your exams went well!)</div></td>\n</tr>'), ('2017-02-09 01:09:49.084798', 11205574, 220359263, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2756027&amp;r ... (1155 characters truncated) ... teresting scenario, and I can\'t wait until Hermionie comes along. <br>\n(And also, hello again, three years later... How are you?)</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-09 01:09:49.084811', 11205574, 220612680, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2756027&amp;r ... (1079 characters truncated) ... ors. <br>\nI really like it, and am so excited for it to continue and develop more plot! <br>\n(Also, I hope your exams went well!)</div></td>\n</tr>'), ('2017-02-09 01:09:49.084813', 11205574, 220359263, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2756027&amp;r ... (1155 characters truncated) ... teresting scenario, and I can\'t wait until Hermionie comes along. <br>\n(And also, hello again, three years later... How are you?)</div></td>\n</tr>'))]
17:09:49 reviews: Job OK (d116bd59-1dcb-4480-88ea-846b6f83f20c)
17:09:49 Result is kept for 500 seconds
17:09:49 
17:09:49 *** Listening on chapters, profiles, reviews...
17:09:49 reviews: fanfic.jobs.crawl_reviews(11205982) (7cfd735d-ee08-4e46-a5b6-a67230968f74)
2017-02-08 17:09:54 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 01:09:54.960642', 11205982, 224203135, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3000280&amp;r ... (1649 characters truncated) ... een in face of other people being bullyied and the adaptation of Candance in Slytherin with his fantasies about a pureblood father.</div></td>\n</tr>'), ('2017-02-09 01:09:54.960647', 11205982, 224169824, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (710 characters truncated) ... y with Daphne using the stupid excuse of Hermione being used by Daphne, with much less reason. It wasn\'t her bully that saved her!</div></td>\n</tr>'), ('2017-02-09 01:09:54.960649', 11205982, 223629210, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4321042&amp;r ... (1168 characters truncated) ... e "Extras" you know... Hufflepuffs are known for being humble, and generally good people, which I think should count for something.</div></td>\n</tr>'), ('2017-02-09 01:09:54.960651', 11205982, 223404443, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (662 characters truncated) ...  good thing was that the classes are a little more detailed, but you could have detailed then more, so you wouldn\'t copy the book.</div></td>\n</tr>'), ('2017-02-09 01:09:54.960653', 11205982, 221517398, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4321042&amp;r ... (1136 characters truncated) ... oking forward to actual plot, could you let me know where that comes in? Also I like your characters. Cathie is nice and relatable.</div></td>\n</tr>'), ('2017-02-09 01:09:54.960655', 11205982, 221516608, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4321042&amp;r ... (997 characters truncated) ... "margin-top:5px">This chapter was a little hard to understand what was going on, with the new characters, but it was still good. :)</div></td>\n</tr>'), ('2017-02-09 01:09:54.960657', 11205982, 221515802, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4321042&amp;r ... (990 characters truncated) ...  style="margin-top:5px">Well I\'ve only read the first chapter, but so far I like it! Maybe make the ANs a bit shorter though... ;)</div></td>\n</tr>'), ('2017-02-09 01:09:54.960659', 11205982, 224203135, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3000280&amp;r ... (1649 characters truncated) ... een in face of other people being bullyied and the adaptation of Candance in Slytherin with his fantasies about a pureblood father.</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-09 01:09:54.960668', 11205982, 221516608, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4321042&amp;r ... (997 characters truncated) ... "margin-top:5px">This chapter was a little hard to understand what was going on, with the new characters, but it was still good. :)</div></td>\n</tr>'), ('2017-02-09 01:09:54.960670', 11205982, 221515802, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4321042&amp;r ... (990 characters truncated) ...  style="margin-top:5px">Well I\'ve only read the first chapter, but so far I like it! Maybe make the ANs a bit shorter though... ;)</div></td>\n</tr>'))]
17:09:54 reviews: Job OK (7cfd735d-ee08-4e46-a5b6-a67230968f74)
17:09:54 Result is kept for 500 seconds
17:09:54 
17:09:54 *** Listening on chapters, profiles, reviews...
17:09:54 reviews: fanfic.jobs.crawl_reviews(11206815) (88989cac-d435-441a-8a0e-fb7a138bd5d7)
17:10:49 reviews: Job OK (88989cac-d435-441a-8a0e-fb7a138bd5d7)
17:10:49 Result is kept for 500 seconds
17:10:49 
17:10:49 *** Listening on chapters, profiles, reviews...
17:10:49 reviews: fanfic.jobs.crawl_reviews(11206826) (d400b73e-8826-451d-bd51-dfecdb3568fd)
17:11:01 reviews: Job OK (d400b73e-8826-451d-bd51-dfecdb3568fd)
17:11:01 Result is kept for 500 seconds
17:11:01 
17:11:01 *** Listening on chapters, profiles, reviews...
17:11:01 reviews: fanfic.jobs.crawl_reviews(11207132) (7df8e851-37f4-48eb-b260-07d9a72e69d6)
17:13:17 reviews: Job OK (7df8e851-37f4-48eb-b260-07d9a72e69d6)
17:13:17 Result is kept for 500 seconds
17:13:17 
17:13:17 *** Listening on chapters, profiles, reviews...
17:13:17 reviews: fanfic.jobs.crawl_reviews(11207861) (4ca48eff-c8ca-4709-affa-ff2ab21a6074)
17:14:01 reviews: Job OK (4ca48eff-c8ca-4709-affa-ff2ab21a6074)
17:14:01 Result is kept for 500 seconds
17:14:01 
17:14:01 *** Listening on chapters, profiles, reviews...
17:14:01 reviews: fanfic.jobs.crawl_reviews(11207949) (1cb85226-2357-495e-a12b-a94a78b59658)
17:14:29 reviews: Job OK (1cb85226-2357-495e-a12b-a94a78b59658)
17:14:29 Result is kept for 500 seconds
17:14:29 
17:14:29 *** Listening on chapters, profiles, reviews...
17:14:29 reviews: fanfic.jobs.crawl_reviews(11208485) (46dbf0d1-ebf6-4353-a967-7fe576ec87cf)
17:14:59 reviews: Job OK (46dbf0d1-ebf6-4353-a967-7fe576ec87cf)
17:14:59 Result is kept for 500 seconds
17:14:59 
17:14:59 *** Listening on chapters, profiles, reviews...
17:14:59 reviews: fanfic.jobs.crawl_reviews(11208580) (56369083-14b7-428b-abb1-947aa4b693e4)
17:15:04 reviews: Job OK (56369083-14b7-428b-abb1-947aa4b693e4)
17:15:04 Result is kept for 500 seconds
17:15:04 
17:15:04 *** Listening on chapters, profiles, reviews...
17:15:04 reviews: fanfic.jobs.crawl_reviews(11208928) (f0da5b31-53e2-4c47-9dee-38179d23f105)
17:15:08 reviews: Job OK (f0da5b31-53e2-4c47-9dee-38179d23f105)
17:15:08 Result is kept for 500 seconds
17:15:08 
17:15:08 *** Listening on chapters, profiles, reviews...
17:15:08 reviews: fanfic.jobs.crawl_reviews(11208933) (3b599ae3-6ab5-4a5e-a0d7-d05a0f9669c6)
17:17:22 reviews: Job OK (3b599ae3-6ab5-4a5e-a0d7-d05a0f9669c6)
17:17:22 Result is kept for 500 seconds
17:17:22 
17:17:22 *** Listening on chapters, profiles, reviews...
17:17:22 reviews: fanfic.jobs.crawl_reviews(11209155) (b6e64c8b-1f66-4fc6-b6f4-bfdaa562fe17)
17:17:39 reviews: Job OK (b6e64c8b-1f66-4fc6-b6f4-bfdaa562fe17)
17:17:39 Result is kept for 500 seconds
17:17:39 
17:17:39 *** Listening on chapters, profiles, reviews...
17:17:39 reviews: fanfic.jobs.crawl_reviews(11210022) (bcca8af9-3447-48c6-9ff4-2f325b404287)
17:18:00 reviews: Job OK (bcca8af9-3447-48c6-9ff4-2f325b404287)
17:18:00 Result is kept for 500 seconds
17:18:00 
17:18:00 *** Listening on chapters, profiles, reviews...
17:18:00 reviews: fanfic.jobs.crawl_reviews(11210783) (c867030d-7744-48fe-9e3b-02da3b771b0e)
17:19:09 reviews: Job OK (c867030d-7744-48fe-9e3b-02da3b771b0e)
17:19:09 Result is kept for 500 seconds
17:19:09 
17:19:09 *** Listening on chapters, profiles, reviews...
17:19:09 reviews: fanfic.jobs.crawl_reviews(11211046) (23ea77f0-9e65-4cbf-b793-82f2778f69fc)
17:20:29 reviews: Job OK (23ea77f0-9e65-4cbf-b793-82f2778f69fc)
17:20:29 Result is kept for 500 seconds
17:20:29 
17:20:29 *** Listening on chapters, profiles, reviews...
17:20:29 reviews: fanfic.jobs.crawl_reviews(11211762) (1d07ea26-0d44-4542-806a-0b70884a3bf8)
17:27:57 reviews: Job OK (1d07ea26-0d44-4542-806a-0b70884a3bf8)
17:27:57 Result is kept for 500 seconds
17:27:57 
17:27:57 *** Listening on chapters, profiles, reviews...
17:27:57 reviews: fanfic.jobs.crawl_reviews(11211969) (4209775d-890e-480d-97a0-494be311f5c1)
17:30:25 reviews: Job OK (4209775d-890e-480d-97a0-494be311f5c1)
17:30:25 Result is kept for 500 seconds
17:30:25 
17:30:25 *** Listening on chapters, profiles, reviews...
17:30:25 reviews: fanfic.jobs.crawl_reviews(11212278) (4f50c999-bdea-4aff-8eb3-0b8531ad1b37)
17:30:31 reviews: Job OK (4f50c999-bdea-4aff-8eb3-0b8531ad1b37)
17:30:31 Result is kept for 500 seconds
17:30:31 
17:30:31 *** Listening on chapters, profiles, reviews...
17:30:31 reviews: fanfic.jobs.crawl_reviews(11212591) (1fd36071-e54c-48b9-82ac-b00fcdb973b6)
17:30:39 reviews: Job OK (1fd36071-e54c-48b9-82ac-b00fcdb973b6)
17:30:39 Result is kept for 500 seconds
17:30:39 
17:30:39 *** Listening on chapters, profiles, reviews...
17:30:39 reviews: fanfic.jobs.crawl_reviews(11213024) (147d8b87-bd73-414c-9c7a-0a0466464df4)
2017-02-08 17:30:44 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 01:30:44.337207', 11213024, 246550790, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (680 characters truncated) ...  they grow older, but then a twist of fate happened. hopefully there\'s still a chance? something drastic occurs or something. idk.</div></td>\n</tr>'), ('2017-02-09 01:30:44.337212', 11213024, 245913073, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8085670&amp;r ... (927 characters truncated) ... wrong for this but I still think Chinhua and Albus should hook up, I mean they already marry cousins in the potterverse so why not?</div></td>\n</tr>'), ('2017-02-09 01:30:44.337214', 11213024, 236801962, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (630 characters truncated) ... x">I\'ve read the sixteen chapters you have so far. A very inventive story. But chapter 11 in particular is amazing. Very poignant.</div></td>\n</tr>'), ('2017-02-09 01:30:44.337217', 11213024, 228741449, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (574 characters truncated) ... 67">11/5/2015</span> </small><div style="margin-top:5px">"i was worse, ginny." f\'en genius line!<br>\nanyway, awesome story, bruh.</div></td>\n</tr>'), ('2017-02-09 01:30:44.337219', 11213024, 228737902, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5248572&amp;r ... (881 characters truncated) ...  </small><div style="margin-top:5px">Great update! Just wanting to let you know that I haven\'t given up on this story! Keep it up!</div></td>\n</tr>'), ('2017-02-09 01:30:44.337220', 11213024, 227101884, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5248572&amp;r ... (967 characters truncated) ... the part when Julia mentioned that Tony allows pets at the meetings, so Julia decides Albus could go since he\'s like a pet to her.</div></td>\n</tr>'), ('2017-02-09 01:30:44.337222', 11213024, 226943859, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (566 characters truncated) ... me="1443109696">9/24/2015</span> </small><div style="margin-top:5px">Awesome story, man! Really enjoying the progression right now!</div></td>\n</tr>'), ('2017-02-09 01:30:44.337224', 11213024, 224639325, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5248572&amp;r ... (1977 characters truncated) ... ill as awkward as he is. In addition, that\'s a nice idea that Chinhua had come up with. I\'d like to see how they\'ll play it out!</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-09 01:30:44.337264', 11213024, 219599621, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6509382&amp;r ... (790 characters truncated) ... all style="color:gray">chapter 1 . <span data-xutime="1430553125">5/2/2015</span> </small><div style="margin-top:5px">Fixed. Thanks</div></td>\n</tr>'), ('2017-02-09 01:30:44.337266', 11213024, 219384975, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1864945&amp;r ... (917 characters truncated) ... data-xutime="1430173582">4/27/2015</span> </small><div style="margin-top:5px">Good start, I don\'t think out filed is a word though</div></td>\n</tr>'))]
17:30:44 reviews: Job OK (147d8b87-bd73-414c-9c7a-0a0466464df4)
17:30:44 Result is kept for 500 seconds
17:30:44 
17:30:44 *** Listening on chapters, profiles, reviews...
17:30:44 reviews: fanfic.jobs.crawl_reviews(11213443) (7795b6f0-883c-4ba3-8192-d5d2b7b7571d)
17:32:38 reviews: Job OK (7795b6f0-883c-4ba3-8192-d5d2b7b7571d)
17:32:38 Result is kept for 500 seconds
17:32:38 
17:32:38 *** Listening on chapters, profiles, reviews...
17:32:38 reviews: fanfic.jobs.crawl_reviews(11215426) (8cdbd234-1ac4-440c-8111-73f84135a644)
17:35:01 reviews: Job OK (8cdbd234-1ac4-440c-8111-73f84135a644)
17:35:01 Result is kept for 500 seconds
17:35:01 
17:35:01 *** Listening on chapters, profiles, reviews...
17:35:01 reviews: fanfic.jobs.crawl_reviews(11216024) (6025457c-d1ac-4767-bf38-081a4d07d028)
17:35:14 reviews: Job OK (6025457c-d1ac-4767-bf38-081a4d07d028)
17:35:14 Result is kept for 500 seconds
17:35:14 
17:35:14 *** Listening on chapters, profiles, reviews...
17:35:14 reviews: fanfic.jobs.crawl_reviews(11216272) (1f1aa6df-f566-4b32-8b50-1f1ef3447d74)
2017-02-08 17:35:18 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 01:35:18.420608', 11216272, 226982984, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (651 characters truncated) ... ZING. THE PLOT LINE OMG. I CANT BELIEVE THIS DOES NOT GET HUNDREDS OF REVIEWS. IM FANGIRLING SO MUCH I CANT GIVE A PROPER SENTENCE.</div></td>\n</tr>'), ('2017-02-09 01:35:18.420613', 11216272, 226676697, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=976025&amp;rw ... (933 characters truncated) ... 07">9/18/2015</span> </small><div style="margin-top:5px">It was NOT \'SO CRAP\'! I just felt like that was very necessary to say :D</div></td>\n</tr>'), ('2017-02-09 01:35:18.420615', 11216272, 226676558, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=976025&amp;rw ... (903 characters truncated) ...  . <span data-xutime="1442636242">9/18/2015</span> </small><div style="margin-top:5px">This is very very interesting! Loving it! :D</div></td>\n</tr>'), ('2017-02-09 01:35:18.420617', 11216272, 222851310, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5488242&amp;r ... (894 characters truncated) ... olor:gray">chapter 10 . <span data-xutime="1435998320">7/4/2015</span> </small><div style="margin-top:5px">:0 I did not expect that</div></td>\n</tr>'), ('2017-02-09 01:35:18.420619', 11216272, 222471625, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5488242&amp;r ... (891 characters truncated) ... ="color:gray">chapter 9 . <span data-xutime="1435388531">6/27/2015</span> </small><div style="margin-top:5px">Favourite chapter yet</div></td>\n</tr>'), ('2017-02-09 01:35:18.420621', 11216272, 220111997, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5488242&amp;r ... (997 characters truncated) ... px">DON DON DON DON! But seriously... the character development... the writing... it was all amazing! THIS WAS A BRILLIANT CHAPTER!</div></td>\n</tr>'), ('2017-02-09 01:35:18.420623', 11216272, 219868754, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5488242&amp;r ... (1243 characters truncated) ... at she\'s human.<br>\nSecondly, Athelinda\'s not a problem compared to her brother. HE is practically the definition of a Gary Stu!</div></td>\n</tr>'), ('2017-02-09 01:35:18.420625', 11216272, 226982984, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (651 characters truncated) ... ZING. THE PLOT LINE OMG. I CANT BELIEVE THIS DOES NOT GET HUNDREDS OF REVIEWS. IM FANGIRLING SO MUCH I CANT GIVE A PROPER SENTENCE.</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-09 01:35:18.420634', 11216272, 220111997, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5488242&amp;r ... (997 characters truncated) ... px">DON DON DON DON! But seriously... the character development... the writing... it was all amazing! THIS WAS A BRILLIANT CHAPTER!</div></td>\n</tr>'), ('2017-02-09 01:35:18.420636', 11216272, 219868754, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5488242&amp;r ... (1243 characters truncated) ... at she\'s human.<br>\nSecondly, Athelinda\'s not a problem compared to her brother. HE is practically the definition of a Gary Stu!</div></td>\n</tr>'))]
17:35:18 reviews: Job OK (1f1aa6df-f566-4b32-8b50-1f1ef3447d74)
17:35:18 Result is kept for 500 seconds
17:35:18 
17:35:18 *** Listening on chapters, profiles, reviews...
17:35:18 reviews: fanfic.jobs.crawl_reviews(11216983) (ab1a6965-abad-452d-811b-6324dd767216)
17:35:55 reviews: Job OK (ab1a6965-abad-452d-811b-6324dd767216)
17:35:55 Result is kept for 500 seconds
17:35:55 
17:35:55 *** Listening on chapters, profiles, reviews...
17:35:55 reviews: fanfic.jobs.crawl_reviews(11219090) (bf774253-82d1-4d63-88ae-cc18c82f1132)
17:36:04 reviews: Job OK (bf774253-82d1-4d63-88ae-cc18c82f1132)
17:36:04 Result is kept for 500 seconds
17:36:04 
17:36:04 *** Listening on chapters, profiles, reviews...
17:36:04 reviews: fanfic.jobs.crawl_reviews(11221471) (65061e9e-e835-4b65-8c1e-b657772ee4f3)
17:36:54 reviews: Job OK (65061e9e-e835-4b65-8c1e-b657772ee4f3)
17:36:54 Result is kept for 500 seconds
17:36:54 
17:36:54 *** Listening on chapters, profiles, reviews...
17:36:54 reviews: fanfic.jobs.crawl_reviews(11222428) (16a6bafe-7e90-47dd-a9ed-bcc5ec03ae01)
17:37:17 reviews: Job OK (16a6bafe-7e90-47dd-a9ed-bcc5ec03ae01)
17:37:17 Result is kept for 500 seconds
17:37:17 
17:37:17 *** Listening on chapters, profiles, reviews...
17:37:17 reviews: fanfic.jobs.crawl_reviews(11223227) (9c42bf98-78e5-4532-a406-c97fd647da83)
2017-02-08 17:37:19 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/11223227/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
17:37:19 reviews: Job OK (9c42bf98-78e5-4532-a406-c97fd647da83)
17:37:19 Result is kept for 500 seconds
17:37:19 
17:37:19 *** Listening on chapters, profiles, reviews...
17:37:19 reviews: fanfic.jobs.crawl_reviews(11223409) (d2821687-e458-48f3-85d0-0e20f90279fe)
2017-02-08 17:37:24 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 01:37:24.229344', 11223409, 233440223, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (553 characters truncated) ...  <span data-xutime="1456121487">2/21/2016</span> </small><div style="margin-top:5px">A FERRET?! Just like malfoy and moody. LOL hah</div></td>\n</tr>'), ('2017-02-09 01:37:24.229348', 11223409, 231641480, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3923802&amp;r ... (977 characters truncated) ... gin-top:5px">Absolutely loved this story. It is my number one favorite. You are such a good writer and I hope to read many more. :)</div></td>\n</tr>'), ('2017-02-09 01:37:24.229351', 11223409, 231046982, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1234710&amp;r ... (1291 characters truncated) ... e often gets described. I like drunken Remus. I only hope you can add a bit more excitement, so that I\'m not able to stop reading.</div></td>\n</tr>'), ('2017-02-09 01:37:24.229352', 11223409, 230921047, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (582 characters truncated) ... 27/2015</span> </small><div style="margin-top:5px">Such a great story! I hope you keep on writing :) I look forward to reading more</div></td>\n</tr>'), ('2017-02-09 01:37:24.229354', 11223409, 230787344, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (556 characters truncated) ... a-xutime="1451004518">12/24/2015</span> </small><div style="margin-top:5px">I\'ve only read a bit of this show far but it is great!</div></td>\n</tr>'), ('2017-02-09 01:37:24.229356', 11223409, 226734133, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6346481&amp;r ... (812 characters truncated) ... er 17 . <span data-xutime="1442755428">9/20/2015</span> </small><div style="margin-top:5px">I am really enjoying this story so far!</div></td>\n</tr>'), ('2017-02-09 01:37:24.229358', 11223409, 225212552, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (857 characters truncated) ... to keep forever. But if that\'s not the direction you\'re going in then I\'ll be excited either way! Keep doing what you\'re doing!</div></td>\n</tr>'), ('2017-02-09 01:37:24.229360', 11223409, 222934139, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (744 characters truncated) ...  she complete is disrespectful of James. The way he\'s a complete wimp and just takes it is disgusting and so not like canon James.</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-09 01:37:24.229392', 11223409, 220079727, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3117479&amp;r ... (865 characters truncated) ... ll style="color:gray">chapter 4 . <span data-xutime="1431385774">5/11/2015</span> </small><div style="margin-top:5px">Great chapter</div></td>\n</tr>'), ('2017-02-09 01:37:24.229394', 11223409, 219681282, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3083859&amp;r ... (1197 characters truncated) ... he story (I\'m just a bit pedantic sometimes). Anyway, as I say a really great start and hope to see more soon- it was really good!</div></td>\n</tr>'))]
17:37:24 reviews: Job OK (d2821687-e458-48f3-85d0-0e20f90279fe)
17:37:24 Result is kept for 500 seconds
17:37:24 
17:37:24 *** Listening on chapters, profiles, reviews...
17:37:24 reviews: fanfic.jobs.crawl_reviews(11223914) (efe051dc-6cc4-4e64-b61a-da318517137d)
17:38:13 reviews: Job OK (efe051dc-6cc4-4e64-b61a-da318517137d)
17:38:13 Result is kept for 500 seconds
17:38:13 
17:38:13 *** Listening on chapters, profiles, reviews...
17:38:13 reviews: fanfic.jobs.crawl_reviews(11223957) (054b9a3f-3a32-426c-a478-3e523601838a)
17:38:41 reviews: Job OK (054b9a3f-3a32-426c-a478-3e523601838a)
17:38:41 Result is kept for 500 seconds
17:38:41 
17:38:41 *** Listening on chapters, profiles, reviews...
17:38:41 reviews: fanfic.jobs.crawl_reviews(11224974) (90f7a0f6-067d-4671-b8f0-c94aba829779)
17:38:53 reviews: Job OK (90f7a0f6-067d-4671-b8f0-c94aba829779)
17:38:53 Result is kept for 500 seconds
17:38:53 
17:38:53 *** Listening on chapters, profiles, reviews...
17:38:53 reviews: fanfic.jobs.crawl_reviews(11225681) (b0b7e5ff-4880-4499-a64c-5a9c7b496155)
2017-02-08 17:38:56 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 01:38:56.945937', 11225681, 232762400, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (668 characters truncated) ... ave invested my heart and soul into Draco and Jess. Send help. Not to mention the plot, the writing. Dear lord someone help me. ;_;</div></td>\n</tr>'), ('2017-02-09 01:38:56.945942', 11225681, 232383869, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3582143&amp;r ... (951 characters truncated) ... 0">1/28/2016</span> </small><div style="margin-top:5px">LOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOVE your stuff</div></td>\n</tr>'), ('2017-02-09 01:38:56.945944', 11225681, 226320275, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1001 characters truncated) ... >\nSeriously though, please do keep up this awesome read. So much action, and even more feels! <br>\n<br>\n-You know my "name" now.</div></td>\n</tr>'), ('2017-02-09 01:38:56.945946', 11225681, 223640291, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (11353 characters truncated) ... ammit that damn elena graham <br>\n<br>\nthey need to stop arguing :( THEY\'RE STRONGER IF THEY\'RE UNITED AND NOT DRIFTING APART D</div></td>\n</tr>'), ('2017-02-09 01:38:56.945948', 11225681, 223205946, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6261890&amp;r ... (1074 characters truncated) ...  Flint, like personally? and that he\'ll make Draco get into trouble so he gets into Dumbles office and Imperio him. just a thought</div></td>\n</tr>'), ('2017-02-09 01:38:56.945950', 11225681, 220568641, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (8338 characters truncated) ... AAAAAAAAAAAARE YOU! horrid writer... whom i love and admire very much. Really good chapter 2F2L, please update soon? I cannot wait!</div></td>\n</tr>'), ('2017-02-09 01:38:56.945952', 11225681, 220198798, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (3548 characters truncated) ... WAS DOING IT FOR REAAAAL <br>\n<br>\nUPDATE<br>\n<br>\nNOW<br>\nPLEASE! omg i can\'teven.. omg.. I LOVE YOU THIS STORY IS TOO GOOD!</div></td>\n</tr>'), ('2017-02-09 01:38:56.945954', 11225681, 220175606, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1825 characters truncated) ... n<br>\ntake a guess? i like her hahahha<br>\n<br>\nand HARRY, HERMIONE AND RON DON\'TKNOW ABOUT THE MANSION? BUT BUT BUT... shit...</div></td>\n</tr>')  ... displaying 10 of 18 total bound parameter sets ...  ('2017-02-09 01:38:56.945971', 11225681, 220175606, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1825 characters truncated) ... n<br>\ntake a guess? i like her hahahha<br>\n<br>\nand HARRY, HERMIONE AND RON DON\'TKNOW ABOUT THE MANSION? BUT BUT BUT... shit...</div></td>\n</tr>'), ('2017-02-09 01:38:56.945972', 11225681, 220171399, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3870251&amp;r ... (1451 characters truncated) ... ção de todos!<br>\n<br>\nEnfim, TOOONKS 3 Faltou um momento romance com o Remus :X E eu também adoro ela, aliás! Ela é incrível *-*</div></td>\n</tr>'))]
17:38:56 reviews: Job OK (b0b7e5ff-4880-4499-a64c-5a9c7b496155)
17:38:56 Result is kept for 500 seconds
17:38:56 
17:38:56 *** Listening on chapters, profiles, reviews...
17:38:56 reviews: fanfic.jobs.crawl_reviews(11226923) (63c31c10-e6bd-469b-9733-6698e8da47ff)
17:39:17 reviews: Job OK (63c31c10-e6bd-469b-9733-6698e8da47ff)
17:39:17 Result is kept for 500 seconds
17:39:17 
17:39:17 *** Listening on chapters, profiles, reviews...
17:39:17 reviews: fanfic.jobs.crawl_reviews(11227868) (763c9f76-b1db-45a0-9bb5-7fef354deb43)
17:40:16 reviews: Job OK (763c9f76-b1db-45a0-9bb5-7fef354deb43)
17:40:16 Result is kept for 500 seconds
17:40:16 
17:40:16 *** Listening on chapters, profiles, reviews...
17:40:16 reviews: fanfic.jobs.crawl_reviews(11228810) (6b7cae0b-dc98-49c9-bd30-8ee62cf6a0dd)
2017-02-08 17:40:22 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 01:40:22.574387', 11228810, 220577606, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (2033 characters truncated) ... and tinker a bit with original storyline? That would definitly make it more interesting :P<br>\n<br>\nKeep up good work, I love it!</div></td>\n</tr>'), ('2017-02-09 01:40:22.574391', 11228810, 220545011, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (907 characters truncated) ... r 20 . <span data-xutime="1432188440">5/20/2015</span> </small><div style="margin-top:5px">Yayyy! Let me know when next story is up</div></td>\n</tr>'), ('2017-02-09 01:40:22.574393', 11228810, 220493136, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5623263&amp;r ... (885 characters truncated) ... v style="margin-top:5px">another year gone. great story. looking forward to the next one. and seriously you should do Jaime/Ariana.</div></td>\n</tr>'), ('2017-02-09 01:40:22.574395', 11228810, 220492128, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (881 characters truncated) ...  style="color:gray">chapter 19 . <span data-xutime="1432094174">5/19/2015</span> </small><div style="margin-top:5px">Great chapter!</div></td>\n</tr>'), ('2017-02-09 01:40:22.574397', 11228810, 220394507, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (923 characters truncated) ... a-xutime="1431929602">5/17/2015</span> </small><div style="margin-top:5px">Great story! They sound catch Pettigrew and free Sirius!</div></td>\n</tr>'), ('2017-02-09 01:40:22.574399', 11228810, 220263546, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5623263&amp;r ... (791 characters truncated) ... ll style="color:gray">chapter 13 . <span data-xutime="1431716939">5/15/2015</span> </small><div style="margin-top:5px">good chapter</div></td>\n</tr>'), ('2017-02-09 01:40:22.574401', 11228810, 220065848, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5623263&amp;r ... (796 characters truncated) ... yle="color:gray">chapter 10 . <span data-xutime="1431364972">5/11/2015</span> </small><div style="margin-top:5px">lol great chapter</div></td>\n</tr>'), ('2017-02-09 01:40:22.574403', 11228810, 219980542, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5623263&amp;r ... (824 characters truncated) ...  <span data-xutime="1431218115">5/9/2015</span> </small><div style="margin-top:5px">great chapter. I like the Jamie/Ariana moments.</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-09 01:40:22.574434', 11228810, 219870077, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5623263&amp;r ... (790 characters truncated) ... all style="color:gray">chapter 4 . <span data-xutime="1431017614">5/7/2015</span> </small><div style="margin-top:5px">great chapter</div></td>\n</tr>'), ('2017-02-09 01:40:22.574436', 11228810, 219827602, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5623263&amp;r ... (810 characters truncated) ... y">chapter 3 . <span data-xutime="1430941321">5/6/2015</span> </small><div style="margin-top:5px">so is this going to be Harry/OC ?</div></td>\n</tr>'))]
17:40:22 reviews: Job OK (6b7cae0b-dc98-49c9-bd30-8ee62cf6a0dd)
17:40:22 Result is kept for 500 seconds
17:40:22 
17:40:22 *** Listening on chapters, profiles, reviews...
17:40:22 reviews: fanfic.jobs.crawl_reviews(11230048) (d7705947-616f-4f38-907b-c69a21373a6d)
17:41:07 reviews: Job OK (d7705947-616f-4f38-907b-c69a21373a6d)
17:41:07 Result is kept for 500 seconds
17:41:07 
17:41:07 *** Listening on chapters, profiles, reviews...
17:41:07 reviews: fanfic.jobs.crawl_reviews(11232278) (ace43fb1-346d-43b1-ba6f-4a2295be2e12)
17:41:41 reviews: Job OK (ace43fb1-346d-43b1-ba6f-4a2295be2e12)
17:41:41 Result is kept for 500 seconds
17:41:41 
17:41:41 *** Listening on chapters, profiles, reviews...
17:41:41 reviews: fanfic.jobs.crawl_reviews(11233889) (15b4f5ab-bae4-4df2-b792-977e398dc362)
17:42:54 reviews: Job OK (15b4f5ab-bae4-4df2-b792-977e398dc362)
17:42:54 Result is kept for 500 seconds
17:42:54 
17:42:54 *** Listening on chapters, profiles, reviews...
17:42:54 reviews: fanfic.jobs.crawl_reviews(11233892) (e523c07a-fa1a-4a49-8232-6db046e70ccf)
17:43:04 reviews: Job OK (e523c07a-fa1a-4a49-8232-6db046e70ccf)
17:43:04 Result is kept for 500 seconds
17:43:04 
17:43:04 *** Listening on chapters, profiles, reviews...
17:43:04 reviews: fanfic.jobs.crawl_reviews(11236598) (60fa18f9-8e14-403f-8dd6-ad0adb4a3975)
17:43:33 reviews: Job OK (60fa18f9-8e14-403f-8dd6-ad0adb4a3975)
17:43:33 Result is kept for 500 seconds
17:43:33 
17:43:33 *** Listening on chapters, profiles, reviews...
17:43:33 reviews: fanfic.jobs.crawl_reviews(11236976) (09617b4f-9ecb-4961-9001-36db0f805312)
17:45:02 reviews: Job OK (09617b4f-9ecb-4961-9001-36db0f805312)
17:45:02 Result is kept for 500 seconds
17:45:02 
17:45:02 *** Listening on chapters, profiles, reviews...
17:45:02 reviews: fanfic.jobs.crawl_reviews(11237293) (47a628b9-cadf-4425-a91d-f523c89b0852)
17:45:18 reviews: Job OK (47a628b9-cadf-4425-a91d-f523c89b0852)
17:45:18 Result is kept for 500 seconds
17:45:18 
17:45:18 *** Listening on chapters, profiles, reviews...
17:45:18 reviews: fanfic.jobs.crawl_reviews(11237394) (0106c388-d059-43a8-b5b6-68ce528be853)
17:48:41 reviews: Job OK (0106c388-d059-43a8-b5b6-68ce528be853)
17:48:41 Result is kept for 500 seconds
17:48:41 
17:48:41 *** Listening on chapters, profiles, reviews...
17:48:41 reviews: fanfic.jobs.crawl_reviews(11237661) (e94a2f20-ddab-48fa-b537-2171bbfe8e3f)
17:48:51 reviews: Job OK (e94a2f20-ddab-48fa-b537-2171bbfe8e3f)
17:48:51 Result is kept for 500 seconds
17:48:51 
17:48:51 *** Listening on chapters, profiles, reviews...
17:48:51 reviews: fanfic.jobs.crawl_reviews(11238938) (a288ef28-e690-4e4d-aad9-d9c71b76f76e)
17:49:12 reviews: Job OK (a288ef28-e690-4e4d-aad9-d9c71b76f76e)
17:49:12 Result is kept for 500 seconds
17:49:12 
17:49:12 *** Listening on chapters, profiles, reviews...
17:49:12 reviews: fanfic.jobs.crawl_reviews(11239029) (7f73a57f-161b-4b88-9e10-72f0cf1422bf)
17:49:22 reviews: Job OK (7f73a57f-161b-4b88-9e10-72f0cf1422bf)
17:49:22 Result is kept for 500 seconds
17:49:22 
17:49:22 *** Listening on chapters, profiles, reviews...
17:49:22 reviews: fanfic.jobs.crawl_reviews(11239854) (6e7948b6-24ea-49c5-ab4e-97a655d62e3b)
17:49:35 reviews: Job OK (6e7948b6-24ea-49c5-ab4e-97a655d62e3b)
17:49:35 Result is kept for 500 seconds
17:49:35 
17:49:35 *** Listening on chapters, profiles, reviews...
17:49:35 reviews: fanfic.jobs.crawl_reviews(11240489) (c610777d-0b2b-49f7-98c6-90e4cbfad9af)
17:52:05 reviews: Job OK (c610777d-0b2b-49f7-98c6-90e4cbfad9af)
17:52:05 Result is kept for 500 seconds
17:52:05 
17:52:05 *** Listening on chapters, profiles, reviews...
17:52:05 reviews: fanfic.jobs.crawl_reviews(11240579) (f1d2a8cb-8b3a-4753-9373-2afb1deba58b)
17:52:15 reviews: Job OK (f1d2a8cb-8b3a-4753-9373-2afb1deba58b)
17:52:15 Result is kept for 500 seconds
17:52:15 
17:52:15 *** Listening on chapters, profiles, reviews...
17:52:15 reviews: fanfic.jobs.crawl_reviews(11241902) (28c19a96-225d-491a-860b-99bad392f367)
17:54:41 reviews: Job OK (28c19a96-225d-491a-860b-99bad392f367)
17:54:41 Result is kept for 500 seconds
17:54:41 
17:54:41 *** Listening on chapters, profiles, reviews...
17:54:41 reviews: fanfic.jobs.crawl_reviews(11242045) (c54aa703-a60c-4337-8530-d37c8ad32fcc)
17:55:37 reviews: Job OK (c54aa703-a60c-4337-8530-d37c8ad32fcc)
17:55:37 Result is kept for 500 seconds
17:55:37 
17:55:37 *** Listening on chapters, profiles, reviews...
17:55:37 reviews: fanfic.jobs.crawl_reviews(11242729) (3307a851-640c-4516-8aac-6d0a5bbb9804)
2017-02-08 17:55:38 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/11242729/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
17:55:38 reviews: Job OK (3307a851-640c-4516-8aac-6d0a5bbb9804)
17:55:38 Result is kept for 500 seconds
17:55:38 
17:55:38 *** Listening on chapters, profiles, reviews...
17:55:38 reviews: fanfic.jobs.crawl_reviews(11243441) (0bbea7f4-b8cf-4459-8b05-55d4d4f944e8)
17:56:47 reviews: Job OK (0bbea7f4-b8cf-4459-8b05-55d4d4f944e8)
17:56:47 Result is kept for 500 seconds
17:56:47 
17:56:47 *** Listening on chapters, profiles, reviews...
17:56:47 reviews: fanfic.jobs.crawl_reviews(11244519) (f9c05e21-58f0-4a7e-b977-8e1f020590d5)
17:58:01 reviews: Job OK (f9c05e21-58f0-4a7e-b977-8e1f020590d5)
17:58:01 Result is kept for 500 seconds
17:58:01 
17:58:01 *** Listening on chapters, profiles, reviews...
17:58:01 reviews: fanfic.jobs.crawl_reviews(11244975) (342c3e50-4df1-4e70-b8e3-3a47b6890c2c)
17:59:28 reviews: Job OK (342c3e50-4df1-4e70-b8e3-3a47b6890c2c)
17:59:28 Result is kept for 500 seconds
17:59:28 
17:59:28 *** Listening on chapters, profiles, reviews...
17:59:28 reviews: fanfic.jobs.crawl_reviews(11246382) (c5da63e9-ab92-419b-a2e6-830893b13d4b)
17:59:56 reviews: Job OK (c5da63e9-ab92-419b-a2e6-830893b13d4b)
17:59:56 Result is kept for 500 seconds
17:59:56 
17:59:56 *** Listening on chapters, profiles, reviews...
17:59:56 reviews: fanfic.jobs.crawl_reviews(11247432) (ed09db09-94d9-4f71-8622-6c1a12c6af61)
18:00:35 reviews: Job OK (ed09db09-94d9-4f71-8622-6c1a12c6af61)
18:00:35 Result is kept for 500 seconds
18:00:35 
18:00:35 *** Listening on chapters, profiles, reviews...
18:00:35 reviews: fanfic.jobs.crawl_reviews(11247748) (7ebbd00a-f8a6-45e2-ab44-2f41242593c4)
18:03:24 reviews: Job OK (7ebbd00a-f8a6-45e2-ab44-2f41242593c4)
18:03:24 Result is kept for 500 seconds
18:03:24 Cleaning registries for queue: chapters
18:03:24 Cleaning registries for queue: profiles
18:03:24 Cleaning registries for queue: reviews
18:03:24 
18:03:24 *** Listening on chapters, profiles, reviews...
18:03:24 reviews: fanfic.jobs.crawl_reviews(11248015) (2331a2c5-6889-4d03-b49d-aecd67576da6)
18:26:33 reviews: Job OK (2331a2c5-6889-4d03-b49d-aecd67576da6)
18:26:33 Result is kept for 500 seconds
18:26:33 
18:26:33 *** Listening on chapters, profiles, reviews...
18:26:33 reviews: fanfic.jobs.crawl_reviews(11251021) (b898f5a5-4909-4807-af7f-d336da946b46)
18:26:38 reviews: Job OK (b898f5a5-4909-4807-af7f-d336da946b46)
18:26:38 Result is kept for 500 seconds
18:26:38 
18:26:38 *** Listening on chapters, profiles, reviews...
18:26:38 reviews: fanfic.jobs.crawl_reviews(11251490) (488038a6-c9c5-4c77-bb88-26d06ebd0d09)
18:27:13 reviews: Job OK (488038a6-c9c5-4c77-bb88-26d06ebd0d09)
18:27:13 Result is kept for 500 seconds
18:27:13 
18:27:13 *** Listening on chapters, profiles, reviews...
18:27:13 reviews: fanfic.jobs.crawl_reviews(11251745) (147ee978-bf20-4785-88de-9089958b6e05)
18:31:28 reviews: Job OK (147ee978-bf20-4785-88de-9089958b6e05)
18:31:28 Result is kept for 500 seconds
18:31:28 
18:31:28 *** Listening on chapters, profiles, reviews...
18:31:28 reviews: fanfic.jobs.crawl_reviews(11253734) (4fdd80ce-56fe-4897-8e8e-87d2c56e6697)
18:31:57 reviews: Job OK (4fdd80ce-56fe-4897-8e8e-87d2c56e6697)
18:31:57 Result is kept for 500 seconds
18:31:58 
18:31:58 *** Listening on chapters, profiles, reviews...
18:31:58 reviews: fanfic.jobs.crawl_reviews(11254763) (514c9ed8-1255-46e4-891d-ff5ed7b6941c)
18:36:46 reviews: Job OK (514c9ed8-1255-46e4-891d-ff5ed7b6941c)
18:36:46 Result is kept for 500 seconds
18:36:46 
18:36:46 *** Listening on chapters, profiles, reviews...
18:36:46 reviews: fanfic.jobs.crawl_reviews(11255157) (a90f21d0-1808-477f-83f7-cde939b81381)
18:36:54 reviews: Job OK (a90f21d0-1808-477f-83f7-cde939b81381)
18:36:54 Result is kept for 500 seconds
18:36:54 
18:36:54 *** Listening on chapters, profiles, reviews...
18:36:54 reviews: fanfic.jobs.crawl_reviews(11256945) (c833f07e-cb7e-41f5-be84-c16c2524bce5)
18:37:03 reviews: Job OK (c833f07e-cb7e-41f5-be84-c16c2524bce5)
18:37:03 Result is kept for 500 seconds
18:37:03 
18:37:03 *** Listening on chapters, profiles, reviews...
18:37:03 reviews: fanfic.jobs.crawl_reviews(11257016) (947a166c-4e6d-45a5-97ba-e1f10d2c2ccc)
18:37:17 reviews: Job OK (947a166c-4e6d-45a5-97ba-e1f10d2c2ccc)
18:37:17 Result is kept for 500 seconds
18:37:17 
18:37:17 *** Listening on chapters, profiles, reviews...
18:37:17 reviews: fanfic.jobs.crawl_reviews(11257719) (5a7e3db2-632a-47ba-b337-62f79933cc24)
18:38:15 reviews: Job OK (5a7e3db2-632a-47ba-b337-62f79933cc24)
18:38:15 Result is kept for 500 seconds
18:38:15 
18:38:15 *** Listening on chapters, profiles, reviews...
18:38:15 reviews: fanfic.jobs.crawl_reviews(11257753) (fd4be7e0-5f5f-49a1-be93-819afa773f1e)
18:40:53 reviews: Job OK (fd4be7e0-5f5f-49a1-be93-819afa773f1e)
18:40:53 Result is kept for 500 seconds
18:40:53 
18:40:53 *** Listening on chapters, profiles, reviews...
18:40:53 reviews: fanfic.jobs.crawl_reviews(11257997) (1aa0b581-f130-4d74-af09-535c6e90dff5)
18:41:00 reviews: Job OK (1aa0b581-f130-4d74-af09-535c6e90dff5)
18:41:00 Result is kept for 500 seconds
18:41:00 
18:41:00 *** Listening on chapters, profiles, reviews...
18:41:00 reviews: fanfic.jobs.crawl_reviews(11258150) (646a2924-d813-4e1d-ad83-b16ceb61dcbb)
18:41:06 reviews: Job OK (646a2924-d813-4e1d-ad83-b16ceb61dcbb)
18:41:06 Result is kept for 500 seconds
18:41:06 
18:41:06 *** Listening on chapters, profiles, reviews...
18:41:06 reviews: fanfic.jobs.crawl_reviews(11258318) (faea958f-1708-4bcf-9542-0500ebe21712)
18:41:16 reviews: Job OK (faea958f-1708-4bcf-9542-0500ebe21712)
18:41:16 Result is kept for 500 seconds
18:41:16 
18:41:16 *** Listening on chapters, profiles, reviews...
18:41:16 reviews: fanfic.jobs.crawl_reviews(11259276) (6ab99322-194b-4902-813c-289c6de3455d)
18:42:45 reviews: Job OK (6ab99322-194b-4902-813c-289c6de3455d)
18:42:45 Result is kept for 500 seconds
18:42:45 
18:42:45 *** Listening on chapters, profiles, reviews...
18:42:45 reviews: fanfic.jobs.crawl_reviews(11259389) (7b902dbb-5b81-4284-a964-d7b81d39305c)
18:42:50 reviews: Job OK (7b902dbb-5b81-4284-a964-d7b81d39305c)
18:42:50 Result is kept for 500 seconds
18:42:50 
18:42:50 *** Listening on chapters, profiles, reviews...
18:42:50 reviews: fanfic.jobs.crawl_reviews(11260631) (a773f52f-bf35-42a1-b208-e447aa849b40)
18:43:40 reviews: Job OK (a773f52f-bf35-42a1-b208-e447aa849b40)
18:43:40 Result is kept for 500 seconds
18:43:40 
18:43:40 *** Listening on chapters, profiles, reviews...
18:43:40 reviews: fanfic.jobs.crawl_reviews(11261696) (2c6e49e2-278b-45ae-a9f9-f1bdd4f3d8db)
18:43:56 reviews: Job OK (2c6e49e2-278b-45ae-a9f9-f1bdd4f3d8db)
18:43:56 Result is kept for 500 seconds
18:43:56 
18:43:56 *** Listening on chapters, profiles, reviews...
18:43:56 reviews: fanfic.jobs.crawl_reviews(11261750) (5f9012d5-97ac-4d87-b123-6b62e329e8c0)
18:59:15 reviews: Job OK (5f9012d5-97ac-4d87-b123-6b62e329e8c0)
18:59:15 Result is kept for 500 seconds
18:59:15 
18:59:15 *** Listening on chapters, profiles, reviews...
18:59:15 reviews: fanfic.jobs.crawl_reviews(11262352) (bd3783da-71a9-4ff8-83a6-69ebf775243d)
19:00:06 reviews: Job OK (bd3783da-71a9-4ff8-83a6-69ebf775243d)
19:00:06 Result is kept for 500 seconds
19:00:06 
19:00:06 *** Listening on chapters, profiles, reviews...
19:00:06 reviews: fanfic.jobs.crawl_reviews(11262681) (1eeac793-5811-4d03-a7f7-000a04d09cdf)
2017-02-08 19:00:11 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 03:00:11.637937', 11262681, 228015462, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6103427&amp;r ... (920 characters truncated) ... an> </small><div style="margin-top:5px">Update plz im in a phase of loving every thing Harry potter and I want to continue reading.</div></td>\n</tr>'), ('2017-02-09 03:00:11.637941', 11262681, 224811859, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1924519&amp;r ... (1172 characters truncated) ...  <br>\nMostly lots of hidden crushes going round, which is fun to read about ;) <br>\nI hope you\'re still working on the story! :)</div></td>\n</tr>'), ('2017-02-09 03:00:11.637944', 11262681, 223255714, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6754045&amp;r ... (1019 characters truncated) ... the Dominique and Eli stuff going on. very excited for that to later develope. and the Alice and James was a delightful suprise. :)</div></td>\n</tr>'), ('2017-02-09 03:00:11.637946', 11262681, 223235481, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (588 characters truncated) ... an> </small><div style="margin-top:5px">I\'ve always liked the idea of Aloce and James. I hope there is a part two to this chapter!</div></td>\n</tr>'), ('2017-02-09 03:00:11.637947', 11262681, 222213047, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (726 characters truncated) ... rs give them all their own little stories but I hope they\'ll come together at some point and do things together. Pls keep updating</div></td>\n</tr>'), ('2017-02-09 03:00:11.637949', 11262681, 221095494, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6754045&amp;r ... (1006 characters truncated) ...  and Eli, it\'s cool how\'s she likes to be diffrent and all. But I think Eli will break down her walls. Can\'t wait for the update</div></td>\n</tr>'), ('2017-02-09 03:00:11.637951', 11262681, 228015462, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6103427&amp;r ... (920 characters truncated) ... an> </small><div style="margin-top:5px">Update plz im in a phase of loving every thing Harry potter and I want to continue reading.</div></td>\n</tr>'), ('2017-02-09 03:00:11.637953', 11262681, 224811859, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1924519&amp;r ... (1172 characters truncated) ...  <br>\nMostly lots of hidden crushes going round, which is fun to read about ;) <br>\nI hope you\'re still working on the story! :)</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-09 03:00:11.637959', 11262681, 222213047, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (726 characters truncated) ... rs give them all their own little stories but I hope they\'ll come together at some point and do things together. Pls keep updating</div></td>\n</tr>'), ('2017-02-09 03:00:11.637961', 11262681, 221095494, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6754045&amp;r ... (1006 characters truncated) ...  and Eli, it\'s cool how\'s she likes to be diffrent and all. But I think Eli will break down her walls. Can\'t wait for the update</div></td>\n</tr>'))]
19:00:11 reviews: Job OK (1eeac793-5811-4d03-a7f7-000a04d09cdf)
19:00:11 Result is kept for 500 seconds
19:00:11 
19:00:11 *** Listening on chapters, profiles, reviews...
19:00:11 reviews: fanfic.jobs.crawl_reviews(11262791) (38a54164-b72d-4a3b-bd34-a46aa13f66f6)
19:00:17 reviews: Job OK (38a54164-b72d-4a3b-bd34-a46aa13f66f6)
19:00:17 Result is kept for 500 seconds
19:00:17 
19:00:17 *** Listening on chapters, profiles, reviews...
19:00:17 reviews: fanfic.jobs.crawl_reviews(11262848) (e0753c26-e70b-4141-a1b6-9111e2bbaec8)
19:00:33 reviews: Job OK (e0753c26-e70b-4141-a1b6-9111e2bbaec8)
19:00:33 Result is kept for 500 seconds
19:00:33 
19:00:33 *** Listening on chapters, profiles, reviews...
19:00:33 reviews: fanfic.jobs.crawl_reviews(11263775) (4352fbb3-1a65-4f31-916c-0fd45155f6b5)
19:01:23 reviews: Job OK (4352fbb3-1a65-4f31-916c-0fd45155f6b5)
19:01:23 Result is kept for 500 seconds
19:01:23 
19:01:23 *** Listening on chapters, profiles, reviews...
19:01:23 reviews: fanfic.jobs.crawl_reviews(11264162) (d8ce1836-dee5-4c2a-9e71-3b2e651c789c)
19:02:31 reviews: Job OK (d8ce1836-dee5-4c2a-9e71-3b2e651c789c)
19:02:31 Result is kept for 500 seconds
19:02:31 
19:02:31 *** Listening on chapters, profiles, reviews...
19:02:31 reviews: fanfic.jobs.crawl_reviews(11264331) (7ae4d15b-0cd0-4518-b1c2-4a6ff0c3a1a6)
19:04:26 reviews: Job OK (7ae4d15b-0cd0-4518-b1c2-4a6ff0c3a1a6)
19:04:26 Result is kept for 500 seconds
19:04:26 Cleaning registries for queue: chapters
19:04:26 Cleaning registries for queue: profiles
19:04:26 Cleaning registries for queue: reviews
19:04:26 
19:04:26 *** Listening on chapters, profiles, reviews...
19:04:26 reviews: fanfic.jobs.crawl_reviews(11266166) (fcd137b4-c352-4bfe-ae0f-faa147d180c4)
19:04:53 reviews: Job OK (fcd137b4-c352-4bfe-ae0f-faa147d180c4)
19:04:53 Result is kept for 500 seconds
19:04:53 
19:04:53 *** Listening on chapters, profiles, reviews...
19:04:53 reviews: fanfic.jobs.crawl_reviews(11266220) (e2f6524d-efc7-44ce-9c4e-11072366e6f6)
19:07:29 reviews: Job OK (e2f6524d-efc7-44ce-9c4e-11072366e6f6)
19:07:29 Result is kept for 500 seconds
19:07:29 
19:07:29 *** Listening on chapters, profiles, reviews...
19:07:29 reviews: fanfic.jobs.crawl_reviews(11268360) (cafdace1-6c90-42d7-92e9-a05b94391c47)
19:07:33 reviews: Job OK (cafdace1-6c90-42d7-92e9-a05b94391c47)
19:07:33 Result is kept for 500 seconds
19:07:33 
19:07:33 *** Listening on chapters, profiles, reviews...
19:07:33 reviews: fanfic.jobs.crawl_reviews(11268636) (3b93769e-3504-4cf3-986a-c1e922cbdbfd)
19:08:30 reviews: Job OK (3b93769e-3504-4cf3-986a-c1e922cbdbfd)
19:08:30 Result is kept for 500 seconds
19:08:30 
19:08:30 *** Listening on chapters, profiles, reviews...
19:08:30 reviews: fanfic.jobs.crawl_reviews(11268925) (5a512755-6b57-4687-885e-5ecfe7da6fcc)
19:08:54 reviews: Job OK (5a512755-6b57-4687-885e-5ecfe7da6fcc)
19:08:54 Result is kept for 500 seconds
19:08:54 
19:08:54 *** Listening on chapters, profiles, reviews...
19:08:54 reviews: fanfic.jobs.crawl_reviews(11269078) (4ec0d7bb-eb07-4ba2-b275-b52758b1a4c3)
19:18:21 reviews: Job OK (4ec0d7bb-eb07-4ba2-b275-b52758b1a4c3)
19:18:21 Result is kept for 500 seconds
19:18:21 
19:18:21 *** Listening on chapters, profiles, reviews...
19:18:21 reviews: fanfic.jobs.crawl_reviews(11269604) (786ca535-ee0f-460f-bc3d-8e5d5dcfbbb4)
19:20:49 reviews: Job OK (786ca535-ee0f-460f-bc3d-8e5d5dcfbbb4)
19:20:49 Result is kept for 500 seconds
19:20:49 
19:20:49 *** Listening on chapters, profiles, reviews...
19:20:49 reviews: fanfic.jobs.crawl_reviews(11269724) (53c86625-9a0d-4b21-a43e-b2c93bc0ce8f)
19:21:49 reviews: Job OK (53c86625-9a0d-4b21-a43e-b2c93bc0ce8f)
19:21:49 Result is kept for 500 seconds
19:21:49 
19:21:49 *** Listening on chapters, profiles, reviews...
19:21:49 reviews: fanfic.jobs.crawl_reviews(11271437) (ceca9496-6bfb-4ce3-8ac0-100fef32a734)
19:22:20 reviews: Job OK (ceca9496-6bfb-4ce3-8ac0-100fef32a734)
19:22:20 Result is kept for 500 seconds
19:22:20 
19:22:20 *** Listening on chapters, profiles, reviews...
19:22:20 reviews: fanfic.jobs.crawl_reviews(11271716) (6788d4b3-1b1a-44c8-9a09-7ea0870994c7)
19:24:02 reviews: Job OK (6788d4b3-1b1a-44c8-9a09-7ea0870994c7)
19:24:02 Result is kept for 500 seconds
19:24:02 
19:24:02 *** Listening on chapters, profiles, reviews...
19:24:02 reviews: fanfic.jobs.crawl_reviews(11271762) (f9024c5d-01e4-4de3-a9d8-255c22f3e379)
19:26:35 reviews: Job OK (f9024c5d-01e4-4de3-a9d8-255c22f3e379)
19:26:35 Result is kept for 500 seconds
19:26:35 
19:26:35 *** Listening on chapters, profiles, reviews...
19:26:35 reviews: fanfic.jobs.crawl_reviews(11271839) (48bed853-3d1b-4420-bd35-a495ec978917)
19:27:11 reviews: Job OK (48bed853-3d1b-4420-bd35-a495ec978917)
19:27:11 Result is kept for 500 seconds
19:27:11 
19:27:11 *** Listening on chapters, profiles, reviews...
19:27:11 reviews: fanfic.jobs.crawl_reviews(11272349) (2e8689a3-449d-4d4d-9d63-748ac2c9bcde)
2017-02-08 19:27:16 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 03:27:16.562242', 11272349, 225746970, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (923 characters truncated) ... :gray">chapter 38 . <span data-xutime="1440772687">8/28/2015</span> </small><div style="margin-top:5px">looking forward to the trip</div></td>\n</tr>'), ('2017-02-09 03:27:16.562247', 11272349, 225736533, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1002909&amp;r ... (997 characters truncated) ... demort instead of the Dark Lord. Ron usually hates it when Harry says Voldmort, yet he says it in this story without even a twitch.</div></td>\n</tr>'), ('2017-02-09 03:27:16.562249', 11272349, 225559131, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (916 characters truncated) ... ="color:gray">chapter 36 . <span data-xutime="1440432085">8/24/2015</span> </small><div style="margin-top:5px">Will Fudge be sacked</div></td>\n</tr>'), ('2017-02-09 03:27:16.562251', 11272349, 225005283, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (924 characters truncated) ... gray">chapter 34 . <span data-xutime="1439487337">8/13/2015</span> </small><div style="margin-top:5px">good to see Motherly Minerva</div></td>\n</tr>'), ('2017-02-09 03:27:16.562253', 11272349, 224328157, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (904 characters truncated) ... <small style="color:gray">chapter 30 . <span data-xutime="1438337097">7/31/2015</span> </small><div style="margin-top:5px">ooh jazz</div></td>\n</tr>'), ('2017-02-09 03:27:16.562255', 11272349, 224088903, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=976025&amp;rw ... (1155 characters truncated) ... st whooshing through. I really, really love this! So, so good! You\'re a great writer, now I need to go whoosh to the next chapter.</div></td>\n</tr>'), ('2017-02-09 03:27:16.562257', 11272349, 223580349, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (915 characters truncated) ... e="color:gray">chapter 26 . <span data-xutime="1437159310">7/17/2015</span> </small><div style="margin-top:5px">wow depressed harry</div></td>\n</tr>'), ('2017-02-09 03:27:16.562258', 11272349, 223580277, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (916 characters truncated) ... ="color:gray">chapter 18 . <span data-xutime="1437159206">7/17/2015</span> </small><div style="margin-top:5px">ooh grindlewald plot</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-09 03:27:16.562282', 11272349, 223229450, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3675778&amp;r ... (1000 characters truncated) ... div style="margin-top:5px">Really loving this story so far! Well-written, original intriguing piece of work. Thank you for sharing.</div></td>\n</tr>'), ('2017-02-09 03:27:16.562284', 11272349, 222878634, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (528 characters truncated) ... color:gray">chapter 5 . <span data-xutime="1435875181">7/2/2015</span> </small><div style="margin-top:5px">I like the story so far.</div></td>\n</tr>'))]
19:27:16 reviews: Job OK (2e8689a3-449d-4d4d-9d63-748ac2c9bcde)
19:27:16 Result is kept for 500 seconds
19:27:16 
19:27:16 *** Listening on chapters, profiles, reviews...
19:27:16 reviews: fanfic.jobs.crawl_reviews(11272601) (af3280a0-5742-491a-b926-611d9781adda)
19:27:30 reviews: Job OK (af3280a0-5742-491a-b926-611d9781adda)
19:27:30 Result is kept for 500 seconds
19:27:30 
19:27:30 *** Listening on chapters, profiles, reviews...
19:27:30 reviews: fanfic.jobs.crawl_reviews(11273721) (684d1cfb-e42e-4398-a184-ac633564770c)
19:33:00 reviews: Job OK (684d1cfb-e42e-4398-a184-ac633564770c)
19:33:00 Result is kept for 500 seconds
19:33:00 
19:33:00 *** Listening on chapters, profiles, reviews...
19:33:00 reviews: fanfic.jobs.crawl_reviews(11273847) (ca2ab9dc-f71a-415e-ae2f-38b3de08ed07)
19:35:24 reviews: Job OK (ca2ab9dc-f71a-415e-ae2f-38b3de08ed07)
19:35:24 Result is kept for 500 seconds
19:35:24 
19:35:24 *** Listening on chapters, profiles, reviews...
19:35:24 reviews: fanfic.jobs.crawl_reviews(11274959) (bc9183d0-a578-4278-b349-9e0ab99cb8f5)
19:36:21 reviews: Job OK (bc9183d0-a578-4278-b349-9e0ab99cb8f5)
19:36:21 Result is kept for 500 seconds
19:36:21 
19:36:21 *** Listening on chapters, profiles, reviews...
19:36:21 reviews: fanfic.jobs.crawl_reviews(11275516) (acd988e3-95e5-4a6b-9070-2be9a350d785)
19:36:50 reviews: Job OK (acd988e3-95e5-4a6b-9070-2be9a350d785)
19:36:50 Result is kept for 500 seconds
19:36:50 
19:36:50 *** Listening on chapters, profiles, reviews...
19:36:50 reviews: fanfic.jobs.crawl_reviews(11275892) (2ad73502-f780-48b8-9750-6f954b6855e3)
19:37:25 reviews: Job OK (2ad73502-f780-48b8-9750-6f954b6855e3)
19:37:25 Result is kept for 500 seconds
19:37:25 
19:37:25 *** Listening on chapters, profiles, reviews...
19:37:25 reviews: fanfic.jobs.crawl_reviews(11275902) (172e7ddd-1c52-4d9b-903f-a4eef05b49d1)
19:37:45 reviews: Job OK (172e7ddd-1c52-4d9b-903f-a4eef05b49d1)
19:37:45 Result is kept for 500 seconds
19:37:45 
19:37:45 *** Listening on chapters, profiles, reviews...
19:37:45 reviews: fanfic.jobs.crawl_reviews(11276250) (eab029fd-c0fd-4e8b-89a5-a276c1d4c7ba)
19:38:17 reviews: Job OK (eab029fd-c0fd-4e8b-89a5-a276c1d4c7ba)
19:38:17 Result is kept for 500 seconds
19:38:17 
19:38:17 *** Listening on chapters, profiles, reviews...
19:38:17 reviews: fanfic.jobs.crawl_reviews(11276383) (5d495886-e237-43a8-a023-b03ebd9fdc40)
2017-02-08 19:38:22 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 03:38:22.623395', 11276383, 242744620, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (586 characters truncated) ... </span> </small><div style="margin-top:5px">That was good closure to that story. :) Thanks for writing I always enjoy your fanfics!</div></td>\n</tr>'), ('2017-02-09 03:38:22.623400', 11276383, 242724182, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (543 characters truncated) ...  . <span data-xutime="1475956874">10/8/2016</span> </small><div style="margin-top:5px">I love having an update on the sanctuary. :)</div></td>\n</tr>'), ('2017-02-09 03:38:22.623402', 11276383, 242723880, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (700 characters truncated) ... hemselves to violent organizations that they then can\'t leave. Out of interest was that intentionally topical or a coincidence? :o</div></td>\n</tr>'), ('2017-02-09 03:38:22.623405', 11276383, 242708401, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (562 characters truncated) ... "1475911773">10/8/2016</span> </small><div style="margin-top:5px">Yay, so happy to have stumbled on this story, really enjoying it!</div></td>\n</tr>'), ('2017-02-09 03:38:22.623407', 11276383, 242708325, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (739 characters truncated) ...  as believable and memorable as the source work! I\'m meant to be getting ready to go out but think I\'ll read one more chapter. ;)</div></td>\n</tr>'), ('2017-02-09 03:38:22.623410', 11276383, 242708143, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (607 characters truncated) ... yle="margin-top:5px">Cool, I didn\'t know there was a sequel to Shades! :) looking forward to reading what the pack has been up to.</div></td>\n</tr>'), ('2017-02-09 03:38:22.623412', 11276383, 240097395, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5889742&amp;r ... (1082 characters truncated) ... romances, and the part that George and Lee got to play. Your Greyback was creepy and disturbing. Well done! :-) Thanks for writing!</div></td>\n</tr>'), ('2017-02-09 03:38:22.623415', 11276383, 233049076, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (611 characters truncated) ... le="margin-top:5px">Holy smokes, this is so good!<br>\n<br>\nJust finished the prequel and this one, gonna read the sequel next! :)</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-09 03:38:22.623454', 11276383, 222248658, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2004370&amp;r ... (866 characters truncated) ... 1435033153">6/22/2015</span> </small><div style="margin-top:5px">Loved it! Great story! Victoire and Teddy be Greyback was amazing!</div></td>\n</tr>'), ('2017-02-09 03:38:22.623457', 11276383, 221409614, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=976025&amp;rw ... (1013 characters truncated) ... s so interesting already. Eeeeeeek (sorry, wow no idea why that seemed like a necessary thing to type). To the next chapterrrrrrrr!</div></td>\n</tr>'))]
19:38:22 reviews: Job OK (5d495886-e237-43a8-a023-b03ebd9fdc40)
19:38:22 Result is kept for 500 seconds
19:38:22 
19:38:22 *** Listening on chapters, profiles, reviews...
19:38:22 reviews: fanfic.jobs.crawl_reviews(11278299) (55d48b00-242d-44b9-b6dd-32f9b52cc184)
19:43:33 reviews: Job OK (55d48b00-242d-44b9-b6dd-32f9b52cc184)
19:43:33 Result is kept for 500 seconds
19:43:33 
19:43:33 *** Listening on chapters, profiles, reviews...
19:43:33 reviews: fanfic.jobs.crawl_reviews(11278408) (13938cde-5366-42f4-ba07-298f329c0f9c)
19:47:34 reviews: Job OK (13938cde-5366-42f4-ba07-298f329c0f9c)
19:47:34 Result is kept for 500 seconds
19:47:34 
19:47:34 *** Listening on chapters, profiles, reviews...
19:47:34 reviews: fanfic.jobs.crawl_reviews(11279277) (f3d907fb-1a2f-4694-bb4c-5dadaaaafcec)
19:48:34 reviews: Job OK (f3d907fb-1a2f-4694-bb4c-5dadaaaafcec)
19:48:34 Result is kept for 500 seconds
19:48:34 
19:48:34 *** Listening on chapters, profiles, reviews...
19:48:34 reviews: fanfic.jobs.crawl_reviews(11279476) (29182d2c-5965-4a8e-adfd-085211ec58a5)
19:52:26 reviews: Job OK (29182d2c-5965-4a8e-adfd-085211ec58a5)
19:52:26 Result is kept for 500 seconds
19:52:26 
19:52:26 *** Listening on chapters, profiles, reviews...
19:52:26 reviews: fanfic.jobs.crawl_reviews(11280068) (2996f90e-7807-4d61-bfcf-33b01213c4d5)
19:55:19 reviews: Job OK (2996f90e-7807-4d61-bfcf-33b01213c4d5)
19:55:19 Result is kept for 500 seconds
19:55:19 
19:55:19 *** Listening on chapters, profiles, reviews...
19:55:19 reviews: fanfic.jobs.crawl_reviews(11280393) (65c87709-d99a-4e55-8dea-a997fc2011d8)
19:55:23 reviews: Job OK (65c87709-d99a-4e55-8dea-a997fc2011d8)
19:55:23 Result is kept for 500 seconds
19:55:23 
19:55:23 *** Listening on chapters, profiles, reviews...
19:55:23 reviews: fanfic.jobs.crawl_reviews(11280889) (8f0ad647-2376-4041-8e7b-63c2a4083231)
19:55:28 reviews: Job OK (8f0ad647-2376-4041-8e7b-63c2a4083231)
19:55:28 Result is kept for 500 seconds
19:55:28 
19:55:28 *** Listening on chapters, profiles, reviews...
19:55:28 reviews: fanfic.jobs.crawl_reviews(11280901) (0e463e19-ee96-4c7c-bdeb-8c42c967389a)
19:55:39 reviews: Job OK (0e463e19-ee96-4c7c-bdeb-8c42c967389a)
19:55:39 Result is kept for 500 seconds
19:55:39 
19:55:39 *** Listening on chapters, profiles, reviews...
19:55:39 reviews: fanfic.jobs.crawl_reviews(11282358) (619fc538-03aa-4c28-b08b-d4acb04ab38c)
19:55:59 reviews: Job OK (619fc538-03aa-4c28-b08b-d4acb04ab38c)
19:55:59 Result is kept for 500 seconds
19:55:59 
19:55:59 *** Listening on chapters, profiles, reviews...
19:55:59 reviews: fanfic.jobs.crawl_reviews(11284452) (02493783-086c-47d7-babc-a66a4a3a5251)
19:56:28 reviews: Job OK (02493783-086c-47d7-babc-a66a4a3a5251)
19:56:28 Result is kept for 500 seconds
19:56:28 
19:56:28 *** Listening on chapters, profiles, reviews...
19:56:28 reviews: fanfic.jobs.crawl_reviews(11284506) (39da68d4-52e4-404d-90eb-388c025a28b3)
19:56:51 reviews: Job OK (39da68d4-52e4-404d-90eb-388c025a28b3)
19:56:51 Result is kept for 500 seconds
19:56:51 
19:56:51 *** Listening on chapters, profiles, reviews...
19:56:51 reviews: fanfic.jobs.crawl_reviews(11285561) (169173a1-ff80-4d90-bd13-57c613cce45c)
19:57:31 reviews: Job OK (169173a1-ff80-4d90-bd13-57c613cce45c)
19:57:31 Result is kept for 500 seconds
19:57:31 
19:57:31 *** Listening on chapters, profiles, reviews...
19:57:31 reviews: fanfic.jobs.crawl_reviews(11285876) (4de095dc-c554-4f24-a4e1-296fac152230)
19:58:17 reviews: Job OK (4de095dc-c554-4f24-a4e1-296fac152230)
19:58:17 Result is kept for 500 seconds
19:58:17 
19:58:17 *** Listening on chapters, profiles, reviews...
19:58:17 reviews: fanfic.jobs.crawl_reviews(11286400) (722c8d45-5ee4-4522-921a-8c367ecf02ba)
19:58:25 reviews: Job OK (722c8d45-5ee4-4522-921a-8c367ecf02ba)
19:58:25 Result is kept for 500 seconds
19:58:25 
19:58:25 *** Listening on chapters, profiles, reviews...
19:58:25 reviews: fanfic.jobs.crawl_reviews(11287280) (6816641f-f1d2-4629-851d-f4fe402d1d05)
20:00:38 reviews: Job OK (6816641f-f1d2-4629-851d-f4fe402d1d05)
20:00:38 Result is kept for 500 seconds
20:00:38 
20:00:38 *** Listening on chapters, profiles, reviews...
20:00:38 reviews: fanfic.jobs.crawl_reviews(11287688) (ce3cba70-7a60-4f04-adb9-77dde0bbbaba)
20:02:44 reviews: Job OK (ce3cba70-7a60-4f04-adb9-77dde0bbbaba)
20:02:44 Result is kept for 500 seconds
20:02:44 
20:02:44 *** Listening on chapters, profiles, reviews...
20:02:44 reviews: fanfic.jobs.crawl_reviews(11287868) (a6fbf876-158f-4b40-9348-5836fb9fb905)
20:03:53 reviews: Job OK (a6fbf876-158f-4b40-9348-5836fb9fb905)
20:03:53 Result is kept for 500 seconds
20:03:53 
20:03:53 *** Listening on chapters, profiles, reviews...
20:03:53 reviews: fanfic.jobs.crawl_reviews(11289011) (22d8fe14-c17d-4f86-8ca7-622b64969a5b)
20:04:02 reviews: Job OK (22d8fe14-c17d-4f86-8ca7-622b64969a5b)
20:04:02 Result is kept for 500 seconds
20:04:02 
20:04:02 *** Listening on chapters, profiles, reviews...
20:04:02 reviews: fanfic.jobs.crawl_reviews(11290157) (554cba97-7a2d-4627-9685-8362b7d20bce)
2017-02-08 20:04:07 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 04:04:07.466072', 11290157, 240117004, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (657 characters truncated) ... rs. rape fetish. elements of originality, but then you rubberband back to following canon events for no other reason than laziness.</div></td>\n</tr>'), ('2017-02-09 04:04:07.466077', 11290157, 235797277, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (624 characters truncated) ... px">Your fic is pretty good, but hard to find of you don\'t know the name. I think that\'s why there are so few readers. Keep going</div></td>\n</tr>'), ('2017-02-09 04:04:07.466079', 11290157, 231086344, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2987995&amp;r ... (1237 characters truncated) ... r is going through is honestly aggravating. Interesting story so far and can\'t wait to see how\'ll you\'ll bring the two together.</div></td>\n</tr>'), ('2017-02-09 04:04:07.466081', 11290157, 225830938, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6073508&amp;r ... (960 characters truncated) ... n data-xutime="1440923166">8/30/2015</span> </small><div style="margin-top:5px">Hmm...at least he died with honor! Go Barty Crouch!</div></td>\n</tr>'), ('2017-02-09 04:04:07.466083', 11290157, 224272102, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4870000&amp;r ... (1608 characters truncated) ... shown in later chapters, then please think about revising this chapter.<br>\n<br>\nHopefully you don\'t see this as a flame-review.</div></td>\n</tr>'), ('2017-02-09 04:04:07.466085', 11290157, 223370508, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4917090&amp;r ... (1101 characters truncated) ... Either he is much older than you wrote, or he was but a toddler/baby during the first war. <br>\nIt\'s kind of a big contradiction.</div></td>\n</tr>'), ('2017-02-09 04:04:07.466087', 11290157, 223356610, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6763452&amp;r ... (961 characters truncated) ...  for the next and future chapters is lay off the fleur abuse it\'s nice story but that parts just a little too strong for my liking</div></td>\n</tr>'), ('2017-02-09 04:04:07.466089', 11290157, 222953999, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4921235&amp;r ... (824 characters truncated) ... style="color:gray">chapter 4 . <span data-xutime="1436167182">7/6/2015</span> </small><div style="margin-top:5px">That was Awesome!</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-09 04:04:07.466125', 11290157, 221666910, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4541300&amp;r ... (995 characters truncated) ... to be one of my favourite fleur story\'s right now. Oh also I so hope that when you said "dead" you really meant "not really dead".</div></td>\n</tr>'), ('2017-02-09 04:04:07.466127', 11290157, 221232505, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4917090&amp;r ... (1471 characters truncated) ...  a person, not an action figure. <br>\n<br>\nStill, I\'m a heavy Tolkien fan and OC/Fleur is rare, so I won\'t complain too hard :)</div></td>\n</tr>'))]
20:04:07 reviews: Job OK (554cba97-7a2d-4627-9685-8362b7d20bce)
20:04:07 Result is kept for 500 seconds
20:04:07 
20:04:07 *** Listening on chapters, profiles, reviews...
20:04:07 reviews: fanfic.jobs.crawl_reviews(11290952) (0a243643-3746-4b7c-ac19-d46976605f42)
20:04:19 reviews: Job OK (0a243643-3746-4b7c-ac19-d46976605f42)
20:04:19 Result is kept for 500 seconds
20:04:19 
20:04:19 *** Listening on chapters, profiles, reviews...
20:04:19 reviews: fanfic.jobs.crawl_reviews(11291056) (a2843cc8-fb53-459d-a42f-315073680197)
20:04:25 reviews: Job OK (a2843cc8-fb53-459d-a42f-315073680197)
20:04:25 Result is kept for 500 seconds
20:04:25 
20:04:25 *** Listening on chapters, profiles, reviews...
20:04:25 reviews: fanfic.jobs.crawl_reviews(11291473) (039d670d-afe6-4e41-a6fb-aa9bb4a1f2b1)
20:04:59 reviews: Job OK (039d670d-afe6-4e41-a6fb-aa9bb4a1f2b1)
20:04:59 Result is kept for 500 seconds
20:04:59 Cleaning registries for queue: chapters
20:04:59 Cleaning registries for queue: profiles
20:04:59 Cleaning registries for queue: reviews
20:04:59 
20:04:59 *** Listening on chapters, profiles, reviews...
20:04:59 reviews: fanfic.jobs.crawl_reviews(11291480) (4611bc65-1d16-4e8a-a196-7a5a6116d2e8)
20:05:57 reviews: Job OK (4611bc65-1d16-4e8a-a196-7a5a6116d2e8)
20:05:57 Result is kept for 500 seconds
20:05:57 
20:05:57 *** Listening on chapters, profiles, reviews...
20:05:57 reviews: fanfic.jobs.crawl_reviews(11291745) (4e78bf50-82e2-455d-af0e-48b2547c6859)
20:06:43 reviews: Job OK (4e78bf50-82e2-455d-af0e-48b2547c6859)
20:06:43 Result is kept for 500 seconds
20:06:43 
20:06:43 *** Listening on chapters, profiles, reviews...
20:06:43 reviews: fanfic.jobs.crawl_reviews(11292931) (458a29a9-3b05-4ad5-a267-6ee8aae708d6)
20:07:10 reviews: Job OK (458a29a9-3b05-4ad5-a267-6ee8aae708d6)
20:07:10 Result is kept for 500 seconds
20:07:10 
20:07:10 *** Listening on chapters, profiles, reviews...
20:07:10 reviews: fanfic.jobs.crawl_reviews(11294456) (3486ffcb-ed12-4da5-a6bb-7cb181e9b61e)
2017-02-08 20:07:12 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/11294456/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
20:07:12 reviews: Job OK (3486ffcb-ed12-4da5-a6bb-7cb181e9b61e)
20:07:12 Result is kept for 500 seconds
20:07:12 
20:07:12 *** Listening on chapters, profiles, reviews...
20:07:12 reviews: fanfic.jobs.crawl_reviews(11296256) (7df662e0-da7e-45c6-881c-d3d1f9bb62d5)
20:07:25 reviews: Job OK (7df662e0-da7e-45c6-881c-d3d1f9bb62d5)
20:07:25 Result is kept for 500 seconds
20:07:25 
20:07:25 *** Listening on chapters, profiles, reviews...
20:07:25 reviews: fanfic.jobs.crawl_reviews(11296913) (84bdcd16-92ad-4111-a061-c1022ea2c375)
20:08:02 reviews: Job OK (84bdcd16-92ad-4111-a061-c1022ea2c375)
20:08:02 Result is kept for 500 seconds
20:08:02 
20:08:02 *** Listening on chapters, profiles, reviews...
20:08:02 reviews: fanfic.jobs.crawl_reviews(11297224) (b5843a83-bf45-408c-812b-54d1b1a543ea)
20:08:27 reviews: Job OK (b5843a83-bf45-408c-812b-54d1b1a543ea)
20:08:27 Result is kept for 500 seconds
20:08:27 
20:08:27 *** Listening on chapters, profiles, reviews...
20:08:27 reviews: fanfic.jobs.crawl_reviews(11298223) (9e78da76-7be1-4466-8776-77bca3b4fd1e)
20:11:46 reviews: Job OK (9e78da76-7be1-4466-8776-77bca3b4fd1e)
20:11:46 Result is kept for 500 seconds
20:11:46 
20:11:46 *** Listening on chapters, profiles, reviews...
20:11:46 reviews: fanfic.jobs.crawl_reviews(11298265) (d0ca9e5e-d4ba-4b93-a012-ef42778152a0)
2017-02-08 20:11:52 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 04:11:52.040522', 11298265, 240330836, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7134058&amp;r ... (889 characters truncated) ... color:gray">chapter 34 . <span data-xutime="1470398293">8/5/2016</span> </small><div style="margin-top:5px">really enjoy this story</div></td>\n</tr>'), ('2017-02-09 04:11:52.040527', 11298265, 238545325, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2016918&amp;r ... (1617 characters truncated) ...  it so much better. Maybe if she was 16 or something when this happened, it might work but a 10 to 11 year old? That just doesn\'t.</div></td>\n</tr>'), ('2017-02-09 04:11:52.040529', 11298265, 222110210, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1589180&amp;r ... (926 characters truncated) ... xutime="1434819621">6/20/2015</span> </small><div style="margin-top:5px">HOLY SHIT I DID NOT SEE THAT COMING THIS IS THE BEST THING</div></td>\n</tr>'), ('2017-02-09 04:11:52.040531', 11298265, 240330836, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7134058&amp;r ... (889 characters truncated) ... color:gray">chapter 34 . <span data-xutime="1470398293">8/5/2016</span> </small><div style="margin-top:5px">really enjoy this story</div></td>\n</tr>'), ('2017-02-09 04:11:52.040533', 11298265, 238545325, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2016918&amp;r ... (1617 characters truncated) ...  it so much better. Maybe if she was 16 or something when this happened, it might work but a 10 to 11 year old? That just doesn\'t.</div></td>\n</tr>'), ('2017-02-09 04:11:52.040535', 11298265, 222110210, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1589180&amp;r ... (926 characters truncated) ... xutime="1434819621">6/20/2015</span> </small><div style="margin-top:5px">HOLY SHIT I DID NOT SEE THAT COMING THIS IS THE BEST THING</div></td>\n</tr>'))]
20:11:52 reviews: Job OK (d0ca9e5e-d4ba-4b93-a012-ef42778152a0)
20:11:52 Result is kept for 500 seconds
20:11:52 
20:11:52 *** Listening on chapters, profiles, reviews...
20:11:52 reviews: fanfic.jobs.crawl_reviews(11298296) (174ddc9f-22f0-4ba8-ba5a-aed4a971fde6)
20:12:13 reviews: Job OK (174ddc9f-22f0-4ba8-ba5a-aed4a971fde6)
20:12:13 Result is kept for 500 seconds
20:12:13 
20:12:13 *** Listening on chapters, profiles, reviews...
20:12:13 reviews: fanfic.jobs.crawl_reviews(11299015) (8825bb9e-1c6f-4ecc-a17f-d74a51219e73)
20:12:38 reviews: Job OK (8825bb9e-1c6f-4ecc-a17f-d74a51219e73)
20:12:38 Result is kept for 500 seconds
20:12:38 
20:12:38 *** Listening on chapters, profiles, reviews...
20:12:38 reviews: fanfic.jobs.crawl_reviews(11299333) (b3ad9908-2571-46b4-994f-20c6d7f87a0f)
20:19:05 reviews: Job OK (b3ad9908-2571-46b4-994f-20c6d7f87a0f)
20:19:05 Result is kept for 500 seconds
20:19:05 
20:19:05 *** Listening on chapters, profiles, reviews...
20:19:05 reviews: fanfic.jobs.crawl_reviews(11301003) (86a0afd8-412d-44a3-b3a8-2747d7570662)
20:20:04 reviews: Job OK (86a0afd8-412d-44a3-b3a8-2747d7570662)
20:20:04 Result is kept for 500 seconds
20:20:04 
20:20:04 *** Listening on chapters, profiles, reviews...
20:20:04 reviews: fanfic.jobs.crawl_reviews(11301490) (8f307c63-3b51-4990-8076-b84fe8f385fb)
20:20:10 reviews: Job OK (8f307c63-3b51-4990-8076-b84fe8f385fb)
20:20:10 Result is kept for 500 seconds
20:20:10 
20:20:10 *** Listening on chapters, profiles, reviews...
20:20:10 reviews: fanfic.jobs.crawl_reviews(11301563) (5bb0daba-fdc5-4ea3-bc00-df2dc82da18b)
20:20:53 reviews: Job OK (5bb0daba-fdc5-4ea3-bc00-df2dc82da18b)
20:20:53 Result is kept for 500 seconds
20:20:53 
20:20:53 *** Listening on chapters, profiles, reviews...
20:20:53 reviews: fanfic.jobs.crawl_reviews(11301790) (11e249c9-1db0-4a96-8c7c-97f0554d6fcf)
2017-02-08 20:20:58 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 04:20:58.669763', 11301790, 222922185, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (554 characters truncated) ... a-xutime="1436124157">7/5/2015</span> </small><div style="margin-top:5px">Not really canon but a great story. You should write more</div></td>\n</tr>'), ('2017-02-09 04:20:58.669769', 11301790, 222910087, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (581 characters truncated) ... /2015</span> </small><div style="margin-top:5px">I am really enjoying your story but there is so much random font info in chapter 8</div></td>\n</tr>'), ('2017-02-09 04:20:58.669771', 11301790, 221900189, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6743011&amp;r ... (995 characters truncated) ... OORAY! New Chapters! I was just about to put on my pouty face and whinge for more. I\'m enjoying the story a lot so keep it coming!</div></td>\n</tr>'), ('2017-02-09 04:20:58.669773', 11301790, 222922185, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (554 characters truncated) ... a-xutime="1436124157">7/5/2015</span> </small><div style="margin-top:5px">Not really canon but a great story. You should write more</div></td>\n</tr>'), ('2017-02-09 04:20:58.669775', 11301790, 222910087, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (581 characters truncated) ... /2015</span> </small><div style="margin-top:5px">I am really enjoying your story but there is so much random font info in chapter 8</div></td>\n</tr>'), ('2017-02-09 04:20:58.669777', 11301790, 221900189, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6743011&amp;r ... (995 characters truncated) ... OORAY! New Chapters! I was just about to put on my pouty face and whinge for more. I\'m enjoying the story a lot so keep it coming!</div></td>\n</tr>'))]
20:20:58 reviews: Job OK (11e249c9-1db0-4a96-8c7c-97f0554d6fcf)
20:20:58 Result is kept for 500 seconds
20:20:58 
20:20:58 *** Listening on chapters, profiles, reviews...
20:20:58 reviews: fanfic.jobs.crawl_reviews(11302467) (5bb1582a-e9be-4426-be9d-7ebc77dbeaf3)
20:23:23 reviews: Job OK (5bb1582a-e9be-4426-be9d-7ebc77dbeaf3)
20:23:23 Result is kept for 500 seconds
20:23:23 
20:23:23 *** Listening on chapters, profiles, reviews...
20:23:23 reviews: fanfic.jobs.crawl_reviews(11302568) (24f2e1cc-cd3d-4eee-bcc6-c9d095ad83db)
20:26:22 reviews: Job OK (24f2e1cc-cd3d-4eee-bcc6-c9d095ad83db)
20:26:22 Result is kept for 500 seconds
20:26:22 
20:26:22 *** Listening on chapters, profiles, reviews...
20:26:22 reviews: fanfic.jobs.crawl_reviews(11302977) (1f05818f-122c-45c1-804e-ced1cd6cf5d8)
20:26:41 reviews: Job OK (1f05818f-122c-45c1-804e-ced1cd6cf5d8)
20:26:41 Result is kept for 500 seconds
20:26:41 
20:26:41 *** Listening on chapters, profiles, reviews...
20:26:41 reviews: fanfic.jobs.crawl_reviews(11303165) (cb82da03-a187-4192-84be-3adca00fe8a7)
20:27:22 reviews: Job OK (cb82da03-a187-4192-84be-3adca00fe8a7)
20:27:22 Result is kept for 500 seconds
20:27:22 
20:27:22 *** Listening on chapters, profiles, reviews...
20:27:22 reviews: fanfic.jobs.crawl_reviews(11303786) (d41614d5-2dbd-41e8-bbde-5f25e2fdbf56)
20:29:48 reviews: Job OK (d41614d5-2dbd-41e8-bbde-5f25e2fdbf56)
20:29:48 Result is kept for 500 seconds
20:29:48 
20:29:48 *** Listening on chapters, profiles, reviews...
20:29:48 reviews: fanfic.jobs.crawl_reviews(11304085) (2cf5fef8-67e3-43d6-909e-a5a997c30e0e)
20:30:15 reviews: Job OK (2cf5fef8-67e3-43d6-909e-a5a997c30e0e)
20:30:15 Result is kept for 500 seconds
20:30:15 
20:30:15 *** Listening on chapters, profiles, reviews...
20:30:15 reviews: fanfic.jobs.crawl_reviews(11304578) (57ec1684-20f2-4658-adf2-4f1f930bfe11)
20:33:15 reviews: Job OK (57ec1684-20f2-4658-adf2-4f1f930bfe11)
20:33:15 Result is kept for 500 seconds
20:33:15 
20:33:15 *** Listening on chapters, profiles, reviews...
20:33:15 reviews: fanfic.jobs.crawl_reviews(11305351) (309abccf-bfdb-4144-9723-806e141cebcd)
20:34:15 reviews: Job OK (309abccf-bfdb-4144-9723-806e141cebcd)
20:34:15 Result is kept for 500 seconds
20:34:15 
20:34:15 *** Listening on chapters, profiles, reviews...
20:34:15 reviews: fanfic.jobs.crawl_reviews(11305366) (c1f8dba5-473c-4b8b-a845-d09829b1d398)
20:34:32 reviews: Job OK (c1f8dba5-473c-4b8b-a845-d09829b1d398)
20:34:32 Result is kept for 500 seconds
20:34:32 
20:34:32 *** Listening on chapters, profiles, reviews...
20:34:32 reviews: fanfic.jobs.crawl_reviews(11305455) (fbc22b5e-33e7-4d6c-878e-2b7b65f2d985)
20:35:42 reviews: Job OK (fbc22b5e-33e7-4d6c-878e-2b7b65f2d985)
20:35:42 Result is kept for 500 seconds
20:35:42 
20:35:42 *** Listening on chapters, profiles, reviews...
20:35:42 reviews: fanfic.jobs.crawl_reviews(11306345) (4bbcb9a2-d308-4934-9c7d-43d04ee0abf1)
20:38:13 reviews: Job OK (4bbcb9a2-d308-4934-9c7d-43d04ee0abf1)
20:38:13 Result is kept for 500 seconds
20:38:13 
20:38:13 *** Listening on chapters, profiles, reviews...
20:38:13 reviews: fanfic.jobs.crawl_reviews(11306448) (6adb2746-70a8-4a1d-9edb-db261081111c)
20:38:28 reviews: Job OK (6adb2746-70a8-4a1d-9edb-db261081111c)
20:38:28 Result is kept for 500 seconds
20:38:28 
20:38:28 *** Listening on chapters, profiles, reviews...
20:38:28 reviews: fanfic.jobs.crawl_reviews(11306507) (5a78757e-a089-4dd1-bdb3-a4cc0acadfe1)
20:40:02 reviews: Job OK (5a78757e-a089-4dd1-bdb3-a4cc0acadfe1)
20:40:02 Result is kept for 500 seconds
20:40:02 
20:40:02 *** Listening on chapters, profiles, reviews...
20:40:02 reviews: fanfic.jobs.crawl_reviews(11307638) (144a357a-512d-4de6-a57a-474303e17ae7)
20:40:39 reviews: Job OK (144a357a-512d-4de6-a57a-474303e17ae7)
20:40:39 Result is kept for 500 seconds
20:40:39 
20:40:39 *** Listening on chapters, profiles, reviews...
20:40:39 reviews: fanfic.jobs.crawl_reviews(11308842) (4eb7967c-2f92-446d-bd1b-34f01dea07c9)
20:41:34 reviews: Job OK (4eb7967c-2f92-446d-bd1b-34f01dea07c9)
20:41:34 Result is kept for 500 seconds
20:41:34 
20:41:34 *** Listening on chapters, profiles, reviews...
20:41:34 reviews: fanfic.jobs.crawl_reviews(11309141) (6beadf7a-49d5-41fd-89de-30403304739b)
20:41:39 reviews: Job OK (6beadf7a-49d5-41fd-89de-30403304739b)
20:41:39 Result is kept for 500 seconds
20:41:39 
20:41:39 *** Listening on chapters, profiles, reviews...
20:41:39 reviews: fanfic.jobs.crawl_reviews(11311521) (62f0c895-fdb1-4c6a-9596-b8d6e02f63aa)
20:42:05 reviews: Job OK (62f0c895-fdb1-4c6a-9596-b8d6e02f63aa)
20:42:05 Result is kept for 500 seconds
20:42:05 
20:42:05 *** Listening on chapters, profiles, reviews...
20:42:05 reviews: fanfic.jobs.crawl_reviews(11312703) (bcd51c68-b353-42bb-98b5-13fa3cb2a932)
20:42:58 reviews: Job OK (bcd51c68-b353-42bb-98b5-13fa3cb2a932)
20:42:58 Result is kept for 500 seconds
20:42:58 
20:42:58 *** Listening on chapters, profiles, reviews...
20:42:58 reviews: fanfic.jobs.crawl_reviews(11313166) (d9793b26-b806-4f5d-b432-6dc3c97b8089)
20:43:26 reviews: Job OK (d9793b26-b806-4f5d-b432-6dc3c97b8089)
20:43:26 Result is kept for 500 seconds
20:43:26 
20:43:26 *** Listening on chapters, profiles, reviews...
20:43:26 reviews: fanfic.jobs.crawl_reviews(11314870) (59c6a10a-58da-4b02-bada-f7689df1c478)
20:43:50 reviews: Job OK (59c6a10a-58da-4b02-bada-f7689df1c478)
20:43:50 Result is kept for 500 seconds
20:43:50 
20:43:50 *** Listening on chapters, profiles, reviews...
20:43:50 reviews: fanfic.jobs.crawl_reviews(11315480) (084b5385-b2a5-4c3f-a49d-05ea787613c1)
2017-02-08 20:43:55 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 04:43:55.080189', 11315480, 227189071, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5327572&amp;r ... (944 characters truncated) ... >9/30/2015</span> </small><div style="margin-top:5px">That was amazing! Thank you so very much! Everything! Perfection! Perfection!</div></td>\n</tr>'), ('2017-02-09 04:43:55.080193', 11315480, 224045589, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1336 characters truncated) ...  the series again, but it\'s another character\'s POV, for example, Ron\'s POV, except the OC has a different personality than him.</div></td>\n</tr>'), ('2017-02-09 04:43:55.080196', 11315480, 224029233, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1336485&amp;r ... (1076 characters truncated) ... for word from her book. Why didn\'t you write something new and fresh for your characters. They are interesting; your story is not!</div></td>\n</tr>'), ('2017-02-09 04:43:55.080198', 11315480, 224015628, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1336485&amp;r ... (1036 characters truncated) ... hat. Besides that, it\'s boring when you do it. We\'ve all read the books already. Change it up, summarize, do something different.</div></td>\n</tr>'), ('2017-02-09 04:43:55.080200', 11315480, 223278884, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6770427&amp;r ... (833 characters truncated) ... 8 . <span data-xutime="1436677944">7/11/2015</span> </small><div style="margin-top:5px">LOL. Malfoy the creature. Like the chapter.</div></td>\n</tr>'), ('2017-02-09 04:43:55.080202', 11315480, 223240846, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6770427&amp;r ... (1236 characters truncated) ... ind it somewhere else? Did the twins tell them? Other than that, yeah, this is a wonderful story! Please update and keep writing :)</div></td>\n</tr>'), ('2017-02-09 04:43:55.080203', 11315480, 222951042, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2506297&amp;r ... (1075 characters truncated) ... making me die of laughter at 2 in the morning.<br>\nReally hoping to see more of your fantastic story,<br>\nDame-Of-The-Living-Dead</div></td>\n</tr>'), ('2017-02-09 04:43:55.080205', 11315480, 222902092, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5327572&amp;r ... (876 characters truncated) ... small style="color:gray">chapter 1 . <span data-xutime="1436089520">7/5/2015</span> </small><div style="margin-top:5px">Oh awesome!</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-09 04:43:55.080240', 11315480, 222902042, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5327572&amp;r ... (918 characters truncated) ...  data-xutime="1436089394">7/5/2015</span> </small><div style="margin-top:5px">"Liquified dread" that is both depressing and awesome</div></td>\n</tr>'), ('2017-02-09 04:43:55.080242', 11315480, 222901984, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5327572&amp;r ... (891 characters truncated) ... lor:gray">chapter 7 . <span data-xutime="1436089255">7/5/2015</span> </small><div style="margin-top:5px">I LOVE THIS STORY SO MUCH!</div></td>\n</tr>'))]
20:43:55 reviews: Job OK (084b5385-b2a5-4c3f-a49d-05ea787613c1)
20:43:55 Result is kept for 500 seconds
20:43:55 
20:43:55 *** Listening on chapters, profiles, reviews...
20:43:55 reviews: fanfic.jobs.crawl_reviews(11316644) (8dd545cd-c8be-451c-867b-33c7c15fdc9d)
20:46:08 reviews: Job OK (8dd545cd-c8be-451c-867b-33c7c15fdc9d)
20:46:08 Result is kept for 500 seconds
20:46:08 
20:46:08 *** Listening on chapters, profiles, reviews...
20:46:08 reviews: fanfic.jobs.crawl_reviews(11316846) (453b1246-c9cb-4268-8efc-898363118776)
20:46:41 reviews: Job OK (453b1246-c9cb-4268-8efc-898363118776)
20:46:41 Result is kept for 500 seconds
20:46:41 
20:46:41 *** Listening on chapters, profiles, reviews...
20:46:41 reviews: fanfic.jobs.crawl_reviews(11317075) (186febe4-e999-4e12-bd06-de637689afbd)
20:49:30 reviews: Job OK (186febe4-e999-4e12-bd06-de637689afbd)
20:49:30 Result is kept for 500 seconds
20:49:30 
20:49:30 *** Listening on chapters, profiles, reviews...
20:49:30 reviews: fanfic.jobs.crawl_reviews(11317269) (85d81bb1-2c2a-48f2-8fea-e2287a89e49f)
20:49:53 reviews: Job OK (85d81bb1-2c2a-48f2-8fea-e2287a89e49f)
20:49:53 Result is kept for 500 seconds
20:49:53 
20:49:53 *** Listening on chapters, profiles, reviews...
20:49:53 reviews: fanfic.jobs.crawl_reviews(11318107) (eb6d1dc1-154a-4601-82e3-92a536f4b96d)
20:53:16 reviews: Job OK (eb6d1dc1-154a-4601-82e3-92a536f4b96d)
20:53:16 Result is kept for 500 seconds
20:53:16 
20:53:16 *** Listening on chapters, profiles, reviews...
20:53:16 reviews: fanfic.jobs.crawl_reviews(11318823) (b3101642-0723-4b23-8daf-0f6bfb8dc11a)
20:53:24 reviews: Job OK (b3101642-0723-4b23-8daf-0f6bfb8dc11a)
20:53:24 Result is kept for 500 seconds
20:53:24 
20:53:24 *** Listening on chapters, profiles, reviews...
20:53:24 reviews: fanfic.jobs.crawl_reviews(11319060) (91372909-1453-4589-9703-9aa3bd6c5424)
20:54:00 reviews: Job OK (91372909-1453-4589-9703-9aa3bd6c5424)
20:54:00 Result is kept for 500 seconds
20:54:00 
20:54:00 *** Listening on chapters, profiles, reviews...
20:54:00 reviews: fanfic.jobs.crawl_reviews(11319097) (d0c45ce8-3ca4-42d0-9676-384475be32ff)
20:55:49 reviews: Job OK (d0c45ce8-3ca4-42d0-9676-384475be32ff)
20:55:49 Result is kept for 500 seconds
20:55:49 
20:55:49 *** Listening on chapters, profiles, reviews...
20:55:49 reviews: fanfic.jobs.crawl_reviews(11319367) (0e35d7c8-287e-46b0-8a3a-56fc636793d8)
20:56:12 reviews: Job OK (0e35d7c8-287e-46b0-8a3a-56fc636793d8)
20:56:12 Result is kept for 500 seconds
20:56:12 
20:56:12 *** Listening on chapters, profiles, reviews...
20:56:12 reviews: fanfic.jobs.crawl_reviews(11319473) (f04481cb-1c62-4788-8bf4-a4e9530d13c5)
20:56:42 reviews: Job OK (f04481cb-1c62-4788-8bf4-a4e9530d13c5)
20:56:42 Result is kept for 500 seconds
20:56:42 
20:56:42 *** Listening on chapters, profiles, reviews...
20:56:42 reviews: fanfic.jobs.crawl_reviews(11320587) (1cbf7ef9-152b-4dc3-9d06-2832e2ca7166)
20:57:22 reviews: Job OK (1cbf7ef9-152b-4dc3-9d06-2832e2ca7166)
20:57:22 Result is kept for 500 seconds
20:57:22 
20:57:22 *** Listening on chapters, profiles, reviews...
20:57:22 reviews: fanfic.jobs.crawl_reviews(11321032) (9efa75c7-fe06-430a-a7aa-d0380dce733f)
21:06:20 reviews: Job OK (9efa75c7-fe06-430a-a7aa-d0380dce733f)
21:06:20 Result is kept for 500 seconds
21:06:20 Cleaning registries for queue: chapters
21:06:20 Cleaning registries for queue: profiles
21:06:20 Cleaning registries for queue: reviews
21:06:20 
21:06:20 *** Listening on chapters, profiles, reviews...
21:06:20 reviews: fanfic.jobs.crawl_reviews(11321509) (b1a3dda4-ac1c-4f40-8995-86799195b4f7)
21:06:43 reviews: Job OK (b1a3dda4-ac1c-4f40-8995-86799195b4f7)
21:06:43 Result is kept for 500 seconds
21:06:43 
21:06:43 *** Listening on chapters, profiles, reviews...
21:06:43 reviews: fanfic.jobs.crawl_reviews(11321626) (a98e9933-dce3-4ec0-b69b-2d37a4789227)
21:07:23 reviews: Job OK (a98e9933-dce3-4ec0-b69b-2d37a4789227)
21:07:23 Result is kept for 500 seconds
21:07:23 
21:07:23 *** Listening on chapters, profiles, reviews...
21:07:23 reviews: fanfic.jobs.crawl_reviews(11321683) (f210a758-66a4-4d00-9360-14161158b4a7)
21:10:05 reviews: Job OK (f210a758-66a4-4d00-9360-14161158b4a7)
21:10:05 Result is kept for 500 seconds
21:10:05 
21:10:05 *** Listening on chapters, profiles, reviews...
21:10:05 reviews: fanfic.jobs.crawl_reviews(11323333) (b18aeccd-36fe-4b77-a2cb-d59f9611e0ee)
2017-02-08 21:10:10 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 05:10:10.344107', 11323333, 230873771, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=314420&amp;rw ... (1075 characters truncated) ... rough lack of trying. (fans self vigorously yet again). <br>\n<br>\nYet another extremely hot chapter, and highly appreciated, too.</div></td>\n</tr>'), ('2017-02-09 05:10:10.344111', 11323333, 226717997, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=314420&amp;rw ... (1036 characters truncated) ... y Bonded. (and I wonder if Albus can tell if Severus is ovulating or not-that might be what he is smelling that\'s \'off\' to him).</div></td>\n</tr>'), ('2017-02-09 05:10:10.344114', 11323333, 226717730, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=314420&amp;rw ... (1358 characters truncated) ...  Albus wasn\'t taking any this time around, either, apparently. <br>\n<br>\n(still fanning myself vigorously, your writing is hot).</div></td>\n</tr>'), ('2017-02-09 05:10:10.344116', 11323333, 226717406, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=314420&amp;rw ... (1145 characters truncated) ... Ah well. Good thing Snape actually does watch over students, isn\'t it? <br>\n<br>\nAnyway, I love the long smut session immensely.</div></td>\n</tr>'), ('2017-02-09 05:10:10.344117', 11323333, 226717217, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=314420&amp;rw ... (1174 characters truncated) ... ining with someone else in a week with the same intent. <br>\n<br>\nAnd I\'m sure Snape can think of *something* to even the field.</div></td>\n</tr>'), ('2017-02-09 05:10:10.344119', 11323333, 223672576, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6062035&amp;r ... (857 characters truncated) ... "1437316655">7/19/2015</span> </small><div style="margin-top:5px">I\'m so happy this chapter came out. Can\'t wait for the next one</div></td>\n</tr>'), ('2017-02-09 05:10:10.344121', 11323333, 222821483, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6062035&amp;r ... (859 characters truncated) ... 435950748">7/3/2015</span> </small><div style="margin-top:5px">Please update or...or... I dont know what I\'ll do but please update</div></td>\n</tr>'), ('2017-02-09 05:10:10.344123', 11323333, 222510599, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=314420&amp;rw ... (1079 characters truncated) ... <br>\nAnd I suspect that courting Sluggy is going to blow up in Albus\' face, and Sev\'s, too. <br>\n<br>\nLooking forward to more.</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-09 05:10:10.344151', 11323333, 222509697, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=314420&amp;rw ... (1242 characters truncated) ... wards Snape would make slightly more sense if he could subconsciously sense that Snape was an Omega, but refusing to be submissive.</div></td>\n</tr>'), ('2017-02-09 05:10:10.344153', 11323333, 222393085, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2175335&amp;r ... (823 characters truncated) ... chapter 2 . <span data-xutime="1435264231">6/25/2015</span> </small><div style="margin-top:5px">poor sev...please update soon 10/10</div></td>\n</tr>'))]
21:10:10 reviews: Job OK (b18aeccd-36fe-4b77-a2cb-d59f9611e0ee)
21:10:10 Result is kept for 500 seconds
21:10:10 
21:10:10 *** Listening on chapters, profiles, reviews...
21:10:10 reviews: fanfic.jobs.crawl_reviews(11323860) (3d6a7f22-5ac3-4560-be9f-79dffa5718cd)
21:11:54 reviews: Job OK (3d6a7f22-5ac3-4560-be9f-79dffa5718cd)
21:11:54 Result is kept for 500 seconds
21:11:54 
21:11:54 *** Listening on chapters, profiles, reviews...
21:11:54 reviews: fanfic.jobs.crawl_reviews(11324117) (d0be3cf8-4d43-479e-aa43-f85477f85977)
21:15:59 reviews: Job OK (d0be3cf8-4d43-479e-aa43-f85477f85977)
21:15:59 Result is kept for 500 seconds
21:15:59 
21:15:59 *** Listening on chapters, profiles, reviews...
21:15:59 reviews: fanfic.jobs.crawl_reviews(11324342) (e4a5f021-a706-4396-93ac-dc6d0bc70b55)
21:16:21 reviews: Job OK (e4a5f021-a706-4396-93ac-dc6d0bc70b55)
21:16:21 Result is kept for 500 seconds
21:16:21 
21:16:21 *** Listening on chapters, profiles, reviews...
21:16:21 reviews: fanfic.jobs.crawl_reviews(11325042) (f100eb7a-6faa-4595-8f06-daa45f0ac369)
21:16:33 reviews: Job OK (f100eb7a-6faa-4595-8f06-daa45f0ac369)
21:16:33 Result is kept for 500 seconds
21:16:33 
21:16:33 *** Listening on chapters, profiles, reviews...
21:16:33 reviews: fanfic.jobs.crawl_reviews(11326008) (c2522c42-1505-4917-9e3a-7bc297057c7e)
2017-02-08 21:16:39 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 05:16:39.454089', 11326008, 232364241, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1632399&amp;r ... (1499 characters truncated) ... with flaws and qualities.<br>\n<br>\nWonderful story, I hope more people will find and read this series, you deserve the attention!</div></td>\n</tr>'), ('2017-02-09 05:16:39.454093', 11326008, 227239632, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7124960&amp;r ... (822 characters truncated) ... ">chapter 32 . <span data-xutime="1443758619">10/1/2015</span> </small><div style="margin-top:5px">Another wonderful novel! Thanks!</div></td>\n</tr>'), ('2017-02-09 05:16:39.454095', 11326008, 223118340, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2388024&amp;r ... (952 characters truncated) ... delightful stories! They are so well written and have a wonderful plot line. I do hope you continue to post them if there are more!</div></td>\n</tr>'), ('2017-02-09 05:16:39.454097', 11326008, 222487352, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (561 characters truncated) ... e="1435420882">6/27/2015</span> </small><div style="margin-top:5px">Holy craps this is good... Wonder what they are alldping there!</div></td>\n</tr>'), ('2017-02-09 05:16:39.454099', 11326008, 222272544, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6853671&amp;r ... (1008 characters truncated) ...  Because then wouldn\'t she be Donzo McLaggen, not McCormack? Or maybe you\'re not saying that at all, in which case, ignore me. :)</div></td>\n</tr>'), ('2017-02-09 05:16:39.454101', 11326008, 222271672, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6853671&amp;r ... (1325 characters truncated) ... ther. After all of the crazy junk that those kids went through, it\'s wonderful to see them as happy parents, spouses, and friends.</div></td>\n</tr>'), ('2017-02-09 05:16:39.454103', 11326008, 232364241, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1632399&amp;r ... (1499 characters truncated) ... with flaws and qualities.<br>\n<br>\nWonderful story, I hope more people will find and read this series, you deserve the attention!</div></td>\n</tr>'), ('2017-02-09 05:16:39.454105', 11326008, 227239632, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7124960&amp;r ... (822 characters truncated) ... ">chapter 32 . <span data-xutime="1443758619">10/1/2015</span> </small><div style="margin-top:5px">Another wonderful novel! Thanks!</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-09 05:16:39.454111', 11326008, 222272544, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6853671&amp;r ... (1008 characters truncated) ...  Because then wouldn\'t she be Donzo McLaggen, not McCormack? Or maybe you\'re not saying that at all, in which case, ignore me. :)</div></td>\n</tr>'), ('2017-02-09 05:16:39.454112', 11326008, 222271672, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6853671&amp;r ... (1325 characters truncated) ... ther. After all of the crazy junk that those kids went through, it\'s wonderful to see them as happy parents, spouses, and friends.</div></td>\n</tr>'))]
21:16:39 reviews: Job OK (c2522c42-1505-4917-9e3a-7bc297057c7e)
21:16:39 Result is kept for 500 seconds
21:16:39 
21:16:39 *** Listening on chapters, profiles, reviews...
21:16:39 reviews: fanfic.jobs.crawl_reviews(11326194) (a09aa567-000b-4cba-bfee-ea2fd54a466b)
21:18:31 reviews: Job OK (a09aa567-000b-4cba-bfee-ea2fd54a466b)
21:18:31 Result is kept for 500 seconds
21:18:31 
21:18:31 *** Listening on chapters, profiles, reviews...
21:18:31 reviews: fanfic.jobs.crawl_reviews(11327070) (20c7bc03-eca8-4240-aa92-4c6539b3fc14)
21:18:41 reviews: Job OK (20c7bc03-eca8-4240-aa92-4c6539b3fc14)
21:18:41 Result is kept for 500 seconds
21:18:41 
21:18:41 *** Listening on chapters, profiles, reviews...
21:18:41 reviews: fanfic.jobs.crawl_reviews(11327158) (ec4a91b4-3ce5-4d84-9faf-f49c7a38eab3)
2017-02-08 21:18:45 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 05:18:45.392790', 11327158, 225385149, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5613864&amp;r ... (1004 characters truncated) ... ow emotional and moving this story is. It will definitely stay with me for a long time. Expertly crafted, you are a true wordsmith.</div></td>\n</tr>'), ('2017-02-09 05:18:45.392796', 11327158, 222511861, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6881964&amp;r ... (911 characters truncated) ...  <span data-xutime="1435456697">6/27/2015</span> </small><div style="margin-top:5px">Jesus Christ! The feels! I am dying right now.</div></td>\n</tr>'), ('2017-02-09 05:18:45.392798', 11327158, 225385149, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5613864&amp;r ... (1004 characters truncated) ... ow emotional and moving this story is. It will definitely stay with me for a long time. Expertly crafted, you are a true wordsmith.</div></td>\n</tr>'), ('2017-02-09 05:18:45.392800', 11327158, 222511861, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6881964&amp;r ... (911 characters truncated) ...  <span data-xutime="1435456697">6/27/2015</span> </small><div style="margin-top:5px">Jesus Christ! The feels! I am dying right now.</div></td>\n</tr>'))]
21:18:45 reviews: Job OK (ec4a91b4-3ce5-4d84-9faf-f49c7a38eab3)
21:18:45 Result is kept for 500 seconds
21:18:45 
21:18:45 *** Listening on chapters, profiles, reviews...
21:18:45 reviews: fanfic.jobs.crawl_reviews(11327680) (f57a165b-8c07-4435-bc49-c8e2e5ef01e7)
21:19:36 reviews: Job OK (f57a165b-8c07-4435-bc49-c8e2e5ef01e7)
21:19:36 Result is kept for 500 seconds
21:19:36 
21:19:36 *** Listening on chapters, profiles, reviews...
21:19:36 reviews: fanfic.jobs.crawl_reviews(11328023) (8e4c82c4-0cdf-415c-9ddc-8f6a8bfdab9f)
21:22:45 reviews: Job OK (8e4c82c4-0cdf-415c-9ddc-8f6a8bfdab9f)
21:22:45 Result is kept for 500 seconds
21:22:45 
21:22:45 *** Listening on chapters, profiles, reviews...
21:22:45 reviews: fanfic.jobs.crawl_reviews(11329168) (c73b2d19-835d-4f37-ab6e-9a5819fd4604)
21:24:11 reviews: Job OK (c73b2d19-835d-4f37-ab6e-9a5819fd4604)
21:24:11 Result is kept for 500 seconds
21:24:11 
21:24:11 *** Listening on chapters, profiles, reviews...
21:24:11 reviews: fanfic.jobs.crawl_reviews(11329678) (4be63cfc-b18c-4115-aea5-6c7dc4182118)
2017-02-08 21:24:16 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 05:24:16.661905', 11329678, 239055197, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (562 characters truncated) ... 467575073">7/3/2016</span> </small><div style="margin-top:5px">Please say you are still working on this piece and will update soon!</div></td>\n</tr>'), ('2017-02-09 05:24:16.661909', 11329678, 233992636, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (558 characters truncated) ... e="1457183350">3/5/2016</span> </small><div style="margin-top:5px">Lovethus story- cant wait fir the next chapter! when will it be?</div></td>\n</tr>'), ('2017-02-09 05:24:16.661911', 11329678, 232819784, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4939341&amp;r ... (846 characters truncated) ... utime="1454901613">2/7/2016</span> </small><div style="margin-top:5px">Love this story! Please update with another chapter soon! :)</div></td>\n</tr>'), ('2017-02-09 05:24:16.661913', 11329678, 232021277, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7242232&amp;r ... (810 characters truncated) ... r:gray">chapter 5 . <span data-xutime="1453318289">1/20/2016</span> </small><div style="margin-top:5px">Love it! Please update soon</div></td>\n</tr>'), ('2017-02-09 05:24:16.661915', 11329678, 228522821, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (515 characters truncated) ... e="color:gray">chapter 5 . <span data-xutime="1446322258">10/31/2015</span> </small><div style="margin-top:5px">This fic is amazing</div></td>\n</tr>'), ('2017-02-09 05:24:16.661917', 11329678, 228359716, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4124504&amp;r ... (982 characters truncated) ... "margin-top:5px">I am in love with this story! The way you write is so beautiful! Love it and I\'m looking forward to reading more!</div></td>\n</tr>'), ('2017-02-09 05:24:16.661919', 11329678, 228357369, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4124504&amp;r ... (941 characters truncated) ... 78">10/27/2015</span> </small><div style="margin-top:5px">I have no words for this amazing chapter! You are such an amazing author!</div></td>\n</tr>'), ('2017-02-09 05:24:16.661920', 11329678, 228355656, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4124504&amp;r ... (931 characters truncated) ... ="1446009924">10/27/2015</span> </small><div style="margin-top:5px">I gotta admit I kinda hate Smetty... But another great chapter!</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-09 05:24:16.661959', 11329678, 227064406, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5251105&amp;r ... (987 characters truncated) ... 5px">This is really good! I want to read more!<br>\nYou have a fan here!<br>\nCan\'t wait to know why James is doing this?<br>\n;-)</div></td>\n</tr>'), ('2017-02-09 05:24:16.661961', 11329678, 222189051, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4726595&amp;r ... (901 characters truncated) ... pter 1 . <span data-xutime="1434942440">6/21/2015</span> </small><div style="margin-top:5px">Nice job good story please update soon</div></td>\n</tr>'))]
21:24:16 reviews: Job OK (4be63cfc-b18c-4115-aea5-6c7dc4182118)
21:24:16 Result is kept for 500 seconds
21:24:16 
21:24:16 *** Listening on chapters, profiles, reviews...
21:24:16 reviews: fanfic.jobs.crawl_reviews(11330784) (e0d83bc6-b4aa-470b-b0dd-4c7a83453327)
21:25:47 reviews: Job OK (e0d83bc6-b4aa-470b-b0dd-4c7a83453327)
21:25:47 Result is kept for 500 seconds
21:25:47 
21:25:47 *** Listening on chapters, profiles, reviews...
21:25:47 reviews: fanfic.jobs.crawl_reviews(11332400) (4bd664a6-a38e-4104-a400-a157af3ba73c)
21:27:44 reviews: Job OK (4bd664a6-a38e-4104-a400-a157af3ba73c)
21:27:44 Result is kept for 500 seconds
21:27:44 
21:27:44 *** Listening on chapters, profiles, reviews...
21:27:44 reviews: fanfic.jobs.crawl_reviews(11332900) (87654aeb-7155-4603-a535-ab7473897004)
21:28:11 reviews: Job OK (87654aeb-7155-4603-a535-ab7473897004)
21:28:11 Result is kept for 500 seconds
21:28:11 
21:28:11 *** Listening on chapters, profiles, reviews...
21:28:11 reviews: fanfic.jobs.crawl_reviews(11334118) (fb194264-2f1a-4035-addb-a6fb1d85858d)
21:28:28 reviews: Job OK (fb194264-2f1a-4035-addb-a6fb1d85858d)
21:28:28 Result is kept for 500 seconds
21:28:28 
21:28:28 *** Listening on chapters, profiles, reviews...
21:28:28 reviews: fanfic.jobs.crawl_reviews(11336884) (f0794b3e-8d72-4ba8-acf7-98d351f5ae76)
2017-02-08 21:28:30 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/11336884/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
21:28:30 reviews: Job OK (f0794b3e-8d72-4ba8-acf7-98d351f5ae76)
21:28:30 Result is kept for 500 seconds
21:28:30 
21:28:30 *** Listening on chapters, profiles, reviews...
21:28:30 reviews: fanfic.jobs.crawl_reviews(11338922) (91942077-262c-4227-b436-75605f081f70)
21:28:40 reviews: Job OK (91942077-262c-4227-b436-75605f081f70)
21:28:40 Result is kept for 500 seconds
21:28:40 
21:28:40 *** Listening on chapters, profiles, reviews...
21:28:40 reviews: fanfic.jobs.crawl_reviews(11340840) (9029332f-31b0-4b70-9064-7b5df433c8d7)
21:29:03 reviews: Job OK (9029332f-31b0-4b70-9064-7b5df433c8d7)
21:29:03 Result is kept for 500 seconds
21:29:03 
21:29:03 *** Listening on chapters, profiles, reviews...
21:29:03 reviews: fanfic.jobs.crawl_reviews(11341421) (a1694d45-544b-4d23-80dc-8a9143b0da7a)
21:29:12 reviews: Job OK (a1694d45-544b-4d23-80dc-8a9143b0da7a)
21:29:12 Result is kept for 500 seconds
21:29:12 
21:29:12 *** Listening on chapters, profiles, reviews...
21:29:12 reviews: fanfic.jobs.crawl_reviews(11341620) (f6794606-7dc1-4dbb-a58f-1a3a32bba7a4)
21:29:51 reviews: Job OK (f6794606-7dc1-4dbb-a58f-1a3a32bba7a4)
21:29:51 Result is kept for 500 seconds
21:29:51 
21:29:51 *** Listening on chapters, profiles, reviews...
21:29:51 reviews: fanfic.jobs.crawl_reviews(11342106) (32db4428-d707-45c9-b48b-0f5048025ed9)
21:30:03 reviews: Job OK (32db4428-d707-45c9-b48b-0f5048025ed9)
21:30:03 Result is kept for 500 seconds
21:30:03 
21:30:03 *** Listening on chapters, profiles, reviews...
21:30:03 reviews: fanfic.jobs.crawl_reviews(11343248) (99f9d988-5afb-4371-98ff-d6a144ed0762)
21:30:28 reviews: Job OK (99f9d988-5afb-4371-98ff-d6a144ed0762)
21:30:28 Result is kept for 500 seconds
21:30:28 
21:30:28 *** Listening on chapters, profiles, reviews...
21:30:28 reviews: fanfic.jobs.crawl_reviews(11344073) (d16ede13-7519-4289-b18b-1de0b2caf248)
21:32:00 reviews: Job OK (d16ede13-7519-4289-b18b-1de0b2caf248)
21:32:00 Result is kept for 500 seconds
21:32:00 
21:32:00 *** Listening on chapters, profiles, reviews...
21:32:00 reviews: fanfic.jobs.crawl_reviews(11344091) (430a8df7-6654-4d39-adbd-2d8d221dbfee)
21:32:08 reviews: Job OK (430a8df7-6654-4d39-adbd-2d8d221dbfee)
21:32:08 Result is kept for 500 seconds
21:32:08 
21:32:08 *** Listening on chapters, profiles, reviews...
21:32:08 reviews: fanfic.jobs.crawl_reviews(11344695) (4e59866e-f937-418f-9d20-1afbb8dd574d)
21:32:55 reviews: Job OK (4e59866e-f937-418f-9d20-1afbb8dd574d)
21:32:55 Result is kept for 500 seconds
21:32:55 
21:32:55 *** Listening on chapters, profiles, reviews...
21:32:55 reviews: fanfic.jobs.crawl_reviews(11344815) (c858ec2b-4032-4f3f-a8ed-6ccd6aa8e2db)
21:33:32 reviews: Job OK (c858ec2b-4032-4f3f-a8ed-6ccd6aa8e2db)
21:33:32 Result is kept for 500 seconds
21:33:32 
21:33:32 *** Listening on chapters, profiles, reviews...
21:33:32 reviews: fanfic.jobs.crawl_reviews(11344818) (455f3666-79e6-4980-8175-f8f9cdcd0c33)
21:33:45 reviews: Job OK (455f3666-79e6-4980-8175-f8f9cdcd0c33)
21:33:45 Result is kept for 500 seconds
21:33:45 
21:33:45 *** Listening on chapters, profiles, reviews...
21:33:45 reviews: fanfic.jobs.crawl_reviews(11347042) (a4569fc7-13f2-413d-8eca-e301e59e2353)
21:34:40 reviews: Job OK (a4569fc7-13f2-413d-8eca-e301e59e2353)
21:34:40 Result is kept for 500 seconds
21:34:40 
21:34:40 *** Listening on chapters, profiles, reviews...
21:34:40 reviews: fanfic.jobs.crawl_reviews(11348665) (7d365c51-14fd-414d-b82c-0563672b75f5)
21:38:27 reviews: Job OK (7d365c51-14fd-414d-b82c-0563672b75f5)
21:38:27 Result is kept for 500 seconds
21:38:27 
21:38:27 *** Listening on chapters, profiles, reviews...
21:38:27 reviews: fanfic.jobs.crawl_reviews(11349330) (a669d45f-89d6-49be-8ac2-0c6278e46c91)
2017-02-08 21:38:31 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 05:38:31.374810', 11349330, 243677658, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8377846&amp;r ... (1413 characters truncated) ...  what they\'ve already done. <br>\n<br>\nLooking forward to those qualifier chapters very much, and thanks again for more cold tea.</div></td>\n</tr>'), ('2017-02-09 05:38:31.374815', 11349330, 243547877, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8377846&amp;r ... (1218 characters truncated) ... quence of needing to know what happens nxt.<br>\n<br>\nnice touh with Neville\'s patronus. i always imagined it would be a toad too</div></td>\n</tr>'), ('2017-02-09 05:38:31.374818', 11349330, 243517921, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8377846&amp;r ... (939 characters truncated) ... data-xutime="1477981346">10/31/2016</span> </small><div style="margin-top:5px">Elza here, good to have this back on my follow list.</div></td>\n</tr>'), ('2017-02-09 05:38:31.374820', 11349330, 240649813, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8082990&amp;r ... (860 characters truncated) ... -xutime="1471079550">8/13/2016</span> </small><div style="margin-top:5px">Great storytelling, love this! Hope you feel better soon.</div></td>\n</tr>'), ('2017-02-09 05:38:31.374822', 11349330, 225933510, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (542 characters truncated) ...  . <span data-xutime="1440993389">8/30/2015</span> </small><div style="margin-top:5px">Really enjoying reading. Please update soon.</div></td>\n</tr>'), ('2017-02-09 05:38:31.374825', 11349330, 225572373, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6828825&amp;r ... (851 characters truncated) ... ter 16 . <span data-xutime="1440453346">8/24/2015</span> </small><div style="margin-top:5px">please update soon. it is a great book</div></td>\n</tr>'), ('2017-02-09 05:38:31.374827', 11349330, 223996456, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5244847&amp;r ... (1856 characters truncated) ... eighed next to nothing. And a featherlight charm on herself would have enabled her to leap over chasms or magic-resistant barriers.</div></td>\n</tr>'), ('2017-02-09 05:38:31.374829', 11349330, 222955285, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (560 characters truncated) ... e="1435995849">7/4/2015</span> </small><div style="margin-top:5px">great story really like it but the chapters 2 and 3 are the same</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-09 05:38:31.374846', 11349330, 223996456, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5244847&amp;r ... (1856 characters truncated) ... eighed next to nothing. And a featherlight charm on herself would have enabled her to leap over chasms or magic-resistant barriers.</div></td>\n</tr>'), ('2017-02-09 05:38:31.374848', 11349330, 222955285, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (560 characters truncated) ... e="1435995849">7/4/2015</span> </small><div style="margin-top:5px">great story really like it but the chapters 2 and 3 are the same</div></td>\n</tr>'))]
21:38:31 reviews: Job OK (a669d45f-89d6-49be-8ac2-0c6278e46c91)
21:38:31 Result is kept for 500 seconds
21:38:31 
21:38:31 *** Listening on chapters, profiles, reviews...
21:38:31 reviews: fanfic.jobs.crawl_reviews(11350535) (e2bd1792-d50e-43ed-b3f5-f80b59c9a145)
21:38:45 reviews: Job OK (e2bd1792-d50e-43ed-b3f5-f80b59c9a145)
21:38:45 Result is kept for 500 seconds
21:38:45 
21:38:45 *** Listening on chapters, profiles, reviews...
21:38:45 reviews: fanfic.jobs.crawl_reviews(11350593) (fc31ad8f-95bd-4cec-916a-9ac0f309cd74)
21:39:10 reviews: Job OK (fc31ad8f-95bd-4cec-916a-9ac0f309cd74)
21:39:10 Result is kept for 500 seconds
21:39:10 
21:39:10 *** Listening on chapters, profiles, reviews...
21:39:10 reviews: fanfic.jobs.crawl_reviews(11350719) (711c6892-565d-4c66-939a-cc759c9bb4ed)
21:39:30 reviews: Job OK (711c6892-565d-4c66-939a-cc759c9bb4ed)
21:39:30 Result is kept for 500 seconds
21:39:30 
21:39:30 *** Listening on chapters, profiles, reviews...
21:39:30 reviews: fanfic.jobs.crawl_reviews(11352516) (b9c70991-8e13-4feb-81cb-32d769ac714f)
21:39:38 reviews: Job OK (b9c70991-8e13-4feb-81cb-32d769ac714f)
21:39:38 Result is kept for 500 seconds
21:39:38 
21:39:38 *** Listening on chapters, profiles, reviews...
21:39:38 reviews: fanfic.jobs.crawl_reviews(11352978) (60193572-3c30-43ee-b418-8b588a9f75bd)
21:39:43 reviews: Job OK (60193572-3c30-43ee-b418-8b588a9f75bd)
21:39:43 Result is kept for 500 seconds
21:39:43 
21:39:43 *** Listening on chapters, profiles, reviews...
21:39:43 reviews: fanfic.jobs.crawl_reviews(11353362) (997b8fb3-6e5f-40d1-964b-913164296c12)
21:40:09 reviews: Job OK (997b8fb3-6e5f-40d1-964b-913164296c12)
21:40:09 Result is kept for 500 seconds
21:40:09 
21:40:09 *** Listening on chapters, profiles, reviews...
21:40:09 reviews: fanfic.jobs.crawl_reviews(11354075) (80718cc5-7fec-4499-9307-2c92b841c086)
21:40:18 reviews: Job OK (80718cc5-7fec-4499-9307-2c92b841c086)
21:40:18 Result is kept for 500 seconds
21:40:18 
21:40:18 *** Listening on chapters, profiles, reviews...
21:40:18 reviews: fanfic.jobs.crawl_reviews(11356205) (7ecbf667-e03a-4589-887e-694c8138dbcd)
21:41:11 reviews: Job OK (7ecbf667-e03a-4589-887e-694c8138dbcd)
21:41:11 Result is kept for 500 seconds
21:41:11 
21:41:11 *** Listening on chapters, profiles, reviews...
21:41:11 reviews: fanfic.jobs.crawl_reviews(11357426) (f103f43f-148b-43ef-ac5f-fbf3c269f9fe)
21:41:49 reviews: Job OK (f103f43f-148b-43ef-ac5f-fbf3c269f9fe)
21:41:49 Result is kept for 500 seconds
21:41:49 
21:41:49 *** Listening on chapters, profiles, reviews...
21:41:49 reviews: fanfic.jobs.crawl_reviews(11357806) (96dcf139-767a-4be0-856d-9a933286e06f)
21:48:17 reviews: Job OK (96dcf139-767a-4be0-856d-9a933286e06f)
21:48:17 Result is kept for 500 seconds
21:48:17 
21:48:17 *** Listening on chapters, profiles, reviews...
21:48:17 reviews: fanfic.jobs.crawl_reviews(11358216) (8e254895-af78-42ae-83e8-7819dd6549df)
21:48:30 reviews: Job OK (8e254895-af78-42ae-83e8-7819dd6549df)
21:48:30 Result is kept for 500 seconds
21:48:30 
21:48:30 *** Listening on chapters, profiles, reviews...
21:48:30 reviews: fanfic.jobs.crawl_reviews(11358664) (6113ca7c-4515-4461-8f11-86eda5c923f3)
21:50:42 reviews: Job OK (6113ca7c-4515-4461-8f11-86eda5c923f3)
21:50:42 Result is kept for 500 seconds
21:50:42 
21:50:42 *** Listening on chapters, profiles, reviews...
21:50:42 reviews: fanfic.jobs.crawl_reviews(11359138) (435a4797-5486-4e82-a956-18cdfd936c56)
21:55:13 reviews: Job OK (435a4797-5486-4e82-a956-18cdfd936c56)
21:55:13 Result is kept for 500 seconds
21:55:13 
21:55:13 *** Listening on chapters, profiles, reviews...
21:55:13 reviews: fanfic.jobs.crawl_reviews(11359747) (b43b0302-bebf-41c9-bd84-41005b91bba8)
21:55:29 reviews: Job OK (b43b0302-bebf-41c9-bd84-41005b91bba8)
21:55:29 Result is kept for 500 seconds
21:55:29 
21:55:29 *** Listening on chapters, profiles, reviews...
21:55:29 reviews: fanfic.jobs.crawl_reviews(11360264) (8463e1ab-f162-47c5-9ea9-7e817bdd6b24)
22:34:05 reviews: Job OK (8463e1ab-f162-47c5-9ea9-7e817bdd6b24)
22:34:05 Result is kept for 500 seconds
22:34:05 Cleaning registries for queue: chapters
22:34:05 Cleaning registries for queue: profiles
22:34:05 Cleaning registries for queue: reviews
22:34:05 
22:34:05 *** Listening on chapters, profiles, reviews...
22:34:05 reviews: fanfic.jobs.crawl_reviews(11360525) (57239f3d-3fce-4d82-887d-b76b484539c4)
22:35:34 reviews: Job OK (57239f3d-3fce-4d82-887d-b76b484539c4)
22:35:34 Result is kept for 500 seconds
22:35:34 
22:35:34 *** Listening on chapters, profiles, reviews...
22:35:34 reviews: fanfic.jobs.crawl_reviews(11360784) (7ab42a4d-8d11-412c-b87a-82896dac93e3)
22:35:43 reviews: Job OK (7ab42a4d-8d11-412c-b87a-82896dac93e3)
22:35:43 Result is kept for 500 seconds
22:35:43 
22:35:43 *** Listening on chapters, profiles, reviews...
22:35:43 reviews: fanfic.jobs.crawl_reviews(11361088) (206a4ede-de39-4562-a457-d744a67d575b)
22:35:57 reviews: Job OK (206a4ede-de39-4562-a457-d744a67d575b)
22:35:57 Result is kept for 500 seconds
22:35:57 
22:35:57 *** Listening on chapters, profiles, reviews...
22:35:57 reviews: fanfic.jobs.crawl_reviews(11361136) (3c3f7f3f-ee8b-45b5-89ba-75edc966cfc1)
22:36:09 reviews: Job OK (3c3f7f3f-ee8b-45b5-89ba-75edc966cfc1)
22:36:09 Result is kept for 500 seconds
22:36:09 
22:36:09 *** Listening on chapters, profiles, reviews...
22:36:09 reviews: fanfic.jobs.crawl_reviews(11363580) (8179195d-1813-4a70-af61-552d2a429737)
22:36:52 reviews: Job OK (8179195d-1813-4a70-af61-552d2a429737)
22:36:52 Result is kept for 500 seconds
22:36:52 
22:36:52 *** Listening on chapters, profiles, reviews...
22:36:52 reviews: fanfic.jobs.crawl_reviews(11363629) (206f5dc6-eff3-4270-a54a-7752f28782c7)
22:38:48 reviews: Job OK (206f5dc6-eff3-4270-a54a-7752f28782c7)
22:38:48 Result is kept for 500 seconds
22:38:48 
22:38:48 *** Listening on chapters, profiles, reviews...
22:38:48 reviews: fanfic.jobs.crawl_reviews(11364092) (1eeee511-1958-4974-a4a8-29753744c62b)
22:39:08 reviews: Job OK (1eeee511-1958-4974-a4a8-29753744c62b)
22:39:08 Result is kept for 500 seconds
22:39:09 
22:39:09 *** Listening on chapters, profiles, reviews...
22:39:09 reviews: fanfic.jobs.crawl_reviews(11364170) (65401c4e-a428-4117-9297-cad6cca6294c)
22:39:17 reviews: Job OK (65401c4e-a428-4117-9297-cad6cca6294c)
22:39:17 Result is kept for 500 seconds
22:39:17 
22:39:17 *** Listening on chapters, profiles, reviews...
22:39:17 reviews: fanfic.jobs.crawl_reviews(11364705) (e65970b3-3e7c-410d-b366-6793bb413545)
22:47:11 reviews: Job OK (e65970b3-3e7c-410d-b366-6793bb413545)
22:47:11 Result is kept for 500 seconds
22:47:11 
22:47:11 *** Listening on chapters, profiles, reviews...
22:47:11 reviews: fanfic.jobs.crawl_reviews(11364883) (e79db8dd-e761-434d-bc92-4161a251a728)
22:47:17 reviews: Job OK (e79db8dd-e761-434d-bc92-4161a251a728)
22:47:17 Result is kept for 500 seconds
22:47:17 
22:47:17 *** Listening on chapters, profiles, reviews...
22:47:17 reviews: fanfic.jobs.crawl_reviews(11365851) (e02182fa-5391-4fe4-8ac5-738e03fc1a89)
22:47:47 reviews: Job OK (e02182fa-5391-4fe4-8ac5-738e03fc1a89)
22:47:47 Result is kept for 500 seconds
22:47:47 
22:47:47 *** Listening on chapters, profiles, reviews...
22:47:47 reviews: fanfic.jobs.crawl_reviews(11366032) (39d6dbb7-f9ba-4643-a12c-72fa3cd587e7)
22:47:52 reviews: Job OK (39d6dbb7-f9ba-4643-a12c-72fa3cd587e7)
22:47:52 Result is kept for 500 seconds
22:47:52 
22:47:52 *** Listening on chapters, profiles, reviews...
22:47:52 reviews: fanfic.jobs.crawl_reviews(11368211) (1110f168-90bb-4a1d-8b25-c08684153981)
22:55:10 reviews: Job OK (1110f168-90bb-4a1d-8b25-c08684153981)
22:55:10 Result is kept for 500 seconds
22:55:10 
22:55:10 *** Listening on chapters, profiles, reviews...
22:55:10 reviews: fanfic.jobs.crawl_reviews(11369661) (8a4e01cb-56d3-4f62-bd68-3b011bae23f4)
22:55:53 reviews: Job OK (8a4e01cb-56d3-4f62-bd68-3b011bae23f4)
22:55:53 Result is kept for 500 seconds
22:55:53 
22:55:53 *** Listening on chapters, profiles, reviews...
22:55:53 reviews: fanfic.jobs.crawl_reviews(11370591) (e57c218f-1746-4c9e-b4fc-a6eb1e6f3d58)
22:55:58 reviews: Job OK (e57c218f-1746-4c9e-b4fc-a6eb1e6f3d58)
22:55:58 Result is kept for 500 seconds
22:55:58 
22:55:58 *** Listening on chapters, profiles, reviews...
22:55:58 reviews: fanfic.jobs.crawl_reviews(11370709) (bcd4ed9c-d184-4862-9d25-b1a14372cc3a)
22:57:00 reviews: Job OK (bcd4ed9c-d184-4862-9d25-b1a14372cc3a)
22:57:00 Result is kept for 500 seconds
22:57:00 
22:57:00 *** Listening on chapters, profiles, reviews...
22:57:00 reviews: fanfic.jobs.crawl_reviews(11371044) (795fa5a7-9c0a-4cc8-8d72-e98730f8a78c)
22:57:31 reviews: Job OK (795fa5a7-9c0a-4cc8-8d72-e98730f8a78c)
22:57:31 Result is kept for 500 seconds
22:57:31 
22:57:31 *** Listening on chapters, profiles, reviews...
22:57:31 reviews: fanfic.jobs.crawl_reviews(11372172) (718aa629-4915-4f9f-bd7d-c1e050219e25)
22:57:44 reviews: Job OK (718aa629-4915-4f9f-bd7d-c1e050219e25)
22:57:44 Result is kept for 500 seconds
22:57:44 
22:57:44 *** Listening on chapters, profiles, reviews...
22:57:44 reviews: fanfic.jobs.crawl_reviews(11374434) (a414e2fe-a785-4590-af8f-04341b32de3b)
22:57:52 reviews: Job OK (a414e2fe-a785-4590-af8f-04341b32de3b)
22:57:52 Result is kept for 500 seconds
22:57:52 
22:57:52 *** Listening on chapters, profiles, reviews...
22:57:52 reviews: fanfic.jobs.crawl_reviews(11374530) (9c133ca8-ef87-4c49-95f5-6d964ca39546)
2017-02-08 22:57:58 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 06:57:58.014470', 11374530, 226209203, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2193847&amp;r ... (1182 characters truncated) ... As the oldest brother, he is the perfect character to encourage Percy. <br>\n<br>\nPercy Weasley was the hero that no one expected.</div></td>\n</tr>'), ('2017-02-09 06:57:58.014474', 11374530, 226100324, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (739 characters truncated) ...  a bet and have to go with the next guy who ask her. She spend time with him and he act normal And slowly she fall In love with him</div></td>\n</tr>'), ('2017-02-09 06:57:58.014476', 11374530, 224916462, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2193847&amp;r ... (979 characters truncated) ... span> </small><div style="margin-top:5px">Very good chapter. I especially like your depictions of Mrs Delacour, Penny and Lockhart.</div></td>\n</tr>'), ('2017-02-09 06:57:58.014478', 11374530, 224594909, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2193847&amp;r ... (1199 characters truncated) ... cy have a good friendship. I like the way you are trying to balance out the character flaws JK Rowling burdened them with in canon.</div></td>\n</tr>'), ('2017-02-09 06:57:58.014480', 11374530, 223481303, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2193847&amp;r ... (1125 characters truncated) ... him the outcast of the family for no good reason. I like the way you explained the reasons for his character flaws in your fan fic.</div></td>\n</tr>'), ('2017-02-09 06:57:58.014482', 11374530, 223393292, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (747 characters truncated) ... A said that harry and Hermonie should get together but since she never read the books just the scrip, I don\'t care what she thinks</div></td>\n</tr>'), ('2017-02-09 06:57:58.014484', 11374530, 226209203, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2193847&amp;r ... (1182 characters truncated) ... As the oldest brother, he is the perfect character to encourage Percy. <br>\n<br>\nPercy Weasley was the hero that no one expected.</div></td>\n</tr>'), ('2017-02-09 06:57:58.014486', 11374530, 226100324, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (739 characters truncated) ...  a bet and have to go with the next guy who ask her. She spend time with him and he act normal And slowly she fall In love with him</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-09 06:57:58.014492', 11374530, 223481303, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2193847&amp;r ... (1125 characters truncated) ... him the outcast of the family for no good reason. I like the way you explained the reasons for his character flaws in your fan fic.</div></td>\n</tr>'), ('2017-02-09 06:57:58.014494', 11374530, 223393292, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (747 characters truncated) ... A said that harry and Hermonie should get together but since she never read the books just the scrip, I don\'t care what she thinks</div></td>\n</tr>'))]
22:57:58 reviews: Job OK (9c133ca8-ef87-4c49-95f5-6d964ca39546)
22:57:58 Result is kept for 500 seconds
22:57:58 
22:57:58 *** Listening on chapters, profiles, reviews...
22:57:58 reviews: fanfic.jobs.crawl_reviews(11375066) (e72868af-584e-42bc-bbf4-21e0fd2c11c2)
22:58:03 reviews: Job OK (e72868af-584e-42bc-bbf4-21e0fd2c11c2)
22:58:03 Result is kept for 500 seconds
22:58:03 
22:58:03 *** Listening on chapters, profiles, reviews...
22:58:03 reviews: fanfic.jobs.crawl_reviews(11375722) (ff3c1dbb-1014-43e9-97c2-d7cd23159fe1)
2017-02-08 22:58:09 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 06:58:09.292613', 11375722, 240879012, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (556 characters truncated) ... -xutime="1471570808">8/18/2016</span> </small><div style="margin-top:5px">I wasn\'t expecting that, this chapter was very capturing</div></td>\n</tr>'), ('2017-02-09 06:58:09.292617', 11375722, 239099673, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (557 characters truncated) ... xutime="1467842343">7/6/2016</span> </small><div style="margin-top:5px">Omg I love this ! Keep writing ! :) - Claire Potter-Malfoy.</div></td>\n</tr>'), ('2017-02-09 06:58:09.292619', 11375722, 232568176, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (542 characters truncated) ... 20 . <span data-xutime="1454384218">2/1/2016</span> </small><div style="margin-top:5px">So happy you updated! can\'t wait for more!</div></td>\n</tr>'), ('2017-02-09 06:58:09.292621', 11375722, 232556674, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (751 characters truncated) ... ser which is Claire Wilson. I love your YouTube ! It\'s cool that you actually have a YouTube account called Slitherin Forever ! :)</div></td>\n</tr>'), ('2017-02-09 06:58:09.292623', 11375722, 231146632, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5511310&amp;r ... (1442 characters truncated) ... and grammer mistakes in random places but can be sorted. Like my fics. Keep going im looking foward to the rest of it :)<br>\n-A xx</div></td>\n</tr>'), ('2017-02-09 06:58:09.292625', 11375722, 230874315, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (519 characters truncated) ... e="color:gray">chapter 18 . <span data-xutime="1451180539">12/26/2015</span> </small><div style="margin-top:5px">Really enjoying it</div></td>\n</tr>'), ('2017-02-09 06:58:09.292627', 11375722, 230874242, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (554 characters truncated) ... ata-xutime="1451180432">12/26/2015</span> </small><div style="margin-top:5px">I\'m glad you updated and I hope the end isn\'t soon.</div></td>\n</tr>'), ('2017-02-09 06:58:09.292629', 11375722, 226450544, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (598 characters truncated) ... all><div style="margin-top:5px">I liked the story line. Some spelling mistakes though. I\'m eagerly awaiting for the next chapters.</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-09 06:58:09.292669', 11375722, 223764829, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (907 characters truncated) ... he whole thing from my emotional reaction.<br>\nHoping Magie rebels, with Draco\'s help perhaps, and make her own way in the world.</div></td>\n</tr>'), ('2017-02-09 06:58:09.292670', 11375722, 223311958, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5511310&amp;r ... (947 characters truncated) ... e="1436736020">7/12/2015</span> </small><div style="margin-top:5px">Omg this is so cool! I love this. Also Pm me? Wee need to speak</div></td>\n</tr>'))]
22:58:09 reviews: Job OK (ff3c1dbb-1014-43e9-97c2-d7cd23159fe1)
22:58:09 Result is kept for 500 seconds
22:58:09 
22:58:09 *** Listening on chapters, profiles, reviews...
22:58:09 reviews: fanfic.jobs.crawl_reviews(11376514) (f26f6524-048c-4d78-9e4b-e16e756b9b1a)
22:58:53 reviews: Job OK (f26f6524-048c-4d78-9e4b-e16e756b9b1a)
22:58:53 Result is kept for 500 seconds
22:58:53 
22:58:53 *** Listening on chapters, profiles, reviews...
22:58:53 reviews: fanfic.jobs.crawl_reviews(11377120) (a6fdd33a-26e6-4b62-88d2-1833ac342b52)
23:00:03 reviews: Job OK (a6fdd33a-26e6-4b62-88d2-1833ac342b52)
23:00:03 Result is kept for 500 seconds
23:00:03 
23:00:03 *** Listening on chapters, profiles, reviews...
23:00:03 reviews: fanfic.jobs.crawl_reviews(11377655) (286e2af5-ca8b-4bf7-b66c-56019408dd7d)
23:00:31 reviews: Job OK (286e2af5-ca8b-4bf7-b66c-56019408dd7d)
23:00:31 Result is kept for 500 seconds
23:00:31 
23:00:31 *** Listening on chapters, profiles, reviews...
23:00:31 reviews: fanfic.jobs.crawl_reviews(11377880) (41043986-8771-4ce8-96ff-27a6b01b9a9d)
23:02:35 reviews: Job OK (41043986-8771-4ce8-96ff-27a6b01b9a9d)
23:02:35 Result is kept for 500 seconds
23:02:35 
23:02:35 *** Listening on chapters, profiles, reviews...
23:02:35 reviews: fanfic.jobs.crawl_reviews(11378626) (d1f24bdb-63bb-4c43-8a3e-a33a50e7cac6)
23:02:54 reviews: Job OK (d1f24bdb-63bb-4c43-8a3e-a33a50e7cac6)
23:02:54 Result is kept for 500 seconds
23:02:54 
23:02:54 *** Listening on chapters, profiles, reviews...
23:02:54 reviews: fanfic.jobs.crawl_reviews(11379661) (d40c1223-0eaa-408f-babb-e10401fbf965)
23:04:51 reviews: Job OK (d40c1223-0eaa-408f-babb-e10401fbf965)
23:04:51 Result is kept for 500 seconds
23:04:51 
23:04:51 *** Listening on chapters, profiles, reviews...
23:04:51 reviews: fanfic.jobs.crawl_reviews(11379882) (4fc4ec15-9ba1-45c9-b6dc-16cf01b1a94d)
23:07:45 reviews: Job OK (4fc4ec15-9ba1-45c9-b6dc-16cf01b1a94d)
23:07:45 Result is kept for 500 seconds
23:07:45 
23:07:45 *** Listening on chapters, profiles, reviews...
23:07:45 reviews: fanfic.jobs.crawl_reviews(11380141) (0b05a622-3fb3-4d2f-8a30-a2470c9d4fe8)
23:09:41 reviews: Job OK (0b05a622-3fb3-4d2f-8a30-a2470c9d4fe8)
23:09:41 Result is kept for 500 seconds
23:09:41 
23:09:41 *** Listening on chapters, profiles, reviews...
23:09:41 reviews: fanfic.jobs.crawl_reviews(11383357) (d4a0904e-0991-4074-aef3-870288d526ff)
2017-02-08 23:09:47 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 07:09:47.257367', 11383357, 237290802, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (615 characters truncated) ... rgin-top:5px">You have put a lot of thought and care into your plot and your characters but you need to seriously revise your story</div></td>\n</tr>'), ('2017-02-09 07:09:47.257371', 11383357, 237250628, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (521 characters truncated) ... olor:gray">chapter 2 . <span data-xutime="1463979626">5/22/2016</span> </small><div style="margin-top:5px">Ugh she\'s in gryffindor</div></td>\n</tr>'), ('2017-02-09 07:09:47.257373', 11383357, 235233106, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7485625&amp;r ... (870 characters truncated) ... 44186">4/3/2016</span> </small><div style="margin-top:5px">Her Imperial Majesty, the Grand Duchess, died at 17 and had no children.</div></td>\n</tr>'), ('2017-02-09 07:09:47.257375', 11383357, 235232939, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7485625&amp;r ... (944 characters truncated) ... jesty, the Grand Duchess, died at 17 and had no children.<br>\n<br>\nAlso, the word you were looking for was descendant, not decent</div></td>\n</tr>'), ('2017-02-09 07:09:47.257377', 11383357, 233347812, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4181992&amp;r ... (1004 characters truncated) ... but they\'re so confusing. Killing loving caring sadness for each other. They\'re like bipolar lol but I love it! Update more soon!</div></td>\n</tr>'), ('2017-02-09 07:09:47.257379', 11383357, 232978023, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7455308&amp;r ... (869 characters truncated) ... </small><div style="margin-top:5px">Yay another chapter! I loved Hogsmade though, that was a really cute moment with her and Draco.</div></td>\n</tr>'), ('2017-02-09 07:09:47.257381', 11383357, 232967230, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7281488&amp;r ... (888 characters truncated) ... ">chapter 23 . <span data-xutime="1455201547">2/11/2016</span> </small><div style="margin-top:5px">woww...amazing story. i love it.</div></td>\n</tr>'), ('2017-02-09 07:09:47.257383', 11383357, 232874245, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6743514&amp;r ... (873 characters truncated) ...  <small style="color:gray">chapter 21 . <span data-xutime="1455003298">2/8/2016</span> </small><div style="margin-top:5px">Love it!</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-09 07:09:47.257411', 11383357, 231782545, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4153212&amp;r ... (807 characters truncated) ... pter 16 . <span data-xutime="1452856058">1/15/2016</span> </small><div style="margin-top:5px">Ahhh I love so much need more please!</div></td>\n</tr>'), ('2017-02-09 07:09:47.257413', 11383357, 231040416, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (584 characters truncated) ... 5</span> </small><div style="margin-top:5px">HII This is such a well-written fanfiction with an interesting plot! Keep updating pls</div></td>\n</tr>'))]
23:09:47 reviews: Job OK (d4a0904e-0991-4074-aef3-870288d526ff)
23:09:47 Result is kept for 500 seconds
23:09:47 
23:09:47 *** Listening on chapters, profiles, reviews...
23:09:47 reviews: fanfic.jobs.crawl_reviews(11386343) (f12febf4-5c3b-403a-8386-ba7e46265ae7)
23:10:13 reviews: Job OK (f12febf4-5c3b-403a-8386-ba7e46265ae7)
23:10:13 Result is kept for 500 seconds
23:10:13 
23:10:13 *** Listening on chapters, profiles, reviews...
23:10:13 reviews: fanfic.jobs.crawl_reviews(11386502) (c1738687-de81-4356-8722-5be97c8f116f)
2017-02-08 23:10:18 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 07:10:18.738500', 11386502, 224550658, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6803217&amp;r ... (849 characters truncated) ... e="1438702857">8/4/2015</span> </small><div style="margin-top:5px">That poem is genius!I literally laughed out loud when I read it!</div></td>\n</tr>'), ('2017-02-09 07:10:18.738505', 11386502, 224550658, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6803217&amp;r ... (849 characters truncated) ... e="1438702857">8/4/2015</span> </small><div style="margin-top:5px">That poem is genius!I literally laughed out loud when I read it!</div></td>\n</tr>'))]
23:10:18 reviews: Job OK (c1738687-de81-4356-8722-5be97c8f116f)
23:10:18 Result is kept for 500 seconds
23:10:18 
23:10:18 *** Listening on chapters, profiles, reviews...
23:10:18 reviews: fanfic.jobs.crawl_reviews(11387753) (56d27c07-a66a-4239-8209-4e4f5a2ef810)
23:10:41 reviews: Job OK (56d27c07-a66a-4239-8209-4e4f5a2ef810)
23:10:41 Result is kept for 500 seconds
23:10:41 
23:10:41 *** Listening on chapters, profiles, reviews...
23:10:41 reviews: fanfic.jobs.crawl_reviews(11387778) (c7ba269c-3a8a-4ad7-bf2e-0fd0b90ab37b)
23:11:29 reviews: Job OK (c7ba269c-3a8a-4ad7-bf2e-0fd0b90ab37b)
23:11:29 Result is kept for 500 seconds
23:11:29 
23:11:29 *** Listening on chapters, profiles, reviews...
23:11:29 reviews: fanfic.jobs.crawl_reviews(11387795) (1d8ae561-313d-4d68-90f3-ac4bf8e8ca96)
23:11:59 reviews: Job OK (1d8ae561-313d-4d68-90f3-ac4bf8e8ca96)
23:11:59 Result is kept for 500 seconds
23:11:59 
23:11:59 *** Listening on chapters, profiles, reviews...
23:11:59 reviews: fanfic.jobs.crawl_reviews(11387987) (a6bafe46-c63f-4b55-82e1-ee3af694e9bd)
23:12:50 reviews: Job OK (a6bafe46-c63f-4b55-82e1-ee3af694e9bd)
23:12:50 Result is kept for 500 seconds
23:12:50 
23:12:50 *** Listening on chapters, profiles, reviews...
23:12:50 reviews: fanfic.jobs.crawl_reviews(11390494) (f14ef04f-61c8-4d33-a9d9-dcbd16dfd32f)
23:13:15 reviews: Job OK (f14ef04f-61c8-4d33-a9d9-dcbd16dfd32f)
23:13:15 Result is kept for 500 seconds
23:13:15 
23:13:15 *** Listening on chapters, profiles, reviews...
23:13:15 reviews: fanfic.jobs.crawl_reviews(11390810) (d80a81a6-544e-4f21-9805-06d49318a9be)
23:13:52 reviews: Job OK (d80a81a6-544e-4f21-9805-06d49318a9be)
23:13:52 Result is kept for 500 seconds
23:13:52 
23:13:52 *** Listening on chapters, profiles, reviews...
23:13:52 reviews: fanfic.jobs.crawl_reviews(11390857) (f8261ee3-7263-4811-9450-70e25250e716)
2017-02-08 23:13:57 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 07:13:57.766959', 11390857, 243064873, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (567 characters truncated) ... 774149">10/18/2016</span> </small><div style="margin-top:5px">Did you even read the last book? Griphook betrayed them in the vault.</div></td>\n</tr>'), ('2017-02-09 07:13:57.766964', 11390857, 243064872, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (540 characters truncated) ... 4 . <span data-xutime="1476739349">10/17/2016</span> </small><div style="margin-top:5px">WTH are you writing here in this chapter..</div></td>\n</tr>'), ('2017-02-09 07:13:57.766966', 11390857, 243064870, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (628 characters truncated) ... >So many extremely strange spelling issues.<br>\n<br>\nIt\'s Azkaban, Weasley(Wheasley..wtf), sword(sward?), Hermione(Herminie?)...</div></td>\n</tr>'), ('2017-02-09 07:13:57.766968', 11390857, 227494603, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7180033&amp;r ... (818 characters truncated) ... ray">chapter 16 . <span data-xutime="1444276440">10/7/2015</span> </small><div style="margin-top:5px">amasing. please udateret soon</div></td>\n</tr>'), ('2017-02-09 07:13:57.766970', 11390857, 223994189, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (825 characters truncated) ... 've read in some time. Very good reading. I wish I had another couple hours so I could finish it tonight but, alas, bed time comes.</div></td>\n</tr>'), ('2017-02-09 07:13:57.766972', 11390857, 243064873, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (567 characters truncated) ... 774149">10/18/2016</span> </small><div style="margin-top:5px">Did you even read the last book? Griphook betrayed them in the vault.</div></td>\n</tr>'), ('2017-02-09 07:13:57.766974', 11390857, 243064872, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (540 characters truncated) ... 4 . <span data-xutime="1476739349">10/17/2016</span> </small><div style="margin-top:5px">WTH are you writing here in this chapter..</div></td>\n</tr>'), ('2017-02-09 07:13:57.766976', 11390857, 243064870, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (628 characters truncated) ... >So many extremely strange spelling issues.<br>\n<br>\nIt\'s Azkaban, Weasley(Wheasley..wtf), sword(sward?), Hermione(Herminie?)...</div></td>\n</tr>'), ('2017-02-09 07:13:57.766978', 11390857, 227494603, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7180033&amp;r ... (818 characters truncated) ... ray">chapter 16 . <span data-xutime="1444276440">10/7/2015</span> </small><div style="margin-top:5px">amasing. please udateret soon</div></td>\n</tr>'), ('2017-02-09 07:13:57.766980', 11390857, 223994189, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (825 characters truncated) ... 've read in some time. Very good reading. I wish I had another couple hours so I could finish it tonight but, alas, bed time comes.</div></td>\n</tr>'))]
23:13:57 reviews: Job OK (f8261ee3-7263-4811-9450-70e25250e716)
23:13:57 Result is kept for 500 seconds
23:13:57 
23:13:57 *** Listening on chapters, profiles, reviews...
23:13:57 reviews: fanfic.jobs.crawl_reviews(11392492) (682b5707-2fe9-4c0f-b76d-4983ceca96ea)
23:14:20 reviews: Job OK (682b5707-2fe9-4c0f-b76d-4983ceca96ea)
23:14:20 Result is kept for 500 seconds
23:14:20 
23:14:20 *** Listening on chapters, profiles, reviews...
23:14:20 reviews: fanfic.jobs.crawl_reviews(11393204) (23ba23de-6a2d-48f2-8a77-601134475473)
23:15:03 reviews: Job OK (23ba23de-6a2d-48f2-8a77-601134475473)
23:15:03 Result is kept for 500 seconds
23:15:03 
23:15:03 *** Listening on chapters, profiles, reviews...
23:15:03 reviews: fanfic.jobs.crawl_reviews(11393515) (9fc2bf96-bc87-44eb-aa2e-8a534e7eef9d)
23:16:14 reviews: Job OK (9fc2bf96-bc87-44eb-aa2e-8a534e7eef9d)
23:16:14 Result is kept for 500 seconds
23:16:14 
23:16:14 *** Listening on chapters, profiles, reviews...
23:16:14 reviews: fanfic.jobs.crawl_reviews(11393887) (551c95f9-8c38-459a-ad60-1e6749b3ffb7)
23:16:33 reviews: Job OK (551c95f9-8c38-459a-ad60-1e6749b3ffb7)
23:16:33 Result is kept for 500 seconds
23:16:33 
23:16:33 *** Listening on chapters, profiles, reviews...
23:16:33 reviews: fanfic.jobs.crawl_reviews(11394118) (9d711529-92e1-4d2e-83b9-830a7cb9a4d6)
23:16:46 reviews: Job OK (9d711529-92e1-4d2e-83b9-830a7cb9a4d6)
23:16:46 Result is kept for 500 seconds
23:16:46 
23:16:46 *** Listening on chapters, profiles, reviews...
23:16:46 reviews: fanfic.jobs.crawl_reviews(11394636) (4385578d-6cb1-4768-aa9b-eb80832e6a3f)
2017-02-08 23:16:51 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 07:16:51.466263', 11394636, 230880100, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (940 characters truncated) ... lytherin he is the "prince" and if he doesn\'t comply malfoy can make hell for him while he stays at hogwarts really cunning of him</div></td>\n</tr>'), ('2017-02-09 07:16:51.466267', 11394636, 225206672, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (701 characters truncated) ... ng is okay but it is really spoilt by the bad grammer each chapter. Please get someone to edit it before you put it online, PLEASE.</div></td>\n</tr>'), ('2017-02-09 07:16:51.466270', 11394636, 225205349, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (672 characters truncated) ...  the terrible grammer and use of past and present text at the same time, would be a whole lot better if someone edited it properly.</div></td>\n</tr>'), ('2017-02-09 07:16:51.466272', 11394636, 224717045, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5195398&amp;r ... (1114 characters truncated) ... r end of reading quality on this website. Also maleOc represent... Liked it overall and am looking forward to reading the sequel :D</div></td>\n</tr>'), ('2017-02-09 07:16:51.466273', 11394636, 224580524, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5342773&amp;r ... (1034 characters truncated) ...  But I do wish Matt would stop taking crap from Draco... Hoping to see an update soon as I have been enjoying your writing so far;)</div></td>\n</tr>'), ('2017-02-09 07:16:51.466275', 11394636, 223882173, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5721416&amp;r ... (1571 characters truncated) ... everything that\'s going on to <br>\nbuild him up a little bit more as a character.<br>\nI look forward to reading what comes next.</div></td>\n</tr>'), ('2017-02-09 07:16:51.466277', 11394636, 230880100, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (940 characters truncated) ... lytherin he is the "prince" and if he doesn\'t comply malfoy can make hell for him while he stays at hogwarts really cunning of him</div></td>\n</tr>'), ('2017-02-09 07:16:51.466279', 11394636, 225206672, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (701 characters truncated) ... ng is okay but it is really spoilt by the bad grammer each chapter. Please get someone to edit it before you put it online, PLEASE.</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-09 07:16:51.466285', 11394636, 224580524, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5342773&amp;r ... (1034 characters truncated) ...  But I do wish Matt would stop taking crap from Draco... Hoping to see an update soon as I have been enjoying your writing so far;)</div></td>\n</tr>'), ('2017-02-09 07:16:51.466286', 11394636, 223882173, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5721416&amp;r ... (1571 characters truncated) ... everything that\'s going on to <br>\nbuild him up a little bit more as a character.<br>\nI look forward to reading what comes next.</div></td>\n</tr>'))]
23:16:51 reviews: Job OK (4385578d-6cb1-4768-aa9b-eb80832e6a3f)
23:16:51 Result is kept for 500 seconds
23:16:51 
23:16:51 *** Listening on chapters, profiles, reviews...
23:16:51 reviews: fanfic.jobs.crawl_reviews(11395728) (4614f1de-b796-42ed-8d9f-45a1908eb39e)
23:17:24 reviews: Job OK (4614f1de-b796-42ed-8d9f-45a1908eb39e)
23:17:24 Result is kept for 500 seconds
23:17:24 
23:17:24 *** Listening on chapters, profiles, reviews...
23:17:24 reviews: fanfic.jobs.crawl_reviews(11396307) (313958cb-0787-4603-9bb8-93c803795e71)
23:18:33 reviews: Job OK (313958cb-0787-4603-9bb8-93c803795e71)
23:18:33 Result is kept for 500 seconds
23:18:33 
23:18:33 *** Listening on chapters, profiles, reviews...
23:18:33 reviews: fanfic.jobs.crawl_reviews(11397225) (f4714d8d-2527-442a-a2f7-4692d3fa0103)
23:18:39 reviews: Job OK (f4714d8d-2527-442a-a2f7-4692d3fa0103)
23:18:39 Result is kept for 500 seconds
23:18:39 
23:18:39 *** Listening on chapters, profiles, reviews...
23:18:39 reviews: fanfic.jobs.crawl_reviews(11398850) (b766a334-77c1-4f45-8b8e-29f0c588b274)
23:18:50 reviews: Job OK (b766a334-77c1-4f45-8b8e-29f0c588b274)
23:18:50 Result is kept for 500 seconds
23:18:50 
23:18:50 *** Listening on chapters, profiles, reviews...
23:18:50 reviews: fanfic.jobs.crawl_reviews(11399532) (2f17eacb-aef3-4404-8f33-c5450533533b)
23:18:55 reviews: Job OK (2f17eacb-aef3-4404-8f33-c5450533533b)
23:18:55 Result is kept for 500 seconds
23:18:55 
23:18:55 *** Listening on chapters, profiles, reviews...
23:18:55 reviews: fanfic.jobs.crawl_reviews(11399565) (31d49b02-b504-4c07-8a65-754b75a7053a)
23:19:07 reviews: Job OK (31d49b02-b504-4c07-8a65-754b75a7053a)
23:19:07 Result is kept for 500 seconds
23:19:07 
23:19:07 *** Listening on chapters, profiles, reviews...
23:19:07 reviews: fanfic.jobs.crawl_reviews(11400746) (1a16da91-00e1-4e32-b631-3d2339b70f2e)
23:19:11 reviews: Job OK (1a16da91-00e1-4e32-b631-3d2339b70f2e)
23:19:11 Result is kept for 500 seconds
23:19:11 
23:19:11 *** Listening on chapters, profiles, reviews...
23:19:11 reviews: fanfic.jobs.crawl_reviews(11401618) (644d7942-5aac-474e-99cf-160e47762cf1)
23:19:37 reviews: Job OK (644d7942-5aac-474e-99cf-160e47762cf1)
23:19:37 Result is kept for 500 seconds
23:19:37 
23:19:37 *** Listening on chapters, profiles, reviews...
23:19:37 reviews: fanfic.jobs.crawl_reviews(11401654) (c7f2aced-7bd5-4bdf-b7bd-687d2b7579de)
23:20:18 reviews: Job OK (c7f2aced-7bd5-4bdf-b7bd-687d2b7579de)
23:20:18 Result is kept for 500 seconds
23:20:18 
23:20:18 *** Listening on chapters, profiles, reviews...
23:20:18 reviews: fanfic.jobs.crawl_reviews(11403013) (2286c76d-ba55-4d7d-af3a-c65d0ac460d3)
23:20:28 reviews: Job OK (2286c76d-ba55-4d7d-af3a-c65d0ac460d3)
23:20:28 Result is kept for 500 seconds
23:20:28 
23:20:28 *** Listening on chapters, profiles, reviews...
23:20:28 reviews: fanfic.jobs.crawl_reviews(11403360) (2300d689-d67d-4643-8601-c030606574f4)
23:20:48 reviews: Job OK (2300d689-d67d-4643-8601-c030606574f4)
23:20:48 Result is kept for 500 seconds
23:20:48 
23:20:48 *** Listening on chapters, profiles, reviews...
23:20:48 reviews: fanfic.jobs.crawl_reviews(11404889) (bbe07302-9125-4e48-94a5-4a0ca23c6882)
23:21:16 reviews: Job OK (bbe07302-9125-4e48-94a5-4a0ca23c6882)
23:21:16 Result is kept for 500 seconds
23:21:16 
23:21:16 *** Listening on chapters, profiles, reviews...
23:21:16 reviews: fanfic.jobs.crawl_reviews(11405322) (3c17994d-4ee0-42ab-a50f-346f26e73205)
23:21:31 reviews: Job OK (3c17994d-4ee0-42ab-a50f-346f26e73205)
23:21:31 Result is kept for 500 seconds
23:21:31 
23:21:31 *** Listening on chapters, profiles, reviews...
23:21:31 reviews: fanfic.jobs.crawl_reviews(11405690) (b69cca14-4468-4a96-ac3b-f48e5a8b182f)
23:21:58 reviews: Job OK (b69cca14-4468-4a96-ac3b-f48e5a8b182f)
23:21:58 Result is kept for 500 seconds
23:21:58 
23:21:58 *** Listening on chapters, profiles, reviews...
23:21:58 reviews: fanfic.jobs.crawl_reviews(11405852) (5471db2e-0198-41ed-8584-54f81377672d)
23:22:24 reviews: Job OK (5471db2e-0198-41ed-8584-54f81377672d)
23:22:24 Result is kept for 500 seconds
23:22:24 
23:22:24 *** Listening on chapters, profiles, reviews...
23:22:24 reviews: fanfic.jobs.crawl_reviews(11405877) (1a53c517-fa45-4845-8407-2473165e536a)
23:22:34 reviews: Job OK (1a53c517-fa45-4845-8407-2473165e536a)
23:22:34 Result is kept for 500 seconds
23:22:34 
23:22:34 *** Listening on chapters, profiles, reviews...
23:22:34 reviews: fanfic.jobs.crawl_reviews(11406001) (8f2f2120-5248-4451-a3c8-1e95d3230fb3)
23:23:36 reviews: Job OK (8f2f2120-5248-4451-a3c8-1e95d3230fb3)
23:23:36 Result is kept for 500 seconds
23:23:36 
23:23:36 *** Listening on chapters, profiles, reviews...
23:23:36 reviews: fanfic.jobs.crawl_reviews(11406907) (2860a963-0b3e-4c74-a547-c3f9967eca59)
23:23:48 reviews: Job OK (2860a963-0b3e-4c74-a547-c3f9967eca59)
23:23:48 Result is kept for 500 seconds
23:23:48 
23:23:48 *** Listening on chapters, profiles, reviews...
23:23:48 reviews: fanfic.jobs.crawl_reviews(11407475) (52ed1773-0a06-415f-b93b-410be602c2c8)
2017-02-08 23:23:49 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/11407475/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
23:23:49 reviews: Job OK (52ed1773-0a06-415f-b93b-410be602c2c8)
23:23:49 Result is kept for 500 seconds
23:23:49 
23:23:49 *** Listening on chapters, profiles, reviews...
23:23:49 reviews: fanfic.jobs.crawl_reviews(11408674) (0db07e0d-2736-4f16-9305-7db921677eb0)
2017-02-08 23:23:55 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 07:23:55.623900', 11408674, 246772442, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8216508&amp;r ... (1354 characters truncated) ...  adorable. A few spelling mistakes here and there but nothing too bad. Overall, I look forward to seeing how this story develops :)</div></td>\n</tr>'), ('2017-02-09 07:23:55.623904', 11408674, 245909290, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (542 characters truncated) ...  . <span data-xutime="1483790751">1/7</span> </small><div style="margin-top:5px">Just found this story, it is amazing. Keep writing</div></td>\n</tr>'), ('2017-02-09 07:23:55.623907', 11408674, 244595233, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5546608&amp;r ... (993 characters truncated) ... mall><div style="margin-top:5px">Aw cute -<br>\nI like this idea, I hope the rest of your story is as good as the first chapter! :3</div></td>\n</tr>'), ('2017-02-09 07:23:55.623909', 11408674, 238836938, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (517 characters truncated) ... mall style="color:gray">chapter 24 . <span data-xutime="1467127278">6/28/2016</span> </small><div style="margin-top:5px">Nice story</div></td>\n</tr>'), ('2017-02-09 07:23:55.623911', 11408674, 238058365, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7411886&amp;r ... (842 characters truncated) ... r 21 . <span data-xutime="1465698116">6/11/2016</span> </small><div style="margin-top:5px">I love love love this please update soon</div></td>\n</tr>'), ('2017-02-09 07:23:55.623913', 11408674, 246772442, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8216508&amp;r ... (1354 characters truncated) ...  adorable. A few spelling mistakes here and there but nothing too bad. Overall, I look forward to seeing how this story develops :)</div></td>\n</tr>'), ('2017-02-09 07:23:55.623915', 11408674, 245909290, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (542 characters truncated) ...  . <span data-xutime="1483790751">1/7</span> </small><div style="margin-top:5px">Just found this story, it is amazing. Keep writing</div></td>\n</tr>'), ('2017-02-09 07:23:55.623917', 11408674, 244595233, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5546608&amp;r ... (993 characters truncated) ... mall><div style="margin-top:5px">Aw cute -<br>\nI like this idea, I hope the rest of your story is as good as the first chapter! :3</div></td>\n</tr>'), ('2017-02-09 07:23:55.623919', 11408674, 238836938, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (517 characters truncated) ... mall style="color:gray">chapter 24 . <span data-xutime="1467127278">6/28/2016</span> </small><div style="margin-top:5px">Nice story</div></td>\n</tr>'), ('2017-02-09 07:23:55.623920', 11408674, 238058365, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7411886&amp;r ... (842 characters truncated) ... r 21 . <span data-xutime="1465698116">6/11/2016</span> </small><div style="margin-top:5px">I love love love this please update soon</div></td>\n</tr>'))]
23:23:55 reviews: Job OK (0db07e0d-2736-4f16-9305-7db921677eb0)
23:23:55 Result is kept for 500 seconds
23:23:55 
23:23:55 *** Listening on chapters, profiles, reviews...
23:23:55 reviews: fanfic.jobs.crawl_reviews(11409123) (3e2b0725-2090-4bc6-aa74-3207bd3b7597)
23:24:09 reviews: Job OK (3e2b0725-2090-4bc6-aa74-3207bd3b7597)
23:24:09 Result is kept for 500 seconds
23:24:09 
23:24:09 *** Listening on chapters, profiles, reviews...
23:24:09 reviews: fanfic.jobs.crawl_reviews(11411071) (e45919dc-3805-4725-a58c-d8a681bee6f8)
2017-02-08 23:24:15 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 07:24:15.591275', 11411071, 233994685, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7455308&amp;r ... (997 characters truncated) ... even though Draco is a Death-Eater. I hope you update again soon I love this fanfiction and really enjoy how it\'s going right now.</div></td>\n</tr>'), ('2017-02-09 07:24:15.591279', 11411071, 233914860, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2808951&amp;r ... (1147 characters truncated) ...  and I feel you\'ve done a great job writing Draco too... I really hope you finish this story, can\'t wait for the next chapter! :)</div></td>\n</tr>'), ('2017-02-09 07:24:15.591282', 11411071, 232073412, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (744 characters truncated) ... ot in a bad why<br>\nwhich makes her very interesting, so hope you will update soon, cause really <br>\nwant to see next chapter X3</div></td>\n</tr>'), ('2017-02-09 07:24:15.591284', 11411071, 225898117, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (924 characters truncated) ... le="color:gray">chapter 9 . <span data-xutime="1441040664">8/31/2015</span> </small><div style="margin-top:5px">ooh the embrassment</div></td>\n</tr>'), ('2017-02-09 07:24:15.591286', 11411071, 225553232, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (914 characters truncated) ... <small style="color:gray">chapter 7 . <span data-xutime="1440422056">8/24/2015</span> </small><div style="margin-top:5px">ooh lefay</div></td>\n</tr>'), ('2017-02-09 07:24:15.591288', 11411071, 224853596, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6186295&amp;r ... (932 characters truncated) ... <span data-xutime="1439210108">8/10/2015</span> </small><div style="margin-top:5px">Awesome, like every other chapter. Poor Hagrid.</div></td>\n</tr>'), ('2017-02-09 07:24:15.591290', 11411071, 233994685, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7455308&amp;r ... (997 characters truncated) ... even though Draco is a Death-Eater. I hope you update again soon I love this fanfiction and really enjoy how it\'s going right now.</div></td>\n</tr>'), ('2017-02-09 07:24:15.591292', 11411071, 233914860, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2808951&amp;r ... (1147 characters truncated) ...  and I feel you\'ve done a great job writing Draco too... I really hope you finish this story, can\'t wait for the next chapter! :)</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-09 07:24:15.591297', 11411071, 225553232, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (914 characters truncated) ... <small style="color:gray">chapter 7 . <span data-xutime="1440422056">8/24/2015</span> </small><div style="margin-top:5px">ooh lefay</div></td>\n</tr>'), ('2017-02-09 07:24:15.591299', 11411071, 224853596, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6186295&amp;r ... (932 characters truncated) ... <span data-xutime="1439210108">8/10/2015</span> </small><div style="margin-top:5px">Awesome, like every other chapter. Poor Hagrid.</div></td>\n</tr>'))]
23:24:15 reviews: Job OK (e45919dc-3805-4725-a58c-d8a681bee6f8)
23:24:15 Result is kept for 500 seconds
23:24:15 
23:24:15 *** Listening on chapters, profiles, reviews...
23:24:15 reviews: fanfic.jobs.crawl_reviews(11411281) (bed45c64-e841-4173-abcb-eac5269b16cf)
23:24:20 reviews: Job OK (bed45c64-e841-4173-abcb-eac5269b16cf)
23:24:20 Result is kept for 500 seconds
23:24:20 
23:24:20 *** Listening on chapters, profiles, reviews...
23:24:20 reviews: fanfic.jobs.crawl_reviews(11412580) (bafe2ae3-7af7-4941-a18a-0319b2fef578)
23:26:39 reviews: Job OK (bafe2ae3-7af7-4941-a18a-0319b2fef578)
23:26:39 Result is kept for 500 seconds
23:26:39 
23:26:39 *** Listening on chapters, profiles, reviews...
23:26:39 reviews: fanfic.jobs.crawl_reviews(11416177) (550858e6-3458-4cf3-b8ab-c1c507b83027)
23:31:46 reviews: Job OK (550858e6-3458-4cf3-b8ab-c1c507b83027)
23:31:46 Result is kept for 500 seconds
23:31:46 
23:31:46 *** Listening on chapters, profiles, reviews...
23:31:46 reviews: fanfic.jobs.crawl_reviews(11416974) (c5f57727-e086-4187-b88c-776fa5fdea53)
23:32:01 reviews: Job OK (c5f57727-e086-4187-b88c-776fa5fdea53)
23:32:01 Result is kept for 500 seconds
23:32:01 
23:32:01 *** Listening on chapters, profiles, reviews...
23:32:01 reviews: fanfic.jobs.crawl_reviews(11417542) (b6e3d310-6fdc-4fc7-ab09-af1c4f119c4d)
23:32:09 reviews: Job OK (b6e3d310-6fdc-4fc7-ab09-af1c4f119c4d)
23:32:09 Result is kept for 500 seconds
23:32:09 
23:32:09 *** Listening on chapters, profiles, reviews...
23:32:09 reviews: fanfic.jobs.crawl_reviews(11417551) (fa0162b4-f175-4313-b720-da16792308a1)
23:37:11 reviews: Job OK (fa0162b4-f175-4313-b720-da16792308a1)
23:37:11 Result is kept for 500 seconds
23:37:11 Cleaning registries for queue: chapters
23:37:11 Cleaning registries for queue: profiles
23:37:11 Cleaning registries for queue: reviews
23:37:11 
23:37:11 *** Listening on chapters, profiles, reviews...
23:37:11 reviews: fanfic.jobs.crawl_reviews(11418202) (26c26ff8-a9ac-4398-890e-dd5494b61898)
23:38:13 reviews: Job OK (26c26ff8-a9ac-4398-890e-dd5494b61898)
23:38:13 Result is kept for 500 seconds
23:38:13 
23:38:13 *** Listening on chapters, profiles, reviews...
23:38:13 reviews: fanfic.jobs.crawl_reviews(11418593) (dc116b81-8e62-47c3-bcdd-3c39f6cdc53b)
23:38:49 reviews: Job OK (dc116b81-8e62-47c3-bcdd-3c39f6cdc53b)
23:38:49 Result is kept for 500 seconds
23:38:49 
23:38:49 *** Listening on chapters, profiles, reviews...
23:38:49 reviews: fanfic.jobs.crawl_reviews(11418714) (92a49778-d351-4e50-9360-c8fda67983ab)
23:40:17 reviews: Job OK (92a49778-d351-4e50-9360-c8fda67983ab)
23:40:17 Result is kept for 500 seconds
23:40:17 
23:40:17 *** Listening on chapters, profiles, reviews...
23:40:17 reviews: fanfic.jobs.crawl_reviews(11418764) (12711874-e83d-4aa3-a1d9-e4934b7bf342)
23:40:34 reviews: Job OK (12711874-e83d-4aa3-a1d9-e4934b7bf342)
23:40:34 Result is kept for 500 seconds
23:40:34 
23:40:34 *** Listening on chapters, profiles, reviews...
23:40:34 reviews: fanfic.jobs.crawl_reviews(11419408) (278af7b7-7398-4048-b575-79c31435e9ad)
23:41:41 reviews: Job OK (278af7b7-7398-4048-b575-79c31435e9ad)
23:41:41 Result is kept for 500 seconds
23:41:41 
23:41:41 *** Listening on chapters, profiles, reviews...
23:41:41 reviews: fanfic.jobs.crawl_reviews(11419898) (6c5e2047-b25c-4922-8a77-993db1870550)
23:42:30 reviews: Job OK (6c5e2047-b25c-4922-8a77-993db1870550)
23:42:30 Result is kept for 500 seconds
23:42:30 
23:42:30 *** Listening on chapters, profiles, reviews...
23:42:30 reviews: fanfic.jobs.crawl_reviews(11420222) (f45bb5c3-2a5f-4747-a066-1576066c57db)
23:44:44 reviews: Job OK (f45bb5c3-2a5f-4747-a066-1576066c57db)
23:44:44 Result is kept for 500 seconds
23:44:44 
23:44:44 *** Listening on chapters, profiles, reviews...
23:44:44 reviews: fanfic.jobs.crawl_reviews(11420434) (daf5d076-cc58-43f7-ab72-2b2e113bba7c)
23:47:35 reviews: Job OK (daf5d076-cc58-43f7-ab72-2b2e113bba7c)
23:47:35 Result is kept for 500 seconds
23:47:35 
23:47:35 *** Listening on chapters, profiles, reviews...
23:47:35 reviews: fanfic.jobs.crawl_reviews(11420452) (4b29870f-be88-4f10-8463-9bd52e8d3552)
23:49:20 reviews: Job OK (4b29870f-be88-4f10-8463-9bd52e8d3552)
23:49:20 Result is kept for 500 seconds
23:49:20 
23:49:20 *** Listening on chapters, profiles, reviews...
23:49:20 reviews: fanfic.jobs.crawl_reviews(11420492) (98a6f41a-67c4-4c95-a8e9-ab67ad64b786)
23:49:27 reviews: Job OK (98a6f41a-67c4-4c95-a8e9-ab67ad64b786)
23:49:27 Result is kept for 500 seconds
23:49:27 
23:49:27 *** Listening on chapters, profiles, reviews...
23:49:27 reviews: fanfic.jobs.crawl_reviews(11420609) (1e2daabf-920e-4506-bf1b-8c1dc2deb5e8)
23:50:26 reviews: Job OK (1e2daabf-920e-4506-bf1b-8c1dc2deb5e8)
23:50:26 Result is kept for 500 seconds
23:50:26 
23:50:26 *** Listening on chapters, profiles, reviews...
23:50:26 reviews: fanfic.jobs.crawl_reviews(11420732) (6fd11958-f5b9-4783-b8ec-41bc9a9bd8e4)
23:50:41 reviews: Job OK (6fd11958-f5b9-4783-b8ec-41bc9a9bd8e4)
23:50:41 Result is kept for 500 seconds
23:50:41 
23:50:41 *** Listening on chapters, profiles, reviews...
23:50:41 reviews: fanfic.jobs.crawl_reviews(11423589) (f22fb983-85d6-4367-8267-58b702a527c0)
23:50:50 reviews: Job OK (f22fb983-85d6-4367-8267-58b702a527c0)
23:50:50 Result is kept for 500 seconds
23:50:50 
23:50:50 *** Listening on chapters, profiles, reviews...
23:50:50 reviews: fanfic.jobs.crawl_reviews(11428699) (e28f0fe0-bb0a-459b-b1b9-c923a42fa10c)
23:51:11 reviews: Job OK (e28f0fe0-bb0a-459b-b1b9-c923a42fa10c)
23:51:11 Result is kept for 500 seconds
23:51:11 
23:51:11 *** Listening on chapters, profiles, reviews...
23:51:11 reviews: fanfic.jobs.crawl_reviews(11429036) (0e2e268e-7f67-4b4f-8fa1-5bef96a60017)
23:51:47 reviews: Job OK (0e2e268e-7f67-4b4f-8fa1-5bef96a60017)
23:51:47 Result is kept for 500 seconds
23:51:47 
23:51:47 *** Listening on chapters, profiles, reviews...
23:51:47 reviews: fanfic.jobs.crawl_reviews(11429632) (b3455f3e-219f-47ae-8410-9186ab053356)
23:52:21 reviews: Job OK (b3455f3e-219f-47ae-8410-9186ab053356)
23:52:21 Result is kept for 500 seconds
23:52:21 
23:52:21 *** Listening on chapters, profiles, reviews...
23:52:21 reviews: fanfic.jobs.crawl_reviews(11430526) (10cf0ac4-8c2e-4993-a596-e8082e1e31b3)
23:53:57 reviews: Job OK (10cf0ac4-8c2e-4993-a596-e8082e1e31b3)
23:53:57 Result is kept for 500 seconds
23:53:57 
23:53:57 *** Listening on chapters, profiles, reviews...
23:53:57 reviews: fanfic.jobs.crawl_reviews(11432620) (88ed4b23-a335-4d9e-8c9c-48239484d8fd)
23:54:01 reviews: Job OK (88ed4b23-a335-4d9e-8c9c-48239484d8fd)
23:54:01 Result is kept for 500 seconds
23:54:01 
23:54:01 *** Listening on chapters, profiles, reviews...
23:54:01 reviews: fanfic.jobs.crawl_reviews(11433924) (09b5fc71-4c63-4e48-9095-bafb6330bec1)
23:54:31 reviews: Job OK (09b5fc71-4c63-4e48-9095-bafb6330bec1)
23:54:31 Result is kept for 500 seconds
23:54:31 
23:54:31 *** Listening on chapters, profiles, reviews...
23:54:31 reviews: fanfic.jobs.crawl_reviews(11434139) (c756d84b-1251-4ed4-ba27-22137eaf05c8)
23:59:28 reviews: Job OK (c756d84b-1251-4ed4-ba27-22137eaf05c8)
23:59:28 Result is kept for 500 seconds
23:59:28 
23:59:28 *** Listening on chapters, profiles, reviews...
23:59:28 reviews: fanfic.jobs.crawl_reviews(11434291) (2cfb093e-6742-4170-9a62-749a069b894c)
23:59:59 reviews: Job OK (2cfb093e-6742-4170-9a62-749a069b894c)
23:59:59 Result is kept for 500 seconds
23:59:59 
23:59:59 *** Listening on chapters, profiles, reviews...
23:59:59 reviews: fanfic.jobs.crawl_reviews(11434552) (1ffb4391-3e2f-423b-9a9d-44c002f63f98)
00:00:07 reviews: Job OK (1ffb4391-3e2f-423b-9a9d-44c002f63f98)
00:00:07 Result is kept for 500 seconds
00:00:07 
00:00:07 *** Listening on chapters, profiles, reviews...
00:00:07 reviews: fanfic.jobs.crawl_reviews(11434785) (027fdab7-652d-4557-9dca-6d0a992b2fc9)
00:00:17 reviews: Job OK (027fdab7-652d-4557-9dca-6d0a992b2fc9)
00:00:17 Result is kept for 500 seconds
00:00:17 
00:00:17 *** Listening on chapters, profiles, reviews...
00:00:17 reviews: fanfic.jobs.crawl_reviews(11435028) (68bd5a95-b418-45fa-a4dd-4b25d0388edd)
00:00:50 reviews: Job OK (68bd5a95-b418-45fa-a4dd-4b25d0388edd)
00:00:50 Result is kept for 500 seconds
00:00:50 
00:00:50 *** Listening on chapters, profiles, reviews...
00:00:50 reviews: fanfic.jobs.crawl_reviews(11435565) (070aa469-55f3-4652-951c-c79149ea803c)
00:01:14 reviews: Job OK (070aa469-55f3-4652-951c-c79149ea803c)
00:01:14 Result is kept for 500 seconds
00:01:14 
00:01:14 *** Listening on chapters, profiles, reviews...
00:01:14 reviews: fanfic.jobs.crawl_reviews(11435571) (99009442-e60f-41ec-9b71-8590eebcc218)
00:01:23 reviews: Job OK (99009442-e60f-41ec-9b71-8590eebcc218)
00:01:23 Result is kept for 500 seconds
00:01:23 
00:01:23 *** Listening on chapters, profiles, reviews...
00:01:23 reviews: fanfic.jobs.crawl_reviews(11435898) (7029a87b-64a2-4333-b71a-c408d2474310)
00:02:24 reviews: Job OK (7029a87b-64a2-4333-b71a-c408d2474310)
00:02:24 Result is kept for 500 seconds
00:02:24 
00:02:24 *** Listening on chapters, profiles, reviews...
00:02:24 reviews: fanfic.jobs.crawl_reviews(11436927) (d3962985-6e7d-4959-a2f0-ab1ea3d5f964)
00:03:00 reviews: Job OK (d3962985-6e7d-4959-a2f0-ab1ea3d5f964)
00:03:00 Result is kept for 500 seconds
00:03:00 
00:03:00 *** Listening on chapters, profiles, reviews...
00:03:00 reviews: fanfic.jobs.crawl_reviews(11437132) (f68fd43e-501f-4cec-875b-966a6c0e57ee)
00:03:15 reviews: Job OK (f68fd43e-501f-4cec-875b-966a6c0e57ee)
00:03:15 Result is kept for 500 seconds
00:03:15 
00:03:15 *** Listening on chapters, profiles, reviews...
00:03:15 reviews: fanfic.jobs.crawl_reviews(11437380) (9672810e-9711-401a-b984-31c32e9b9b2b)
00:04:19 reviews: Job OK (9672810e-9711-401a-b984-31c32e9b9b2b)
00:04:19 Result is kept for 500 seconds
00:04:19 
00:04:19 *** Listening on chapters, profiles, reviews...
00:04:19 reviews: fanfic.jobs.crawl_reviews(11437578) (ab5587e6-a244-47de-9d3e-0a48666f2da4)
00:04:34 reviews: Job OK (ab5587e6-a244-47de-9d3e-0a48666f2da4)
00:04:34 Result is kept for 500 seconds
00:04:34 
00:04:34 *** Listening on chapters, profiles, reviews...
00:04:34 reviews: fanfic.jobs.crawl_reviews(11437703) (e39665b2-9f56-40ca-99f5-170ef7742e18)
00:04:58 reviews: Job OK (e39665b2-9f56-40ca-99f5-170ef7742e18)
00:04:58 Result is kept for 500 seconds
00:04:58 
00:04:58 *** Listening on chapters, profiles, reviews...
00:04:58 reviews: fanfic.jobs.crawl_reviews(11437810) (5a16c6e2-ef46-4328-9e55-e5f34e348660)
00:06:40 reviews: Job OK (5a16c6e2-ef46-4328-9e55-e5f34e348660)
00:06:40 Result is kept for 500 seconds
00:06:40 
00:06:40 *** Listening on chapters, profiles, reviews...
00:06:40 reviews: fanfic.jobs.crawl_reviews(11439537) (dd12b0e6-dffb-417a-963c-ed3b42193c80)
00:07:30 reviews: Job OK (dd12b0e6-dffb-417a-963c-ed3b42193c80)
00:07:30 Result is kept for 500 seconds
00:07:30 
00:07:30 *** Listening on chapters, profiles, reviews...
00:07:30 reviews: fanfic.jobs.crawl_reviews(11439594) (8fb93596-ccaa-42b1-a7bc-f0baba1ee16d)
Unhandled Error
Traceback (most recent call last):
  File "./fanfic/jobs.py", line 35, in crawl_reviews
    crawl('review', book_id)
  File "./fanfic/jobs.py", line 20, in crawl
    proc.start()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/crawler.py", line 280, in start
    reactor.run(installSignalHandlers=False)  # blocking call
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/base.py", line 1199, in run
    self.mainLoop()
--- <exception caught here> ---
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/base.py", line 1211, in mainLoop
    self.doIteration(t)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/selectreactor.py", line 103, in doSelect
    [], timeout)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/rq/timeouts.py", line 51, in handle_death_penalty
    'value ({0} seconds)'.format(self._timeout))
rq.timeouts.JobTimeoutException: Job exceeded maximum timeout value (3600 seconds)

2017-02-09 01:07:30 [twisted] CRITICAL: Unhandled Error
Traceback (most recent call last):
  File "./fanfic/jobs.py", line 35, in crawl_reviews
    crawl('review', book_id)
  File "./fanfic/jobs.py", line 20, in crawl
    proc.start()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/crawler.py", line 280, in start
    reactor.run(installSignalHandlers=False)  # blocking call
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/base.py", line 1199, in run
    self.mainLoop()
--- <exception caught here> ---
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/base.py", line 1211, in mainLoop
    self.doIteration(t)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/selectreactor.py", line 103, in doSelect
    [], timeout)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/rq/timeouts.py", line 51, in handle_death_penalty
    'value ({0} seconds)'.format(self._timeout))
rq.timeouts.JobTimeoutException: Job exceeded maximum timeout value (3600 seconds)

02:27:47 reviews: Job OK (8fb93596-ccaa-42b1-a7bc-f0baba1ee16d)
02:27:47 Result is kept for 500 seconds
02:27:47 Cleaning registries for queue: chapters
02:27:47 Cleaning registries for queue: profiles
02:27:47 Cleaning registries for queue: reviews
02:27:47 
02:27:47 *** Listening on chapters, profiles, reviews...
02:27:47 reviews: fanfic.jobs.crawl_reviews(11440530) (1f7075f7-5128-4eab-bad3-e04b1eca158b)
02:28:00 reviews: Job OK (1f7075f7-5128-4eab-bad3-e04b1eca158b)
02:28:00 Result is kept for 500 seconds
02:28:00 
02:28:00 *** Listening on chapters, profiles, reviews...
02:28:00 reviews: fanfic.jobs.crawl_reviews(11441564) (448b4ede-ee01-4f16-9310-1b4ab8bce7b2)
02:28:08 reviews: Job OK (448b4ede-ee01-4f16-9310-1b4ab8bce7b2)
02:28:08 Result is kept for 500 seconds
02:28:08 
02:28:08 *** Listening on chapters, profiles, reviews...
02:28:08 reviews: fanfic.jobs.crawl_reviews(11443535) (1e3e7468-25b9-46c8-a539-d819ed7c2922)
02:28:53 reviews: Job OK (1e3e7468-25b9-46c8-a539-d819ed7c2922)
02:28:53 Result is kept for 500 seconds
02:28:53 
02:28:53 *** Listening on chapters, profiles, reviews...
02:28:53 reviews: fanfic.jobs.crawl_reviews(11444872) (ea258b8d-91f8-4228-91ad-759cf0dcee1c)
2017-02-09 02:28:58 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 10:28:58.305951', 11444872, 244349739, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6917667&amp;r ... (925 characters truncated) ... data-xutime="1480172831">11/26/2016</span> </small><div style="margin-top:5px">Wow this is great. Love, love, love all the updates!</div></td>\n</tr>'), ('2017-02-09 10:28:58.305955', 11444872, 230297132, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6917667&amp;r ... (962 characters truncated) ... span> </small><div style="margin-top:5px">Omg. MAJOR plot twist. How can you expect my heart to live through something like this ?!</div></td>\n</tr>'), ('2017-02-09 10:28:58.305958', 11444872, 228846073, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7206034&amp;r ... (925 characters truncated) ... s you are doing please don\'t stop any chance you can shorten the time between each chapter but keep the chapter the same length :)</div></td>\n</tr>'), ('2017-02-09 10:28:58.305960', 11444872, 228171453, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6917667&amp;r ... (1164 characters truncated) ... ed one more story to earn my beta status. I think it would be less pressure to do a double story. Plus we would both get more views</div></td>\n</tr>'), ('2017-02-09 10:28:58.305962', 11444872, 228106581, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6917667&amp;r ... (1243 characters truncated) ...  and she could get embarrassed. I dont mind if don\'t like it but it was just an idea. I\'d love to work with you on anything else.</div></td>\n</tr>'), ('2017-02-09 10:28:58.305964', 11444872, 228001360, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6917667&amp;r ... (1083 characters truncated) ... ays I really love this and I don\'t want you to stop writing it like ever. I love Remus and Red and I don\'t want them to break up.</div></td>\n</tr>'), ('2017-02-09 10:28:58.305965', 11444872, 227902312, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7210945&amp;r ... (838 characters truncated) ... ="1445114364">10/17/2015</span> </small><div style="margin-top:5px">the date was good even if you haven\'t experienced one yourself</div></td>\n</tr>'), ('2017-02-09 10:28:58.305967', 11444872, 227670699, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7206034&amp;r ... (906 characters truncated) ... ice, ive been reading this story for a few hours now got up to chapter 8 and I like it a lot please continue doing this I enjoy it.</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-09 10:28:58.306000', 11444872, 227014444, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6931325&amp;r ... (784 characters truncated) ...   <small style="color:gray">chapter 16 . <span data-xutime="1443311985">9/26/2015</span> </small><div style="margin-top:5px">Awwwww</div></td>\n</tr>'), ('2017-02-09 10:28:58.306001', 11444872, 225432778, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (506 characters truncated) ... <small style="color:gray">chapter 8 . <span data-xutime="1440039481">8/19/2015</span> </small><div style="margin-top:5px">cute cute</div></td>\n</tr>'))]
02:28:58 reviews: Job OK (ea258b8d-91f8-4228-91ad-759cf0dcee1c)
02:28:58 Result is kept for 500 seconds
02:28:58 
02:28:58 *** Listening on chapters, profiles, reviews...
02:28:58 reviews: fanfic.jobs.crawl_reviews(11444909) (4e31ea87-fa2f-473e-b553-10a745ead627)
02:29:16 reviews: Job OK (4e31ea87-fa2f-473e-b553-10a745ead627)
02:29:16 Result is kept for 500 seconds
02:29:16 
02:29:16 *** Listening on chapters, profiles, reviews...
02:29:16 reviews: fanfic.jobs.crawl_reviews(11445115) (d59b0539-812b-4026-892c-bd3a2bd9f870)
02:29:22 reviews: Job OK (d59b0539-812b-4026-892c-bd3a2bd9f870)
02:29:22 Result is kept for 500 seconds
02:29:22 
02:29:22 *** Listening on chapters, profiles, reviews...
02:29:22 reviews: fanfic.jobs.crawl_reviews(11445761) (947a1170-3017-436f-964c-bcd873ec0bb9)
02:30:40 reviews: Job OK (947a1170-3017-436f-964c-bcd873ec0bb9)
02:30:40 Result is kept for 500 seconds
02:30:40 
02:30:40 *** Listening on chapters, profiles, reviews...
02:30:40 reviews: fanfic.jobs.crawl_reviews(11446957) (13833281-632a-4973-a48a-8db42bfc1a42)
03:11:37 reviews: Job OK (13833281-632a-4973-a48a-8db42bfc1a42)
03:11:37 Result is kept for 500 seconds
03:11:37 
03:11:37 *** Listening on chapters, profiles, reviews...
03:11:37 reviews: fanfic.jobs.crawl_reviews(11446989) (252495b2-6efd-4f1b-9565-e9b17920cb00)
2017-02-09 03:11:43 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 11:11:43.150570', 11446989, 240403387, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5195398&amp;r ... (970 characters truncated) ... 552743">8/6/2016</span> </small><div style="margin-top:5px">I ship theomatt . I don\'t care if the grass is greener with Daphne. :)</div></td>\n</tr>'), ('2017-02-09 11:11:43.150574', 11446989, 240015142, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5195398&amp;r ... (961 characters truncated) ... me="1469728505">7/28/2016</span> </small><div style="margin-top:5px">Yay it\'s back! :) I\'ll make sure to check your other updates</div></td>\n</tr>'), ('2017-02-09 11:11:43.150577', 11446989, 230847546, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5195398&amp;r ... (935 characters truncated) ... hapter 8 . <span data-xutime="1451129354">12/26/2015</span> </small><div style="margin-top:5px">Thanks for the Christmas present :)</div></td>\n</tr>'), ('2017-02-09 11:11:43.150579', 11446989, 226015958, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6607010&amp;r ... (1103 characters truncated) ... tely addicted to this series, now. The best thing about it is that there\'s a MALE OC- Matthias is so cool- Good luck with writing.</div></td>\n</tr>'), ('2017-02-09 11:11:43.150581', 11446989, 225704018, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (548 characters truncated) ... n data-xutime="1440691479">8/27/2015</span> </small><div style="margin-top:5px">Please update soon, I\'m really enjoying the series</div></td>\n</tr>'), ('2017-02-09 11:11:43.150582', 11446989, 225094898, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5195398&amp;r ... (924 characters truncated) ... lor:gray">chapter 2 . <span data-xutime="1439646524">8/15/2015</span> </small><div style="margin-top:5px">It\'s up already. Yay! :)</div></td>\n</tr>'), ('2017-02-09 11:11:43.150584', 11446989, 240403387, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5195398&amp;r ... (970 characters truncated) ... 552743">8/6/2016</span> </small><div style="margin-top:5px">I ship theomatt . I don\'t care if the grass is greener with Daphne. :)</div></td>\n</tr>'), ('2017-02-09 11:11:43.150586', 11446989, 240015142, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5195398&amp;r ... (961 characters truncated) ... me="1469728505">7/28/2016</span> </small><div style="margin-top:5px">Yay it\'s back! :) I\'ll make sure to check your other updates</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-09 11:11:43.150592', 11446989, 225704018, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (548 characters truncated) ... n data-xutime="1440691479">8/27/2015</span> </small><div style="margin-top:5px">Please update soon, I\'m really enjoying the series</div></td>\n</tr>'), ('2017-02-09 11:11:43.150594', 11446989, 225094898, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5195398&amp;r ... (924 characters truncated) ... lor:gray">chapter 2 . <span data-xutime="1439646524">8/15/2015</span> </small><div style="margin-top:5px">It\'s up already. Yay! :)</div></td>\n</tr>'))]
03:11:43 reviews: Job OK (252495b2-6efd-4f1b-9565-e9b17920cb00)
03:11:43 Result is kept for 500 seconds
03:11:43 
03:11:43 *** Listening on chapters, profiles, reviews...
03:11:43 reviews: fanfic.jobs.crawl_reviews(11447025) (a88ff57c-4283-4461-ba9d-57cda604b6d9)
03:12:21 reviews: Job OK (a88ff57c-4283-4461-ba9d-57cda604b6d9)
03:12:21 Result is kept for 500 seconds
03:12:21 
03:12:21 *** Listening on chapters, profiles, reviews...
03:12:21 reviews: fanfic.jobs.crawl_reviews(11447544) (1a425b67-7397-4975-b549-cc5d7cfc41ab)
03:12:55 reviews: Job OK (1a425b67-7397-4975-b549-cc5d7cfc41ab)
03:12:55 Result is kept for 500 seconds
03:12:55 
03:12:55 *** Listening on chapters, profiles, reviews...
03:12:55 reviews: fanfic.jobs.crawl_reviews(11448437) (1d2dae78-7707-488e-a5b6-2535f5afc81d)
03:13:10 reviews: Job OK (1d2dae78-7707-488e-a5b6-2535f5afc81d)
03:13:10 Result is kept for 500 seconds
03:13:10 
03:13:10 *** Listening on chapters, profiles, reviews...
03:13:10 reviews: fanfic.jobs.crawl_reviews(11448506) (353f1a80-7484-44f2-8e48-1b37d61c4d73)
03:15:26 reviews: Job OK (353f1a80-7484-44f2-8e48-1b37d61c4d73)
03:15:26 Result is kept for 500 seconds
03:15:26 
03:15:26 *** Listening on chapters, profiles, reviews...
03:15:26 reviews: fanfic.jobs.crawl_reviews(11448997) (15fce395-8f81-46a2-aa4d-a40232f6bfd5)
03:17:29 reviews: Job OK (15fce395-8f81-46a2-aa4d-a40232f6bfd5)
03:17:29 Result is kept for 500 seconds
03:17:29 
03:17:29 *** Listening on chapters, profiles, reviews...
03:17:29 reviews: fanfic.jobs.crawl_reviews(11449153) (4625e6c5-7997-42e8-b550-31102f9a6fcc)
03:17:34 reviews: Job OK (4625e6c5-7997-42e8-b550-31102f9a6fcc)
03:17:34 Result is kept for 500 seconds
03:17:34 
03:17:34 *** Listening on chapters, profiles, reviews...
03:17:34 reviews: fanfic.jobs.crawl_reviews(11450622) (01124908-dd71-42c6-a4e4-feb1f262f260)
03:18:56 reviews: Job OK (01124908-dd71-42c6-a4e4-feb1f262f260)
03:18:56 Result is kept for 500 seconds
03:18:56 
03:18:56 *** Listening on chapters, profiles, reviews...
03:18:56 reviews: fanfic.jobs.crawl_reviews(11451888) (b364e034-bc5b-4f61-a1a0-3fcd766dde6a)
03:19:04 reviews: Job OK (b364e034-bc5b-4f61-a1a0-3fcd766dde6a)
03:19:04 Result is kept for 500 seconds
03:19:04 
03:19:04 *** Listening on chapters, profiles, reviews...
03:19:04 reviews: fanfic.jobs.crawl_reviews(11452174) (6d7595b2-08e2-4315-bc35-08edb1d0d39a)
03:20:32 reviews: Job OK (6d7595b2-08e2-4315-bc35-08edb1d0d39a)
03:20:32 Result is kept for 500 seconds
03:20:32 
03:20:32 *** Listening on chapters, profiles, reviews...
03:20:32 reviews: fanfic.jobs.crawl_reviews(11452292) (0c5175b1-433e-4f12-8841-2379f7f8d894)
03:20:41 reviews: Job OK (0c5175b1-433e-4f12-8841-2379f7f8d894)
03:20:41 Result is kept for 500 seconds
03:20:41 
03:20:41 *** Listening on chapters, profiles, reviews...
03:20:41 reviews: fanfic.jobs.crawl_reviews(11452361) (99f029e5-b56b-405c-a7b6-3b4f8cc6a856)
03:21:47 reviews: Job OK (99f029e5-b56b-405c-a7b6-3b4f8cc6a856)
03:21:47 Result is kept for 500 seconds
03:21:47 
03:21:47 *** Listening on chapters, profiles, reviews...
03:21:47 reviews: fanfic.jobs.crawl_reviews(11452657) (82c9b144-198b-4372-a9a0-0e23683b0fca)
03:22:00 reviews: Job OK (82c9b144-198b-4372-a9a0-0e23683b0fca)
03:22:00 Result is kept for 500 seconds
03:22:00 
03:22:00 *** Listening on chapters, profiles, reviews...
03:22:00 reviews: fanfic.jobs.crawl_reviews(11453335) (5e363af1-fe87-4d1c-b33c-814566d51926)
03:24:01 reviews: Job OK (5e363af1-fe87-4d1c-b33c-814566d51926)
03:24:01 Result is kept for 500 seconds
03:24:01 
03:24:01 *** Listening on chapters, profiles, reviews...
03:24:01 reviews: fanfic.jobs.crawl_reviews(11454710) (2894a106-137b-4399-9fe8-9ebc9c4905e4)
2017-02-09 03:24:06 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 11:24:06.993631', 11454710, 236018567, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2369253&amp;r ... (1056 characters truncated) ... ing the spelling and grammatical errors, this is one of the best stories I\'ve read. Please continue soon, I\'m dying to read more!</div></td>\n</tr>'), ('2017-02-09 11:24:06.993635', 11454710, 226045256, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (868 characters truncated) ... ll style="color:gray">chapter 9 . <span data-xutime="1441409866">9/4/2015</span> </small><div style="margin-top:5px">Great chapter.</div></td>\n</tr>'), ('2017-02-09 11:24:06.993638', 11454710, 225951176, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6984899&amp;r ... (795 characters truncated) ... or:gray">chapter 8 . <span data-xutime="1441228192">9/2/2015</span> </small><div style="margin-top:5px">More please. I can\'t wait.</div></td>\n</tr>'), ('2017-02-09 11:24:06.993640', 11454710, 225950957, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6984899&amp;r ... (871 characters truncated) ... <div style="margin-top:5px">I just can\'t stop reading this. It was the same with prophecy. I would sit and read and read and read.</div></td>\n</tr>'), ('2017-02-09 11:24:06.993642', 11454710, 225950757, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6984899&amp;r ... (822 characters truncated) ... data-xutime="1441227665">9/2/2015</span> </small><div style="margin-top:5px">Loved Prophecy. I\'m sure i\'ll love this one as well.</div></td>\n</tr>'), ('2017-02-09 11:24:06.993644', 11454710, 225641192, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (868 characters truncated) ... ll style="color:gray">chapter 8 . <span data-xutime="1440569236">8/25/2015</span> </small><div style="margin-top:5px">Great chapter</div></td>\n</tr>'), ('2017-02-09 11:24:06.993646', 11454710, 225429778, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (868 characters truncated) ... ll style="color:gray">chapter 7 . <span data-xutime="1440209151">8/21/2015</span> </small><div style="margin-top:5px">Great chapter</div></td>\n</tr>'), ('2017-02-09 11:24:06.993648', 11454710, 225382870, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (868 characters truncated) ... ll style="color:gray">chapter 6 . <span data-xutime="1440125780">8/20/2015</span> </small><div style="margin-top:5px">Great chapter</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-09 11:24:06.993669', 11454710, 225324876, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (865 characters truncated) ... small style="color:gray">chapter 5 . <span data-xutime="1440025224">8/19/2015</span> </small><div style="margin-top:5px">Hmmmmmm...</div></td>\n</tr>'), ('2017-02-09 11:24:06.993670', 11454710, 225319159, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2954381&amp;r ... (868 characters truncated) ... ll style="color:gray">chapter 4 . <span data-xutime="1440016926">8/19/2015</span> </small><div style="margin-top:5px">Great chapter</div></td>\n</tr>'))]
03:24:07 reviews: Job OK (2894a106-137b-4399-9fe8-9ebc9c4905e4)
03:24:07 Result is kept for 500 seconds
03:24:07 
03:24:07 *** Listening on chapters, profiles, reviews...
03:24:07 reviews: fanfic.jobs.crawl_reviews(11454917) (9dab7314-5688-46d5-a1e8-5f367de24d2d)
03:26:02 reviews: Job OK (9dab7314-5688-46d5-a1e8-5f367de24d2d)
03:26:02 Result is kept for 500 seconds
03:26:02 
03:26:02 *** Listening on chapters, profiles, reviews...
03:26:02 reviews: fanfic.jobs.crawl_reviews(11455847) (071064e7-3ae6-433c-81f5-e3febd8d5806)
03:26:34 reviews: Job OK (071064e7-3ae6-433c-81f5-e3febd8d5806)
03:26:34 Result is kept for 500 seconds
03:26:34 
03:26:34 *** Listening on chapters, profiles, reviews...
03:26:34 reviews: fanfic.jobs.crawl_reviews(11457470) (398b0a9c-eca1-4b95-88f4-e05b790a24e2)
03:27:35 reviews: Job OK (398b0a9c-eca1-4b95-88f4-e05b790a24e2)
03:27:35 Result is kept for 500 seconds
03:27:35 
03:27:35 *** Listening on chapters, profiles, reviews...
03:27:35 reviews: fanfic.jobs.crawl_reviews(11458795) (41e1aa22-307d-444e-8c18-59a30e9c30d8)
03:27:48 reviews: Job OK (41e1aa22-307d-444e-8c18-59a30e9c30d8)
03:27:48 Result is kept for 500 seconds
03:27:48 Cleaning registries for queue: chapters
03:27:48 Cleaning registries for queue: profiles
03:27:48 Cleaning registries for queue: reviews
03:27:48 
03:27:48 *** Listening on chapters, profiles, reviews...
03:27:48 reviews: fanfic.jobs.crawl_reviews(11459184) (c036a408-569c-4d54-89a5-3013edeec83c)
03:28:22 reviews: Job OK (c036a408-569c-4d54-89a5-3013edeec83c)
03:28:22 Result is kept for 500 seconds
03:28:22 
03:28:22 *** Listening on chapters, profiles, reviews...
03:28:22 reviews: fanfic.jobs.crawl_reviews(11459481) (bf02fc0e-4147-4eaf-b899-715c93a841da)
03:28:32 reviews: Job OK (bf02fc0e-4147-4eaf-b899-715c93a841da)
03:28:32 Result is kept for 500 seconds
03:28:32 
03:28:32 *** Listening on chapters, profiles, reviews...
03:28:32 reviews: fanfic.jobs.crawl_reviews(11460211) (6f92198d-011d-4225-944e-e83909b8546a)
03:28:40 reviews: Job OK (6f92198d-011d-4225-944e-e83909b8546a)
03:28:40 Result is kept for 500 seconds
03:28:40 
03:28:40 *** Listening on chapters, profiles, reviews...
03:28:40 reviews: fanfic.jobs.crawl_reviews(11460322) (01fba1fb-2f1f-4f8b-bf13-f1eb04609d8f)
03:29:10 reviews: Job OK (01fba1fb-2f1f-4f8b-bf13-f1eb04609d8f)
03:29:10 Result is kept for 500 seconds
03:29:10 
03:29:10 *** Listening on chapters, profiles, reviews...
03:29:10 reviews: fanfic.jobs.crawl_reviews(11461552) (be5ab989-0e3f-415e-939c-b7c0b9ac6966)
03:29:47 reviews: Job OK (be5ab989-0e3f-415e-939c-b7c0b9ac6966)
03:29:47 Result is kept for 500 seconds
03:29:47 
03:29:47 *** Listening on chapters, profiles, reviews...
03:29:47 reviews: fanfic.jobs.crawl_reviews(11463030) (11fe1258-db04-4792-bdbb-bef212305044)
03:39:01 reviews: Job OK (11fe1258-db04-4792-bdbb-bef212305044)
03:39:01 Result is kept for 500 seconds
03:39:01 
03:39:01 *** Listening on chapters, profiles, reviews...
03:39:01 reviews: fanfic.jobs.crawl_reviews(11463504) (38a37aff-28af-4ba9-92e0-ffd6738d01ef)
03:39:40 reviews: Job OK (38a37aff-28af-4ba9-92e0-ffd6738d01ef)
03:39:40 Result is kept for 500 seconds
03:39:40 
03:39:40 *** Listening on chapters, profiles, reviews...
03:39:40 reviews: fanfic.jobs.crawl_reviews(11463785) (f3e15518-4e48-45c5-89ee-2102dbaad8db)
03:40:05 reviews: Job OK (f3e15518-4e48-45c5-89ee-2102dbaad8db)
03:40:05 Result is kept for 500 seconds
03:40:05 
03:40:05 *** Listening on chapters, profiles, reviews...
03:40:05 reviews: fanfic.jobs.crawl_reviews(11465654) (bc6d8301-22d4-41d6-846e-dd52a860e733)
2017-02-09 03:40:11 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 11:40:11.033120', 11465654, 231755440, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1612180&amp;r ... (924 characters truncated) ... -xutime="1452802086">1/14/2016</span> </small><div style="margin-top:5px">I apologize for my last review but I do enjoy your story.</div></td>\n</tr>'), ('2017-02-09 11:40:11.033127', 11465654, 231598870, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1612180&amp;r ... (880 characters truncated) ... ll style="color:gray">chapter 1 . <span data-xutime="1452484378">1/10/2016</span> </small><div style="margin-top:5px">v kf y .yhgbb</div></td>\n</tr>'), ('2017-02-09 11:40:11.033129', 11465654, 231755440, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1612180&amp;r ... (924 characters truncated) ... -xutime="1452802086">1/14/2016</span> </small><div style="margin-top:5px">I apologize for my last review but I do enjoy your story.</div></td>\n</tr>'), ('2017-02-09 11:40:11.033131', 11465654, 231598870, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1612180&amp;r ... (880 characters truncated) ... ll style="color:gray">chapter 1 . <span data-xutime="1452484378">1/10/2016</span> </small><div style="margin-top:5px">v kf y .yhgbb</div></td>\n</tr>'))]
03:40:11 reviews: Job OK (bc6d8301-22d4-41d6-846e-dd52a860e733)
03:40:11 Result is kept for 500 seconds
03:40:11 
03:40:11 *** Listening on chapters, profiles, reviews...
03:40:11 reviews: fanfic.jobs.crawl_reviews(11466846) (f1790f1e-40a1-4e06-840c-ba1ee64e2d5f)
03:41:49 reviews: Job OK (f1790f1e-40a1-4e06-840c-ba1ee64e2d5f)
03:41:49 Result is kept for 500 seconds
03:41:49 
03:41:49 *** Listening on chapters, profiles, reviews...
03:41:49 reviews: fanfic.jobs.crawl_reviews(11468033) (260b793d-6978-4456-9170-6684e60c8289)
03:42:08 reviews: Job OK (260b793d-6978-4456-9170-6684e60c8289)
03:42:08 Result is kept for 500 seconds
03:42:08 
03:42:08 *** Listening on chapters, profiles, reviews...
03:42:08 reviews: fanfic.jobs.crawl_reviews(11468883) (30ae5d76-e6f3-4cf3-8322-894c091a7fb2)
03:43:06 reviews: Job OK (30ae5d76-e6f3-4cf3-8322-894c091a7fb2)
03:43:06 Result is kept for 500 seconds
03:43:06 
03:43:06 *** Listening on chapters, profiles, reviews...
03:43:06 reviews: fanfic.jobs.crawl_reviews(11469628) (29a02060-c851-46db-90dd-27d3a8ef2384)
03:43:10 reviews: Job OK (29a02060-c851-46db-90dd-27d3a8ef2384)
03:43:10 Result is kept for 500 seconds
03:43:10 
03:43:10 *** Listening on chapters, profiles, reviews...
03:43:10 reviews: fanfic.jobs.crawl_reviews(11469683) (325e3b26-66f4-473c-9fce-051db207a631)
03:44:01 reviews: Job OK (325e3b26-66f4-473c-9fce-051db207a631)
03:44:01 Result is kept for 500 seconds
03:44:01 
03:44:01 *** Listening on chapters, profiles, reviews...
03:44:01 reviews: fanfic.jobs.crawl_reviews(11470789) (7bcc6ac3-f376-4ad6-b503-4f1925616ba9)
2017-02-09 03:44:05 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 11:44:05.952407', 11470789, 226379516, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7126186&amp;r ... (835 characters truncated) ... y">chapter 12 . <span data-xutime="1442056907">9/12/2015</span> </small><div style="margin-top:5px">this was long, but really good!</div></td>\n</tr>'), ('2017-02-09 11:44:05.952411', 11470789, 226313320, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (561 characters truncated) ... e="1441744228">9/8/2015</span> </small><div style="margin-top:5px">Omg pleasee update xx im obsessed with this fabulous story xxxxx</div></td>\n</tr>'), ('2017-02-09 11:44:05.952414', 11470789, 226221074, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7098884&amp;r ... (1052 characters truncated) ... n who knew James inside out, and anyone who knows James that well wouldn\'t do something like that. Instead, he\'d do the opposite.</div></td>\n</tr>'), ('2017-02-09 11:44:05.952416', 11470789, 226220714, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7098884&amp;r ... (996 characters truncated) ... s for my story the same way, but then it didn\'t fit...anyway, I loved your story. I love Lily. Can\'t wait for more of James/Lily.</div></td>\n</tr>'), ('2017-02-09 11:44:05.952418', 11470789, 226154067, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6541025&amp;r ... (845 characters truncated) ... pan data-xutime="1441605808">9/6/2015</span> </small><div style="margin-top:5px">I love this story as much as Lily will love James!</div></td>\n</tr>'), ('2017-02-09 11:44:05.952420', 11470789, 225886300, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6757318&amp;r ... (1021 characters truncated) ... x">I love this story! Read it loads. You seem to have the same ideas and fantasies. Lets be friends we seem to like the same stuff.</div></td>\n</tr>'), ('2017-02-09 11:44:05.952421', 11470789, 225796483, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6541025&amp;r ... (1130 characters truncated) ... any terrible, terrible fanfics that this was a welcome change. I am glad to have found such a good piece of writing. Keep updating!</div></td>\n</tr>'), ('2017-02-09 11:44:05.952423', 11470789, 225786174, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6951810&amp;r ... (1016 characters truncated) ... d Jk rowlings permission and wrote a book. I would\'ve. Bought every book starting from year 1 (you should add one like year 1- 7 )</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-09 11:44:05.952450', 11470789, 225652617, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6541025&amp;r ... (851 characters truncated) ... a-xutime="1440596503">8/26/2015</span> </small><div style="margin-top:5px">:\')<br>\nThe all changed and sensible James is so good!</div></td>\n</tr>'), ('2017-02-09 11:44:05.952452', 11470789, 225640559, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6541025&amp;r ... (849 characters truncated) ... ata-xutime="1440568099">8/25/2015</span> </small><div style="margin-top:5px">Really liked this one! Update asap. Totally following.</div></td>\n</tr>'))]
03:44:05 reviews: Job OK (7bcc6ac3-f376-4ad6-b503-4f1925616ba9)
03:44:05 Result is kept for 500 seconds
03:44:05 
03:44:05 *** Listening on chapters, profiles, reviews...
03:44:05 reviews: fanfic.jobs.crawl_reviews(11472121) (5da4dc66-396d-4192-8a2c-e9f151df0c76)
03:44:26 reviews: Job OK (5da4dc66-396d-4192-8a2c-e9f151df0c76)
03:44:26 Result is kept for 500 seconds
03:44:26 
03:44:26 *** Listening on chapters, profiles, reviews...
03:44:26 reviews: fanfic.jobs.crawl_reviews(11473188) (cb9f1158-79fe-4f85-a67d-e4b775366a58)
03:45:22 reviews: Job OK (cb9f1158-79fe-4f85-a67d-e4b775366a58)
03:45:22 Result is kept for 500 seconds
03:45:22 
03:45:22 *** Listening on chapters, profiles, reviews...
03:45:22 reviews: fanfic.jobs.crawl_reviews(11474840) (913dd703-964c-45dc-bd3e-15d83805e4e6)
03:46:16 reviews: Job OK (913dd703-964c-45dc-bd3e-15d83805e4e6)
03:46:16 Result is kept for 500 seconds
03:46:16 
03:46:16 *** Listening on chapters, profiles, reviews...
03:46:16 reviews: fanfic.jobs.crawl_reviews(11475075) (bf4b90de-73f1-4996-af35-63427a4079ec)
2017-02-09 03:46:20 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 11:46:20.543600', 11475075, 243375357, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (670 characters truncated) ... f your story doesn\'t upload properly and is unreadable? Might explain why you only have 2 reviews and it\'s sad you never noticed.</div></td>\n</tr>'), ('2017-02-09 11:46:20.543604', 11475075, 229913098, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4574373&amp;r ... (985 characters truncated) ... -xutime="1449231795">12/4/2015</span> </small><div style="margin-top:5px">I love love LOVE it! Keep writing I can\'t wait for more!</div></td>\n</tr>'), ('2017-02-09 11:46:20.543606', 11475075, 225886074, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (602 characters truncated) ... iv style="margin-top:5px">Eh, you have some spelling mistakes that you should fix. Also, there\'s no \'e\' at the end of Voldemort.</div></td>\n</tr>'), ('2017-02-09 11:46:20.543608', 11475075, 243375357, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (670 characters truncated) ... f your story doesn\'t upload properly and is unreadable? Might explain why you only have 2 reviews and it\'s sad you never noticed.</div></td>\n</tr>'), ('2017-02-09 11:46:20.543610', 11475075, 229913098, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4574373&amp;r ... (985 characters truncated) ... -xutime="1449231795">12/4/2015</span> </small><div style="margin-top:5px">I love love LOVE it! Keep writing I can\'t wait for more!</div></td>\n</tr>'), ('2017-02-09 11:46:20.543612', 11475075, 225886074, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (602 characters truncated) ... iv style="margin-top:5px">Eh, you have some spelling mistakes that you should fix. Also, there\'s no \'e\' at the end of Voldemort.</div></td>\n</tr>'))]
03:46:20 reviews: Job OK (bf4b90de-73f1-4996-af35-63427a4079ec)
03:46:20 Result is kept for 500 seconds
03:46:20 
03:46:20 *** Listening on chapters, profiles, reviews...
03:46:20 reviews: fanfic.jobs.crawl_reviews(11475566) (2883f470-ea57-4401-ae48-5381268cbd4b)
03:46:34 reviews: Job OK (2883f470-ea57-4401-ae48-5381268cbd4b)
03:46:34 Result is kept for 500 seconds
03:46:34 
03:46:34 *** Listening on chapters, profiles, reviews...
03:46:34 reviews: fanfic.jobs.crawl_reviews(11476481) (8857bcb0-8fb8-42e0-aba3-0ca62487ba6f)
03:46:53 reviews: Job OK (8857bcb0-8fb8-42e0-aba3-0ca62487ba6f)
03:46:53 Result is kept for 500 seconds
03:46:53 
03:46:53 *** Listening on chapters, profiles, reviews...
03:46:53 reviews: fanfic.jobs.crawl_reviews(11476491) (4926c697-6db9-439e-9791-e9c5180e2de9)
03:52:05 reviews: Job OK (4926c697-6db9-439e-9791-e9c5180e2de9)
03:52:05 Result is kept for 500 seconds
03:52:05 
03:52:05 *** Listening on chapters, profiles, reviews...
03:52:05 reviews: fanfic.jobs.crawl_reviews(11476656) (9a296efb-2b70-4abf-8505-182b7531d13a)
2017-02-09 03:52:10 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 11:52:10.753763', 11476656, 240749272, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6451776&amp;r ... (831 characters truncated) ... pan data-xutime="1471291533">8/15/2016</span> </small><div style="margin-top:5px">nice y1 twice now. plz post more n more d best :)</div></td>\n</tr>'), ('2017-02-09 11:52:10.753767', 11476656, 240699624, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (899 characters truncated) ... style="color:gray">chapter 21 . <span data-xutime="1471190989">8/14/2016</span> </small><div style="margin-top:5px">nice scoreboard</div></td>\n</tr>'), ('2017-02-09 11:52:10.753770', 11476656, 237137868, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7508054&amp;r ... (959 characters truncated) ... e first part was epic, too! Great work! Keep it up! I know you\'re busy, but can you try to update frequently? No pressure, though!</div></td>\n</tr>'), ('2017-02-09 11:52:10.753772', 11476656, 230413012, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4002445&amp;r ... (1047 characters truncated) ... is the year that James and Sirius find out about Remus\'s transformation that that\'ll certainly be great to see and how they react</div></td>\n</tr>'), ('2017-02-09 11:52:10.753774', 11476656, 230412669, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4002445&amp;r ... (1258 characters truncated) ... oming officially a couple in their seventh year I think it was. You should update twice a week if possible but it\'s not a big deal</div></td>\n</tr>'), ('2017-02-09 11:52:10.753776', 11476656, 229462032, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7248930&amp;r ... (1121 characters truncated) ... I have quite enjoyed what I have read so far. Probably one of the best Marauder fanfics I\'ve read in fact. Keep up the great work!</div></td>\n</tr>'), ('2017-02-09 11:52:10.753777', 11476656, 228196781, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6953255&amp;r ... (924 characters truncated) ... NG! I read the whole first one yesterday and finished these chapters today! I hope you update soon, because you have got me hooked!</div></td>\n</tr>'), ('2017-02-09 11:52:10.753779', 11476656, 227283936, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1417056&amp;r ... (1097 characters truncated) ... ating horcruxes? Curious about his relationship with sons of salazar...<br>\n<br>\nI will wait patiently for james\' appearance :))</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-09 11:52:10.753800', 11476656, 226673763, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5696337&amp;r ... (1047 characters truncated) ... ay is more Kreacher/Dumbledore love scenes. I like the badass grandpa Dumbledore. But more Kreacher/Dumbledore lemons slash please.</div></td>\n</tr>'), ('2017-02-09 11:52:10.753801', 11476656, 226672812, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (578 characters truncated) ... 8/2015</span> </small><div style="margin-top:5px">Really like this story, esp chapter 1.<br>\nCan\'t wait for james\' appearance :)</div></td>\n</tr>'))]
03:52:10 reviews: Job OK (9a296efb-2b70-4abf-8505-182b7531d13a)
03:52:10 Result is kept for 500 seconds
03:52:10 
03:52:10 *** Listening on chapters, profiles, reviews...
03:52:10 reviews: fanfic.jobs.crawl_reviews(11478357) (4b749b43-67db-49a6-b418-d5ce6f7a5612)
03:52:27 reviews: Job OK (4b749b43-67db-49a6-b418-d5ce6f7a5612)
03:52:27 Result is kept for 500 seconds
03:52:27 
03:52:27 *** Listening on chapters, profiles, reviews...
03:52:27 reviews: fanfic.jobs.crawl_reviews(11478858) (65332a7b-e694-4b78-a230-e08e8a59568c)
03:52:55 reviews: Job OK (65332a7b-e694-4b78-a230-e08e8a59568c)
03:52:55 Result is kept for 500 seconds
03:52:55 
03:52:55 *** Listening on chapters, profiles, reviews...
03:52:55 reviews: fanfic.jobs.crawl_reviews(11479106) (ef3ff9e9-40f3-4443-83b5-773e8dd0c984)
03:54:09 reviews: Job OK (ef3ff9e9-40f3-4443-83b5-773e8dd0c984)
03:54:09 Result is kept for 500 seconds
03:54:09 
03:54:09 *** Listening on chapters, profiles, reviews...
03:54:09 reviews: fanfic.jobs.crawl_reviews(11480024) (2cf979a6-ef29-41a6-bb2a-8f34e703a6f8)
03:55:13 reviews: Job OK (2cf979a6-ef29-41a6-bb2a-8f34e703a6f8)
03:55:13 Result is kept for 500 seconds
03:55:13 
03:55:13 *** Listening on chapters, profiles, reviews...
03:55:13 reviews: fanfic.jobs.crawl_reviews(11480678) (6b5d2c55-5954-48d2-b7c6-98dbd6a3ce03)
03:55:29 reviews: Job OK (6b5d2c55-5954-48d2-b7c6-98dbd6a3ce03)
03:55:29 Result is kept for 500 seconds
03:55:29 
03:55:29 *** Listening on chapters, profiles, reviews...
03:55:29 reviews: fanfic.jobs.crawl_reviews(11480714) (aa887c22-c5e7-40a3-a654-4a439490be16)
03:56:36 reviews: Job OK (aa887c22-c5e7-40a3-a654-4a439490be16)
03:56:36 Result is kept for 500 seconds
03:56:36 
03:56:36 *** Listening on chapters, profiles, reviews...
03:56:36 reviews: fanfic.jobs.crawl_reviews(11481524) (46e2e1fe-48b6-4bd6-902d-4dbd124a987d)
03:56:41 reviews: Job OK (46e2e1fe-48b6-4bd6-902d-4dbd124a987d)
03:56:41 Result is kept for 500 seconds
03:56:41 
03:56:41 *** Listening on chapters, profiles, reviews...
03:56:41 reviews: fanfic.jobs.crawl_reviews(11482672) (a5e0380c-1e61-4c9a-81a2-a277e144853e)
03:59:27 reviews: Job OK (a5e0380c-1e61-4c9a-81a2-a277e144853e)
03:59:27 Result is kept for 500 seconds
03:59:27 
03:59:27 *** Listening on chapters, profiles, reviews...
03:59:27 reviews: fanfic.jobs.crawl_reviews(11483509) (d0cafc08-d644-4edf-a7b2-76e00781b001)
03:59:42 reviews: Job OK (d0cafc08-d644-4edf-a7b2-76e00781b001)
03:59:42 Result is kept for 500 seconds
03:59:42 
03:59:42 *** Listening on chapters, profiles, reviews...
03:59:42 reviews: fanfic.jobs.crawl_reviews(11483591) (a070884e-44b9-41bd-aa1f-f34fbc22dc22)
04:00:14 reviews: Job OK (a070884e-44b9-41bd-aa1f-f34fbc22dc22)
04:00:14 Result is kept for 500 seconds
04:00:14 
04:00:14 *** Listening on chapters, profiles, reviews...
04:00:14 reviews: fanfic.jobs.crawl_reviews(11483648) (83cc7be0-6c26-46d9-a4c0-cb0a836d2148)
04:01:15 reviews: Job OK (83cc7be0-6c26-46d9-a4c0-cb0a836d2148)
04:01:15 Result is kept for 500 seconds
04:01:15 
04:01:15 *** Listening on chapters, profiles, reviews...
04:01:15 reviews: fanfic.jobs.crawl_reviews(11484011) (a7f9712f-b178-4318-afbc-1299b046bf43)
04:01:34 reviews: Job OK (a7f9712f-b178-4318-afbc-1299b046bf43)
04:01:34 Result is kept for 500 seconds
04:01:34 
04:01:34 *** Listening on chapters, profiles, reviews...
04:01:34 reviews: fanfic.jobs.crawl_reviews(11484234) (36ced95c-d7e0-4de1-b17b-d6abaa23966e)
2017-02-09 04:01:39 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 12:01:39.926896', 11484234, 236686716, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1896027&amp;r ... (872 characters truncated) ...   <small style="color:gray">chapter 9 . <span data-xutime="1462756062">5/8/2016</span> </small><div style="margin-top:5px">Awesome!</div></td>\n</tr>'), ('2017-02-09 12:01:39.926901', 11484234, 234885487, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1429891&amp;r ... (918 characters truncated) ... xutime="1459087958">3/27/2016</span> </small><div style="margin-top:5px">Great chapter story so far please continue this story soon</div></td>\n</tr>'), ('2017-02-09 12:01:39.926903', 11484234, 234461899, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4467422&amp;r ... (881 characters truncated) ... all style="color:gray">chapter 24 . <span data-xutime="1458236542">3/17/2016</span> </small><div style="margin-top:5px">:-) :-) :-)</div></td>\n</tr>'), ('2017-02-09 12:01:39.926905', 11484234, 233370983, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1429891&amp;r ... (923 characters truncated) ... e="1456000386">2/20/2016</span> </small><div style="margin-top:5px">Great chapter and story so far please continue this story soon.</div></td>\n</tr>'), ('2017-02-09 12:01:39.926907', 11484234, 233271823, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1429891&amp;r ... (923 characters truncated) ... e="1455797686">2/18/2016</span> </small><div style="margin-top:5px">Great chapter and story so far please continue this story soon.</div></td>\n</tr>'), ('2017-02-09 12:01:39.926909', 11484234, 229079951, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (542 characters truncated) ... . <span data-xutime="1447321258">11/12/2015</span> </small><div style="margin-top:5px">Well these aren\'t normal thoughts at all...</div></td>\n</tr>'), ('2017-02-09 12:01:39.926911', 11484234, 225969073, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1678209&amp;r ... (999 characters truncated) ... os &amp; Psyche, while your challenges have started off not so explicit, I still think it would be a good idea if more was changed.</div></td>\n</tr>'), ('2017-02-09 12:01:39.926913', 11484234, 225968314, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1678209&amp;r ... (935 characters truncated) ... time someone new speaks a new line is created. This is especially important when writing a conversation between two or more people.</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-09 12:01:39.926926', 11484234, 225969073, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1678209&amp;r ... (999 characters truncated) ... os &amp; Psyche, while your challenges have started off not so explicit, I still think it would be a good idea if more was changed.</div></td>\n</tr>'), ('2017-02-09 12:01:39.926928', 11484234, 225968314, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1678209&amp;r ... (935 characters truncated) ... time someone new speaks a new line is created. This is especially important when writing a conversation between two or more people.</div></td>\n</tr>'))]
04:01:39 reviews: Job OK (36ced95c-d7e0-4de1-b17b-d6abaa23966e)
04:01:39 Result is kept for 500 seconds
04:01:39 
04:01:39 *** Listening on chapters, profiles, reviews...
04:01:39 reviews: fanfic.jobs.crawl_reviews(11485982) (d2e98608-f428-4768-9d74-126a862a6d43)
04:01:45 reviews: Job OK (d2e98608-f428-4768-9d74-126a862a6d43)
04:01:45 Result is kept for 500 seconds
04:01:45 
04:01:45 *** Listening on chapters, profiles, reviews...
04:01:45 reviews: fanfic.jobs.crawl_reviews(11486857) (17c24596-7513-4628-8384-bb6e26f94d26)
04:03:57 reviews: Job OK (17c24596-7513-4628-8384-bb6e26f94d26)
04:03:57 Result is kept for 500 seconds
04:03:57 
04:03:57 *** Listening on chapters, profiles, reviews...
04:03:57 reviews: fanfic.jobs.crawl_reviews(11487602) (0ccfad9a-9fbb-4d7f-a20b-3e7cbbdc7fbf)
04:04:11 reviews: Job OK (0ccfad9a-9fbb-4d7f-a20b-3e7cbbdc7fbf)
04:04:11 Result is kept for 500 seconds
04:04:11 
04:04:11 *** Listening on chapters, profiles, reviews...
04:04:11 reviews: fanfic.jobs.crawl_reviews(11488630) (b82d4e9d-30c9-4f49-a01a-1ae55ca396e5)
04:07:48 reviews: Job OK (b82d4e9d-30c9-4f49-a01a-1ae55ca396e5)
04:07:48 Result is kept for 500 seconds
04:07:48 
04:07:48 *** Listening on chapters, profiles, reviews...
04:07:48 reviews: fanfic.jobs.crawl_reviews(11488713) (e8024fbf-a03c-43cd-ab6b-a726f1343d3d)
04:08:08 reviews: Job OK (e8024fbf-a03c-43cd-ab6b-a726f1343d3d)
04:08:08 Result is kept for 500 seconds
04:08:08 
04:08:08 *** Listening on chapters, profiles, reviews...
04:08:08 reviews: fanfic.jobs.crawl_reviews(11488906) (248aeef6-567c-4ecc-9710-5cc7f55d424e)
04:10:50 reviews: Job OK (248aeef6-567c-4ecc-9710-5cc7f55d424e)
04:10:50 Result is kept for 500 seconds
04:10:50 
04:10:50 *** Listening on chapters, profiles, reviews...
04:10:50 reviews: fanfic.jobs.crawl_reviews(11489343) (f19f8900-885b-44f2-b4d7-c5c90eba2beb)
04:11:42 reviews: Job OK (f19f8900-885b-44f2-b4d7-c5c90eba2beb)
04:11:42 Result is kept for 500 seconds
04:11:42 
04:11:42 *** Listening on chapters, profiles, reviews...
04:11:42 reviews: fanfic.jobs.crawl_reviews(11489372) (63677f18-37d7-43a6-8337-8e09557fd770)
2017-02-09 04:11:48 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 12:11:48.291646', 11489372, 246763282, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (596 characters truncated) ... v style="margin-top:5px">bonne fic!<br>\nles rebelles sont un peu trop passifs; ils étaient censé pratiquer une guerre de guérilla.</div></td>\n</tr>'), ('2017-02-09 12:11:48.291651', 11489372, 242013498, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7410367&amp;r ... (909 characters truncated) ... argin-top:5px">I love this story and it is very original, but i was wondering if you were going to add anymore to the story or not?</div></td>\n</tr>'), ('2017-02-09 12:11:48.291653', 11489372, 235634748, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6469567&amp;r ... (970 characters truncated) ... pan> </small><div style="margin-top:5px">isn\'t that like an Oedipus complex? I mean, he is sort of her great whatever grandfather.</div></td>\n</tr>'), ('2017-02-09 12:11:48.291655', 11489372, 233691243, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1780644&amp;r ... (1941 characters truncated) ... re you racing against time to get this out the door? Was someone paying you to be "on schedule" so you said "to hell with English"?</div></td>\n</tr>'), ('2017-02-09 12:11:48.291657', 11489372, 228561128, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2875905&amp;r ... (833 characters truncated) ... span data-xutime="1446432445">11/1/2015</span> </small><div style="margin-top:5px">Great story, thanks for the enjoyment it brought</div></td>\n</tr>'), ('2017-02-09 12:11:48.291659', 11489372, 228058160, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5315329&amp;r ... (914 characters truncated) ... . <span data-xutime="1445411437">10/21/2015</span> </small><div style="margin-top:5px">Great story I hope you are going to do more!</div></td>\n</tr>'), ('2017-02-09 12:11:48.291661', 11489372, 227806504, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2202893&amp;r ... (1097 characters truncated) ...  and the relationships built. My only problem was the ending. I thought it was rushed and didnt actually finish the story. Good job</div></td>\n</tr>'), ('2017-02-09 12:11:48.291663', 11489372, 226903373, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=798752&amp;rw ... (3380 characters truncated) ... icon as a great tool for juggling these sort of details ( ). Good luck with the story in progress, and thanks for posting this one!</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-09 12:11:48.291699', 11489372, 226134924, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (749 characters truncated) ... ing it so that some chapters just seem to go on forever and others go by too quickly. I love that you added a good little epilogue.</div></td>\n</tr>'), ('2017-02-09 12:11:48.291701', 11489372, 226108846, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2055056&amp;r ... (1107 characters truncated) ...  were quite a few words either misspelled or misused so a bit of editing would help your story a lot imho.<br>\n<br>\nthanks again!</div></td>\n</tr>'))]
04:11:48 reviews: Job OK (63677f18-37d7-43a6-8337-8e09557fd770)
04:11:48 Result is kept for 500 seconds
04:11:48 
04:11:48 *** Listening on chapters, profiles, reviews...
04:11:48 reviews: fanfic.jobs.crawl_reviews(11490053) (f0071388-3bf5-44b6-a7dc-993c37d142de)
04:14:15 reviews: Job OK (f0071388-3bf5-44b6-a7dc-993c37d142de)
04:14:15 Result is kept for 500 seconds
04:14:15 
04:14:15 *** Listening on chapters, profiles, reviews...
04:14:15 reviews: fanfic.jobs.crawl_reviews(11491494) (dc9d1387-ebf7-4fab-9c0b-6d490e9201bc)
04:15:49 reviews: Job OK (dc9d1387-ebf7-4fab-9c0b-6d490e9201bc)
04:15:49 Result is kept for 500 seconds
04:15:49 
04:15:49 *** Listening on chapters, profiles, reviews...
04:15:49 reviews: fanfic.jobs.crawl_reviews(11491920) (850c5f86-459c-4f62-9f27-883821c267fc)
04:16:01 reviews: Job OK (850c5f86-459c-4f62-9f27-883821c267fc)
04:16:01 Result is kept for 500 seconds
04:16:01 
04:16:01 *** Listening on chapters, profiles, reviews...
04:16:01 reviews: fanfic.jobs.crawl_reviews(11492354) (196e0c3c-7760-4c03-adf9-9bc391ab8de2)
04:16:15 reviews: Job OK (196e0c3c-7760-4c03-adf9-9bc391ab8de2)
04:16:15 Result is kept for 500 seconds
04:16:15 
04:16:15 *** Listening on chapters, profiles, reviews...
04:16:15 reviews: fanfic.jobs.crawl_reviews(11494764) (758cd00d-4e13-4043-b662-1cb5aa7bd255)
04:44:42 reviews: Job OK (758cd00d-4e13-4043-b662-1cb5aa7bd255)
04:44:42 Result is kept for 500 seconds
04:44:42 Cleaning registries for queue: chapters
04:44:42 Cleaning registries for queue: profiles
04:44:42 Cleaning registries for queue: reviews
04:44:42 
04:44:42 *** Listening on chapters, profiles, reviews...
04:44:42 reviews: fanfic.jobs.crawl_reviews(11494858) (2f982c65-c8c1-422d-9ef1-cec2434c197b)
04:45:56 reviews: Job OK (2f982c65-c8c1-422d-9ef1-cec2434c197b)
04:45:56 Result is kept for 500 seconds
04:45:56 
04:45:56 *** Listening on chapters, profiles, reviews...
04:45:56 reviews: fanfic.jobs.crawl_reviews(11495123) (3436eab2-82cc-44a8-9915-3c01a082dc89)
04:46:42 reviews: Job OK (3436eab2-82cc-44a8-9915-3c01a082dc89)
04:46:42 Result is kept for 500 seconds
04:46:42 
04:46:42 *** Listening on chapters, profiles, reviews...
04:46:42 reviews: fanfic.jobs.crawl_reviews(11495504) (1d8e5edd-5fbb-4daa-a6e0-34f67055dba8)
04:50:23 reviews: Job OK (1d8e5edd-5fbb-4daa-a6e0-34f67055dba8)
04:50:23 Result is kept for 500 seconds
04:50:23 
04:50:23 *** Listening on chapters, profiles, reviews...
04:50:23 reviews: fanfic.jobs.crawl_reviews(11495654) (74693688-244b-4dc0-87c4-e338c9717d60)
04:57:07 reviews: Job OK (74693688-244b-4dc0-87c4-e338c9717d60)
04:57:07 Result is kept for 500 seconds
04:57:07 
04:57:07 *** Listening on chapters, profiles, reviews...
04:57:07 reviews: fanfic.jobs.crawl_reviews(11496585) (0adc29b6-0062-4676-ad84-54f48cad62aa)
04:57:13 reviews: Job OK (0adc29b6-0062-4676-ad84-54f48cad62aa)
04:57:13 Result is kept for 500 seconds
04:57:13 
04:57:13 *** Listening on chapters, profiles, reviews...
04:57:13 reviews: fanfic.jobs.crawl_reviews(11499560) (6668d551-74ce-4321-9476-317c0a273296)
04:59:13 reviews: Job OK (6668d551-74ce-4321-9476-317c0a273296)
04:59:13 Result is kept for 500 seconds
04:59:13 
04:59:13 *** Listening on chapters, profiles, reviews...
04:59:13 reviews: fanfic.jobs.crawl_reviews(11500812) (a51787d8-bd00-495c-b14b-ea6d9105dd83)
2017-02-09 04:59:19 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 12:59:19.108720', 11500812, 246310035, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3000389&amp;r ... (922 characters truncated) ... time="1484923462">1/20</span> </small><div style="margin-top:5px">What the hell FREDDDD! I should have expected this but oh my gosh</div></td>\n</tr>'), ('2017-02-09 12:59:19.108724', 11500812, 244083733, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4525918&amp;r ... (981 characters truncated) ... p:5px">Holy heck I love your writing it\'s fantastic! I hope you get another chapter up whenever you can! Keep up the amazing work!</div></td>\n</tr>'), ('2017-02-09 12:59:19.108727', 11500812, 236075311, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5530337&amp;r ... (1312 characters truncated) ... m also planning on updating my one fanfic, "Neville\'s Take: Philosophers Stone", if you wanna read it and tell me what you think:)</div></td>\n</tr>'), ('2017-02-09 12:59:19.108729', 11500812, 246310035, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3000389&amp;r ... (922 characters truncated) ... time="1484923462">1/20</span> </small><div style="margin-top:5px">What the hell FREDDDD! I should have expected this but oh my gosh</div></td>\n</tr>'), ('2017-02-09 12:59:19.108731', 11500812, 244083733, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4525918&amp;r ... (981 characters truncated) ... p:5px">Holy heck I love your writing it\'s fantastic! I hope you get another chapter up whenever you can! Keep up the amazing work!</div></td>\n</tr>'), ('2017-02-09 12:59:19.108732', 11500812, 236075311, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5530337&amp;r ... (1312 characters truncated) ... m also planning on updating my one fanfic, "Neville\'s Take: Philosophers Stone", if you wanna read it and tell me what you think:)</div></td>\n</tr>'))]
04:59:19 reviews: Job OK (a51787d8-bd00-495c-b14b-ea6d9105dd83)
04:59:19 Result is kept for 500 seconds
04:59:19 
04:59:19 *** Listening on chapters, profiles, reviews...
04:59:19 reviews: fanfic.jobs.crawl_reviews(11500936) (73152c79-b97a-430e-ab85-d293fc0bc7aa)
05:15:57 reviews: Job OK (73152c79-b97a-430e-ab85-d293fc0bc7aa)
05:15:57 Result is kept for 500 seconds
05:15:57 
05:15:57 *** Listening on chapters, profiles, reviews...
05:15:57 reviews: fanfic.jobs.crawl_reviews(11501083) (23e14158-6ebd-4db2-8858-36bf196208ea)
05:16:05 reviews: Job OK (23e14158-6ebd-4db2-8858-36bf196208ea)
05:16:05 Result is kept for 500 seconds
05:16:05 
05:16:05 *** Listening on chapters, profiles, reviews...
05:16:05 reviews: fanfic.jobs.crawl_reviews(11501215) (f49adee0-bfd2-4245-9805-3b5c3b661ad2)
05:17:04 reviews: Job OK (f49adee0-bfd2-4245-9805-3b5c3b661ad2)
05:17:04 Result is kept for 500 seconds
05:17:04 
05:17:04 *** Listening on chapters, profiles, reviews...
05:17:04 reviews: fanfic.jobs.crawl_reviews(11502532) (3cdff8f9-2cb6-47e5-976a-1fe9e949aa1b)
05:18:52 reviews: Job OK (3cdff8f9-2cb6-47e5-976a-1fe9e949aa1b)
05:18:52 Result is kept for 500 seconds
05:18:52 
05:18:52 *** Listening on chapters, profiles, reviews...
05:18:52 reviews: fanfic.jobs.crawl_reviews(11503065) (555e73a4-8f65-4a9a-bc7a-8b04359e2a08)
05:18:58 reviews: Job OK (555e73a4-8f65-4a9a-bc7a-8b04359e2a08)
05:18:58 Result is kept for 500 seconds
05:18:58 
05:18:58 *** Listening on chapters, profiles, reviews...
05:18:58 reviews: fanfic.jobs.crawl_reviews(11503602) (5af30d63-3f84-4f68-bff9-941c6e88a0d4)
05:19:08 reviews: Job OK (5af30d63-3f84-4f68-bff9-941c6e88a0d4)
05:19:08 Result is kept for 500 seconds
05:19:08 
05:19:08 *** Listening on chapters, profiles, reviews...
05:19:08 reviews: fanfic.jobs.crawl_reviews(11504933) (23030bf9-f4f5-49d5-a252-0c0d9a3884d2)
05:19:20 reviews: Job OK (23030bf9-f4f5-49d5-a252-0c0d9a3884d2)
05:19:20 Result is kept for 500 seconds
05:19:20 
05:19:20 *** Listening on chapters, profiles, reviews...
05:19:20 reviews: fanfic.jobs.crawl_reviews(11505564) (c3f32758-7808-4b7f-a751-4d01e55152ea)
05:19:35 reviews: Job OK (c3f32758-7808-4b7f-a751-4d01e55152ea)
05:19:35 Result is kept for 500 seconds
05:19:35 
05:19:35 *** Listening on chapters, profiles, reviews...
05:19:35 reviews: fanfic.jobs.crawl_reviews(11506450) (5705a4e8-6141-4ea7-acf4-659825b7a40a)
05:19:55 reviews: Job OK (5705a4e8-6141-4ea7-acf4-659825b7a40a)
05:19:55 Result is kept for 500 seconds
05:19:55 
05:19:55 *** Listening on chapters, profiles, reviews...
05:19:55 reviews: fanfic.jobs.crawl_reviews(11506688) (4b616171-5c9c-4fd4-b01e-199d83a7bf85)
05:20:20 reviews: Job OK (4b616171-5c9c-4fd4-b01e-199d83a7bf85)
05:20:20 Result is kept for 500 seconds
05:20:20 
05:20:20 *** Listening on chapters, profiles, reviews...
05:20:20 reviews: fanfic.jobs.crawl_reviews(11508305) (45e53b8b-d70e-42e2-840f-1fbd58fb920f)
05:20:29 reviews: Job OK (45e53b8b-d70e-42e2-840f-1fbd58fb920f)
05:20:29 Result is kept for 500 seconds
05:20:29 
05:20:29 *** Listening on chapters, profiles, reviews...
05:20:29 reviews: fanfic.jobs.crawl_reviews(11509234) (e84bf755-345a-44e7-87b7-807a272913c5)
05:20:39 reviews: Job OK (e84bf755-345a-44e7-87b7-807a272913c5)
05:20:39 Result is kept for 500 seconds
05:20:39 
05:20:39 *** Listening on chapters, profiles, reviews...
05:20:39 reviews: fanfic.jobs.crawl_reviews(11510594) (3277733e-744b-41b4-851d-c815d9f8cf69)
05:22:59 reviews: Job OK (3277733e-744b-41b4-851d-c815d9f8cf69)
05:22:59 Result is kept for 500 seconds
05:22:59 
05:22:59 *** Listening on chapters, profiles, reviews...
05:22:59 reviews: fanfic.jobs.crawl_reviews(11510729) (9abf3d5d-4592-499c-b4fc-19df446a9af0)
05:28:41 reviews: Job OK (9abf3d5d-4592-499c-b4fc-19df446a9af0)
05:28:41 Result is kept for 500 seconds
05:28:41 
05:28:41 *** Listening on chapters, profiles, reviews...
05:28:41 reviews: fanfic.jobs.crawl_reviews(11511191) (c8104ca9-b605-4b48-9695-e7267e49d928)
05:29:50 reviews: Job OK (c8104ca9-b605-4b48-9695-e7267e49d928)
05:29:50 Result is kept for 500 seconds
05:29:50 
05:29:50 *** Listening on chapters, profiles, reviews...
05:29:50 reviews: fanfic.jobs.crawl_reviews(11511581) (b7606953-9e24-4e42-b527-f3668bef2488)
05:29:59 reviews: Job OK (b7606953-9e24-4e42-b527-f3668bef2488)
05:29:59 Result is kept for 500 seconds
05:29:59 
05:29:59 *** Listening on chapters, profiles, reviews...
05:29:59 reviews: fanfic.jobs.crawl_reviews(11511917) (8bea7721-8468-4417-a43c-73f8f1d1bc39)
05:30:28 reviews: Job OK (8bea7721-8468-4417-a43c-73f8f1d1bc39)
05:30:28 Result is kept for 500 seconds
05:30:28 
05:30:28 *** Listening on chapters, profiles, reviews...
05:30:28 reviews: fanfic.jobs.crawl_reviews(11514382) (9af92e28-ae87-4e80-b734-6bf3280f723c)
2017-02-09 05:30:33 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 13:30:33.276864', 11514382, 241668640, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4834068&amp;r ... (907 characters truncated) ... <span data-xutime="1473341648">9/8/2016</span> </small><div style="margin-top:5px">Well written looking forward to reading the rest</div></td>\n</tr>'), ('2017-02-09 13:30:33.276870', 11514382, 239777387, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (657 characters truncated) ... ! I read the entire serie in only a few hours! And I must say I am just amazed by your writing, and the complexity of your stories!</div></td>\n</tr>'), ('2017-02-09 13:30:33.276872', 11514382, 237036447, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (683 characters truncated) ... y Potter world fanfictions! They are amazing! They are definitely not a conventional love stories... It is so much more! Great Job!</div></td>\n</tr>'), ('2017-02-09 13:30:33.276874', 11514382, 241668640, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4834068&amp;r ... (907 characters truncated) ... <span data-xutime="1473341648">9/8/2016</span> </small><div style="margin-top:5px">Well written looking forward to reading the rest</div></td>\n</tr>'), ('2017-02-09 13:30:33.276876', 11514382, 239777387, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (657 characters truncated) ... ! I read the entire serie in only a few hours! And I must say I am just amazed by your writing, and the complexity of your stories!</div></td>\n</tr>'), ('2017-02-09 13:30:33.276878', 11514382, 237036447, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (683 characters truncated) ... y Potter world fanfictions! They are amazing! They are definitely not a conventional love stories... It is so much more! Great Job!</div></td>\n</tr>'))]
05:30:33 reviews: Job OK (9af92e28-ae87-4e80-b734-6bf3280f723c)
05:30:33 Result is kept for 500 seconds
05:30:33 
05:30:33 *** Listening on chapters, profiles, reviews...
05:30:33 reviews: fanfic.jobs.crawl_reviews(11514749) (12c3720c-3191-4860-a094-20f269bac578)
05:31:32 reviews: Job OK (12c3720c-3191-4860-a094-20f269bac578)
05:31:32 Result is kept for 500 seconds
05:31:32 
05:31:32 *** Listening on chapters, profiles, reviews...
05:31:32 reviews: fanfic.jobs.crawl_reviews(11515545) (f3aee22f-874e-4fb4-a22e-fd8580ad1796)
2017-02-09 05:31:36 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 13:31:36.763003', 11515545, 232875927, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3149495&amp;r ... (824 characters truncated) ... er 14 . <span data-xutime="1455007832">2/9/2016</span> </small><div style="margin-top:5px">Lion King came out in 1994. Just saying.</div></td>\n</tr>'), ('2017-02-09 13:31:36.763008', 11515545, 230092936, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2425879&amp;r ... (901 characters truncated) ... a>  <small style="color:gray">chapter 20 . <span data-xutime="1449595123">12/8/2015</span> </small><div style="margin-top:5px">WHY?</div></td>\n</tr>'), ('2017-02-09 13:31:36.763010', 11515545, 228321945, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1667455&amp;r ... (955 characters truncated) ... </span> </small><div style="margin-top:5px">I think this is really well done. I am enjoying the plot and the mystery behind it all.</div></td>\n</tr>'), ('2017-02-09 13:31:36.763012', 11515545, 228319714, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1667455&amp;r ... (944 characters truncated) ... 10/27/2015</span> </small><div style="margin-top:5px">Quite amusing poor Siri, like the boys I am chuckling and grinning and LOL...</div></td>\n</tr>'), ('2017-02-09 13:31:36.763014', 11515545, 227498150, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4407605&amp;r ... (824 characters truncated) ... "color:gray">chapter 10 . <span data-xutime="1444284025">10/7/2015</span> </small><div style="margin-top:5px">Suddenly Life on Mars</div></td>\n</tr>'), ('2017-02-09 13:31:36.763016', 11515545, 227006425, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (522 characters truncated) ... lor:gray">chapter 7 . <span data-xutime="1443227012">9/25/2015</span> </small><div style="margin-top:5px">This is fun. More please.</div></td>\n</tr>'), ('2017-02-09 13:31:36.763017', 11515545, 226967361, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2425879&amp;r ... (1010 characters truncated) ... "margin-top:5px">the use of Neville as a sounding board for your plot idea and hooks should work very well all in all a nice update</div></td>\n</tr>'), ('2017-02-09 13:31:36.763019', 11515545, 226928910, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2425879&amp;r ... (955 characters truncated) ... utime="1443135924">9/24/2015</span> </small><div style="margin-top:5px">well now, a very well written Hat, spot on and a nice twist</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-09 13:31:36.763048', 11515545, 226739488, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2425879&amp;r ... (1016 characters truncated) ... n-top:5px">good balance between move the story forward the shopping trip and character backgroup / history all in all a good update</div></td>\n</tr>'), ('2017-02-09 13:31:36.763050', 11515545, 226708529, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2425879&amp;r ... (1614 characters truncated) ... ow it is how you develop this that will be key to your story and your take on JKR Harry Potter <br>\nthank you for your story start</div></td>\n</tr>'))]
05:31:36 reviews: Job OK (f3aee22f-874e-4fb4-a22e-fd8580ad1796)
05:31:36 Result is kept for 500 seconds
05:31:36 
05:31:36 *** Listening on chapters, profiles, reviews...
05:31:36 reviews: fanfic.jobs.crawl_reviews(11516452) (80ca014b-212a-4476-b6bf-03862002c848)
05:31:47 reviews: Job OK (80ca014b-212a-4476-b6bf-03862002c848)
05:31:47 Result is kept for 500 seconds
05:31:47 
05:31:47 *** Listening on chapters, profiles, reviews...
05:31:47 reviews: fanfic.jobs.crawl_reviews(11516626) (033ae1ce-3ab0-43e0-86e1-5f72e6550832)
05:32:47 reviews: Job OK (033ae1ce-3ab0-43e0-86e1-5f72e6550832)
05:32:47 Result is kept for 500 seconds
05:32:47 
05:32:47 *** Listening on chapters, profiles, reviews...
05:32:47 reviews: fanfic.jobs.crawl_reviews(11516960) (7f185226-2396-4c5f-af4b-cf4eee4c32bd)
2017-02-09 05:32:52 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 13:32:52.667604', 11516960, 241735499, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4329911&amp;r ... (1067 characters truncated) ...  she see or at least suspect that he is a bad guy? Sirius is right about him, and does she listen or at least heed the warning, no.</div></td>\n</tr>'), ('2017-02-09 13:32:52.667609', 11516960, 241734947, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4329911&amp;r ... (1131 characters truncated) ... ch better choice than Kurt, and he actually cares about her, unlike Kurt who just seems like he\'s using her in more ways than one.</div></td>\n</tr>'), ('2017-02-09 13:32:52.667611', 11516960, 241714571, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4329911&amp;r ... (1003 characters truncated) ... 5px">I don\'t get why she\'s with Kurt. He’s kind of an asshole. I\'d rather see her with Sirus. Is that gonna happen anytime soon?</div></td>\n</tr>'), ('2017-02-09 13:32:52.667613', 11516960, 237053445, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2408682&amp;r ... (882 characters truncated) ... small style="color:gray">chapter 24 . <span data-xutime="1463550696">5/17/2016</span> </small><div style="margin-top:5px">Great job</div></td>\n</tr>'), ('2017-02-09 13:32:52.667615', 11516960, 237035095, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2408682&amp;r ... (878 characters truncated) ... >  <small style="color:gray">chapter 19 . <span data-xutime="1463517355">5/17/2016</span> </small><div style="margin-top:5px">Great</div></td>\n</tr>'), ('2017-02-09 13:32:52.667617', 11516960, 236471522, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (789 characters truncated) ... again and fell in love! Guh, I do love it. I hope Kurt gets some form of come-uppance, the sneaky bastard. Anyway! Please update :D</div></td>\n</tr>'), ('2017-02-09 13:32:52.667619', 11516960, 236279964, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2408682&amp;r ... (883 characters truncated) ... mall style="color:gray">chapter 18 . <span data-xutime="1461894977">4/28/2016</span> </small><div style="margin-top:5px">great job!</div></td>\n</tr>'), ('2017-02-09 13:32:52.667621', 11516960, 234370408, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (606 characters truncated) ... style="margin-top:5px">Damn, I felt so bad when they wiped her memory. D: but I do like this story. I can\'t wait for the update :3</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-09 13:32:52.667652', 11516960, 230748713, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2408682&amp;r ... (878 characters truncated) ... >  <small style="color:gray">chapter 4 . <span data-xutime="1450927425">12/23/2015</span> </small><div style="margin-top:5px">Great</div></td>\n</tr>'), ('2017-02-09 13:32:52.667654', 11516960, 229438795, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6709442&amp;r ... (869 characters truncated) ... pan> </small><div style="margin-top:5px">I absolutely love this story, it has to be one of my favorites so far! Please update soon!</div></td>\n</tr>'))]
05:32:52 reviews: Job OK (7f185226-2396-4c5f-af4b-cf4eee4c32bd)
05:32:52 Result is kept for 500 seconds
05:32:52 
05:32:52 *** Listening on chapters, profiles, reviews...
05:32:52 reviews: fanfic.jobs.crawl_reviews(11517235) (0fc6431e-f73b-4228-a064-a39a71517e52)
05:33:13 reviews: Job OK (0fc6431e-f73b-4228-a064-a39a71517e52)
05:33:13 Result is kept for 500 seconds
05:33:13 
05:33:13 *** Listening on chapters, profiles, reviews...
05:33:13 reviews: fanfic.jobs.crawl_reviews(11517506) (9a9f4c43-445b-41af-95ee-2dc31d7b0acc)
05:33:55 reviews: Job OK (9a9f4c43-445b-41af-95ee-2dc31d7b0acc)
05:33:55 Result is kept for 500 seconds
05:33:55 
05:33:55 *** Listening on chapters, profiles, reviews...
05:33:55 reviews: fanfic.jobs.crawl_reviews(11517671) (f6756f59-abcc-47cd-8a78-f8239c46453b)
05:34:30 reviews: Job OK (f6756f59-abcc-47cd-8a78-f8239c46453b)
05:34:30 Result is kept for 500 seconds
05:34:30 
05:34:30 *** Listening on chapters, profiles, reviews...
05:34:30 reviews: fanfic.jobs.crawl_reviews(11519573) (a2937b0f-b884-47e1-9872-b1b4fe248e4d)
05:34:34 reviews: Job OK (a2937b0f-b884-47e1-9872-b1b4fe248e4d)
05:34:34 Result is kept for 500 seconds
05:34:34 
05:34:34 *** Listening on chapters, profiles, reviews...
05:34:34 reviews: fanfic.jobs.crawl_reviews(11519855) (783dcd67-9f9b-42e2-bc2e-ce25d858c82e)
05:34:49 reviews: Job OK (783dcd67-9f9b-42e2-bc2e-ce25d858c82e)
05:34:49 Result is kept for 500 seconds
05:34:49 
05:34:49 *** Listening on chapters, profiles, reviews...
05:34:49 reviews: fanfic.jobs.crawl_reviews(11520431) (9af83779-e54b-4676-a0e6-a2dab09d3553)
05:35:24 reviews: Job OK (9af83779-e54b-4676-a0e6-a2dab09d3553)
05:35:24 Result is kept for 500 seconds
05:35:24 
05:35:24 *** Listening on chapters, profiles, reviews...
05:35:24 reviews: fanfic.jobs.crawl_reviews(11520854) (a3097330-1eb8-42ce-82d7-8c41de806999)
05:38:02 reviews: Job OK (a3097330-1eb8-42ce-82d7-8c41de806999)
05:38:02 Result is kept for 500 seconds
05:38:02 
05:38:02 *** Listening on chapters, profiles, reviews...
05:38:02 reviews: fanfic.jobs.crawl_reviews(11521376) (32f3178a-cea8-4e1d-80e1-3b5473ce31b4)
2017-02-09 05:38:07 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 13:38:07.718867', 11521376, 227960805, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6690016&amp;r ... (880 characters truncated) ... lor:gray">chapter 24 . <span data-xutime="1445221332">10/18/2015</span> </small><div style="margin-top:5px">Im bawling my eyes out.</div></td>\n</tr>'), ('2017-02-09 13:38:07.718871', 11521376, 227905439, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6690016&amp;r ... (969 characters truncated) ... e="margin-top:5px">Omc. I just cant wait for the next chapter. I want Remus and Ava to get back together so bad its not even funny.</div></td>\n</tr>'), ('2017-02-09 13:38:07.718874', 11521376, 227901124, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6690016&amp;r ... (894 characters truncated) ... ter 7 . <span data-xutime="1445112164">10/17/2015</span> </small><div style="margin-top:5px">This chapter is a repeat for chapter 2</div></td>\n</tr>'), ('2017-02-09 13:38:07.718876', 11521376, 227642749, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6861453&amp;r ... (1861 characters truncated) ...  ;)<br>\n<br>\nAltogether it is a decent story and I think the more you write the better you will become. So don\'t stop writing :)</div></td>\n</tr>'), ('2017-02-09 13:38:07.718878', 11521376, 227231393, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (564 characters truncated) ... 443744042">10/1/2015</span> </small><div style="margin-top:5px">i\'m in love with this story already! i can\'t wait to read more :D</div></td>\n</tr>'), ('2017-02-09 13:38:07.718879', 11521376, 227228859, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (540 characters truncated) ... 2 . <span data-xutime="1443643248">9/30/2015</span> </small><div style="margin-top:5px">Love the tension between padfoot and Remus!</div></td>\n</tr>'), ('2017-02-09 13:38:07.718881', 11521376, 227228858, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (557 characters truncated) ... utime="1443643195">9/30/2015</span> </small><div style="margin-top:5px">Why wouldn\'t she date? Lol the marauders need to teach her</div></td>\n</tr>'), ('2017-02-09 13:38:07.718883', 11521376, 227227932, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6658613&amp;r ... (922 characters truncated) ... ime="1443737726">10/1/2015</span> </small><div style="margin-top:5px">Write what you love, don\'t let the hateful troll bother you.</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-09 13:38:07.718903', 11521376, 227097473, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6803755&amp;r ... (1900 characters truncated) ... ot a firm grasp of the English language...<br>\n<br>\nAnyway, have a wonderful sparkly day!<br>\n<br>\nYours truly<br>\nGeysterboos</div></td>\n</tr>'), ('2017-02-09 13:38:07.718905', 11521376, 226849524, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7046249&amp;r ... (899 characters truncated) ... 5px">I thought your story was adorable! I absolutely adore past generation fan fiction! Please keep writing it!<br>\n-Orangebunny14</div></td>\n</tr>'))]
05:38:07 reviews: Job OK (32f3178a-cea8-4e1d-80e1-3b5473ce31b4)
05:38:07 Result is kept for 500 seconds
05:38:07 
05:38:07 *** Listening on chapters, profiles, reviews...
05:38:07 reviews: fanfic.jobs.crawl_reviews(11521399) (f7bc3176-cfe3-4bbb-9281-9881b3b653f3)
2017-02-09 05:38:13 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 13:38:13.076981', 11521399, 242616661, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5740738&amp;r ... (920 characters truncated) ... hapter 15 . <span data-xutime="1475670148">10/5/2016</span> </small><div style="margin-top:5px">are you planning on finishing this?</div></td>\n</tr>'), ('2017-02-09 13:38:13.076986', 11521399, 232686161, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7303112&amp;r ... (941 characters truncated) ... a-xutime="1454633890">2/4/2016</span> </small><div style="margin-top:5px">D: que paso! Aaaaaaaah! :( actualiza pronto! Ufhdidhsksks</div></td>\n</tr>'), ('2017-02-09 13:38:13.076988', 11521399, 231976649, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7456420&amp;r ... (865 characters truncated) ... 0436">1/19/2016</span> </small><div style="margin-top:5px">i must say you have done great so far please keep it up and update soon.</div></td>\n</tr>'), ('2017-02-09 13:38:13.076990', 11521399, 230981357, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6982354&amp;r ... (1089 characters truncated) ... d original, as well) and your work is a pleasure to read. I just wish there was more because I know I will finish this very soon :)</div></td>\n</tr>'), ('2017-02-09 13:38:13.076992', 11521399, 227086834, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5804568&amp;r ... (925 characters truncated) ... ime="1443449902">9/28/2015</span> </small><div style="margin-top:5px">I\'m really enjoying your story..,can\'t wait to read more :)</div></td>\n</tr>'), ('2017-02-09 13:38:13.076994', 11521399, 227085541, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (728 characters truncated) ... \n******************* <br>\nThe dark haired, skinny man.<br>\nHe had straw coloured hair in the books. I wonder why you changed it.</div></td>\n</tr>'), ('2017-02-09 13:38:13.076996', 11521399, 227083782, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (889 characters truncated) ... e.<br>\n**************** <br>\nMad-Eye hit Daphne with a stunning spell<br>\nTrust him to be there! I suppose it is the fake Moody.</div></td>\n</tr>'), ('2017-02-09 13:38:13.076997', 11521399, 226989392, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2293010&amp;r ... (906 characters truncated) ... p:5px">I was enjoying this until you introduced the students from the other schools in the same idiotic way as those stupid movies.</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-09 13:38:13.077010', 11521399, 227083782, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (889 characters truncated) ... e.<br>\n**************** <br>\nMad-Eye hit Daphne with a stunning spell<br>\nTrust him to be there! I suppose it is the fake Moody.</div></td>\n</tr>'), ('2017-02-09 13:38:13.077012', 11521399, 226989392, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2293010&amp;r ... (906 characters truncated) ... p:5px">I was enjoying this until you introduced the students from the other schools in the same idiotic way as those stupid movies.</div></td>\n</tr>'))]
05:38:13 reviews: Job OK (f7bc3176-cfe3-4bbb-9281-9881b3b653f3)
05:38:13 Result is kept for 500 seconds
05:38:13 
05:38:13 *** Listening on chapters, profiles, reviews...
05:38:13 reviews: fanfic.jobs.crawl_reviews(11522499) (d6730fef-57ed-4f92-bc4d-30e31fca34e7)
05:39:47 reviews: Job OK (d6730fef-57ed-4f92-bc4d-30e31fca34e7)
05:39:47 Result is kept for 500 seconds
05:39:47 
05:39:47 *** Listening on chapters, profiles, reviews...
05:39:47 reviews: fanfic.jobs.crawl_reviews(11523962) (26ec3bca-c070-4911-b7ea-e56e4431138b)
05:40:13 reviews: Job OK (26ec3bca-c070-4911-b7ea-e56e4431138b)
05:40:13 Result is kept for 500 seconds
05:40:13 
05:40:13 *** Listening on chapters, profiles, reviews...
05:40:13 reviews: fanfic.jobs.crawl_reviews(11525429) (58fad951-b54a-4586-a587-670b72d227b6)
05:40:33 reviews: Job OK (58fad951-b54a-4586-a587-670b72d227b6)
05:40:33 Result is kept for 500 seconds
05:40:33 
05:40:33 *** Listening on chapters, profiles, reviews...
05:40:33 reviews: fanfic.jobs.crawl_reviews(11527935) (8e9850ac-2265-4fef-9a83-496060447a9a)
05:41:30 reviews: Job OK (8e9850ac-2265-4fef-9a83-496060447a9a)
05:41:30 Result is kept for 500 seconds
05:41:30 
05:41:30 *** Listening on chapters, profiles, reviews...
05:41:30 reviews: fanfic.jobs.crawl_reviews(11527977) (ed31795f-e534-43bb-89f8-880f987d9d9a)
05:56:19 reviews: Job OK (ed31795f-e534-43bb-89f8-880f987d9d9a)
05:56:19 Result is kept for 500 seconds
05:56:19 Cleaning registries for queue: chapters
05:56:19 Cleaning registries for queue: profiles
05:56:19 Cleaning registries for queue: reviews
05:56:19 
05:56:19 *** Listening on chapters, profiles, reviews...
05:56:19 reviews: fanfic.jobs.crawl_reviews(11528164) (5b440078-63a6-4219-ab3b-d0de7a3842f1)
05:58:11 reviews: Job OK (5b440078-63a6-4219-ab3b-d0de7a3842f1)
05:58:11 Result is kept for 500 seconds
05:58:11 
05:58:11 *** Listening on chapters, profiles, reviews...
05:58:11 reviews: fanfic.jobs.crawl_reviews(11529753) (d4ffa504-767e-42ba-a1b3-2f962529e9c5)
05:58:39 reviews: Job OK (d4ffa504-767e-42ba-a1b3-2f962529e9c5)
05:58:39 Result is kept for 500 seconds
05:58:39 
05:58:39 *** Listening on chapters, profiles, reviews...
05:58:39 reviews: fanfic.jobs.crawl_reviews(11530038) (95c1044a-fa7a-408a-961c-959ae7072a24)
05:58:56 reviews: Job OK (95c1044a-fa7a-408a-961c-959ae7072a24)
05:58:56 Result is kept for 500 seconds
05:58:56 
05:58:56 *** Listening on chapters, profiles, reviews...
05:58:56 reviews: fanfic.jobs.crawl_reviews(11531299) (1d962fdb-01d2-4169-8edf-3bba67838184)
05:59:06 reviews: Job OK (1d962fdb-01d2-4169-8edf-3bba67838184)
05:59:06 Result is kept for 500 seconds
05:59:06 
05:59:06 *** Listening on chapters, profiles, reviews...
05:59:06 reviews: fanfic.jobs.crawl_reviews(11533206) (f6cca809-df96-42b0-9542-0e38c226b200)
05:59:43 reviews: Job OK (f6cca809-df96-42b0-9542-0e38c226b200)
05:59:43 Result is kept for 500 seconds
05:59:43 
05:59:43 *** Listening on chapters, profiles, reviews...
05:59:43 reviews: fanfic.jobs.crawl_reviews(11534019) (9c61d981-4388-4987-b7ee-5c3450d5c223)
06:01:13 reviews: Job OK (9c61d981-4388-4987-b7ee-5c3450d5c223)
06:01:13 Result is kept for 500 seconds
06:01:13 
06:01:13 *** Listening on chapters, profiles, reviews...
06:01:13 reviews: fanfic.jobs.crawl_reviews(11534298) (10428fa2-1fc8-4eef-8af9-a9bab31ce166)
2017-02-09 06:01:19 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 14:01:19.217122', 11534298, 231779300, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (706 characters truncated) ... ny reviews as your story deserved. Grammar, spellings and everything is just perfect. Anyways keep going :)<br>\nLoved your story 3</div></td>\n</tr>'), ('2017-02-09 14:01:19.217127', 11534298, 227823232, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (990 characters truncated) ... this doesn\'t change the fact that I enjoyed your story and I\'m looking forward to your sequel! xx Did I repeat myself? Oh well xD</div></td>\n</tr>'), ('2017-02-09 14:01:19.217129', 11534298, 231779300, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (706 characters truncated) ... ny reviews as your story deserved. Grammar, spellings and everything is just perfect. Anyways keep going :)<br>\nLoved your story 3</div></td>\n</tr>'), ('2017-02-09 14:01:19.217131', 11534298, 227823232, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (990 characters truncated) ... this doesn\'t change the fact that I enjoyed your story and I\'m looking forward to your sequel! xx Did I repeat myself? Oh well xD</div></td>\n</tr>'))]
06:01:19 reviews: Job OK (10428fa2-1fc8-4eef-8af9-a9bab31ce166)
06:01:19 Result is kept for 500 seconds
06:01:19 
06:01:19 *** Listening on chapters, profiles, reviews...
06:01:19 reviews: fanfic.jobs.crawl_reviews(11534904) (1ca5a3c1-1d4d-40a5-a8f9-67bf97cc0745)
06:02:17 reviews: Job OK (1ca5a3c1-1d4d-40a5-a8f9-67bf97cc0745)
06:02:17 Result is kept for 500 seconds
06:02:17 
06:02:17 *** Listening on chapters, profiles, reviews...
06:02:17 reviews: fanfic.jobs.crawl_reviews(11535267) (47375061-58c9-4c36-8c98-197830aaf36d)
06:03:06 reviews: Job OK (47375061-58c9-4c36-8c98-197830aaf36d)
06:03:06 Result is kept for 500 seconds
06:03:06 
06:03:06 *** Listening on chapters, profiles, reviews...
06:03:06 reviews: fanfic.jobs.crawl_reviews(11535406) (2831de2f-16e6-4886-994f-07d166e1a0e7)
06:03:25 reviews: Job OK (2831de2f-16e6-4886-994f-07d166e1a0e7)
06:03:25 Result is kept for 500 seconds
06:03:25 
06:03:25 *** Listening on chapters, profiles, reviews...
06:03:25 reviews: fanfic.jobs.crawl_reviews(11535561) (014fee74-537a-43be-bcd5-383e17358361)
06:03:41 reviews: Job OK (014fee74-537a-43be-bcd5-383e17358361)
06:03:41 Result is kept for 500 seconds
06:03:41 
06:03:41 *** Listening on chapters, profiles, reviews...
06:03:41 reviews: fanfic.jobs.crawl_reviews(11536026) (807c3c8d-e0ae-4d27-9483-dd4db08caaed)
06:03:58 reviews: Job OK (807c3c8d-e0ae-4d27-9483-dd4db08caaed)
06:03:58 Result is kept for 500 seconds
06:03:58 
06:03:58 *** Listening on chapters, profiles, reviews...
06:03:58 reviews: fanfic.jobs.crawl_reviews(11537500) (ec682257-938a-400c-8615-5defb7e8e734)
06:04:08 reviews: Job OK (ec682257-938a-400c-8615-5defb7e8e734)
06:04:08 Result is kept for 500 seconds
06:04:08 
06:04:08 *** Listening on chapters, profiles, reviews...
06:04:08 reviews: fanfic.jobs.crawl_reviews(11538248) (0598207b-5b81-4154-973c-9d41e1a5e9ab)
06:04:35 reviews: Job OK (0598207b-5b81-4154-973c-9d41e1a5e9ab)
06:04:35 Result is kept for 500 seconds
06:04:35 
06:04:35 *** Listening on chapters, profiles, reviews...
06:04:35 reviews: fanfic.jobs.crawl_reviews(11538250) (337c5453-30cd-4ad9-9770-6739de4cd125)
06:05:06 reviews: Job OK (337c5453-30cd-4ad9-9770-6739de4cd125)
06:05:06 Result is kept for 500 seconds
06:05:06 
06:05:06 *** Listening on chapters, profiles, reviews...
06:05:06 reviews: fanfic.jobs.crawl_reviews(11539017) (668ece3c-5938-435a-961e-25d9b77c1c21)
06:05:16 reviews: Job OK (668ece3c-5938-435a-961e-25d9b77c1c21)
06:05:16 Result is kept for 500 seconds
06:05:16 
06:05:16 *** Listening on chapters, profiles, reviews...
06:05:16 reviews: fanfic.jobs.crawl_reviews(11539267) (57b7ff5b-7bbf-4fe7-bd08-4329c371a0eb)
06:05:50 reviews: Job OK (57b7ff5b-7bbf-4fe7-bd08-4329c371a0eb)
06:05:50 Result is kept for 500 seconds
06:05:50 
06:05:50 *** Listening on chapters, profiles, reviews...
06:05:50 reviews: fanfic.jobs.crawl_reviews(11540013) (047935af-b92e-424c-9166-18c76ddd47de)
06:12:06 reviews: Job OK (047935af-b92e-424c-9166-18c76ddd47de)
06:12:06 Result is kept for 500 seconds
06:12:06 
06:12:06 *** Listening on chapters, profiles, reviews...
06:12:06 reviews: fanfic.jobs.crawl_reviews(11540175) (37c1bfae-b94f-413a-b0a7-3683f90cb089)
06:13:01 reviews: Job OK (37c1bfae-b94f-413a-b0a7-3683f90cb089)
06:13:01 Result is kept for 500 seconds
06:13:01 
06:13:01 *** Listening on chapters, profiles, reviews...
06:13:01 reviews: fanfic.jobs.crawl_reviews(11540286) (9a718d08-3fc6-4086-b851-dc876f650f50)
06:14:15 reviews: Job OK (9a718d08-3fc6-4086-b851-dc876f650f50)
06:14:15 Result is kept for 500 seconds
06:14:15 
06:14:15 *** Listening on chapters, profiles, reviews...
06:14:15 reviews: fanfic.jobs.crawl_reviews(11540807) (f46f3036-29db-489a-83d0-f412f4c30557)
06:15:27 reviews: Job OK (f46f3036-29db-489a-83d0-f412f4c30557)
06:15:27 Result is kept for 500 seconds
06:15:27 
06:15:27 *** Listening on chapters, profiles, reviews...
06:15:27 reviews: fanfic.jobs.crawl_reviews(11542340) (f348c9ab-b4ba-45ad-b58b-cb6ae5798dcd)
06:16:57 reviews: Job OK (f348c9ab-b4ba-45ad-b58b-cb6ae5798dcd)
06:16:57 Result is kept for 500 seconds
06:16:57 
06:16:57 *** Listening on chapters, profiles, reviews...
06:16:57 reviews: fanfic.jobs.crawl_reviews(11543148) (13fb6804-b7b9-4bc8-9a9e-16f49f0c7749)
06:21:13 reviews: Job OK (13fb6804-b7b9-4bc8-9a9e-16f49f0c7749)
06:21:13 Result is kept for 500 seconds
06:21:13 
06:21:13 *** Listening on chapters, profiles, reviews...
06:21:13 reviews: fanfic.jobs.crawl_reviews(11546016) (6a4cb79f-55a8-4eb8-ada1-f891b4907b01)
2017-02-09 06:21:16 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 14:21:16.613827', 11546016, 245442568, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4810660&amp;r ... (951 characters truncated) ... 016</span> </small><div style="margin-top:5px">I love the spin on Ron! Never been one of my favorite characters so it works for me!</div></td>\n</tr>'), ('2017-02-09 14:21:16.613833', 11546016, 244444879, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7076889&amp;r ... (1310 characters truncated) ... hing... just i have stopped reading because i can\'t handle it... but you keep writing such wonderful stories and have nice time...</div></td>\n</tr>'), ('2017-02-09 14:21:16.613835', 11546016, 244444350, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7076889&amp;r ... (1310 characters truncated) ... hing... just i have stopped reading because i can\'t handle it... but you keep writing such wonderful stories and have nice time...</div></td>\n</tr>'), ('2017-02-09 14:21:16.613837', 11546016, 244404042, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7249454&amp;r ... (949 characters truncated) ...  bit caught me completely by surprise in this fic for some reason and I think that made it all the more hot. Like holy moly. Bravo.</div></td>\n</tr>'), ('2017-02-09 14:21:16.613840', 11546016, 241355730, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (506 characters truncated) ... <small style="color:gray">chapter 4 . <span data-xutime="1472614205">8/30/2016</span> </small><div style="margin-top:5px">i dig it.</div></td>\n</tr>'), ('2017-02-09 14:21:16.613842', 11546016, 240659382, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1753536&amp;r ... (981 characters truncated) ... argin-top:5px">This is sooooooooooo good. Please update it soon. I am waiting at the edge of my seat to find out what happens next.</div></td>\n</tr>'), ('2017-02-09 14:21:16.613844', 11546016, 228363955, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=43341&amp;rwi ... (2230 characters truncated) ...  at that time, really wouldn\'t be here.<br>\n<br>\nAs the speeches toned down in this chapter? They seem to have, so that\'s good.</div></td>\n</tr>'), ('2017-02-09 14:21:16.613846', 11546016, 228363298, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=43341&amp;rwi ... (1049 characters truncated) ... g or sympathetic of draco.<br>\nI do like the timing of where draco joined up with the other side and that snape brought him there.</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-09 14:21:16.613869', 11546016, 228330885, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1454652&amp;r ... (1831 characters truncated) ... nExcited to see where this story goes, especially the development of a relationship between Draco and Hermione! Please update soon!</div></td>\n</tr>'), ('2017-02-09 14:21:16.613871', 11546016, 227478753, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6285863&amp;r ... (963 characters truncated) ... e. The characters don\'t change too much from the book, and I love it. Anyway, I will gladly keep reading your story ! Keep going !</div></td>\n</tr>'))]
06:21:16 reviews: Job OK (6a4cb79f-55a8-4eb8-ada1-f891b4907b01)
06:21:16 Result is kept for 500 seconds
06:21:16 
06:21:16 *** Listening on chapters, profiles, reviews...
06:21:16 reviews: fanfic.jobs.crawl_reviews(11546612) (891e951c-1a46-4a61-a2a1-7b1019711b51)
06:21:39 reviews: Job OK (891e951c-1a46-4a61-a2a1-7b1019711b51)
06:21:39 Result is kept for 500 seconds
06:21:39 
06:21:39 *** Listening on chapters, profiles, reviews...
06:21:39 reviews: fanfic.jobs.crawl_reviews(11546870) (fb4bc62e-4f8a-4370-94bd-8e61ab29744b)
06:21:55 reviews: Job OK (fb4bc62e-4f8a-4370-94bd-8e61ab29744b)
06:21:55 Result is kept for 500 seconds
06:21:55 
06:21:55 *** Listening on chapters, profiles, reviews...
06:21:55 reviews: fanfic.jobs.crawl_reviews(11546930) (e3985d92-9eb2-4052-847c-2b5ceaed8e3e)
06:23:20 reviews: Job OK (e3985d92-9eb2-4052-847c-2b5ceaed8e3e)
06:23:20 Result is kept for 500 seconds
06:23:20 
06:23:20 *** Listening on chapters, profiles, reviews...
06:23:20 reviews: fanfic.jobs.crawl_reviews(11547028) (193f0411-551a-40af-9907-5c95b4a03a39)
06:23:41 reviews: Job OK (193f0411-551a-40af-9907-5c95b4a03a39)
06:23:41 Result is kept for 500 seconds
06:23:41 
06:23:41 *** Listening on chapters, profiles, reviews...
06:23:41 reviews: fanfic.jobs.crawl_reviews(11547735) (7f26003d-7ee7-4c90-957a-cce83aa27987)
06:24:15 reviews: Job OK (7f26003d-7ee7-4c90-957a-cce83aa27987)
06:24:15 Result is kept for 500 seconds
06:24:15 
06:24:15 *** Listening on chapters, profiles, reviews...
06:24:15 reviews: fanfic.jobs.crawl_reviews(11549559) (18b376a9-b50a-4e91-a900-db3618b77428)
06:25:30 reviews: Job OK (18b376a9-b50a-4e91-a900-db3618b77428)
06:25:30 Result is kept for 500 seconds
06:25:30 
06:25:30 *** Listening on chapters, profiles, reviews...
06:25:30 reviews: fanfic.jobs.crawl_reviews(11550444) (f401c475-d20b-401d-8750-32218a077ba2)
06:25:38 reviews: Job OK (f401c475-d20b-401d-8750-32218a077ba2)
06:25:38 Result is kept for 500 seconds
06:25:38 
06:25:38 *** Listening on chapters, profiles, reviews...
06:25:38 reviews: fanfic.jobs.crawl_reviews(11550901) (0d668fd9-5eea-47a4-bc35-8390aae3f1c4)
06:26:53 reviews: Job OK (0d668fd9-5eea-47a4-bc35-8390aae3f1c4)
06:26:53 Result is kept for 500 seconds
06:26:53 
06:26:53 *** Listening on chapters, profiles, reviews...
06:26:53 reviews: fanfic.jobs.crawl_reviews(11551640) (157727b3-aaec-43aa-9316-2126d19a641f)
06:27:05 reviews: Job OK (157727b3-aaec-43aa-9316-2126d19a641f)
06:27:05 Result is kept for 500 seconds
06:27:05 
06:27:05 *** Listening on chapters, profiles, reviews...
06:27:05 reviews: fanfic.jobs.crawl_reviews(11552218) (16b368e7-0c27-4a58-a22f-8985ccf9442d)
06:27:40 reviews: Job OK (16b368e7-0c27-4a58-a22f-8985ccf9442d)
06:27:40 Result is kept for 500 seconds
06:27:40 
06:27:40 *** Listening on chapters, profiles, reviews...
06:27:40 reviews: fanfic.jobs.crawl_reviews(11553991) (583603ad-2668-49b9-be26-2fbc4e5776c2)
06:28:14 reviews: Job OK (583603ad-2668-49b9-be26-2fbc4e5776c2)
06:28:14 Result is kept for 500 seconds
06:28:14 
06:28:14 *** Listening on chapters, profiles, reviews...
06:28:14 reviews: fanfic.jobs.crawl_reviews(11554835) (451e07ed-cd3a-4d58-9637-a508c825c473)
06:28:21 reviews: Job OK (451e07ed-cd3a-4d58-9637-a508c825c473)
06:28:21 Result is kept for 500 seconds
06:28:21 
06:28:21 *** Listening on chapters, profiles, reviews...
06:28:21 reviews: fanfic.jobs.crawl_reviews(11555315) (a36cc573-0014-40c8-b4e7-0cce879fbf76)
06:28:56 reviews: Job OK (a36cc573-0014-40c8-b4e7-0cce879fbf76)
06:28:56 Result is kept for 500 seconds
06:28:56 
06:28:56 *** Listening on chapters, profiles, reviews...
06:28:56 reviews: fanfic.jobs.crawl_reviews(11555352) (80872bcb-6a65-4808-a2c3-53100c360165)
2017-02-09 06:29:02 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 14:29:02.016306', 11555352, 240628939, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1597043&amp;r ... (962 characters truncated) ... </span> </small><div style="margin-top:5px">Why does this have so little review?! Oh my goodness! This story is absolutely amazing!</div></td>\n</tr>'), ('2017-02-09 14:29:02.016310', 11555352, 229288341, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4174904&amp;r ... (921 characters truncated) ... . <span data-xutime="1447915308">11/18/2015</span> </small><div style="margin-top:5px">I didn\'t expect who parents for some reason</div></td>\n</tr>'), ('2017-02-09 14:29:02.016313', 11555352, 229287462, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4174904&amp;r ... (915 characters truncated) ... ter 3 . <span data-xutime="1447913310">11/18/2015</span> </small><div style="margin-top:5px">This is so different and well written!</div></td>\n</tr>'), ('2017-02-09 14:29:02.016315', 11555352, 229287112, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4174904&amp;r ... (936 characters truncated) ... time="1447912533">11/18/2015</span> </small><div style="margin-top:5px">I\'m curious about what will happen with Andy and he diary.</div></td>\n</tr>'), ('2017-02-09 14:29:02.016317', 11555352, 229286804, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4174904&amp;r ... (953 characters truncated) ... >11/18/2015</span> </small><div style="margin-top:5px">So far I\'m liking Andy and how you describe things. It\'s already original!</div></td>\n</tr>'), ('2017-02-09 14:29:02.016319', 11555352, 228419807, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7001293&amp;r ... (1243 characters truncated) ... really enjoyed the Founders. That was something I hadn\'t seen before. All in all, I\'m really looking forward to this! Keep it up!</div></td>\n</tr>'), ('2017-02-09 14:29:02.016320', 11555352, 240628939, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1597043&amp;r ... (962 characters truncated) ... </span> </small><div style="margin-top:5px">Why does this have so little review?! Oh my goodness! This story is absolutely amazing!</div></td>\n</tr>'), ('2017-02-09 14:29:02.016322', 11555352, 229288341, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4174904&amp;r ... (921 characters truncated) ... . <span data-xutime="1447915308">11/18/2015</span> </small><div style="margin-top:5px">I didn\'t expect who parents for some reason</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-09 14:29:02.016328', 11555352, 229286804, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4174904&amp;r ... (953 characters truncated) ... >11/18/2015</span> </small><div style="margin-top:5px">So far I\'m liking Andy and how you describe things. It\'s already original!</div></td>\n</tr>'), ('2017-02-09 14:29:02.016330', 11555352, 228419807, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7001293&amp;r ... (1243 characters truncated) ... really enjoyed the Founders. That was something I hadn\'t seen before. All in all, I\'m really looking forward to this! Keep it up!</div></td>\n</tr>'))]
06:29:02 reviews: Job OK (80872bcb-6a65-4808-a2c3-53100c360165)
06:29:02 Result is kept for 500 seconds
06:29:02 
06:29:02 *** Listening on chapters, profiles, reviews...
06:29:02 reviews: fanfic.jobs.crawl_reviews(11556766) (ad654b9d-6551-413d-b723-f209631057ae)
06:30:01 reviews: Job OK (ad654b9d-6551-413d-b723-f209631057ae)
06:30:01 Result is kept for 500 seconds
06:30:01 
06:30:01 *** Listening on chapters, profiles, reviews...
06:30:01 reviews: fanfic.jobs.crawl_reviews(11557283) (ccce435e-60e8-4e3b-a8ae-311608c45bd5)
06:30:09 reviews: Job OK (ccce435e-60e8-4e3b-a8ae-311608c45bd5)
06:30:09 Result is kept for 500 seconds
06:30:09 
06:30:09 *** Listening on chapters, profiles, reviews...
06:30:09 reviews: fanfic.jobs.crawl_reviews(11557346) (7cf3bedc-36ed-48cc-af0c-265076749ca6)
06:31:09 reviews: Job OK (7cf3bedc-36ed-48cc-af0c-265076749ca6)
06:31:09 Result is kept for 500 seconds
06:31:09 
06:31:09 *** Listening on chapters, profiles, reviews...
06:31:09 reviews: fanfic.jobs.crawl_reviews(11558675) (4ffe2d64-597c-42ba-9493-6c76452f963a)
06:31:15 reviews: Job OK (4ffe2d64-597c-42ba-9493-6c76452f963a)
06:31:15 Result is kept for 500 seconds
06:31:15 
06:31:15 *** Listening on chapters, profiles, reviews...
06:31:15 reviews: fanfic.jobs.crawl_reviews(11558837) (e7cee59a-148a-4ddd-8960-76653d7dd477)
06:36:24 reviews: Job OK (e7cee59a-148a-4ddd-8960-76653d7dd477)
06:36:24 Result is kept for 500 seconds
06:36:24 
06:36:24 *** Listening on chapters, profiles, reviews...
06:36:24 reviews: fanfic.jobs.crawl_reviews(11559036) (38d122c0-3089-4ca3-9eba-819bfee4fb97)
06:36:55 reviews: Job OK (38d122c0-3089-4ca3-9eba-819bfee4fb97)
06:36:55 Result is kept for 500 seconds
06:36:55 
06:36:55 *** Listening on chapters, profiles, reviews...
06:36:55 reviews: fanfic.jobs.crawl_reviews(11559371) (df96262e-bc6c-4945-9d65-f4240c35c63f)
06:37:21 reviews: Job OK (df96262e-bc6c-4945-9d65-f4240c35c63f)
06:37:21 Result is kept for 500 seconds
06:37:21 
06:37:21 *** Listening on chapters, profiles, reviews...
06:37:21 reviews: fanfic.jobs.crawl_reviews(11560398) (9a716b28-dfae-48e5-bd56-7a899004a8cd)
06:38:33 reviews: Job OK (9a716b28-dfae-48e5-bd56-7a899004a8cd)
06:38:33 Result is kept for 500 seconds
06:38:33 
06:38:33 *** Listening on chapters, profiles, reviews...
06:38:33 reviews: fanfic.jobs.crawl_reviews(11561144) (06bf95df-4ebc-47de-aa61-7f7015d23530)
06:38:54 reviews: Job OK (06bf95df-4ebc-47de-aa61-7f7015d23530)
06:38:54 Result is kept for 500 seconds
06:38:54 
06:38:54 *** Listening on chapters, profiles, reviews...
06:38:54 reviews: fanfic.jobs.crawl_reviews(11561410) (9696a802-b107-4eb1-85da-e1cb6afc1e7c)
06:45:17 reviews: Job OK (9696a802-b107-4eb1-85da-e1cb6afc1e7c)
06:45:17 Result is kept for 500 seconds
06:45:17 
06:45:17 *** Listening on chapters, profiles, reviews...
06:45:17 reviews: fanfic.jobs.crawl_reviews(11562016) (76edcd7e-f75f-4f12-ba82-317808a01361)
06:45:26 reviews: Job OK (76edcd7e-f75f-4f12-ba82-317808a01361)
06:45:26 Result is kept for 500 seconds
06:45:26 
06:45:26 *** Listening on chapters, profiles, reviews...
06:45:26 reviews: fanfic.jobs.crawl_reviews(11562122) (c015a90f-44fc-477c-9859-e5ae7163c54e)
06:46:51 reviews: Job OK (c015a90f-44fc-477c-9859-e5ae7163c54e)
06:46:51 Result is kept for 500 seconds
06:46:51 
06:46:51 *** Listening on chapters, profiles, reviews...
06:46:51 reviews: fanfic.jobs.crawl_reviews(11562871) (12bfaf4b-cb08-4f75-8b07-8230c34e6d65)
06:49:07 reviews: Job OK (12bfaf4b-cb08-4f75-8b07-8230c34e6d65)
06:49:07 Result is kept for 500 seconds
06:49:07 
06:49:07 *** Listening on chapters, profiles, reviews...
06:49:07 reviews: fanfic.jobs.crawl_reviews(11563018) (c123c46f-8f4f-4112-957e-08c85221d3a2)
06:49:58 reviews: Job OK (c123c46f-8f4f-4112-957e-08c85221d3a2)
06:49:58 Result is kept for 500 seconds
06:49:58 
06:49:58 *** Listening on chapters, profiles, reviews...
06:49:58 reviews: fanfic.jobs.crawl_reviews(11564062) (49ccd5a9-ac2c-42f5-9928-95981c5cbbf0)
06:50:15 reviews: Job OK (49ccd5a9-ac2c-42f5-9928-95981c5cbbf0)
06:50:15 Result is kept for 500 seconds
06:50:15 
06:50:15 *** Listening on chapters, profiles, reviews...
06:50:15 reviews: fanfic.jobs.crawl_reviews(11567135) (ff82da17-43f0-4907-b8a9-bd8a6a71a5a4)
06:51:13 reviews: Job OK (ff82da17-43f0-4907-b8a9-bd8a6a71a5a4)
06:51:13 Result is kept for 500 seconds
06:51:13 
06:51:13 *** Listening on chapters, profiles, reviews...
06:51:13 reviews: fanfic.jobs.crawl_reviews(11568661) (723f103d-0866-49d2-915e-74ea5049553d)
06:53:27 reviews: Job OK (723f103d-0866-49d2-915e-74ea5049553d)
06:53:27 Result is kept for 500 seconds
06:53:27 
06:53:27 *** Listening on chapters, profiles, reviews...
06:53:27 reviews: fanfic.jobs.crawl_reviews(11568740) (7fa2cf33-b730-4cf7-bb73-5c2a85854111)
07:02:37 reviews: Job OK (7fa2cf33-b730-4cf7-bb73-5c2a85854111)
07:02:37 Result is kept for 500 seconds
07:02:37 Cleaning registries for queue: chapters
07:02:37 Cleaning registries for queue: profiles
07:02:37 Cleaning registries for queue: reviews
07:02:37 
07:02:37 *** Listening on chapters, profiles, reviews...
07:02:37 reviews: fanfic.jobs.crawl_reviews(11568864) (7744f1c2-0c3c-4cd3-b4af-4a25ef26ca1a)
2017-02-09 07:02:42 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 15:02:42.513647', 11568864, 244119463, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4389794&amp;r ... (810 characters truncated) ... le="color:gray">chapter 12 . <span data-xutime="1479552914">11/19/2016</span> </small><div style="margin-top:5px">love to read more</div></td>\n</tr>'), ('2017-02-09 15:02:42.513652', 11568864, 244101696, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4389794&amp;r ... (802 characters truncated) ... mall style="color:gray">chapter 7 . <span data-xutime="1479503929">11/18/2016</span> </small><div style="margin-top:5px">poor ginny</div></td>\n</tr>'), ('2017-02-09 15:02:42.513654', 11568864, 244093811, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4389794&amp;r ... (812 characters truncated) ... ="color:gray">chapter 4 . <span data-xutime="1479481812">11/18/2016</span> </small><div style="margin-top:5px">really nice begining</div></td>\n</tr>'), ('2017-02-09 15:02:42.513656', 11568864, 239278562, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1080 characters truncated) ... of the best Harry Potter fanfics I\'ve read so far and I\'ve enjoyed it so much! Please let us know if you\'re going to continue :)</div></td>\n</tr>'), ('2017-02-09 15:02:42.513658', 11568864, 235241093, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6757318&amp;r ... (923 characters truncated) ... olor:gray">chapter 5 . <span data-xutime="1459762282">4/4/2016</span> </small><div style="margin-top:5px">Great sorting song XD ;D!</div></td>\n</tr>'), ('2017-02-09 15:02:42.513660', 11568864, 233746901, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (521 characters truncated) ... e="color:gray">chapter 7 . <span data-xutime="1456760387">2/29/2016</span> </small><div style="margin-top:5px">Lovely... Pls update</div></td>\n</tr>'), ('2017-02-09 15:02:42.513662', 11568864, 233618523, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (858 characters truncated) ... interesting- can we hear more of him? Just a personal suggestion. I think the fanfic is amazing, and cant wait for the next chaoter</div></td>\n</tr>'), ('2017-02-09 15:02:42.513664', 11568864, 232228355, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1404278&amp;r ... (915 characters truncated) ... olor:gray">chapter 6 . <span data-xutime="1453710148">1/25/2016</span> </small><div style="margin-top:5px">absolutely adoring this!</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-09 15:02:42.513684', 11568864, 232048570, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4221890&amp;r ... (1355 characters truncated) ... up your own story with details never known to us.<br>\nI can\'t wait to read more!<br>\nYou should keep going!<br>\n<br>\nAlicia :)</div></td>\n</tr>'), ('2017-02-09 15:02:42.513686', 11568864, 231480064, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5406340&amp;r ... (1045 characters truncated) ...  chapter! I think the whole Ginny POV thing is very interesting. I hope you continue this amazing fanfiction when you can!<br>\nAna</div></td>\n</tr>'))]
07:02:42 reviews: Job OK (7744f1c2-0c3c-4cd3-b4af-4a25ef26ca1a)
07:02:42 Result is kept for 500 seconds
07:02:42 
07:02:42 *** Listening on chapters, profiles, reviews...
07:02:42 reviews: fanfic.jobs.crawl_reviews(11570086) (eac33e06-88dc-45ed-a1a9-4720982fb9cb)
07:06:18 reviews: Job OK (eac33e06-88dc-45ed-a1a9-4720982fb9cb)
07:06:18 Result is kept for 500 seconds
07:06:18 
07:06:18 *** Listening on chapters, profiles, reviews...
07:06:18 reviews: fanfic.jobs.crawl_reviews(11571095) (6738f159-846b-4c78-a44b-1904e6537f6c)
07:06:30 reviews: Job OK (6738f159-846b-4c78-a44b-1904e6537f6c)
07:06:30 Result is kept for 500 seconds
07:06:30 
07:06:30 *** Listening on chapters, profiles, reviews...
07:06:30 reviews: fanfic.jobs.crawl_reviews(11572779) (a733b57c-bb2f-4670-88df-bc69685b4afc)
07:07:02 reviews: Job OK (a733b57c-bb2f-4670-88df-bc69685b4afc)
07:07:02 Result is kept for 500 seconds
07:07:02 
07:07:02 *** Listening on chapters, profiles, reviews...
07:07:02 reviews: fanfic.jobs.crawl_reviews(11572804) (6010939c-0f07-47e2-9291-3548a58e5e7a)
07:07:35 reviews: Job OK (6010939c-0f07-47e2-9291-3548a58e5e7a)
07:07:35 Result is kept for 500 seconds
07:07:35 
07:07:35 *** Listening on chapters, profiles, reviews...
07:07:35 reviews: fanfic.jobs.crawl_reviews(11573872) (fdde4ad1-3e9b-479d-8cf7-1f05dd073dc0)
2017-02-09 07:07:40 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 15:07:40.059016', 11573872, 229362704, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2055056&amp;r ... (1018 characters truncated) ... ry a lot. I\'d encourage you to wander away from the canonplot more. i think your writing could support a bit more of a fresh take.</div></td>\n</tr>'), ('2017-02-09 15:07:40.059020', 11573872, 229315833, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2055056&amp;r ... (1047 characters truncated) ... /reviewed?.. nice world building, strong characterizations, very much looking forward to the rest of the story. thanks for writing!</div></td>\n</tr>'), ('2017-02-09 15:07:40.059023', 11573872, 228210429, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4852603&amp;r ... (1008 characters truncated) ... he Relashio spell, you said "speaks" but I think you meant "sparks". It was when Alicia was telling Harry what spells he could use.</div></td>\n</tr>'), ('2017-02-09 15:07:40.059025', 11573872, 228195513, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4852603&amp;r ... (969 characters truncated) ... > </small><div style="margin-top:5px">I think you mean "private" not "privet"? "Privet" is the street Harry lives on, Privet Drive.</div></td>\n</tr>'), ('2017-02-09 15:07:40.059026', 11573872, 228140755, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (959 characters truncated) ... /span> </small><div style="margin-top:5px">Hello! I really like this story! I can\'t wait to read year two! Update soon ! Ciao ciao</div></td>\n</tr>'), ('2017-02-09 15:07:40.059028', 11573872, 229362704, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2055056&amp;r ... (1018 characters truncated) ... ry a lot. I\'d encourage you to wander away from the canonplot more. i think your writing could support a bit more of a fresh take.</div></td>\n</tr>'), ('2017-02-09 15:07:40.059030', 11573872, 229315833, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2055056&amp;r ... (1047 characters truncated) ... /reviewed?.. nice world building, strong characterizations, very much looking forward to the rest of the story. thanks for writing!</div></td>\n</tr>'), ('2017-02-09 15:07:40.059032', 11573872, 228210429, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4852603&amp;r ... (1008 characters truncated) ... he Relashio spell, you said "speaks" but I think you meant "sparks". It was when Alicia was telling Harry what spells he could use.</div></td>\n</tr>'), ('2017-02-09 15:07:40.059034', 11573872, 228195513, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4852603&amp;r ... (969 characters truncated) ... > </small><div style="margin-top:5px">I think you mean "private" not "privet"? "Privet" is the street Harry lives on, Privet Drive.</div></td>\n</tr>'), ('2017-02-09 15:07:40.059036', 11573872, 228140755, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (959 characters truncated) ... /span> </small><div style="margin-top:5px">Hello! I really like this story! I can\'t wait to read year two! Update soon ! Ciao ciao</div></td>\n</tr>'))]
07:07:40 reviews: Job OK (fdde4ad1-3e9b-479d-8cf7-1f05dd073dc0)
07:07:40 Result is kept for 500 seconds
07:07:40 
07:07:40 *** Listening on chapters, profiles, reviews...
07:07:40 reviews: fanfic.jobs.crawl_reviews(11573954) (01695b5f-0f88-4663-afc4-8413e3f4549b)
07:08:42 reviews: Job OK (01695b5f-0f88-4663-afc4-8413e3f4549b)
07:08:42 Result is kept for 500 seconds
07:08:42 
07:08:42 *** Listening on chapters, profiles, reviews...
07:08:42 reviews: fanfic.jobs.crawl_reviews(11574569) (3ec7261c-96f4-4a1e-aecb-8e616d2d64d2)
07:25:43 reviews: Job OK (3ec7261c-96f4-4a1e-aecb-8e616d2d64d2)
07:25:43 Result is kept for 500 seconds
07:25:43 
07:25:43 *** Listening on chapters, profiles, reviews...
07:25:43 reviews: fanfic.jobs.crawl_reviews(11574914) (991df0d0-481e-473b-9eef-1484f66d7983)
07:27:25 reviews: Job OK (991df0d0-481e-473b-9eef-1484f66d7983)
07:27:25 Result is kept for 500 seconds
07:27:25 
07:27:25 *** Listening on chapters, profiles, reviews...
07:27:25 reviews: fanfic.jobs.crawl_reviews(11575107) (cb59676b-4654-4d4a-b5f5-c3df2589b752)
07:29:50 reviews: Job OK (cb59676b-4654-4d4a-b5f5-c3df2589b752)
07:29:50 Result is kept for 500 seconds
07:29:50 
07:29:50 *** Listening on chapters, profiles, reviews...
07:29:50 reviews: fanfic.jobs.crawl_reviews(11575833) (1f4989e2-2561-4cf1-9b68-813a23e80fd1)
2017-02-09 07:29:53 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 15:29:53.929826', 11575833, 228224745, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (1088 characters truncated) ... ay, I\'m impressed! I can\'t wait to read year three, but I understand that your exams are your priorities. Update soon! Ciao ciao.</div></td>\n</tr>'), ('2017-02-09 15:29:53.929831', 11575833, 228181322, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (964 characters truncated) ... /span> </small><div style="margin-top:5px">Hello! Fantastic four characters! I can\'t wait to read the next, update soon! Ciao ciao</div></td>\n</tr>'), ('2017-02-09 15:29:53.929833', 11575833, 228224745, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (1088 characters truncated) ... ay, I\'m impressed! I can\'t wait to read year three, but I understand that your exams are your priorities. Update soon! Ciao ciao.</div></td>\n</tr>'), ('2017-02-09 15:29:53.929835', 11575833, 228181322, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (964 characters truncated) ... /span> </small><div style="margin-top:5px">Hello! Fantastic four characters! I can\'t wait to read the next, update soon! Ciao ciao</div></td>\n</tr>'))]
07:29:53 reviews: Job OK (1f4989e2-2561-4cf1-9b68-813a23e80fd1)
07:29:53 Result is kept for 500 seconds
07:29:53 
07:29:53 *** Listening on chapters, profiles, reviews...
07:29:53 reviews: fanfic.jobs.crawl_reviews(11576543) (90616682-f8f5-43ee-83ce-8acc8bf7d8fa)
2017-02-09 07:29:59 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 15:29:59.043572', 11576543, 245101406, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7274955&amp;r ... (1246 characters truncated) ... see a Slytherin version of the DA. I like how flawlessly you included their subterfuge. Rather nice touch. Overall, very well done!</div></td>\n</tr>'), ('2017-02-09 15:29:59.043576', 11576543, 243775522, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (836 characters truncated) ... thing to find! To be honest - I read your story in a few day from start to end - got really absorbed in it! Greetings from Germany.</div></td>\n</tr>'), ('2017-02-09 15:29:59.043578', 11576543, 241297823, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (557 characters truncated) ... time="1472316569">8/27/2016</span> </small><div style="margin-top:5px">oh, this is very interesting, i can\'t wait to read the rest</div></td>\n</tr>'), ('2017-02-09 15:29:59.043580', 11576543, 239807897, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=444524&amp;rw ... (1243 characters truncated) ... ead the next chapter! You are one of my favorite fan fiction writers. My other favorite story of yours is The Enchanted Tower Room.</div></td>\n</tr>'), ('2017-02-09 15:29:59.043582', 11576543, 236426231, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7692452&amp;r ... (1584 characters truncated) ... \nPlease continue this wonderful story, and I\'m already looking forward to the next chapter.<br>\n<br>\nCheers<br>\n<br>\nTimelady</div></td>\n</tr>'), ('2017-02-09 15:29:59.043584', 11576543, 231205815, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1900241&amp;r ... (1132 characters truncated) ...  written. You did such an amazing job of twisting the actual plot just enough to make your idea work perfectly. Please update soon.</div></td>\n</tr>'), ('2017-02-09 15:29:59.043586', 11576543, 230833628, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4704707&amp;r ... (920 characters truncated) ...  found it a little boring the last chapter when it was really like the books but I really like this chapter and I love your writing</div></td>\n</tr>'), ('2017-02-09 15:29:59.043588', 11576543, 230650446, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4704707&amp;r ... (1060 characters truncated) ... aring! I\'m gonna continue to read the rest of the chapter and I hope(and believe) that they are as good as the ones I already read</div></td>\n</tr>')  ... displaying 10 of 18 total bound parameter sets ...  ('2017-02-09 15:29:59.043605', 11576543, 230650446, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4704707&amp;r ... (1060 characters truncated) ... aring! I\'m gonna continue to read the rest of the chapter and I hope(and believe) that they are as good as the ones I already read</div></td>\n</tr>'), ('2017-02-09 15:29:59.043606', 11576543, 230496437, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=873016&amp;rw ... (1064 characters truncated) ... ew chapter! <br>\nSuch an intricate plot (took me a few reads to get it straight in my head lol) and so much fun to read. Thankyou!</div></td>\n</tr>'))]
07:29:59 reviews: Job OK (90616682-f8f5-43ee-83ce-8acc8bf7d8fa)
07:29:59 Result is kept for 500 seconds
07:29:59 
07:29:59 *** Listening on chapters, profiles, reviews...
07:29:59 reviews: fanfic.jobs.crawl_reviews(11576985) (aae58487-fead-4d9f-9227-d559733b9c95)
07:30:24 reviews: Job OK (aae58487-fead-4d9f-9227-d559733b9c95)
07:30:24 Result is kept for 500 seconds
07:30:24 
07:30:24 *** Listening on chapters, profiles, reviews...
07:30:24 reviews: fanfic.jobs.crawl_reviews(11577969) (15fe1df4-d901-4f8a-91cc-f4e97eedabdd)
07:33:54 reviews: Job OK (15fe1df4-d901-4f8a-91cc-f4e97eedabdd)
07:33:54 Result is kept for 500 seconds
07:33:54 
07:33:54 *** Listening on chapters, profiles, reviews...
07:33:54 reviews: fanfic.jobs.crawl_reviews(11578406) (23e4c331-2d3d-4a12-9646-e209af9494b3)
07:34:03 reviews: Job OK (23e4c331-2d3d-4a12-9646-e209af9494b3)
07:34:03 Result is kept for 500 seconds
07:34:03 
07:34:03 *** Listening on chapters, profiles, reviews...
07:34:03 reviews: fanfic.jobs.crawl_reviews(11578510) (e50e27cb-3dc3-4cb0-8cdd-9c0daad4a204)
07:35:41 reviews: Job OK (e50e27cb-3dc3-4cb0-8cdd-9c0daad4a204)
07:35:41 Result is kept for 500 seconds
07:35:41 
07:35:41 *** Listening on chapters, profiles, reviews...
07:35:41 reviews: fanfic.jobs.crawl_reviews(11578526) (e8f613e9-889b-47ce-b735-8b0b5bd0adfc)
07:36:00 reviews: Job OK (e8f613e9-889b-47ce-b735-8b0b5bd0adfc)
07:36:00 Result is kept for 500 seconds
07:36:00 
07:36:00 *** Listening on chapters, profiles, reviews...
07:36:00 reviews: fanfic.jobs.crawl_reviews(11578938) (ae38b30b-67fa-4771-8809-c5f763f7a545)
07:37:38 reviews: Job OK (ae38b30b-67fa-4771-8809-c5f763f7a545)
07:37:38 Result is kept for 500 seconds
07:37:38 
07:37:38 *** Listening on chapters, profiles, reviews...
07:37:38 reviews: fanfic.jobs.crawl_reviews(11579613) (e154f972-e0fb-46b7-bc4a-8a43ac18e21f)
07:37:59 reviews: Job OK (e154f972-e0fb-46b7-bc4a-8a43ac18e21f)
07:37:59 Result is kept for 500 seconds
07:37:59 
07:37:59 *** Listening on chapters, profiles, reviews...
07:37:59 reviews: fanfic.jobs.crawl_reviews(11579634) (8cee39b8-ea15-4277-b5ee-2c087462aa61)
07:38:44 reviews: Job OK (8cee39b8-ea15-4277-b5ee-2c087462aa61)
07:38:44 Result is kept for 500 seconds
07:38:44 
07:38:44 *** Listening on chapters, profiles, reviews...
07:38:44 reviews: fanfic.jobs.crawl_reviews(11580629) (b5d1ca6b-ae59-4d9a-9cc1-7548ebd2bcfe)
07:39:05 reviews: Job OK (b5d1ca6b-ae59-4d9a-9cc1-7548ebd2bcfe)
07:39:05 Result is kept for 500 seconds
07:39:05 
07:39:05 *** Listening on chapters, profiles, reviews...
07:39:05 reviews: fanfic.jobs.crawl_reviews(11580650) (4fbc57ec-7f7c-4fd7-8bf7-68af4569784a)
07:42:11 reviews: Job OK (4fbc57ec-7f7c-4fd7-8bf7-68af4569784a)
07:42:11 Result is kept for 500 seconds
07:42:11 
07:42:11 *** Listening on chapters, profiles, reviews...
07:42:11 reviews: fanfic.jobs.crawl_reviews(11581347) (91b4f024-2e65-48e1-bf0e-b3cc29bc45f3)
07:42:31 reviews: Job OK (91b4f024-2e65-48e1-bf0e-b3cc29bc45f3)
07:42:31 Result is kept for 500 seconds
07:42:31 
07:42:31 *** Listening on chapters, profiles, reviews...
07:42:31 reviews: fanfic.jobs.crawl_reviews(11582634) (91a261ec-9ac5-46b1-ab13-df699d9a8f03)
07:42:49 reviews: Job OK (91a261ec-9ac5-46b1-ab13-df699d9a8f03)
07:42:49 Result is kept for 500 seconds
07:42:49 
07:42:49 *** Listening on chapters, profiles, reviews...
07:42:49 reviews: fanfic.jobs.crawl_reviews(11582856) (c8951ab5-fe59-4580-9b2a-67f9dc6e69b1)
07:45:03 reviews: Job OK (c8951ab5-fe59-4580-9b2a-67f9dc6e69b1)
07:45:03 Result is kept for 500 seconds
07:45:03 
07:45:03 *** Listening on chapters, profiles, reviews...
07:45:03 reviews: fanfic.jobs.crawl_reviews(11582954) (61d5e163-4cb8-4c42-9c21-ed7ef6d3d06a)
07:47:50 reviews: Job OK (61d5e163-4cb8-4c42-9c21-ed7ef6d3d06a)
07:47:50 Result is kept for 500 seconds
07:47:50 
07:47:50 *** Listening on chapters, profiles, reviews...
07:47:50 reviews: fanfic.jobs.crawl_reviews(11583818) (cfea87ab-a048-469b-8a58-ec97a48854ef)
07:48:02 reviews: Job OK (cfea87ab-a048-469b-8a58-ec97a48854ef)
07:48:02 Result is kept for 500 seconds
07:48:02 
07:48:02 *** Listening on chapters, profiles, reviews...
07:48:02 reviews: fanfic.jobs.crawl_reviews(11584214) (ec749ac8-7dea-4c11-9504-53e046072fc1)
07:48:42 reviews: Job OK (ec749ac8-7dea-4c11-9504-53e046072fc1)
07:48:42 Result is kept for 500 seconds
07:48:42 
07:48:42 *** Listening on chapters, profiles, reviews...
07:48:42 reviews: fanfic.jobs.crawl_reviews(11584485) (c503a4fa-eb4a-43b1-8d49-583297e9fb24)
2017-02-09 07:48:46 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 15:48:46.216595', 11584485, 232472476, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7141394&amp;r ... (888 characters truncated) ... rgin-top:5px">Please tell me this isn\'t where you leave us because you have done a good job with this. I do hope you keep writing.</div></td>\n</tr>'), ('2017-02-09 15:48:46.216600', 11584485, 231923396, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7127196&amp;r ... (970 characters truncated) ... op:5px">I\'ve read this for the second time now, and I absolutely loved it. It made me feel all fuzzy and happy, haha. Really good!</div></td>\n</tr>'), ('2017-02-09 15:48:46.216603', 11584485, 230569200, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (568 characters truncated) ... 10940">12/17/2015</span> </small><div style="margin-top:5px">Very nice- not at all copied from the summer after the war. #copypaste</div></td>\n</tr>'), ('2017-02-09 15:48:46.216605', 11584485, 229702856, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4776852&amp;r ... (905 characters truncated) ... chapter 34 . <span data-xutime="1448803055">11/29/2015</span> </small><div style="margin-top:5px">love it ! can\'t wait for more...</div></td>\n</tr>'), ('2017-02-09 15:48:46.216607', 11584485, 229675827, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4776852&amp;r ... (889 characters truncated) ... le="color:gray">chapter 11 . <span data-xutime="1448749490">11/28/2015</span> </small><div style="margin-top:5px">wonderful chapter</div></td>\n</tr>'), ('2017-02-09 15:48:46.216609', 11584485, 228473444, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (511 characters truncated) ... mall style="color:gray">chapter 34 . <span data-xutime="1446088346">10/28/2015</span> </small><div style="margin-top:5px">great job</div></td>\n</tr>'), ('2017-02-09 15:48:46.216611', 11584485, 228464849, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=499792&amp;rw ... (1050 characters truncated) ... huge thing in the scheme of things, but certainly something to think about when writing British characters ;)<br>\n<br>\nWell done.</div></td>\n</tr>'), ('2017-02-09 15:48:46.216613', 11584485, 232472476, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7141394&amp;r ... (888 characters truncated) ... rgin-top:5px">Please tell me this isn\'t where you leave us because you have done a good job with this. I do hope you keep writing.</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-09 15:48:46.216623', 11584485, 228473444, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (511 characters truncated) ... mall style="color:gray">chapter 34 . <span data-xutime="1446088346">10/28/2015</span> </small><div style="margin-top:5px">great job</div></td>\n</tr>'), ('2017-02-09 15:48:46.216625', 11584485, 228464849, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=499792&amp;rw ... (1050 characters truncated) ... huge thing in the scheme of things, but certainly something to think about when writing British characters ;)<br>\n<br>\nWell done.</div></td>\n</tr>'))]
07:48:46 reviews: Job OK (c503a4fa-eb4a-43b1-8d49-583297e9fb24)
07:48:46 Result is kept for 500 seconds
07:48:46 
07:48:46 *** Listening on chapters, profiles, reviews...
07:48:46 reviews: fanfic.jobs.crawl_reviews(11585382) (9de8909a-7e57-4680-8892-1b99460d749d)
07:48:53 reviews: Job OK (9de8909a-7e57-4680-8892-1b99460d749d)
07:48:53 Result is kept for 500 seconds
07:48:53 
07:48:53 *** Listening on chapters, profiles, reviews...
07:48:53 reviews: fanfic.jobs.crawl_reviews(11585513) (46bd06bc-8c4f-41a3-a6e6-09d9f79c6393)
07:52:51 reviews: Job OK (46bd06bc-8c4f-41a3-a6e6-09d9f79c6393)
07:52:51 Result is kept for 500 seconds
07:52:51 
07:52:51 *** Listening on chapters, profiles, reviews...
07:52:51 reviews: fanfic.jobs.crawl_reviews(11585823) (b4467d2f-6398-465f-9c9c-4ee16fbe4d17)
07:59:09 reviews: Job OK (b4467d2f-6398-465f-9c9c-4ee16fbe4d17)
07:59:09 Result is kept for 500 seconds
07:59:09 
07:59:09 *** Listening on chapters, profiles, reviews...
07:59:09 reviews: fanfic.jobs.crawl_reviews(11586084) (54385135-21ea-4cfd-bb6d-f39518e10d7d)
08:00:37 reviews: Job OK (54385135-21ea-4cfd-bb6d-f39518e10d7d)
08:00:37 Result is kept for 500 seconds
08:00:37 
08:00:37 *** Listening on chapters, profiles, reviews...
08:00:37 reviews: fanfic.jobs.crawl_reviews(11586759) (410a9f5b-fbe6-44e3-97bf-908a74cf3c30)
08:04:45 reviews: Job OK (410a9f5b-fbe6-44e3-97bf-908a74cf3c30)
08:04:45 Result is kept for 500 seconds
08:04:45 Cleaning registries for queue: chapters
08:04:45 Cleaning registries for queue: profiles
08:04:45 Cleaning registries for queue: reviews
08:04:45 
08:04:45 *** Listening on chapters, profiles, reviews...
08:04:45 reviews: fanfic.jobs.crawl_reviews(11587029) (f096ed41-cc64-4ea1-bf79-11fe1ef3c89a)
08:05:39 reviews: Job OK (f096ed41-cc64-4ea1-bf79-11fe1ef3c89a)
08:05:39 Result is kept for 500 seconds
08:05:39 
08:05:39 *** Listening on chapters, profiles, reviews...
08:05:39 reviews: fanfic.jobs.crawl_reviews(11587512) (cc59bec2-7288-48ad-b2d1-0f1c83de4cc2)
08:05:54 reviews: Job OK (cc59bec2-7288-48ad-b2d1-0f1c83de4cc2)
08:05:54 Result is kept for 500 seconds
08:05:54 
08:05:54 *** Listening on chapters, profiles, reviews...
08:05:54 reviews: fanfic.jobs.crawl_reviews(11588563) (e5703e22-dcf2-4561-998d-0ff84a0fa174)
08:05:59 reviews: Job OK (e5703e22-dcf2-4561-998d-0ff84a0fa174)
08:05:59 Result is kept for 500 seconds
08:05:59 
08:05:59 *** Listening on chapters, profiles, reviews...
08:05:59 reviews: fanfic.jobs.crawl_reviews(11588856) (b0bef566-0abd-4822-85af-991d413ecf17)
08:07:30 reviews: Job OK (b0bef566-0abd-4822-85af-991d413ecf17)
08:07:30 Result is kept for 500 seconds
08:07:30 
08:07:30 *** Listening on chapters, profiles, reviews...
08:07:30 reviews: fanfic.jobs.crawl_reviews(11591779) (9b6bc232-4709-4717-8e59-a777032658bd)
08:07:35 reviews: Job OK (9b6bc232-4709-4717-8e59-a777032658bd)
08:07:35 Result is kept for 500 seconds
08:07:35 
08:07:35 *** Listening on chapters, profiles, reviews...
08:07:35 reviews: fanfic.jobs.crawl_reviews(11593026) (6675fd91-8cbb-45c8-b5e4-3c76e162b39d)
08:08:06 reviews: Job OK (6675fd91-8cbb-45c8-b5e4-3c76e162b39d)
08:08:06 Result is kept for 500 seconds
08:08:06 
08:08:06 *** Listening on chapters, profiles, reviews...
08:08:06 reviews: fanfic.jobs.crawl_reviews(11593337) (1fe21d15-3f35-43b5-9cb4-743676543183)
08:11:20 reviews: Job OK (1fe21d15-3f35-43b5-9cb4-743676543183)
08:11:20 Result is kept for 500 seconds
08:11:20 
08:11:20 *** Listening on chapters, profiles, reviews...
08:11:20 reviews: fanfic.jobs.crawl_reviews(11593616) (63b1d339-c59c-4c40-9887-50b33efffc3b)
08:11:51 reviews: Job OK (63b1d339-c59c-4c40-9887-50b33efffc3b)
08:11:51 Result is kept for 500 seconds
08:11:51 
08:11:51 *** Listening on chapters, profiles, reviews...
08:11:51 reviews: fanfic.jobs.crawl_reviews(11593633) (57e3fb9e-f122-4100-a845-0bcd7b2aa50b)
2017-02-09 08:11:56 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 16:11:56.549239', 11593633, 246146089, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5270832&amp;r ... (809 characters truncated) ...  <small style="color:gray">chapter 1 . <span data-xutime="1484533343">1/15</span> </small><div style="margin-top:5px">Wrong ship...</div></td>\n</tr>'), ('2017-02-09 16:11:56.549243', 11593633, 228626083, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4597457&amp;r ... (1034 characters truncated) ... , THE DUMB FAN GIRL DOES NOT FIT WITH HARRY, IF not Hermione, Daphne, or Susan, or Luna or Fluer even Lavender is better than Ginny</div></td>\n</tr>'), ('2017-02-09 16:11:56.549246', 11593633, 246146089, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5270832&amp;r ... (809 characters truncated) ...  <small style="color:gray">chapter 1 . <span data-xutime="1484533343">1/15</span> </small><div style="margin-top:5px">Wrong ship...</div></td>\n</tr>'), ('2017-02-09 16:11:56.549248', 11593633, 228626083, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4597457&amp;r ... (1034 characters truncated) ... , THE DUMB FAN GIRL DOES NOT FIT WITH HARRY, IF not Hermione, Daphne, or Susan, or Luna or Fluer even Lavender is better than Ginny</div></td>\n</tr>'))]
08:11:56 reviews: Job OK (57e3fb9e-f122-4100-a845-0bcd7b2aa50b)
08:11:56 Result is kept for 500 seconds
08:11:56 
08:11:56 *** Listening on chapters, profiles, reviews...
08:11:56 reviews: fanfic.jobs.crawl_reviews(11594211) (44bea0fe-b7bd-4ee8-82e3-15c99d24f6b5)
08:15:07 reviews: Job OK (44bea0fe-b7bd-4ee8-82e3-15c99d24f6b5)
08:15:07 Result is kept for 500 seconds
08:15:07 
08:15:07 *** Listening on chapters, profiles, reviews...
08:15:07 reviews: fanfic.jobs.crawl_reviews(11596427) (68ce0c5a-ff52-494a-940c-20586767a404)
08:15:13 reviews: Job OK (68ce0c5a-ff52-494a-940c-20586767a404)
08:15:13 Result is kept for 500 seconds
08:15:13 
08:15:13 *** Listening on chapters, profiles, reviews...
08:15:13 reviews: fanfic.jobs.crawl_reviews(11597278) (a694a1fa-3551-412b-b695-cd71f87f1d35)
08:15:22 reviews: Job OK (a694a1fa-3551-412b-b695-cd71f87f1d35)
08:15:22 Result is kept for 500 seconds
08:15:22 
08:15:22 *** Listening on chapters, profiles, reviews...
08:15:22 reviews: fanfic.jobs.crawl_reviews(11597729) (1166d97c-6626-49ab-8888-e255bfe419bc)
08:15:31 reviews: Job OK (1166d97c-6626-49ab-8888-e255bfe419bc)
08:15:31 Result is kept for 500 seconds
08:15:31 
08:15:31 *** Listening on chapters, profiles, reviews...
08:15:31 reviews: fanfic.jobs.crawl_reviews(11598772) (ea0b6521-4513-4d88-a7f6-bda00ae44b97)
2017-02-09 08:15:37 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 16:15:37.221893', 11598772, 238430173, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6361732&amp;r ... (949 characters truncated) ...  data-xutime="1466475702">6/20/2016</span> </small><div style="margin-top:5px">It definitely did. Now let\'s see what happens next.</div></td>\n</tr>'), ('2017-02-09 16:15:37.221897', 11598772, 238261973, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6361732&amp;r ... (951 characters truncated) ... ata-xutime="1466122588">6/16/2016</span> </small><div style="margin-top:5px">Next thing you know everyone is turning on each other.</div></td>\n</tr>'), ('2017-02-09 16:15:37.221900', 11598772, 237113440, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6806926&amp;r ... (811 characters truncated) ... le="color:gray">chapter 19 . <span data-xutime="1463687827">5/19/2016</span> </small><div style="margin-top:5px">cute scenes yesss!</div></td>\n</tr>'), ('2017-02-09 16:15:37.221902', 11598772, 237111507, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6361732&amp;r ... (937 characters truncated) ... r 19 . <span data-xutime="1463683803">5/19/2016</span> </small><div style="margin-top:5px">When can they meet Sirius? Ir killing me</div></td>\n</tr>'), ('2017-02-09 16:15:37.221903', 11598772, 232167121, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2500756&amp;r ... (894 characters truncated) ... :gray">chapter 12 . <span data-xutime="1453604967">1/23/2016</span> </small><div style="margin-top:5px">Continue please! I love it!</div></td>\n</tr>'), ('2017-02-09 16:15:37.221905', 11598772, 230773933, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=976025&amp;rw ... (898 characters truncated) ... >chapter 9 . <span data-xutime="1450978402">12/24/2015</span> </small><div style="margin-top:5px">Looooove this! LOVE. Update soon!</div></td>\n</tr>'), ('2017-02-09 16:15:37.221907', 11598772, 238430173, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6361732&amp;r ... (949 characters truncated) ...  data-xutime="1466475702">6/20/2016</span> </small><div style="margin-top:5px">It definitely did. Now let\'s see what happens next.</div></td>\n</tr>'), ('2017-02-09 16:15:37.221909', 11598772, 238261973, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6361732&amp;r ... (951 characters truncated) ... ata-xutime="1466122588">6/16/2016</span> </small><div style="margin-top:5px">Next thing you know everyone is turning on each other.</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-09 16:15:37.221915', 11598772, 232167121, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2500756&amp;r ... (894 characters truncated) ... :gray">chapter 12 . <span data-xutime="1453604967">1/23/2016</span> </small><div style="margin-top:5px">Continue please! I love it!</div></td>\n</tr>'), ('2017-02-09 16:15:37.221917', 11598772, 230773933, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=976025&amp;rw ... (898 characters truncated) ... >chapter 9 . <span data-xutime="1450978402">12/24/2015</span> </small><div style="margin-top:5px">Looooove this! LOVE. Update soon!</div></td>\n</tr>'))]
08:15:37 reviews: Job OK (ea0b6521-4513-4d88-a7f6-bda00ae44b97)
08:15:37 Result is kept for 500 seconds
08:15:37 
08:15:37 *** Listening on chapters, profiles, reviews...
08:15:37 reviews: fanfic.jobs.crawl_reviews(11599276) (2733ce65-db73-4e9c-adf5-676c41b932ad)
08:16:07 reviews: Job OK (2733ce65-db73-4e9c-adf5-676c41b932ad)
08:16:07 Result is kept for 500 seconds
08:16:07 
08:16:07 *** Listening on chapters, profiles, reviews...
08:16:07 reviews: fanfic.jobs.crawl_reviews(11599390) (a9d146f6-d3d4-421f-9364-31c14c74263b)
08:17:41 reviews: Job OK (a9d146f6-d3d4-421f-9364-31c14c74263b)
08:17:41 Result is kept for 500 seconds
08:17:41 
08:17:41 *** Listening on chapters, profiles, reviews...
08:17:41 reviews: fanfic.jobs.crawl_reviews(11600583) (39acaeff-2908-43d4-82f7-bf367a19209b)
08:19:57 reviews: Job OK (39acaeff-2908-43d4-82f7-bf367a19209b)
08:19:57 Result is kept for 500 seconds
08:19:57 
08:19:57 *** Listening on chapters, profiles, reviews...
08:19:57 reviews: fanfic.jobs.crawl_reviews(11600979) (df0ff078-9a15-40ce-871f-c0c229956fdc)
08:20:11 reviews: Job OK (df0ff078-9a15-40ce-871f-c0c229956fdc)
08:20:11 Result is kept for 500 seconds
08:20:11 
08:20:11 *** Listening on chapters, profiles, reviews...
08:20:11 reviews: fanfic.jobs.crawl_reviews(11602420) (ee14ce0c-0535-4a8e-a77f-b40d608d7daa)
08:22:12 reviews: Job OK (ee14ce0c-0535-4a8e-a77f-b40d608d7daa)
08:22:12 Result is kept for 500 seconds
08:22:12 
08:22:12 *** Listening on chapters, profiles, reviews...
08:22:12 reviews: fanfic.jobs.crawl_reviews(11603390) (e7de9352-5425-4e70-ba8e-98e74bdb9a35)
08:24:06 reviews: Job OK (e7de9352-5425-4e70-ba8e-98e74bdb9a35)
08:24:06 Result is kept for 500 seconds
08:24:06 
08:24:06 *** Listening on chapters, profiles, reviews...
08:24:06 reviews: fanfic.jobs.crawl_reviews(11604200) (2262b18c-43ef-405f-b623-74546cbe1fe1)
08:24:52 reviews: Job OK (2262b18c-43ef-405f-b623-74546cbe1fe1)
08:24:52 Result is kept for 500 seconds
08:24:52 
08:24:52 *** Listening on chapters, profiles, reviews...
08:24:52 reviews: fanfic.jobs.crawl_reviews(11605866) (2de48b72-c39d-4042-9ebd-b50df603ecf6)
08:25:02 reviews: Job OK (2de48b72-c39d-4042-9ebd-b50df603ecf6)
08:25:02 Result is kept for 500 seconds
08:25:02 
08:25:02 *** Listening on chapters, profiles, reviews...
08:25:02 reviews: fanfic.jobs.crawl_reviews(11608524) (338bfca7-f4d8-47e7-8338-33836b5009b6)
08:26:25 reviews: Job OK (338bfca7-f4d8-47e7-8338-33836b5009b6)
08:26:25 Result is kept for 500 seconds
08:26:25 
08:26:25 *** Listening on chapters, profiles, reviews...
08:26:25 reviews: fanfic.jobs.crawl_reviews(11610805) (99e82f43-bb01-40f7-ad53-0e2759a70a67)
08:33:39 reviews: Job OK (99e82f43-bb01-40f7-ad53-0e2759a70a67)
08:33:39 Result is kept for 500 seconds
08:33:39 
08:33:39 *** Listening on chapters, profiles, reviews...
08:33:39 reviews: fanfic.jobs.crawl_reviews(11611600) (62d1915d-2af4-43db-8694-77a47457c91f)
08:34:22 reviews: Job OK (62d1915d-2af4-43db-8694-77a47457c91f)
08:34:22 Result is kept for 500 seconds
08:34:22 
08:34:22 *** Listening on chapters, profiles, reviews...
08:34:22 reviews: fanfic.jobs.crawl_reviews(11613611) (53d4cb72-2273-43fb-9642-971caf0ee799)
08:34:55 reviews: Job OK (53d4cb72-2273-43fb-9642-971caf0ee799)
08:34:55 Result is kept for 500 seconds
08:34:55 
08:34:55 *** Listening on chapters, profiles, reviews...
08:34:55 reviews: fanfic.jobs.crawl_reviews(11614457) (4a97fc2b-4520-4bad-a0d0-c1b3a4f60233)
08:36:28 reviews: Job OK (4a97fc2b-4520-4bad-a0d0-c1b3a4f60233)
08:36:28 Result is kept for 500 seconds
08:36:28 
08:36:28 *** Listening on chapters, profiles, reviews...
08:36:28 reviews: fanfic.jobs.crawl_reviews(11614972) (2ff518cf-893e-4798-9e79-33f04090e54b)
08:36:44 reviews: Job OK (2ff518cf-893e-4798-9e79-33f04090e54b)
08:36:44 Result is kept for 500 seconds
08:36:44 
08:36:44 *** Listening on chapters, profiles, reviews...
08:36:44 reviews: fanfic.jobs.crawl_reviews(11615416) (73e36825-4d4d-487f-b751-6c8948d30b38)
08:36:50 reviews: Job OK (73e36825-4d4d-487f-b751-6c8948d30b38)
08:36:50 Result is kept for 500 seconds
08:36:50 
08:36:50 *** Listening on chapters, profiles, reviews...
08:36:50 reviews: fanfic.jobs.crawl_reviews(11616361) (d39e2442-f9bc-4806-8d79-950901bbdcbb)
2017-02-09 08:36:52 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/11616361/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
08:36:52 reviews: Job OK (d39e2442-f9bc-4806-8d79-950901bbdcbb)
08:36:52 Result is kept for 500 seconds
08:36:52 
08:36:52 *** Listening on chapters, profiles, reviews...
08:36:52 reviews: fanfic.jobs.crawl_reviews(11617386) (ecaee26a-f702-4bc2-8e9d-f1f245ecea28)
08:38:12 reviews: Job OK (ecaee26a-f702-4bc2-8e9d-f1f245ecea28)
08:38:12 Result is kept for 500 seconds
08:38:13 
08:38:13 *** Listening on chapters, profiles, reviews...
08:38:13 reviews: fanfic.jobs.crawl_reviews(11618313) (39747be7-7f97-4188-a948-5b1508451646)
09:10:45 reviews: Job OK (39747be7-7f97-4188-a948-5b1508451646)
09:10:45 Result is kept for 500 seconds
09:10:45 Cleaning registries for queue: chapters
09:10:45 Cleaning registries for queue: profiles
09:10:45 Cleaning registries for queue: reviews
09:10:45 
09:10:45 *** Listening on chapters, profiles, reviews...
09:10:45 reviews: fanfic.jobs.crawl_reviews(11620240) (9e205569-8fa7-4ac2-ba70-9f12580458d4)
09:11:30 reviews: Job OK (9e205569-8fa7-4ac2-ba70-9f12580458d4)
09:11:30 Result is kept for 500 seconds
09:11:30 
09:11:30 *** Listening on chapters, profiles, reviews...
09:11:30 reviews: fanfic.jobs.crawl_reviews(11620282) (2b83788e-e568-466e-9907-39af94aad864)
2017-02-09 09:11:36 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 17:11:36.569395', 11620282, 246411770, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8657076&amp;r ... (926 characters truncated) ...  an incredible tale and history told on a style and spirit rarely found in the best of authors.<br>\n<br>\nTruly unique. Thank you.</div></td>\n</tr>'), ('2017-02-09 17:11:36.569399', 11620282, 245613780, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2284756&amp;r ... (1000 characters truncated) ... e this story, it has been the only fanfiction I\'ve read in the past couple of days and I am excitedly waiting for the next chapter</div></td>\n</tr>'), ('2017-02-09 17:11:36.569402', 11620282, 245536556, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (570 characters truncated) ... 8">12/30/2016</span> </small><div style="margin-top:5px">great work i think godric will be disappointed but can\'t wait to find out</div></td>\n</tr>'), ('2017-02-09 17:11:36.569404', 11620282, 245532658, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2284756&amp;r ... (1400 characters truncated) ... ceived I just had to comment to let you know that you need to keep writing and don\'t ever give up on it. Can\'t wait to read more!</div></td>\n</tr>'), ('2017-02-09 17:11:36.569405', 11620282, 245066271, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (530 characters truncated) ... ">chapter 22 . <span data-xutime="1481999383">12/17/2016</span> </small><div style="margin-top:5px">Lovely story please don\'t stop</div></td>\n</tr>'), ('2017-02-09 17:11:36.569407', 11620282, 244529356, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (563 characters truncated) ... "1480618035">12/1/2016</span> </small><div style="margin-top:5px">A brilliant story, more than worthy of the Harry Potter universe.</div></td>\n</tr>'), ('2017-02-09 17:11:36.569409', 11620282, 241484208, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (644 characters truncated) ... , finally something different, well thought out and well written. I\'m looking forward to read new chapters of this wonderful saga.</div></td>\n</tr>'), ('2017-02-09 17:11:36.569411', 11620282, 241469005, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (727 characters truncated) ... entioned in the books. Really exited to see where the journey takes you and, by extension all of us readers. As Churchill said: KBO</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-09 17:11:36.569446', 11620282, 237338484, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1228 characters truncated) ... with real historical events whilst keeping to the classic HP universe - def one of the best series I\'ve read so far in fanfiction!</div></td>\n</tr>'), ('2017-02-09 17:11:36.569448', 11620282, 230571119, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5300626&amp;r ... (1045 characters truncated) ... series. I think that your idea to keep to historical events is both intriguing and exciting. I wish you the best of luck my friend.</div></td>\n</tr>'))]
09:11:36 reviews: Job OK (2b83788e-e568-466e-9907-39af94aad864)
09:11:36 Result is kept for 500 seconds
09:11:36 
09:11:36 *** Listening on chapters, profiles, reviews...
09:11:36 reviews: fanfic.jobs.crawl_reviews(11622271) (ad9162a6-c942-4600-8c7d-09e09ff9a460)
2017-02-09 09:11:41 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 17:11:41.864219', 11622271, 243002353, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4809806&amp;r ... (1041 characters truncated) ... uch because Alicia\'s presence in the story doesn\'t really change anything, but you\'re clearly doing something right. Keep at it!</div></td>\n</tr>'), ('2017-02-09 17:11:41.864223', 11622271, 229373007, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (579 characters truncated) ... 9/2015</span> </small><div style="margin-top:5px">I think you\'ve published the fourth book instead of the third after chapter 1...</div></td>\n</tr>'), ('2017-02-09 17:11:41.864225', 11622271, 229364219, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (553 characters truncated) ... a-xutime="1447915033">11/18/2015</span> </small><div style="margin-top:5px">I believe this is the first chapter for the fourth book</div></td>\n</tr>'), ('2017-02-09 17:11:41.864228', 11622271, 229302001, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (988 characters truncated) ... gin-top:5px">My friend I was reading again your story when I noticed that chapter two it\'s not from book three but from book four.</div></td>\n</tr>'), ('2017-02-09 17:11:41.864230', 11622271, 229292879, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (949 characters truncated) ... 1/19/2015</span> </small><div style="margin-top:5px">In one word? WOW! I read it all in one morning! Amazing! Update soon ciao ciao</div></td>\n</tr>'), ('2017-02-09 17:11:41.864231', 11622271, 229272235, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (991 characters truncated) ... -top:5px">Buonasera! Finally you have posted the third book, I love the relationship between the two twins. Update soon! Ciao ciao!</div></td>\n</tr>'), ('2017-02-09 17:11:41.864233', 11622271, 243002353, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4809806&amp;r ... (1041 characters truncated) ... uch because Alicia\'s presence in the story doesn\'t really change anything, but you\'re clearly doing something right. Keep at it!</div></td>\n</tr>'), ('2017-02-09 17:11:41.864235', 11622271, 229373007, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (579 characters truncated) ... 9/2015</span> </small><div style="margin-top:5px">I think you\'ve published the fourth book instead of the third after chapter 1...</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-09 17:11:41.864241', 11622271, 229292879, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (949 characters truncated) ... 1/19/2015</span> </small><div style="margin-top:5px">In one word? WOW! I read it all in one morning! Amazing! Update soon ciao ciao</div></td>\n</tr>'), ('2017-02-09 17:11:41.864242', 11622271, 229272235, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (991 characters truncated) ... -top:5px">Buonasera! Finally you have posted the third book, I love the relationship between the two twins. Update soon! Ciao ciao!</div></td>\n</tr>'))]
09:11:41 reviews: Job OK (ad9162a6-c942-4600-8c7d-09e09ff9a460)
09:11:41 Result is kept for 500 seconds
09:11:41 
09:11:41 *** Listening on chapters, profiles, reviews...
09:11:41 reviews: fanfic.jobs.crawl_reviews(11622715) (6744e4c7-8751-42be-8db0-dfcf9e5fd2af)
09:12:54 reviews: Job OK (6744e4c7-8751-42be-8db0-dfcf9e5fd2af)
09:12:54 Result is kept for 500 seconds
09:12:54 
09:12:54 *** Listening on chapters, profiles, reviews...
09:12:54 reviews: fanfic.jobs.crawl_reviews(11623103) (fb2a3283-ee9f-4c1a-a3a0-1be4e2cc1635)
09:13:17 reviews: Job OK (fb2a3283-ee9f-4c1a-a3a0-1be4e2cc1635)
09:13:17 Result is kept for 500 seconds
09:13:17 
09:13:17 *** Listening on chapters, profiles, reviews...
09:13:17 reviews: fanfic.jobs.crawl_reviews(11623372) (64691b59-2ee3-4947-a711-3a41989b5d91)
2017-02-09 09:13:23 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 17:13:23.187272', 11623372, 229369757, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7308547&amp;r ... (888 characters truncated) ... <small style="color:gray">chapter 1 . <span data-xutime="1448105947">11/21/2015</span> </small><div style="margin-top:5px">spelling</div></td>\n</tr>'), ('2017-02-09 17:13:23.187277', 11623372, 229339689, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6326915&amp;r ... (1530 characters truncated) ... , I would be happy to help.<br>\n<br>\nOtherwise, great stuff! I look forward to more! I wish I could write as meaningfully as you!</div></td>\n</tr>'), ('2017-02-09 17:13:23.187279', 11623372, 229318479, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=642058&amp;rw ... (1051 characters truncated) ...  at first, but this chapter was very well written! I definitely could picture everything that was going on like a scene in my mind.</div></td>\n</tr>'), ('2017-02-09 17:13:23.187281', 11623372, 229369757, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7308547&amp;r ... (888 characters truncated) ... <small style="color:gray">chapter 1 . <span data-xutime="1448105947">11/21/2015</span> </small><div style="margin-top:5px">spelling</div></td>\n</tr>'), ('2017-02-09 17:13:23.187283', 11623372, 229339689, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6326915&amp;r ... (1530 characters truncated) ... , I would be happy to help.<br>\n<br>\nOtherwise, great stuff! I look forward to more! I wish I could write as meaningfully as you!</div></td>\n</tr>'), ('2017-02-09 17:13:23.187285', 11623372, 229318479, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=642058&amp;rw ... (1051 characters truncated) ...  at first, but this chapter was very well written! I definitely could picture everything that was going on like a scene in my mind.</div></td>\n</tr>'))]
09:13:23 reviews: Job OK (64691b59-2ee3-4947-a711-3a41989b5d91)
09:13:23 Result is kept for 500 seconds
09:13:23 
09:13:23 *** Listening on chapters, profiles, reviews...
09:13:23 reviews: fanfic.jobs.crawl_reviews(11623392) (033b4151-4253-4968-9359-072f0b3f946a)
09:13:34 reviews: Job OK (033b4151-4253-4968-9359-072f0b3f946a)
09:13:34 Result is kept for 500 seconds
09:13:34 
09:13:34 *** Listening on chapters, profiles, reviews...
09:13:34 reviews: fanfic.jobs.crawl_reviews(11624455) (9b3a2bde-1124-477b-8423-ae65f73b36a7)
09:13:58 reviews: Job OK (9b3a2bde-1124-477b-8423-ae65f73b36a7)
09:13:58 Result is kept for 500 seconds
09:13:58 
09:13:58 *** Listening on chapters, profiles, reviews...
09:13:58 reviews: fanfic.jobs.crawl_reviews(11625127) (41a5b46c-e6d9-4d36-9042-1401fef1de99)
09:25:29 reviews: Job OK (41a5b46c-e6d9-4d36-9042-1401fef1de99)
09:25:29 Result is kept for 500 seconds
09:25:29 
09:25:29 *** Listening on chapters, profiles, reviews...
09:25:29 reviews: fanfic.jobs.crawl_reviews(11625923) (2d0060dc-2b35-42f4-be00-c293b4075378)
09:25:35 reviews: Job OK (2d0060dc-2b35-42f4-be00-c293b4075378)
09:25:35 Result is kept for 500 seconds
09:25:35 
09:25:35 *** Listening on chapters, profiles, reviews...
09:25:35 reviews: fanfic.jobs.crawl_reviews(11626361) (e76a2f40-53a8-48c2-ab23-f56cb9c1ef0c)
09:25:44 reviews: Job OK (e76a2f40-53a8-48c2-ab23-f56cb9c1ef0c)
09:25:44 Result is kept for 500 seconds
09:25:44 
09:25:44 *** Listening on chapters, profiles, reviews...
09:25:44 reviews: fanfic.jobs.crawl_reviews(11626760) (72243f10-331c-4144-b7c7-8cf030735dc4)
09:25:55 reviews: Job OK (72243f10-331c-4144-b7c7-8cf030735dc4)
09:25:55 Result is kept for 500 seconds
09:25:55 
09:25:55 *** Listening on chapters, profiles, reviews...
09:25:55 reviews: fanfic.jobs.crawl_reviews(11626818) (a6f84420-53ba-4bdf-892e-e8350212d6fb)
09:27:17 reviews: Job OK (a6f84420-53ba-4bdf-892e-e8350212d6fb)
09:27:17 Result is kept for 500 seconds
09:27:17 
09:27:17 *** Listening on chapters, profiles, reviews...
09:27:17 reviews: fanfic.jobs.crawl_reviews(11627485) (1a06a7b0-4c44-453d-b97c-ae17bfcbf5f1)
09:27:50 reviews: Job OK (1a06a7b0-4c44-453d-b97c-ae17bfcbf5f1)
09:27:50 Result is kept for 500 seconds
09:27:50 
09:27:50 *** Listening on chapters, profiles, reviews...
09:27:50 reviews: fanfic.jobs.crawl_reviews(11627914) (2315640b-cd52-492b-a03f-d4f21042b6fb)
09:27:59 reviews: Job OK (2315640b-cd52-492b-a03f-d4f21042b6fb)
09:27:59 Result is kept for 500 seconds
09:27:59 
09:27:59 *** Listening on chapters, profiles, reviews...
09:27:59 reviews: fanfic.jobs.crawl_reviews(11628429) (fba3fb33-ca8f-4200-a626-7048e0a0d1c3)
09:28:55 reviews: Job OK (fba3fb33-ca8f-4200-a626-7048e0a0d1c3)
09:28:55 Result is kept for 500 seconds
09:28:55 
09:28:55 *** Listening on chapters, profiles, reviews...
09:28:55 reviews: fanfic.jobs.crawl_reviews(11631070) (bb534ebe-a735-4b99-82e1-09e610369bfd)
09:31:11 reviews: Job OK (bb534ebe-a735-4b99-82e1-09e610369bfd)
09:31:11 Result is kept for 500 seconds
09:31:11 
09:31:11 *** Listening on chapters, profiles, reviews...
09:31:11 reviews: fanfic.jobs.crawl_reviews(11631093) (b97f39f2-16c0-4ace-af59-6cbcb15a6331)
09:31:16 reviews: Job OK (b97f39f2-16c0-4ace-af59-6cbcb15a6331)
09:31:16 Result is kept for 500 seconds
09:31:16 
09:31:16 *** Listening on chapters, profiles, reviews...
09:31:16 reviews: fanfic.jobs.crawl_reviews(11631219) (87d6eb27-f851-4209-9f0a-1479fc366e38)
09:32:02 reviews: Job OK (87d6eb27-f851-4209-9f0a-1479fc366e38)
09:32:02 Result is kept for 500 seconds
09:32:02 
09:32:02 *** Listening on chapters, profiles, reviews...
09:32:02 reviews: fanfic.jobs.crawl_reviews(11631544) (3e37c8cc-7f1c-4b26-9bfe-ad985ff1a523)
09:33:18 reviews: Job OK (3e37c8cc-7f1c-4b26-9bfe-ad985ff1a523)
09:33:18 Result is kept for 500 seconds
09:33:18 
09:33:18 *** Listening on chapters, profiles, reviews...
09:33:18 reviews: fanfic.jobs.crawl_reviews(11631824) (6157819e-1914-4a65-a39a-155e904994a3)
09:33:40 reviews: Job OK (6157819e-1914-4a65-a39a-155e904994a3)
09:33:40 Result is kept for 500 seconds
09:33:40 
09:33:40 *** Listening on chapters, profiles, reviews...
09:33:40 reviews: fanfic.jobs.crawl_reviews(11632038) (87528627-f7de-496a-8dc1-93de89b917de)
09:35:29 reviews: Job OK (87528627-f7de-496a-8dc1-93de89b917de)
09:35:29 Result is kept for 500 seconds
09:35:29 
09:35:29 *** Listening on chapters, profiles, reviews...
09:35:29 reviews: fanfic.jobs.crawl_reviews(11633844) (f954d012-a53f-45f5-9e76-e1a5fabf890f)
09:36:24 reviews: Job OK (f954d012-a53f-45f5-9e76-e1a5fabf890f)
09:36:24 Result is kept for 500 seconds
09:36:24 
09:36:24 *** Listening on chapters, profiles, reviews...
09:36:24 reviews: fanfic.jobs.crawl_reviews(11634865) (f4d45f3d-63b9-4076-ad05-211125d13385)
09:36:41 reviews: Job OK (f4d45f3d-63b9-4076-ad05-211125d13385)
09:36:41 Result is kept for 500 seconds
09:36:41 
09:36:41 *** Listening on chapters, profiles, reviews...
09:36:41 reviews: fanfic.jobs.crawl_reviews(11635884) (7cf4fa30-b249-4018-b124-80eab98a2e5b)
09:37:18 reviews: Job OK (7cf4fa30-b249-4018-b124-80eab98a2e5b)
09:37:18 Result is kept for 500 seconds
09:37:18 
09:37:18 *** Listening on chapters, profiles, reviews...
09:37:18 reviews: fanfic.jobs.crawl_reviews(11637377) (49bb9214-f48c-4f4b-9600-6297208431fd)
09:38:02 reviews: Job OK (49bb9214-f48c-4f4b-9600-6297208431fd)
09:38:02 Result is kept for 500 seconds
09:38:02 
09:38:02 *** Listening on chapters, profiles, reviews...
09:38:02 reviews: fanfic.jobs.crawl_reviews(11637611) (177242ab-21a4-4a3c-9abd-547b0599584b)
09:40:04 reviews: Job OK (177242ab-21a4-4a3c-9abd-547b0599584b)
09:40:04 Result is kept for 500 seconds
09:40:04 
09:40:04 *** Listening on chapters, profiles, reviews...
09:40:04 reviews: fanfic.jobs.crawl_reviews(11638651) (900ea94a-ac81-4e01-b0f3-370b53d692a1)
09:40:21 reviews: Job OK (900ea94a-ac81-4e01-b0f3-370b53d692a1)
09:40:21 Result is kept for 500 seconds
09:40:21 
09:40:21 *** Listening on chapters, profiles, reviews...
09:40:21 reviews: fanfic.jobs.crawl_reviews(11639433) (6549de77-3951-4214-b68f-f5df68e80455)
09:40:27 reviews: Job OK (6549de77-3951-4214-b68f-f5df68e80455)
09:40:27 Result is kept for 500 seconds
09:40:27 
09:40:27 *** Listening on chapters, profiles, reviews...
09:40:27 reviews: fanfic.jobs.crawl_reviews(11639824) (f104e756-7386-45aa-ab07-8fca018c2dbf)
09:41:44 reviews: Job OK (f104e756-7386-45aa-ab07-8fca018c2dbf)
09:41:44 Result is kept for 500 seconds
09:41:44 
09:41:44 *** Listening on chapters, profiles, reviews...
09:41:44 reviews: fanfic.jobs.crawl_reviews(11640530) (ba1ec581-d687-4665-8569-783f87f024e1)
09:42:04 reviews: Job OK (ba1ec581-d687-4665-8569-783f87f024e1)
09:42:04 Result is kept for 500 seconds
09:42:04 
09:42:04 *** Listening on chapters, profiles, reviews...
09:42:04 reviews: fanfic.jobs.crawl_reviews(11641210) (b17b261e-0c9e-48b7-94c5-d847d5b0864a)
09:42:14 reviews: Job OK (b17b261e-0c9e-48b7-94c5-d847d5b0864a)
09:42:14 Result is kept for 500 seconds
09:42:14 
09:42:14 *** Listening on chapters, profiles, reviews...
09:42:14 reviews: fanfic.jobs.crawl_reviews(11641372) (241f38e6-67ef-479d-91c4-d6dd94a29206)
09:43:00 reviews: Job OK (241f38e6-67ef-479d-91c4-d6dd94a29206)
09:43:00 Result is kept for 500 seconds
09:43:00 
09:43:00 *** Listening on chapters, profiles, reviews...
09:43:00 reviews: fanfic.jobs.crawl_reviews(11641805) (9af1ef19-1f89-4064-b867-0e140a81041a)
09:43:04 reviews: Job OK (9af1ef19-1f89-4064-b867-0e140a81041a)
09:43:04 Result is kept for 500 seconds
09:43:04 
09:43:04 *** Listening on chapters, profiles, reviews...
09:43:04 reviews: fanfic.jobs.crawl_reviews(11642324) (92e1993c-172c-4019-a154-89750d6eed4a)
2017-02-09 09:43:09 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 17:43:09.450510', 11642324, 239032145, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7709928&amp;r ... (1050 characters truncated) ... . And when did Ginny go bad? I thought she was one of the good guys. Oh and what is with everyone\'s nicknames? Why us Harry Ashes?</div></td>\n</tr>'), ('2017-02-09 17:43:09.450515', 11642324, 237877214, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=879286&amp;rw ... (1175 characters truncated) ... ssg101. The copy here is STOLEN. Please read the story and leave reviews for the actual author and report this user for plagiarism.</div></td>\n</tr>'), ('2017-02-09 17:43:09.450517', 11642324, 235058677, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6526556&amp;r ... (1086 characters truncated) ... reading one again. Good riddance! Left such a bad taste in my mouth I had to see if your others were just as bad... they are worse!</div></td>\n</tr>'), ('2017-02-09 17:43:09.450519', 11642324, 232768663, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (543 characters truncated) ... . <span data-xutime="1454807592">2/6/2016</span> </small><div style="margin-top:5px">will there be updates or is this now complete?</div></td>\n</tr>'), ('2017-02-09 17:43:09.450521', 11642324, 229773172, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1067587&amp;r ... (790 characters truncated) ... le="color:gray">chapter 20 . <span data-xutime="1448933491">11/30/2015</span> </small><div style="margin-top:5px">I love this story</div></td>\n</tr>'), ('2017-02-09 17:43:09.450523', 11642324, 239032145, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7709928&amp;r ... (1050 characters truncated) ... . And when did Ginny go bad? I thought she was one of the good guys. Oh and what is with everyone\'s nicknames? Why us Harry Ashes?</div></td>\n</tr>'), ('2017-02-09 17:43:09.450525', 11642324, 237877214, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=879286&amp;rw ... (1175 characters truncated) ... ssg101. The copy here is STOLEN. Please read the story and leave reviews for the actual author and report this user for plagiarism.</div></td>\n</tr>'), ('2017-02-09 17:43:09.450527', 11642324, 235058677, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6526556&amp;r ... (1086 characters truncated) ... reading one again. Good riddance! Left such a bad taste in my mouth I had to see if your others were just as bad... they are worse!</div></td>\n</tr>'), ('2017-02-09 17:43:09.450529', 11642324, 232768663, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (543 characters truncated) ... . <span data-xutime="1454807592">2/6/2016</span> </small><div style="margin-top:5px">will there be updates or is this now complete?</div></td>\n</tr>'), ('2017-02-09 17:43:09.450531', 11642324, 229773172, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1067587&amp;r ... (790 characters truncated) ... le="color:gray">chapter 20 . <span data-xutime="1448933491">11/30/2015</span> </small><div style="margin-top:5px">I love this story</div></td>\n</tr>'))]
09:43:09 reviews: Job OK (92e1993c-172c-4019-a154-89750d6eed4a)
09:43:09 Result is kept for 500 seconds
09:43:09 
09:43:09 *** Listening on chapters, profiles, reviews...
09:43:09 reviews: fanfic.jobs.crawl_reviews(11642791) (4fe0f3fc-f54f-4b5d-b745-9de06974dbf6)
09:43:25 reviews: Job OK (4fe0f3fc-f54f-4b5d-b745-9de06974dbf6)
09:43:25 Result is kept for 500 seconds
09:43:25 
09:43:25 *** Listening on chapters, profiles, reviews...
09:43:25 reviews: fanfic.jobs.crawl_reviews(11643162) (2be65c52-6c43-4d60-9d22-bc61a0edba34)
2017-02-09 09:43:30 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 17:43:30.133157', 11643162, 238723635, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6303067&amp;r ... (935 characters truncated) ... ere\'s so many Weasleys, but i think you\'re focusing too little in some, like Fred and Rose. Hope you keep giving us nice updates!</div></td>\n</tr>'), ('2017-02-09 17:43:30.133161', 11643162, 234055306, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (621 characters truncated) ... gin-top:5px">Nice one. I think you have large section that got repeated, but other than that, glad to hear Lucy\'s alright. Cheers!</div></td>\n</tr>'), ('2017-02-09 17:43:30.133163', 11643162, 234042302, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (614 characters truncated) ... gin-top:5px">You should probably change this story to just be Victoire and Dominique. There\'s barely any Albus, Roxanne, or Molly.</div></td>\n</tr>'), ('2017-02-09 17:43:30.133165', 11643162, 233871476, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=667463&amp;rw ... (1240 characters truncated) ... ly/lovers) on a separate sheet just to keep organized and for things to be simpler to see. Looking forward to the next installment!</div></td>\n</tr>'), ('2017-02-09 17:43:30.133167', 11643162, 232119611, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (635 characters truncated) ... h Victoire. Not enough Roxanne and Albus. But I do enjoy the Dom bits. I\'ve never pictured Molly as a bitch, but I don\'t hate it.</div></td>\n</tr>'), ('2017-02-09 17:43:30.133169', 11643162, 232118066, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (557 characters truncated) ... time="1453337325">1/20/2016</span> </small><div style="margin-top:5px">You said five points to Gryffindor but Albus is in Slytherin</div></td>\n</tr>'), ('2017-02-09 17:43:30.133171', 11643162, 238723635, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6303067&amp;r ... (935 characters truncated) ... ere\'s so many Weasleys, but i think you\'re focusing too little in some, like Fred and Rose. Hope you keep giving us nice updates!</div></td>\n</tr>'), ('2017-02-09 17:43:30.133173', 11643162, 234055306, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (621 characters truncated) ... gin-top:5px">Nice one. I think you have large section that got repeated, but other than that, glad to hear Lucy\'s alright. Cheers!</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-09 17:43:30.133179', 11643162, 232119611, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (635 characters truncated) ... h Victoire. Not enough Roxanne and Albus. But I do enjoy the Dom bits. I\'ve never pictured Molly as a bitch, but I don\'t hate it.</div></td>\n</tr>'), ('2017-02-09 17:43:30.133181', 11643162, 232118066, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (557 characters truncated) ... time="1453337325">1/20/2016</span> </small><div style="margin-top:5px">You said five points to Gryffindor but Albus is in Slytherin</div></td>\n</tr>'))]
09:43:30 reviews: Job OK (2be65c52-6c43-4d60-9d22-bc61a0edba34)
09:43:30 Result is kept for 500 seconds
09:43:30 
09:43:30 *** Listening on chapters, profiles, reviews...
09:43:30 reviews: fanfic.jobs.crawl_reviews(11643238) (bcf0e116-b532-455c-8796-353cc482d409)
09:44:40 reviews: Job OK (bcf0e116-b532-455c-8796-353cc482d409)
09:44:40 Result is kept for 500 seconds
09:44:40 
09:44:40 *** Listening on chapters, profiles, reviews...
09:44:40 reviews: fanfic.jobs.crawl_reviews(11644487) (1fe93664-c604-44c3-a3a8-d8c388fa8cfb)
09:45:15 reviews: Job OK (1fe93664-c604-44c3-a3a8-d8c388fa8cfb)
09:45:15 Result is kept for 500 seconds
09:45:15 
09:45:15 *** Listening on chapters, profiles, reviews...
09:45:15 reviews: fanfic.jobs.crawl_reviews(11645321) (15313a6d-bf1c-4c8f-bcc7-049c30733f0b)
09:48:04 reviews: Job OK (15313a6d-bf1c-4c8f-bcc7-049c30733f0b)
09:48:04 Result is kept for 500 seconds
09:48:04 
09:48:04 *** Listening on chapters, profiles, reviews...
09:48:04 reviews: fanfic.jobs.crawl_reviews(11647003) (6f9c495b-bd42-4b2a-8044-e8d00a27d918)
09:50:17 reviews: Job OK (6f9c495b-bd42-4b2a-8044-e8d00a27d918)
09:50:17 Result is kept for 500 seconds
09:50:17 
09:50:17 *** Listening on chapters, profiles, reviews...
09:50:17 reviews: fanfic.jobs.crawl_reviews(11647145) (933a7b98-49a3-492c-af2a-5e2f9f1573a8)
09:50:41 reviews: Job OK (933a7b98-49a3-492c-af2a-5e2f9f1573a8)
09:50:41 Result is kept for 500 seconds
09:50:41 
09:50:41 *** Listening on chapters, profiles, reviews...
09:50:41 reviews: fanfic.jobs.crawl_reviews(11647542) (f6e7b4e2-4ca9-47aa-8573-7c37a0a38fc1)
10:04:06 reviews: Job OK (f6e7b4e2-4ca9-47aa-8573-7c37a0a38fc1)
10:04:06 Result is kept for 500 seconds
10:04:06 
10:04:06 *** Listening on chapters, profiles, reviews...
10:04:06 reviews: fanfic.jobs.crawl_reviews(11647972) (16fc99be-6e58-4fb3-a5ab-7440cf718d2f)
10:04:49 reviews: Job OK (16fc99be-6e58-4fb3-a5ab-7440cf718d2f)
10:04:49 Result is kept for 500 seconds
10:04:49 
10:04:49 *** Listening on chapters, profiles, reviews...
10:04:49 reviews: fanfic.jobs.crawl_reviews(11648754) (353fe60b-dc98-424d-a56e-327277753057)
10:05:08 reviews: Job OK (353fe60b-dc98-424d-a56e-327277753057)
10:05:08 Result is kept for 500 seconds
10:05:08 
10:05:08 *** Listening on chapters, profiles, reviews...
10:05:08 reviews: fanfic.jobs.crawl_reviews(11649139) (1f03b2bd-3620-4b99-a0f1-49cb618b7887)
10:05:25 reviews: Job OK (1f03b2bd-3620-4b99-a0f1-49cb618b7887)
10:05:25 Result is kept for 500 seconds
10:05:25 
10:05:25 *** Listening on chapters, profiles, reviews...
10:05:25 reviews: fanfic.jobs.crawl_reviews(11649658) (dc3f054b-b7b5-40f6-9bfb-cf5a52eae25b)
10:05:44 reviews: Job OK (dc3f054b-b7b5-40f6-9bfb-cf5a52eae25b)
10:05:44 Result is kept for 500 seconds
10:05:44 
10:05:44 *** Listening on chapters, profiles, reviews...
10:05:44 reviews: fanfic.jobs.crawl_reviews(11651617) (17248f76-b2df-4987-8b77-a9acc343a62d)
10:05:56 reviews: Job OK (17248f76-b2df-4987-8b77-a9acc343a62d)
10:05:56 Result is kept for 500 seconds
10:05:56 
10:05:56 *** Listening on chapters, profiles, reviews...
10:05:56 reviews: fanfic.jobs.crawl_reviews(11651647) (9628c952-d1d9-40c1-bc65-57fa35fe70a4)
10:07:43 reviews: Job OK (9628c952-d1d9-40c1-bc65-57fa35fe70a4)
10:07:43 Result is kept for 500 seconds
10:07:43 
10:07:43 *** Listening on chapters, profiles, reviews...
10:07:43 reviews: fanfic.jobs.crawl_reviews(11651649) (64955c69-a06a-46b9-8f73-241cf781e3cd)
10:07:51 reviews: Job OK (64955c69-a06a-46b9-8f73-241cf781e3cd)
10:07:51 Result is kept for 500 seconds
10:07:51 
10:07:51 *** Listening on chapters, profiles, reviews...
10:07:51 reviews: fanfic.jobs.crawl_reviews(11651684) (5bfd9314-5895-49ae-9040-3ae6c594f5c2)
10:08:11 reviews: Job OK (5bfd9314-5895-49ae-9040-3ae6c594f5c2)
10:08:11 Result is kept for 500 seconds
10:08:11 
10:08:11 *** Listening on chapters, profiles, reviews...
10:08:11 reviews: fanfic.jobs.crawl_reviews(11651939) (2d15f3ce-13bc-45ad-a01f-6030a4e51cc8)
10:08:30 reviews: Job OK (2d15f3ce-13bc-45ad-a01f-6030a4e51cc8)
10:08:30 Result is kept for 500 seconds
10:08:30 
10:08:30 *** Listening on chapters, profiles, reviews...
10:08:30 reviews: fanfic.jobs.crawl_reviews(11653847) (0f61c899-71a3-42ad-94d1-097e77b72e39)
10:12:34 reviews: Job OK (0f61c899-71a3-42ad-94d1-097e77b72e39)
10:12:34 Result is kept for 500 seconds
10:12:34 Cleaning registries for queue: chapters
10:12:34 Cleaning registries for queue: profiles
10:12:34 Cleaning registries for queue: reviews
10:12:34 
10:12:34 *** Listening on chapters, profiles, reviews...
10:12:34 reviews: fanfic.jobs.crawl_reviews(11654689) (360894cb-e7f3-4a03-aeee-b9fc76fa19ee)
10:15:54 reviews: Job OK (360894cb-e7f3-4a03-aeee-b9fc76fa19ee)
10:15:54 Result is kept for 500 seconds
10:15:54 
10:15:54 *** Listening on chapters, profiles, reviews...
10:15:54 reviews: fanfic.jobs.crawl_reviews(11655125) (4b54d037-7880-4842-a8d0-36012a31eddb)
10:16:44 reviews: Job OK (4b54d037-7880-4842-a8d0-36012a31eddb)
10:16:44 Result is kept for 500 seconds
10:16:45 
10:16:45 *** Listening on chapters, profiles, reviews...
10:16:45 reviews: fanfic.jobs.crawl_reviews(11655478) (8a3fe16b-a499-42bd-98e9-08bdbc44903a)
10:17:01 reviews: Job OK (8a3fe16b-a499-42bd-98e9-08bdbc44903a)
10:17:01 Result is kept for 500 seconds
10:17:01 
10:17:01 *** Listening on chapters, profiles, reviews...
10:17:01 reviews: fanfic.jobs.crawl_reviews(11655863) (0bd5525d-e032-44b7-ad53-cfdfc31f88b0)
10:18:21 reviews: Job OK (0bd5525d-e032-44b7-ad53-cfdfc31f88b0)
10:18:21 Result is kept for 500 seconds
10:18:21 
10:18:21 *** Listening on chapters, profiles, reviews...
10:18:21 reviews: fanfic.jobs.crawl_reviews(11655995) (dc0f06de-efbc-4979-9b7e-639355394594)
10:19:28 reviews: Job OK (dc0f06de-efbc-4979-9b7e-639355394594)
10:19:28 Result is kept for 500 seconds
10:19:28 
10:19:28 *** Listening on chapters, profiles, reviews...
10:19:28 reviews: fanfic.jobs.crawl_reviews(11656118) (5abd034d-5e80-4bc5-bdc5-c1ed96f2481a)
10:19:38 reviews: Job OK (5abd034d-5e80-4bc5-bdc5-c1ed96f2481a)
10:19:38 Result is kept for 500 seconds
10:19:38 
10:19:38 *** Listening on chapters, profiles, reviews...
10:19:38 reviews: fanfic.jobs.crawl_reviews(11656250) (3568eebf-988e-4daf-a6d4-047087ce1f24)
10:21:00 reviews: Job OK (3568eebf-988e-4daf-a6d4-047087ce1f24)
10:21:00 Result is kept for 500 seconds
10:21:00 
10:21:00 *** Listening on chapters, profiles, reviews...
10:21:00 reviews: fanfic.jobs.crawl_reviews(11656601) (9508bf2a-9090-42b2-9f68-73f9c88dcc02)
10:21:56 reviews: Job OK (9508bf2a-9090-42b2-9f68-73f9c88dcc02)
10:21:56 Result is kept for 500 seconds
10:21:56 
10:21:56 *** Listening on chapters, profiles, reviews...
10:21:56 reviews: fanfic.jobs.crawl_reviews(11658505) (e1eba29d-9b63-49bc-a00d-0d08e86b9713)
10:24:03 reviews: Job OK (e1eba29d-9b63-49bc-a00d-0d08e86b9713)
10:24:03 Result is kept for 500 seconds
10:24:03 
10:24:03 *** Listening on chapters, profiles, reviews...
10:24:03 reviews: fanfic.jobs.crawl_reviews(11660206) (fa59e0db-92e2-4227-a9dd-8c9a32ccb90f)
10:24:24 reviews: Job OK (fa59e0db-92e2-4227-a9dd-8c9a32ccb90f)
10:24:24 Result is kept for 500 seconds
10:24:24 
10:24:24 *** Listening on chapters, profiles, reviews...
10:24:24 reviews: fanfic.jobs.crawl_reviews(11661389) (f1955b4d-9134-428b-80e5-400b8041991c)
2017-02-09 10:24:30 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 18:24:30.628677', 11661389, 232970741, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4054168&amp;r ... (925 characters truncated) ... this story...I read all 50 chapters in less then 24 hours...keep up the good work. I can not wait to see where u take it from here.</div></td>\n</tr>'), ('2017-02-09 18:24:30.628682', 11661389, 230819988, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2523104&amp;r ... (988 characters truncated) ... okay i dont like Malfoy but i will admit that end was freaking cute. I think i got cavities from how sweet that was lol i loved it.</div></td>\n</tr>'), ('2017-02-09 18:24:30.628684', 11661389, 230702843, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2523104&amp;r ... (992 characters truncated) ... y goooossssshhhhh! WHAT ARE YOU DOING TO ME? ! I DID NOT ASK FOR ANGST?! well..I might have...BUT OMG MY POOR EVELYN!MY POOR CHILD.</div></td>\n</tr>'), ('2017-02-09 18:24:30.628686', 11661389, 230688166, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2523104&amp;r ... (1057 characters truncated) ...  go with?! *Cough*fredforlife*Cough* ahem. sorry something in my throatlol anyway, can\'t wait for the next one! amazing as always!</div></td>\n</tr>'), ('2017-02-09 18:24:30.628688', 11661389, 230658230, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6083722&amp;r ... (791 characters truncated) ... ll style="color:gray">chapter 26 . <span data-xutime="1450757119">12/21/2015</span> </small><div style="margin-top:5px">More please</div></td>\n</tr>'), ('2017-02-09 18:24:30.628690', 11661389, 230655858, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2523104&amp;r ... (907 characters truncated) ... n data-xutime="1450753581">12/21/2015</span> </small><div style="margin-top:5px">yay more amazing chapters! cant wait for the rest!</div></td>\n</tr>'), ('2017-02-09 18:24:30.628692', 11661389, 230473012, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2523104&amp;r ... (963 characters truncated) ... v style="margin-top:5px">Nooooooooo...I need more! (I\'m sorry I\'m gonna be annoying you so much cuz I really love this story lol)</div></td>\n</tr>'), ('2017-02-09 18:24:30.628694', 11661389, 230438244, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2523104&amp;r ... (1019 characters truncated) ... t for the next part! You are such a great writer! I just this story so Mich, it\'s so interesting and the hunters are just awesome!</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-09 18:24:30.628715', 11661389, 230327193, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2523104&amp;r ... (967 characters truncated) ... le="margin-top:5px">I really love this story! Eve is amazing! I really can\'t wait for the next chapter! You\'re doing a great job!</div></td>\n</tr>'), ('2017-02-09 18:24:30.628716', 11661389, 230260743, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7118356&amp;r ... (915 characters truncated) ... gin-top:5px">I think that she should be put im slytherin after what you said about seeing weakness, but griphindoor would work too.</div></td>\n</tr>'))]
10:24:30 reviews: Job OK (f1955b4d-9134-428b-80e5-400b8041991c)
10:24:30 Result is kept for 500 seconds
10:24:30 
10:24:30 *** Listening on chapters, profiles, reviews...
10:24:30 reviews: fanfic.jobs.crawl_reviews(11661745) (4275e854-e700-428f-b488-5151194e2a68)
10:28:55 reviews: Job OK (4275e854-e700-428f-b488-5151194e2a68)
10:28:55 Result is kept for 500 seconds
10:28:55 
10:28:55 *** Listening on chapters, profiles, reviews...
10:28:55 reviews: fanfic.jobs.crawl_reviews(11662107) (e7ddd3dc-8145-485b-8b3a-22a3907b4f7b)
10:29:00 reviews: Job OK (e7ddd3dc-8145-485b-8b3a-22a3907b4f7b)
10:29:00 Result is kept for 500 seconds
10:29:00 
10:29:00 *** Listening on chapters, profiles, reviews...
10:29:00 reviews: fanfic.jobs.crawl_reviews(11662284) (76f9c2a6-7a16-4b94-b6ea-e64884ec2b1d)
10:29:03 reviews: Job OK (76f9c2a6-7a16-4b94-b6ea-e64884ec2b1d)
10:29:03 Result is kept for 500 seconds
10:29:03 
10:29:03 *** Listening on chapters, profiles, reviews...
10:29:03 reviews: fanfic.jobs.crawl_reviews(11662486) (eaf3c9b1-1db8-486b-a853-62154568785a)
10:29:27 reviews: Job OK (eaf3c9b1-1db8-486b-a853-62154568785a)
10:29:27 Result is kept for 500 seconds
10:29:27 
10:29:27 *** Listening on chapters, profiles, reviews...
10:29:27 reviews: fanfic.jobs.crawl_reviews(11663243) (851f239a-a1f8-4351-b0ca-0e72039294c1)
10:30:06 reviews: Job OK (851f239a-a1f8-4351-b0ca-0e72039294c1)
10:30:06 Result is kept for 500 seconds
10:30:06 
10:30:06 *** Listening on chapters, profiles, reviews...
10:30:06 reviews: fanfic.jobs.crawl_reviews(11664138) (b48a0eed-0db2-40da-bb2e-9d2786fd6e54)
10:31:53 reviews: Job OK (b48a0eed-0db2-40da-bb2e-9d2786fd6e54)
10:31:53 Result is kept for 500 seconds
10:31:53 
10:31:53 *** Listening on chapters, profiles, reviews...
10:31:53 reviews: fanfic.jobs.crawl_reviews(11666329) (37ca59bb-0fe9-429b-86bc-b8d155c9d364)
10:32:17 reviews: Job OK (37ca59bb-0fe9-429b-86bc-b8d155c9d364)
10:32:17 Result is kept for 500 seconds
10:32:17 
10:32:17 *** Listening on chapters, profiles, reviews...
10:32:17 reviews: fanfic.jobs.crawl_reviews(11669575) (1ba558d8-4c01-45d8-adf5-e3d0c6d1d57c)
10:55:30 reviews: Job OK (1ba558d8-4c01-45d8-adf5-e3d0c6d1d57c)
10:55:30 Result is kept for 500 seconds
10:55:30 
10:55:30 *** Listening on chapters, profiles, reviews...
10:55:30 reviews: fanfic.jobs.crawl_reviews(11670844) (5bfbedc8-9b63-4d7e-9778-a15de63275d8)
10:56:04 reviews: Job OK (5bfbedc8-9b63-4d7e-9778-a15de63275d8)
10:56:04 Result is kept for 500 seconds
10:56:04 
10:56:04 *** Listening on chapters, profiles, reviews...
10:56:04 reviews: fanfic.jobs.crawl_reviews(11671069) (f88e739e-952e-4533-b025-979242663590)
11:04:40 reviews: Job OK (f88e739e-952e-4533-b025-979242663590)
11:04:40 Result is kept for 500 seconds
11:04:40 
11:04:40 *** Listening on chapters, profiles, reviews...
11:04:40 reviews: fanfic.jobs.crawl_reviews(11672008) (ae245c91-923c-4e3c-ad22-4089a17ddfa2)
11:04:45 reviews: Job OK (ae245c91-923c-4e3c-ad22-4089a17ddfa2)
11:04:45 Result is kept for 500 seconds
11:04:45 
11:04:45 *** Listening on chapters, profiles, reviews...
11:04:45 reviews: fanfic.jobs.crawl_reviews(11674288) (13a644a1-189b-48f8-883f-6ea6cb4792d3)
11:05:09 reviews: Job OK (13a644a1-189b-48f8-883f-6ea6cb4792d3)
11:05:09 Result is kept for 500 seconds
11:05:09 
11:05:09 *** Listening on chapters, profiles, reviews...
11:05:09 reviews: fanfic.jobs.crawl_reviews(11675498) (3f81412b-63e3-4687-8fa4-5f0b1daab3c6)
11:05:40 reviews: Job OK (3f81412b-63e3-4687-8fa4-5f0b1daab3c6)
11:05:40 Result is kept for 500 seconds
11:05:40 
11:05:40 *** Listening on chapters, profiles, reviews...
11:05:40 reviews: fanfic.jobs.crawl_reviews(11677935) (cad8e022-39a7-44ff-92d7-684e4b7f9c41)
11:07:26 reviews: Job OK (cad8e022-39a7-44ff-92d7-684e4b7f9c41)
11:07:26 Result is kept for 500 seconds
11:07:26 
11:07:26 *** Listening on chapters, profiles, reviews...
11:07:26 reviews: fanfic.jobs.crawl_reviews(11678126) (7339fa32-b0c7-4f95-9a20-b1bb4c5b4a83)
2017-02-09 11:07:32 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 19:07:32.240571', 11678126, 243642271, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=705691&amp;rw ... (937 characters truncated) ... olphs choice as to what the twins should call belle. If they want to be called siblings, they should. But it should be their choice</div></td>\n</tr>'), ('2017-02-09 19:07:32.240576', 11678126, 238759571, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6178010&amp;r ... (897 characters truncated) ...  data-xutime="1467146059">6/28/2016</span> </small><div style="margin-top:5px">The Twins :) great! I like many children for them :)</div></td>\n</tr>'), ('2017-02-09 19:07:32.240578', 11678126, 235414325, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6178010&amp;r ... (993 characters truncated) ... or Molly and moRon to hate Ginny because she is with Draco! <br>\n<br>\nBut I\'m glad that a part of family and even Hermione came.</div></td>\n</tr>'), ('2017-02-09 19:07:32.240580', 11678126, 235413562, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6178010&amp;r ... (1270 characters truncated) ... and Ice than Dramione. Ginny is at least pureblood :P But also she is just Ginny, not Hermione, who is so the best and know-it-all.</div></td>\n</tr>'), ('2017-02-09 19:07:32.240582', 11678126, 235377894, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6178010&amp;r ... (973 characters truncated) ... ">Secret sons :D I love that idea.<br>\n<br>\nAnd with aurors like Neville, I don\'t see any bright future for wizarding Britain...</div></td>\n</tr>'), ('2017-02-09 19:07:32.240584', 11678126, 235377710, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6178010&amp;r ... (1091 characters truncated) ... bottom raid I\'ve ever seen. also circumstances how they all became DEs. Rabastan speaking back to Bella, and her anger. Brililant.</div></td>\n</tr>'), ('2017-02-09 19:07:32.240585', 11678126, 235377385, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6178010&amp;r ... (946 characters truncated) ... <div style="margin-top:5px">Very interesting idea about werewolves coming from death, and how Tonks did something very very stupid.</div></td>\n</tr>'), ('2017-02-09 19:07:32.240587', 11678126, 235377118, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6178010&amp;r ... (932 characters truncated) ... span> </small><div style="margin-top:5px">That\'s great fun, how you wrote a scene when Tonks scarried them posing as auntie Bella.</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-09 19:07:32.240622', 11678126, 231363074, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6799066&amp;r ... (829 characters truncated) ... a-xutime="1452044731">1/5/2016</span> </small><div style="margin-top:5px">If you\'re going to call it Always, you need to use Snape</div></td>\n</tr>'), ('2017-02-09 19:07:32.240624', 11678126, 230690949, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5304066&amp;r ... (951 characters truncated) ... </span> </small><div style="margin-top:5px">The first and second chapters were amazing Trixie, I\'m looking forward to the next one</div></td>\n</tr>'))]
11:07:32 reviews: Job OK (7339fa32-b0c7-4f95-9a20-b1bb4c5b4a83)
11:07:32 Result is kept for 500 seconds
11:07:32 
11:07:32 *** Listening on chapters, profiles, reviews...
11:07:32 reviews: fanfic.jobs.crawl_reviews(11679490) (c5e4236f-494b-4a64-84df-753acb9f4185)
11:08:15 reviews: Job OK (c5e4236f-494b-4a64-84df-753acb9f4185)
11:08:15 Result is kept for 500 seconds
11:08:15 
11:08:15 *** Listening on chapters, profiles, reviews...
11:08:15 reviews: fanfic.jobs.crawl_reviews(11679696) (3465b4f8-d4c3-4904-bddf-f06cefc733c1)
11:10:57 reviews: Job OK (3465b4f8-d4c3-4904-bddf-f06cefc733c1)
11:10:57 Result is kept for 500 seconds
11:10:57 
11:10:57 *** Listening on chapters, profiles, reviews...
11:10:57 reviews: fanfic.jobs.crawl_reviews(11682581) (0b8d9c1f-9af2-42be-bede-3ac55e10ae9d)
11:11:57 reviews: Job OK (0b8d9c1f-9af2-42be-bede-3ac55e10ae9d)
11:11:57 Result is kept for 500 seconds
11:11:57 
11:11:57 *** Listening on chapters, profiles, reviews...
11:11:57 reviews: fanfic.jobs.crawl_reviews(11683176) (e95e853d-9a4d-4298-9326-1b92a1615bd9)
11:12:31 reviews: Job OK (e95e853d-9a4d-4298-9326-1b92a1615bd9)
11:12:31 Result is kept for 500 seconds
11:12:31 
11:12:31 *** Listening on chapters, profiles, reviews...
11:12:31 reviews: fanfic.jobs.crawl_reviews(11684895) (8efead40-fbfb-4549-96d1-e8008a56002a)
2017-02-09 11:12:36 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 19:12:36.296499', 11684895, 232108518, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (527 characters truncated) ... r:gray">chapter 10 . <span data-xutime="1453320561">1/20/2016</span> </small><div style="margin-top:5px">It\'s interesting to read.</div></td>\n</tr>'), ('2017-02-09 19:12:36.296504', 11684895, 231956805, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=898024&amp;rw ... (1176 characters truncated) ... y certain she would listen even if they did.<br>\n<br>\nTruthfully, servants actually make more sense in JK\'s world than slaves...</div></td>\n</tr>'), ('2017-02-09 19:12:36.296506', 11684895, 231430257, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (613 characters truncated) ... "margin-top:5px">I don\'t know why Dumby didn\'t think that Voldy could heurt Harry Inside Dursley\'s house since he got his blood.</div></td>\n</tr>'), ('2017-02-09 19:12:36.296508', 11684895, 231173199, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1400456&amp;r ... (996 characters truncated) ... "margin-top:5px">I have no idea where your going with this story but it has peaked mine interest in it, love how you created Tatum.</div></td>\n</tr>'), ('2017-02-09 19:12:36.296510', 11684895, 232108518, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (527 characters truncated) ... r:gray">chapter 10 . <span data-xutime="1453320561">1/20/2016</span> </small><div style="margin-top:5px">It\'s interesting to read.</div></td>\n</tr>'), ('2017-02-09 19:12:36.296512', 11684895, 231956805, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=898024&amp;rw ... (1176 characters truncated) ... y certain she would listen even if they did.<br>\n<br>\nTruthfully, servants actually make more sense in JK\'s world than slaves...</div></td>\n</tr>'), ('2017-02-09 19:12:36.296513', 11684895, 231430257, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (613 characters truncated) ... "margin-top:5px">I don\'t know why Dumby didn\'t think that Voldy could heurt Harry Inside Dursley\'s house since he got his blood.</div></td>\n</tr>'), ('2017-02-09 19:12:36.296515', 11684895, 231173199, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1400456&amp;r ... (996 characters truncated) ... "margin-top:5px">I have no idea where your going with this story but it has peaked mine interest in it, love how you created Tatum.</div></td>\n</tr>'))]
11:12:36 reviews: Job OK (8efead40-fbfb-4549-96d1-e8008a56002a)
11:12:36 Result is kept for 500 seconds
11:12:36 Cleaning registries for queue: chapters
11:12:36 Cleaning registries for queue: profiles
11:12:36 Cleaning registries for queue: reviews
11:12:36 
11:12:36 *** Listening on chapters, profiles, reviews...
11:12:36 reviews: fanfic.jobs.crawl_reviews(11684915) (ac9afd22-6919-4113-9739-f1f9fb638c30)
11:13:41 reviews: Job OK (ac9afd22-6919-4113-9739-f1f9fb638c30)
11:13:41 Result is kept for 500 seconds
11:13:41 
11:13:41 *** Listening on chapters, profiles, reviews...
11:13:41 reviews: fanfic.jobs.crawl_reviews(11685657) (d36e2c54-ed96-4d08-9bfb-515398220aa4)
11:25:55 reviews: Job OK (d36e2c54-ed96-4d08-9bfb-515398220aa4)
11:25:55 Result is kept for 500 seconds
11:25:55 
11:25:55 *** Listening on chapters, profiles, reviews...
11:25:55 reviews: fanfic.jobs.crawl_reviews(11685712) (b4459bf2-8cae-4637-a38f-a02e4a3321cb)
11:26:18 reviews: Job OK (b4459bf2-8cae-4637-a38f-a02e4a3321cb)
11:26:18 Result is kept for 500 seconds
11:26:18 
11:26:18 *** Listening on chapters, profiles, reviews...
11:26:18 reviews: fanfic.jobs.crawl_reviews(11687733) (7be8e90e-2b7b-46d7-8990-479895cf0334)
11:29:23 reviews: Job OK (7be8e90e-2b7b-46d7-8990-479895cf0334)
11:29:23 Result is kept for 500 seconds
11:29:23 
11:29:23 *** Listening on chapters, profiles, reviews...
11:29:23 reviews: fanfic.jobs.crawl_reviews(11689499) (dbdff316-37c8-4c93-9410-117be3df61a9)
11:32:07 reviews: Job OK (dbdff316-37c8-4c93-9410-117be3df61a9)
11:32:07 Result is kept for 500 seconds
11:32:07 
11:32:07 *** Listening on chapters, profiles, reviews...
11:32:07 reviews: fanfic.jobs.crawl_reviews(11691332) (ca9a7428-e977-4751-b4ea-65ae77eb915e)
11:32:36 reviews: Job OK (ca9a7428-e977-4751-b4ea-65ae77eb915e)
11:32:36 Result is kept for 500 seconds
11:32:36 
11:32:36 *** Listening on chapters, profiles, reviews...
11:32:36 reviews: fanfic.jobs.crawl_reviews(11692984) (02318474-6002-4e0b-8d6c-e1eaa4d26740)
11:32:48 reviews: Job OK (02318474-6002-4e0b-8d6c-e1eaa4d26740)
11:32:48 Result is kept for 500 seconds
11:32:48 
11:32:48 *** Listening on chapters, profiles, reviews...
11:32:48 reviews: fanfic.jobs.crawl_reviews(11693624) (cde2d4cc-5806-43b8-b44c-08878e27339a)
11:33:17 reviews: Job OK (cde2d4cc-5806-43b8-b44c-08878e27339a)
11:33:17 Result is kept for 500 seconds
11:33:17 
11:33:17 *** Listening on chapters, profiles, reviews...
11:33:17 reviews: fanfic.jobs.crawl_reviews(11693836) (aacba960-db0b-4fbe-8db7-b7d8ae506a07)
11:34:29 reviews: Job OK (aacba960-db0b-4fbe-8db7-b7d8ae506a07)
11:34:29 Result is kept for 500 seconds
11:34:29 
11:34:29 *** Listening on chapters, profiles, reviews...
11:34:29 reviews: fanfic.jobs.crawl_reviews(11694317) (f2b1bcf8-dd7d-41ae-9559-42f92bef5e73)
11:35:24 reviews: Job OK (f2b1bcf8-dd7d-41ae-9559-42f92bef5e73)
11:35:24 Result is kept for 500 seconds
11:35:24 
11:35:24 *** Listening on chapters, profiles, reviews...
11:35:24 reviews: fanfic.jobs.crawl_reviews(11694504) (0711d35f-973b-4cc9-a1d5-a527b1a46461)
11:35:32 reviews: Job OK (0711d35f-973b-4cc9-a1d5-a527b1a46461)
11:35:32 Result is kept for 500 seconds
11:35:32 
11:35:32 *** Listening on chapters, profiles, reviews...
11:35:32 reviews: fanfic.jobs.crawl_reviews(11696112) (1c8b4f70-e269-4591-a4d9-874e2173b66e)
11:35:37 reviews: Job OK (1c8b4f70-e269-4591-a4d9-874e2173b66e)
11:35:37 Result is kept for 500 seconds
11:35:37 
11:35:37 *** Listening on chapters, profiles, reviews...
11:35:37 reviews: fanfic.jobs.crawl_reviews(11696688) (89cca28d-eef8-49a9-bdd8-ce1b6e9e676b)
11:38:08 reviews: Job OK (89cca28d-eef8-49a9-bdd8-ce1b6e9e676b)
11:38:08 Result is kept for 500 seconds
11:38:08 
11:38:08 *** Listening on chapters, profiles, reviews...
11:38:08 reviews: fanfic.jobs.crawl_reviews(11696844) (d822166b-8417-47ae-8125-8d4de44af9dc)
11:38:25 reviews: Job OK (d822166b-8417-47ae-8125-8d4de44af9dc)
11:38:25 Result is kept for 500 seconds
11:38:25 
11:38:25 *** Listening on chapters, profiles, reviews...
11:38:25 reviews: fanfic.jobs.crawl_reviews(11697407) (d6088dc0-bcc8-48b5-810a-af230bf06f3a)
11:40:41 reviews: Job OK (d6088dc0-bcc8-48b5-810a-af230bf06f3a)
11:40:41 Result is kept for 500 seconds
11:40:41 
11:40:41 *** Listening on chapters, profiles, reviews...
11:40:41 reviews: fanfic.jobs.crawl_reviews(11697590) (a15ed23c-1153-4f3c-82cd-05aa15ca1935)
11:40:45 reviews: Job OK (a15ed23c-1153-4f3c-82cd-05aa15ca1935)
11:40:45 Result is kept for 500 seconds
11:40:45 
11:40:45 *** Listening on chapters, profiles, reviews...
11:40:45 reviews: fanfic.jobs.crawl_reviews(11698065) (a53d9d3a-c56d-43b4-85a8-0e0597c94baa)
11:44:00 reviews: Job OK (a53d9d3a-c56d-43b4-85a8-0e0597c94baa)
11:44:00 Result is kept for 500 seconds
11:44:00 
11:44:00 *** Listening on chapters, profiles, reviews...
11:44:00 reviews: fanfic.jobs.crawl_reviews(11698938) (fd62e656-e618-415d-bcff-47cd06212b64)
11:44:04 reviews: Job OK (fd62e656-e618-415d-bcff-47cd06212b64)
11:44:04 Result is kept for 500 seconds
11:44:04 
11:44:04 *** Listening on chapters, profiles, reviews...
11:44:04 reviews: fanfic.jobs.crawl_reviews(11700786) (ea4d5269-3adc-4778-9f84-16939f660647)
11:44:10 reviews: Job OK (ea4d5269-3adc-4778-9f84-16939f660647)
11:44:10 Result is kept for 500 seconds
11:44:10 
11:44:10 *** Listening on chapters, profiles, reviews...
11:44:10 reviews: fanfic.jobs.crawl_reviews(11700860) (790194c8-ee2d-45f9-82f3-33f09aeab172)
11:49:05 reviews: Job OK (790194c8-ee2d-45f9-82f3-33f09aeab172)
11:49:05 Result is kept for 500 seconds
11:49:05 
11:49:05 *** Listening on chapters, profiles, reviews...
11:49:05 reviews: fanfic.jobs.crawl_reviews(11701008) (eb62d14e-e99b-4842-b2d9-ac5d73c47194)
11:49:27 reviews: Job OK (eb62d14e-e99b-4842-b2d9-ac5d73c47194)
11:49:27 Result is kept for 500 seconds
11:49:27 
11:49:27 *** Listening on chapters, profiles, reviews...
11:49:27 reviews: fanfic.jobs.crawl_reviews(11701466) (d9c975c2-b162-4ada-a50b-17df0d6f03ed)
11:50:13 reviews: Job OK (d9c975c2-b162-4ada-a50b-17df0d6f03ed)
11:50:13 Result is kept for 500 seconds
11:50:13 
11:50:13 *** Listening on chapters, profiles, reviews...
11:50:13 reviews: fanfic.jobs.crawl_reviews(11702523) (818c2e47-397c-4d49-9dc1-ede493748bd8)
11:56:38 reviews: Job OK (818c2e47-397c-4d49-9dc1-ede493748bd8)
11:56:38 Result is kept for 500 seconds
11:56:38 
11:56:38 *** Listening on chapters, profiles, reviews...
11:56:38 reviews: fanfic.jobs.crawl_reviews(11702543) (e7a8e10a-f9c9-4312-a8a0-61ea389a6a4b)
11:57:34 reviews: Job OK (e7a8e10a-f9c9-4312-a8a0-61ea389a6a4b)
11:57:34 Result is kept for 500 seconds
11:57:34 
11:57:34 *** Listening on chapters, profiles, reviews...
11:57:34 reviews: fanfic.jobs.crawl_reviews(11702569) (61f425d1-14a6-4c73-97e3-9dbdab1fd6f3)
11:58:12 reviews: Job OK (61f425d1-14a6-4c73-97e3-9dbdab1fd6f3)
11:58:12 Result is kept for 500 seconds
11:58:12 
11:58:12 *** Listening on chapters, profiles, reviews...
11:58:12 reviews: fanfic.jobs.crawl_reviews(11703942) (78dd274b-60af-47f3-b9a1-e0ceb2c76364)
2017-02-09 11:58:18 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 19:58:18.202835', 11703942, 231911834, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2652328&amp;r ... (1041 characters truncated) ... t and I cant wait for a new chapter to be put up and im happy I found this story on here it is good so for I love it a lot big time</div></td>\n</tr>'), ('2017-02-09 19:58:18.202840', 11703942, 231867475, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3130373&amp;r ... (919 characters truncated) ... a-xutime="1453030684">1/17/2016</span> </small><div style="margin-top:5px">Hasn\'t Sirius been inprisoned in the Azkaban from 1981?</div></td>\n</tr>'), ('2017-02-09 19:58:18.202842', 11703942, 231818614, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2696315&amp;r ... (907 characters truncated) ... >So this is what you\'ve been doing besides The Lion and the Wolf! :(<br>\nGot to admit haven\'t read a harry potter one like this.</div></td>\n</tr>'), ('2017-02-09 19:58:18.202844', 11703942, 231818577, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2696315&amp;r ... (821 characters truncated) ...  . <span data-xutime="1452926361">1/15/2016</span> </small><div style="margin-top:5px">Wonderful! <br>\nUpdate immediately, please!</div></td>\n</tr>'), ('2017-02-09 19:58:18.202846', 11703942, 231752672, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5432369&amp;r ... (986 characters truncated) ... vourite actors and an amazing man, a legend ...<br>\nPlease don\'t stop writing, and let him live through your amazing story :( ...</div></td>\n</tr>'), ('2017-02-09 19:58:18.202848', 11703942, 231326367, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4711306&amp;r ... (871 characters truncated) ... style="color:gray">chapter 9 . <span data-xutime="1451973735">1/4/2016</span> </small><div style="margin-top:5px">Aw great chapter.</div></td>\n</tr>'), ('2017-02-09 19:58:18.202850', 11703942, 231325096, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4711306&amp;r ... (870 characters truncated) ...  style="color:gray">chapter 8 . <span data-xutime="1451971550">1/4/2016</span> </small><div style="margin-top:5px">Ha good chapter.</div></td>\n</tr>'), ('2017-02-09 19:58:18.202852', 11703942, 231323990, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4711306&amp;r ... (867 characters truncated) ... all style="color:gray">chapter 7 . <span data-xutime="1451969774">1/4/2016</span> </small><div style="margin-top:5px">Great chapter</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-09 19:58:18.202887', 11703942, 231258382, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1635581&amp;r ... (821 characters truncated) ...  <span data-xutime="1451856526">1/3/2016</span> </small><div style="margin-top:5px">Interesting story so far, hope you continue it.</div></td>\n</tr>'), ('2017-02-09 19:58:18.202889', 11703942, 231147095, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5432369&amp;r ... (947 characters truncated) ... read ! You are really the best ! I love the subtle hints between her and Snape. Please continue writing! <br>\nP.S. Happy new year!</div></td>\n</tr>'))]
11:58:18 reviews: Job OK (78dd274b-60af-47f3-b9a1-e0ceb2c76364)
11:58:18 Result is kept for 500 seconds
11:58:18 
11:58:18 *** Listening on chapters, profiles, reviews...
11:58:18 reviews: fanfic.jobs.crawl_reviews(11704606) (eeb8458c-6376-4341-91c9-efb83a44afbc)
11:58:49 reviews: Job OK (eeb8458c-6376-4341-91c9-efb83a44afbc)
11:58:49 Result is kept for 500 seconds
11:58:49 
11:58:49 *** Listening on chapters, profiles, reviews...
11:58:49 reviews: fanfic.jobs.crawl_reviews(11706852) (800225ce-97f0-4fcf-aaa4-e7600cb57e53)
11:59:37 reviews: Job OK (800225ce-97f0-4fcf-aaa4-e7600cb57e53)
11:59:37 Result is kept for 500 seconds
11:59:37 
11:59:37 *** Listening on chapters, profiles, reviews...
11:59:37 reviews: fanfic.jobs.crawl_reviews(11707059) (53c6bcac-f68a-4e27-850d-bcf6af121e76)
11:59:47 reviews: Job OK (53c6bcac-f68a-4e27-850d-bcf6af121e76)
11:59:47 Result is kept for 500 seconds
11:59:47 
11:59:47 *** Listening on chapters, profiles, reviews...
11:59:47 reviews: fanfic.jobs.crawl_reviews(11707275) (1f186b7a-6af0-402a-9dcc-bf2ec65e85be)
2017-02-09 11:59:52 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 19:59:52.267310', 11707275, 246785283, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7095059&amp;r ... (838 characters truncated) ... y">chapter 18 . <span data-xutime="1486085527">2/2</span> </small><div style="margin-top:5px">This is an amazing story, keep it up!</div></td>\n</tr>'), ('2017-02-09 19:59:52.267317', 11707275, 235492727, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (553 characters truncated) ... a-xutime="1460232795">4/9/2016</span> </small><div style="margin-top:5px">Cracking good story, well written action and fun. Thanks.</div></td>\n</tr>'), ('2017-02-09 19:59:52.267319', 11707275, 233120135, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2058505&amp;r ... (1007 characters truncated) ... ce. Very detailed. Loved the tangents. Unfortunate that all of these make this a very niche fic. Very much looking forward to more.</div></td>\n</tr>'), ('2017-02-09 19:59:52.267321', 11707275, 232291070, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4300887&amp;r ... (818 characters truncated) ... or:gray">chapter 18 . <span data-xutime="1453835384">1/26/2016</span> </small><div style="margin-top:5px">Love it please keep it up</div></td>\n</tr>'), ('2017-02-09 19:59:52.267323', 11707275, 231885109, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4165001&amp;r ... (806 characters truncated) ... yle="color:gray">chapter 7 . <span data-xutime="1453063934">1/17/2016</span> </small><div style="margin-top:5px">Loving this so far</div></td>\n</tr>'), ('2017-02-09 19:59:52.267325', 11707275, 231863738, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2650812&amp;r ... (924 characters truncated) ... . <span data-xutime="1453020612">1/17/2016</span> </small><div style="margin-top:5px">this is now one of my favorites in along time</div></td>\n</tr>'), ('2017-02-09 19:59:52.267327', 11707275, 231653691, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (752 characters truncated) ... mplete this epic, original story: would Harry still be played by Daniel Radcliffe or would you choose another actor of your liking?</div></td>\n</tr>'), ('2017-02-09 19:59:52.267328', 11707275, 231504958, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5803071&amp;r ... (1113 characters truncated) ... y\'s overall personality is good. From the description I was expecting more James Bond not a soldier/criminal. This is a fun read..</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-09 19:59:52.267356', 11707275, 231423004, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3085620&amp;r ... (1091 characters truncated) ... know next to nothing about the various planes mentioned) as I did actually reading the story. Can\'t wait to see what happens next.</div></td>\n</tr>'), ('2017-02-09 19:59:52.267358', 11707275, 231300959, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1460286&amp;r ... (796 characters truncated) ...  <small style="color:gray">chapter 6 . <span data-xutime="1451932891">1/4/2016</span> </small><div style="margin-top:5px">Very good</div></td>\n</tr>'))]
11:59:52 reviews: Job OK (1f186b7a-6af0-402a-9dcc-bf2ec65e85be)
11:59:52 Result is kept for 500 seconds
11:59:52 
11:59:52 *** Listening on chapters, profiles, reviews...
11:59:52 reviews: fanfic.jobs.crawl_reviews(11708152) (49078e11-14d1-4b16-b116-3ba38c99818d)
12:00:55 reviews: Job OK (49078e11-14d1-4b16-b116-3ba38c99818d)
12:00:55 Result is kept for 500 seconds
12:00:55 
12:00:55 *** Listening on chapters, profiles, reviews...
12:00:55 reviews: fanfic.jobs.crawl_reviews(11708760) (6a99c356-9a7e-4791-ad7d-dcb56145b130)
2017-02-09 12:00:59 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 20:00:59.197642', 11708760, 245508947, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (599 characters truncated) ... ll><div style="margin-top:5px">YEEEEEEEESS! an update! I love it, keep the good writing, dont let this year end with a cliffhanger.</div></td>\n</tr>'), ('2017-02-09 20:00:59.197647', 11708760, 240550079, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (698 characters truncated) ... the soldier at the beginning? Will herminone will give ethan back to the muggles? Will ethan break free from muggles and wizzards?!</div></td>\n</tr>'), ('2017-02-09 20:00:59.197650', 11708760, 238897058, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1616 characters truncated) ... chapter With so mucho exitment, and if you every write your own novels please let usted Know. I feel you will be an amazing writer.</div></td>\n</tr>'), ('2017-02-09 20:00:59.197652', 11708760, 237894413, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1399 characters truncated) ... n. <br>\nI hope you update soon. As far, this is the Best fic i have even read in this year. And the first male oc i actually read.</div></td>\n</tr>'), ('2017-02-09 20:00:59.197654', 11708760, 237866650, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (596 characters truncated) ... all><div style="margin-top:5px">Ethan and his harem of Witches 3 i dont Know but i Just love Iris and her stubborness around Ethan.</div></td>\n</tr>'), ('2017-02-09 20:00:59.197656', 11708760, 237863750, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (593 characters truncated) ... /small><div style="margin-top:5px">I loved how you portrayed this generation. and ethan is my fav male oc in this hp fanfic fandom!</div></td>\n</tr>'), ('2017-02-09 20:00:59.197658', 11708760, 237858679, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (527 characters truncated) ... ray">chapter 12 . <span data-xutime="1465266881">6/6/2016</span> </small><div style="margin-top:5px">Oh my god! Awesome! I love it!</div></td>\n</tr>'), ('2017-02-09 20:00:59.197660', 11708760, 233903026, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1958997&amp;r ... (811 characters truncated) ... >  <small style="color:gray">chapter 1 . <span data-xutime="1457099245">3/4/2016</span> </small><div style="margin-top:5px">is ggod</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-09 20:00:59.197703', 11708760, 232055820, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2189549&amp;r ... (948 characters truncated) ... ds revision for sure. <br>\n<br>\nI like it, neat concept, well written. Just fix the grammar. End people speaking with perids plx.</div></td>\n</tr>'), ('2017-02-09 20:00:59.197705', 11708760, 231206119, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4508734&amp;r ... (920 characters truncated) ... <small style="color:gray">chapter 1 . <span data-xutime="1451764820">1/2/2016</span> </small><div style="margin-top:5px">good story</div></td>\n</tr>'))]
12:00:59 reviews: Job OK (6a99c356-9a7e-4791-ad7d-dcb56145b130)
12:00:59 Result is kept for 500 seconds
12:00:59 
12:00:59 *** Listening on chapters, profiles, reviews...
12:00:59 reviews: fanfic.jobs.crawl_reviews(11709291) (54f8b91f-f1f6-434a-b8f9-fbab64aa4653)
12:01:36 reviews: Job OK (54f8b91f-f1f6-434a-b8f9-fbab64aa4653)
12:01:36 Result is kept for 500 seconds
12:01:36 
12:01:36 *** Listening on chapters, profiles, reviews...
12:01:36 reviews: fanfic.jobs.crawl_reviews(11709496) (64a66a4f-4a44-4034-acdf-c8fa6bd5f450)
12:01:41 reviews: Job OK (64a66a4f-4a44-4034-acdf-c8fa6bd5f450)
12:01:41 Result is kept for 500 seconds
12:01:41 
12:01:41 *** Listening on chapters, profiles, reviews...
12:01:41 reviews: fanfic.jobs.crawl_reviews(11709730) (458f87ff-072b-4f0b-b70b-fbe5929b25b2)
12:02:07 reviews: Job OK (458f87ff-072b-4f0b-b70b-fbe5929b25b2)
12:02:07 Result is kept for 500 seconds
12:02:07 
12:02:07 *** Listening on chapters, profiles, reviews...
12:02:07 reviews: fanfic.jobs.crawl_reviews(11709807) (d7b4c559-31e5-4328-bb68-ca986a3e0f18)
12:03:19 reviews: Job OK (d7b4c559-31e5-4328-bb68-ca986a3e0f18)
12:03:19 Result is kept for 500 seconds
12:03:19 
12:03:19 *** Listening on chapters, profiles, reviews...
12:03:19 reviews: fanfic.jobs.crawl_reviews(11709899) (879ec19e-46fb-4b2e-974e-f7bfe7be485a)
12:09:21 reviews: Job OK (879ec19e-46fb-4b2e-974e-f7bfe7be485a)
12:09:21 Result is kept for 500 seconds
12:09:21 
12:09:21 *** Listening on chapters, profiles, reviews...
12:09:21 reviews: fanfic.jobs.crawl_reviews(11710742) (7517b3b6-74b5-4be7-9bcc-b12e2115c73f)
12:09:31 reviews: Job OK (7517b3b6-74b5-4be7-9bcc-b12e2115c73f)
12:09:31 Result is kept for 500 seconds
12:09:31 
12:09:31 *** Listening on chapters, profiles, reviews...
12:09:31 reviews: fanfic.jobs.crawl_reviews(11711983) (d5301912-5345-47c2-8b68-4b2b9275cbb0)
12:09:36 reviews: Job OK (d5301912-5345-47c2-8b68-4b2b9275cbb0)
12:09:36 Result is kept for 500 seconds
12:09:36 
12:09:36 *** Listening on chapters, profiles, reviews...
12:09:36 reviews: fanfic.jobs.crawl_reviews(11712367) (557ddc67-102a-4565-85be-d46c4cdf713e)
12:10:17 reviews: Job OK (557ddc67-102a-4565-85be-d46c4cdf713e)
12:10:17 Result is kept for 500 seconds
12:10:17 
12:10:17 *** Listening on chapters, profiles, reviews...
12:10:17 reviews: fanfic.jobs.crawl_reviews(11712819) (93a31509-7b8d-4719-a532-524c3ef007a1)
12:10:52 reviews: Job OK (93a31509-7b8d-4719-a532-524c3ef007a1)
12:10:52 Result is kept for 500 seconds
12:10:52 
12:10:52 *** Listening on chapters, profiles, reviews...
12:10:52 reviews: fanfic.jobs.crawl_reviews(11713969) (13775df1-58d2-470f-838d-e8afe80cb531)
12:11:04 reviews: Job OK (13775df1-58d2-470f-838d-e8afe80cb531)
12:11:04 Result is kept for 500 seconds
12:11:04 
12:11:04 *** Listening on chapters, profiles, reviews...
12:11:04 reviews: fanfic.jobs.crawl_reviews(11714527) (5013f20b-ddfd-4e73-8528-248fa3a02dcc)
2017-02-09 12:11:09 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 20:11:09.863734', 11714527, 239950989, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (511 characters truncated) ... l style="color:gray">chapter 1 . <span data-xutime="1469590636">7/26/2016</span> </small><div style="margin-top:5px">Please update!</div></td>\n</tr>'), ('2017-02-09 20:11:09.863738', 11714527, 238457334, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (504 characters truncated) ... t <small style="color:gray">chapter 1 . <span data-xutime="1466533604">6/21/2016</span> </small><div style="margin-top:5px">Update!</div></td>\n</tr>'), ('2017-02-09 20:11:09.863741', 11714527, 237486710, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (511 characters truncated) ... l style="color:gray">chapter 1 . <span data-xutime="1464494033">5/28/2016</span> </small><div style="margin-top:5px">Please update!</div></td>\n</tr>'), ('2017-02-09 20:11:09.863743', 11714527, 237006265, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (504 characters truncated) ... t <small style="color:gray">chapter 1 . <span data-xutime="1463449510">5/16/2016</span> </small><div style="margin-top:5px">Update️</div></td>\n</tr>'), ('2017-02-09 20:11:09.863745', 11714527, 236503528, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (510 characters truncated) ... ll style="color:gray">chapter 1 . <span data-xutime="1462361813">5/4/2016</span> </small><div style="margin-top:5px">Update please!</div></td>\n</tr>'), ('2017-02-09 20:11:09.863747', 11714527, 236050450, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (536 characters truncated) ... ter 30 . <span data-xutime="1461426443">4/23/2016</span> </small><div style="margin-top:5px">So good! Can\'t wait for the next one!</div></td>\n</tr>'), ('2017-02-09 20:11:09.863748', 11714527, 235955260, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (510 characters truncated) ... ll style="color:gray">chapter 1 . <span data-xutime="1461211299">4/20/2016</span> </small><div style="margin-top:5px">Update please</div></td>\n</tr>'), ('2017-02-09 20:11:09.863750', 11714527, 235465285, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (510 characters truncated) ... ll style="color:gray">chapter 1 . <span data-xutime="1460220326">4/9/2016</span> </small><div style="margin-top:5px">Please update!</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-09 20:11:09.863785', 11714527, 231711199, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (540 characters truncated) ... 1 . <span data-xutime="1452710032">1/13/2016</span> </small><div style="margin-top:5px">I need to know what\'s next! Please update!</div></td>\n</tr>'), ('2017-02-09 20:11:09.863787', 11714527, 231665842, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (513 characters truncated) ... style="color:gray">chapter 1 . <span data-xutime="1452619011">1/12/2016</span> </small><div style="margin-top:5px">Update please :)</div></td>\n</tr>'))]
12:11:09 reviews: Job OK (5013f20b-ddfd-4e73-8528-248fa3a02dcc)
12:11:09 Result is kept for 500 seconds
12:11:09 
12:11:09 *** Listening on chapters, profiles, reviews...
12:11:09 reviews: fanfic.jobs.crawl_reviews(11714619) (9b85b48a-1ab9-4f24-9901-be2365014d28)
12:13:40 reviews: Job OK (9b85b48a-1ab9-4f24-9901-be2365014d28)
12:13:40 Result is kept for 500 seconds
12:13:40 Cleaning registries for queue: chapters
12:13:40 Cleaning registries for queue: profiles
12:13:40 Cleaning registries for queue: reviews
12:13:40 
12:13:40 *** Listening on chapters, profiles, reviews...
12:13:40 reviews: fanfic.jobs.crawl_reviews(11715799) (0c61d800-38e3-4017-9bb2-934c36b238b6)
12:16:24 reviews: Job OK (0c61d800-38e3-4017-9bb2-934c36b238b6)
12:16:24 Result is kept for 500 seconds
12:16:24 
12:16:24 *** Listening on chapters, profiles, reviews...
12:16:24 reviews: fanfic.jobs.crawl_reviews(11716216) (0b411531-c802-455b-b0d8-4329c2561938)
12:17:31 reviews: Job OK (0b411531-c802-455b-b0d8-4329c2561938)
12:17:31 Result is kept for 500 seconds
12:17:31 
12:17:31 *** Listening on chapters, profiles, reviews...
12:17:31 reviews: fanfic.jobs.crawl_reviews(11716236) (e922a6ef-f21c-4158-b000-4df6318e302c)
12:18:24 reviews: Job OK (e922a6ef-f21c-4158-b000-4df6318e302c)
12:18:24 Result is kept for 500 seconds
12:18:24 
12:18:24 *** Listening on chapters, profiles, reviews...
12:18:24 reviews: fanfic.jobs.crawl_reviews(11716997) (6c9d5afa-5719-40cb-808b-490dd7b33edf)
12:19:00 reviews: Job OK (6c9d5afa-5719-40cb-808b-490dd7b33edf)
12:19:00 Result is kept for 500 seconds
12:19:00 
12:19:00 *** Listening on chapters, profiles, reviews...
12:19:00 reviews: fanfic.jobs.crawl_reviews(11717042) (7f41a4cf-a48c-4dc8-9095-d5a55b1605c9)
12:21:08 reviews: Job OK (7f41a4cf-a48c-4dc8-9095-d5a55b1605c9)
12:21:08 Result is kept for 500 seconds
12:21:08 
12:21:08 *** Listening on chapters, profiles, reviews...
12:21:08 reviews: fanfic.jobs.crawl_reviews(11717252) (680d21c1-2388-41a6-9652-ade4cf189f87)
12:22:19 reviews: Job OK (680d21c1-2388-41a6-9652-ade4cf189f87)
12:22:19 Result is kept for 500 seconds
12:22:19 
12:22:19 *** Listening on chapters, profiles, reviews...
12:22:19 reviews: fanfic.jobs.crawl_reviews(11719221) (fc73d77a-5e37-4cd1-b9f0-39223910a4eb)
12:23:15 reviews: Job OK (fc73d77a-5e37-4cd1-b9f0-39223910a4eb)
12:23:15 Result is kept for 500 seconds
12:23:15 
12:23:15 *** Listening on chapters, profiles, reviews...
12:23:15 reviews: fanfic.jobs.crawl_reviews(11719565) (7b4d96fb-470d-46ce-afee-d3ede533d2c4)
12:23:21 reviews: Job OK (7b4d96fb-470d-46ce-afee-d3ede533d2c4)
12:23:21 Result is kept for 500 seconds
12:23:21 
12:23:21 *** Listening on chapters, profiles, reviews...
12:23:21 reviews: fanfic.jobs.crawl_reviews(11720141) (44ff4fc0-6b03-4521-85f6-327869cc5514)
12:24:10 reviews: Job OK (44ff4fc0-6b03-4521-85f6-327869cc5514)
12:24:10 Result is kept for 500 seconds
12:24:10 
12:24:10 *** Listening on chapters, profiles, reviews...
12:24:10 reviews: fanfic.jobs.crawl_reviews(11720199) (6ae0e6cf-7ed6-4d89-8415-4433b9798b62)
12:29:31 reviews: Job OK (6ae0e6cf-7ed6-4d89-8415-4433b9798b62)
12:29:31 Result is kept for 500 seconds
12:29:31 
12:29:31 *** Listening on chapters, profiles, reviews...
12:29:31 reviews: fanfic.jobs.crawl_reviews(11720677) (79100340-a30b-48e4-b251-1a34c0626e6f)
12:31:04 reviews: Job OK (79100340-a30b-48e4-b251-1a34c0626e6f)
12:31:04 Result is kept for 500 seconds
12:31:04 
12:31:04 *** Listening on chapters, profiles, reviews...
12:31:04 reviews: fanfic.jobs.crawl_reviews(11721825) (a309addc-af06-4d99-9dfb-afd223d9b659)
12:37:58 reviews: Job OK (a309addc-af06-4d99-9dfb-afd223d9b659)
12:37:58 Result is kept for 500 seconds
12:37:58 
12:37:58 *** Listening on chapters, profiles, reviews...
12:37:58 reviews: fanfic.jobs.crawl_reviews(11722553) (5c4aec3b-d510-4b79-9bf7-4de7ac2372ed)
12:38:42 reviews: Job OK (5c4aec3b-d510-4b79-9bf7-4de7ac2372ed)
12:38:42 Result is kept for 500 seconds
12:38:42 
12:38:42 *** Listening on chapters, profiles, reviews...
12:38:42 reviews: fanfic.jobs.crawl_reviews(11722608) (6a19d943-d51e-47de-ac53-80d3015c0de7)
12:39:31 reviews: Job OK (6a19d943-d51e-47de-ac53-80d3015c0de7)
12:39:31 Result is kept for 500 seconds
12:39:31 
12:39:31 *** Listening on chapters, profiles, reviews...
12:39:31 reviews: fanfic.jobs.crawl_reviews(11722905) (7c912e8b-ce3d-43d2-bddc-2b14fb4f386e)
12:40:07 reviews: Job OK (7c912e8b-ce3d-43d2-bddc-2b14fb4f386e)
12:40:07 Result is kept for 500 seconds
12:40:07 
12:40:07 *** Listening on chapters, profiles, reviews...
12:40:07 reviews: fanfic.jobs.crawl_reviews(11722938) (1c04fada-3e29-4a0d-9713-48373bae9e26)
12:40:20 reviews: Job OK (1c04fada-3e29-4a0d-9713-48373bae9e26)
12:40:20 Result is kept for 500 seconds
12:40:20 
12:40:20 *** Listening on chapters, profiles, reviews...
12:40:20 reviews: fanfic.jobs.crawl_reviews(11722985) (9c9862aa-1e58-42d1-a146-e1aad3db8ed8)
12:40:58 reviews: Job OK (9c9862aa-1e58-42d1-a146-e1aad3db8ed8)
12:40:58 Result is kept for 500 seconds
12:40:58 
12:40:58 *** Listening on chapters, profiles, reviews...
12:40:58 reviews: fanfic.jobs.crawl_reviews(11724130) (5ad1568c-ed6f-44bf-8a62-06e86629c284)
12:44:38 reviews: Job OK (5ad1568c-ed6f-44bf-8a62-06e86629c284)
12:44:38 Result is kept for 500 seconds
12:44:38 
12:44:38 *** Listening on chapters, profiles, reviews...
12:44:38 reviews: fanfic.jobs.crawl_reviews(11726670) (3fb97473-abc8-4cdf-ae9f-f17755307b4f)
12:45:08 reviews: Job OK (3fb97473-abc8-4cdf-ae9f-f17755307b4f)
12:45:08 Result is kept for 500 seconds
12:45:08 
12:45:08 *** Listening on chapters, profiles, reviews...
12:45:08 reviews: fanfic.jobs.crawl_reviews(11726831) (46e44ca2-74ca-4ebc-91fa-ebbad4245068)
12:45:57 reviews: Job OK (46e44ca2-74ca-4ebc-91fa-ebbad4245068)
12:45:57 Result is kept for 500 seconds
12:45:57 
12:45:57 *** Listening on chapters, profiles, reviews...
12:45:57 reviews: fanfic.jobs.crawl_reviews(11726988) (887346eb-6e9f-4005-ae3a-ad1c67ba0576)
12:46:01 reviews: Job OK (887346eb-6e9f-4005-ae3a-ad1c67ba0576)
12:46:01 Result is kept for 500 seconds
12:46:01 
12:46:01 *** Listening on chapters, profiles, reviews...
12:46:01 reviews: fanfic.jobs.crawl_reviews(11727269) (9a092588-4abc-4bec-bed9-c6a20cc01a05)
12:46:21 reviews: Job OK (9a092588-4abc-4bec-bed9-c6a20cc01a05)
12:46:21 Result is kept for 500 seconds
12:46:21 
12:46:21 *** Listening on chapters, profiles, reviews...
12:46:21 reviews: fanfic.jobs.crawl_reviews(11727461) (70a79c47-f817-4315-947b-8f7d8bbc6186)
12:46:29 reviews: Job OK (70a79c47-f817-4315-947b-8f7d8bbc6186)
12:46:29 Result is kept for 500 seconds
12:46:29 
12:46:29 *** Listening on chapters, profiles, reviews...
12:46:29 reviews: fanfic.jobs.crawl_reviews(11729556) (118dfe9d-a30a-4bb0-a7c1-7d37ce4dc1ac)
12:47:11 reviews: Job OK (118dfe9d-a30a-4bb0-a7c1-7d37ce4dc1ac)
12:47:11 Result is kept for 500 seconds
12:47:11 
12:47:11 *** Listening on chapters, profiles, reviews...
12:47:11 reviews: fanfic.jobs.crawl_reviews(11729812) (db2afb5f-6b77-4ae8-9f7f-f766ed13660d)
12:47:53 reviews: Job OK (db2afb5f-6b77-4ae8-9f7f-f766ed13660d)
12:47:53 Result is kept for 500 seconds
12:47:53 
12:47:53 *** Listening on chapters, profiles, reviews...
12:47:53 reviews: fanfic.jobs.crawl_reviews(11730309) (1c73f5d4-02ce-44ec-b042-39d2f5b0b9c8)
12:49:40 reviews: Job OK (1c73f5d4-02ce-44ec-b042-39d2f5b0b9c8)
12:49:40 Result is kept for 500 seconds
12:49:40 
12:49:40 *** Listening on chapters, profiles, reviews...
12:49:40 reviews: fanfic.jobs.crawl_reviews(11730507) (a1ae045b-4c98-447b-a91d-bc215823c965)
12:51:48 reviews: Job OK (a1ae045b-4c98-447b-a91d-bc215823c965)
12:51:48 Result is kept for 500 seconds
12:51:48 
12:51:48 *** Listening on chapters, profiles, reviews...
12:51:48 reviews: fanfic.jobs.crawl_reviews(11730676) (63a8f41b-ae3a-4d20-995b-dc9e86c198e7)
12:52:00 reviews: Job OK (63a8f41b-ae3a-4d20-995b-dc9e86c198e7)
12:52:00 Result is kept for 500 seconds
12:52:00 
12:52:00 *** Listening on chapters, profiles, reviews...
12:52:00 reviews: fanfic.jobs.crawl_reviews(11731179) (1f2dc1e5-2abc-4736-bc20-8d8ea2e300a8)
12:52:32 reviews: Job OK (1f2dc1e5-2abc-4736-bc20-8d8ea2e300a8)
12:52:32 Result is kept for 500 seconds
12:52:32 
12:52:32 *** Listening on chapters, profiles, reviews...
12:52:32 reviews: fanfic.jobs.crawl_reviews(11732213) (6ed092b2-2a9d-40f9-97af-4a158bc50cc4)
12:54:33 reviews: Job OK (6ed092b2-2a9d-40f9-97af-4a158bc50cc4)
12:54:33 Result is kept for 500 seconds
12:54:33 
12:54:33 *** Listening on chapters, profiles, reviews...
12:54:33 reviews: fanfic.jobs.crawl_reviews(11732410) (7e9465b3-f937-4388-aa0a-6fb74b3f1462)
12:54:45 reviews: Job OK (7e9465b3-f937-4388-aa0a-6fb74b3f1462)
12:54:45 Result is kept for 500 seconds
12:54:45 
12:54:45 *** Listening on chapters, profiles, reviews...
12:54:45 reviews: fanfic.jobs.crawl_reviews(11732427) (32b9850a-7272-4bf2-8fc4-69a4bceddbf8)
12:54:56 reviews: Job OK (32b9850a-7272-4bf2-8fc4-69a4bceddbf8)
12:54:56 Result is kept for 500 seconds
12:54:56 
12:54:56 *** Listening on chapters, profiles, reviews...
12:54:56 reviews: fanfic.jobs.crawl_reviews(11732464) (f4f72ab2-201d-4da2-a491-960ebb92bf15)
12:55:02 reviews: Job OK (f4f72ab2-201d-4da2-a491-960ebb92bf15)
12:55:02 Result is kept for 500 seconds
12:55:02 
12:55:02 *** Listening on chapters, profiles, reviews...
12:55:02 reviews: fanfic.jobs.crawl_reviews(11732934) (0711c7d6-c97f-495a-9600-87d07082b137)
12:55:20 reviews: Job OK (0711c7d6-c97f-495a-9600-87d07082b137)
12:55:20 Result is kept for 500 seconds
12:55:20 
12:55:20 *** Listening on chapters, profiles, reviews...
12:55:20 reviews: fanfic.jobs.crawl_reviews(11733942) (01b2a941-1e5e-4e98-bc47-4acf2a4a7c60)
12:56:50 reviews: Job OK (01b2a941-1e5e-4e98-bc47-4acf2a4a7c60)
12:56:50 Result is kept for 500 seconds
12:56:50 
12:56:50 *** Listening on chapters, profiles, reviews...
12:56:50 reviews: fanfic.jobs.crawl_reviews(11734442) (8eb79047-c13c-46aa-b9b4-0e5c76d8dcd0)
12:57:32 reviews: Job OK (8eb79047-c13c-46aa-b9b4-0e5c76d8dcd0)
12:57:32 Result is kept for 500 seconds
12:57:32 
12:57:32 *** Listening on chapters, profiles, reviews...
12:57:32 reviews: fanfic.jobs.crawl_reviews(11734731) (f0373d78-74b8-42c5-8291-1d93ae387f33)
12:57:56 reviews: Job OK (f0373d78-74b8-42c5-8291-1d93ae387f33)
12:57:56 Result is kept for 500 seconds
12:57:56 
12:57:56 *** Listening on chapters, profiles, reviews...
12:57:56 reviews: fanfic.jobs.crawl_reviews(11734965) (6c921943-1ad3-4243-a301-aabea9f73ad2)
12:58:44 reviews: Job OK (6c921943-1ad3-4243-a301-aabea9f73ad2)
12:58:44 Result is kept for 500 seconds
12:58:44 
12:58:44 *** Listening on chapters, profiles, reviews...
12:58:44 reviews: fanfic.jobs.crawl_reviews(11735486) (6c82ab6f-0b0a-4933-a1d6-d7fab2a2677a)
13:03:23 reviews: Job OK (6c82ab6f-0b0a-4933-a1d6-d7fab2a2677a)
13:03:23 Result is kept for 500 seconds
13:03:23 
13:03:23 *** Listening on chapters, profiles, reviews...
13:03:23 reviews: fanfic.jobs.crawl_reviews(11736465) (9ac560e5-3488-445b-b0c7-9964feea0655)
13:04:07 reviews: Job OK (9ac560e5-3488-445b-b0c7-9964feea0655)
13:04:07 Result is kept for 500 seconds
13:04:07 
13:04:07 *** Listening on chapters, profiles, reviews...
13:04:07 reviews: fanfic.jobs.crawl_reviews(11736610) (da4bda31-7eb1-4dad-b12e-19c1efe02280)
13:05:03 reviews: Job OK (da4bda31-7eb1-4dad-b12e-19c1efe02280)
13:05:03 Result is kept for 500 seconds
13:05:03 
13:05:03 *** Listening on chapters, profiles, reviews...
13:05:03 reviews: fanfic.jobs.crawl_reviews(11736648) (6bdd4144-1706-4063-aff7-7f444be9eed8)
13:05:15 reviews: Job OK (6bdd4144-1706-4063-aff7-7f444be9eed8)
13:05:15 Result is kept for 500 seconds
13:05:15 
13:05:15 *** Listening on chapters, profiles, reviews...
13:05:15 reviews: fanfic.jobs.crawl_reviews(11736812) (2f5dc77f-9b7f-4bc5-85c5-a486dbd7bdee)
13:06:05 reviews: Job OK (2f5dc77f-9b7f-4bc5-85c5-a486dbd7bdee)
13:06:05 Result is kept for 500 seconds
13:06:05 
13:06:05 *** Listening on chapters, profiles, reviews...
13:06:05 reviews: fanfic.jobs.crawl_reviews(11738139) (c8e7bdc3-6e9c-45ad-9003-abae259ff8df)
13:06:14 reviews: Job OK (c8e7bdc3-6e9c-45ad-9003-abae259ff8df)
13:06:14 Result is kept for 500 seconds
13:06:14 
13:06:14 *** Listening on chapters, profiles, reviews...
13:06:14 reviews: fanfic.jobs.crawl_reviews(11738574) (267c8bce-1806-4c2b-a1e7-2d6febe29d3f)
13:06:21 reviews: Job OK (267c8bce-1806-4c2b-a1e7-2d6febe29d3f)
13:06:21 Result is kept for 500 seconds
13:06:22 
13:06:22 *** Listening on chapters, profiles, reviews...
13:06:22 reviews: fanfic.jobs.crawl_reviews(11738723) (3cf2e8ea-9fed-44aa-b78d-13eddf7a7849)
13:07:15 reviews: Job OK (3cf2e8ea-9fed-44aa-b78d-13eddf7a7849)
13:07:15 Result is kept for 500 seconds
13:07:15 
13:07:15 *** Listening on chapters, profiles, reviews...
13:07:15 reviews: fanfic.jobs.crawl_reviews(11739841) (47827c57-3bf8-4901-8cee-f9093074f324)
13:08:32 reviews: Job OK (47827c57-3bf8-4901-8cee-f9093074f324)
13:08:32 Result is kept for 500 seconds
13:08:32 
13:08:32 *** Listening on chapters, profiles, reviews...
13:08:32 reviews: fanfic.jobs.crawl_reviews(11739938) (0a3b8a20-d87f-4a35-9199-d3ae9a8fc534)
13:10:44 reviews: Job OK (0a3b8a20-d87f-4a35-9199-d3ae9a8fc534)
13:10:44 Result is kept for 500 seconds
13:10:44 
13:10:44 *** Listening on chapters, profiles, reviews...
13:10:44 reviews: fanfic.jobs.crawl_reviews(11740291) (26c7dea7-845b-4163-9a4c-564b54076c55)
13:12:42 reviews: Job OK (26c7dea7-845b-4163-9a4c-564b54076c55)
13:12:42 Result is kept for 500 seconds
13:12:42 
13:12:42 *** Listening on chapters, profiles, reviews...
13:12:42 reviews: fanfic.jobs.crawl_reviews(11740540) (4cbc5648-5641-4af4-ae6c-660345286424)
13:12:59 reviews: Job OK (4cbc5648-5641-4af4-ae6c-660345286424)
13:12:59 Result is kept for 500 seconds
13:12:59 
13:12:59 *** Listening on chapters, profiles, reviews...
13:12:59 reviews: fanfic.jobs.crawl_reviews(11741313) (a6429bea-d4d0-4301-b1bd-4fd4035b7a43)
13:13:20 reviews: Job OK (a6429bea-d4d0-4301-b1bd-4fd4035b7a43)
13:13:20 Result is kept for 500 seconds
13:13:20 
13:13:20 *** Listening on chapters, profiles, reviews...
13:13:20 reviews: fanfic.jobs.crawl_reviews(11742226) (9a736de1-42c0-4a8f-bb5e-e46d65c7f6d6)
13:15:03 reviews: Job OK (9a736de1-42c0-4a8f-bb5e-e46d65c7f6d6)
13:15:03 Result is kept for 500 seconds
13:15:03 Cleaning registries for queue: chapters
13:15:03 Cleaning registries for queue: profiles
13:15:03 Cleaning registries for queue: reviews
13:15:03 
13:15:03 *** Listening on chapters, profiles, reviews...
13:15:03 reviews: fanfic.jobs.crawl_reviews(11743600) (1c75e754-59aa-425b-be4f-51742e5f699c)
13:15:33 reviews: Job OK (1c75e754-59aa-425b-be4f-51742e5f699c)
13:15:33 Result is kept for 500 seconds
13:15:33 
13:15:33 *** Listening on chapters, profiles, reviews...
13:15:33 reviews: fanfic.jobs.crawl_reviews(11743651) (f1247487-b54e-4cfe-9e20-56cc23302bea)
13:16:17 reviews: Job OK (f1247487-b54e-4cfe-9e20-56cc23302bea)
13:16:17 Result is kept for 500 seconds
13:16:17 
13:16:17 *** Listening on chapters, profiles, reviews...
13:16:17 reviews: fanfic.jobs.crawl_reviews(11744169) (628f378e-4d26-4931-91d3-6fe9c93d3beb)
13:16:46 reviews: Job OK (628f378e-4d26-4931-91d3-6fe9c93d3beb)
13:16:46 Result is kept for 500 seconds
13:16:46 
13:16:46 *** Listening on chapters, profiles, reviews...
13:16:46 reviews: fanfic.jobs.crawl_reviews(11746053) (cd8f6aaf-b8e1-4206-99c0-cc58f66a001e)
13:18:06 reviews: Job OK (cd8f6aaf-b8e1-4206-99c0-cc58f66a001e)
13:18:06 Result is kept for 500 seconds
13:18:06 
13:18:06 *** Listening on chapters, profiles, reviews...
13:18:06 reviews: fanfic.jobs.crawl_reviews(11746466) (cff359f1-1300-4716-9ce6-419b911ff61d)
13:18:48 reviews: Job OK (cff359f1-1300-4716-9ce6-419b911ff61d)
13:18:48 Result is kept for 500 seconds
13:18:48 
13:18:48 *** Listening on chapters, profiles, reviews...
13:18:48 reviews: fanfic.jobs.crawl_reviews(11747402) (8435d85c-5feb-45d8-bc74-450d7523a3c6)
13:20:16 reviews: Job OK (8435d85c-5feb-45d8-bc74-450d7523a3c6)
13:20:16 Result is kept for 500 seconds
13:20:16 
13:20:16 *** Listening on chapters, profiles, reviews...
13:20:16 reviews: fanfic.jobs.crawl_reviews(11747549) (11482a39-6472-4bcf-b5a0-acaf5829b368)
13:21:47 reviews: Job OK (11482a39-6472-4bcf-b5a0-acaf5829b368)
13:21:47 Result is kept for 500 seconds
13:21:47 
13:21:47 *** Listening on chapters, profiles, reviews...
13:21:47 reviews: fanfic.jobs.crawl_reviews(11747888) (98e7c6b8-a860-400a-b32e-22ed2936ce11)
13:22:48 reviews: Job OK (98e7c6b8-a860-400a-b32e-22ed2936ce11)
13:22:48 Result is kept for 500 seconds
13:22:48 
13:22:48 *** Listening on chapters, profiles, reviews...
13:22:48 reviews: fanfic.jobs.crawl_reviews(11748601) (e47485a2-975e-4216-8e19-fb875ddb8960)
13:22:53 reviews: Job OK (e47485a2-975e-4216-8e19-fb875ddb8960)
13:22:53 Result is kept for 500 seconds
13:22:53 
13:22:53 *** Listening on chapters, profiles, reviews...
13:22:53 reviews: fanfic.jobs.crawl_reviews(11748849) (63aa54a4-1abc-46fd-84fa-5be29694cd6f)
13:23:11 reviews: Job OK (63aa54a4-1abc-46fd-84fa-5be29694cd6f)
13:23:11 Result is kept for 500 seconds
13:23:11 
13:23:11 *** Listening on chapters, profiles, reviews...
13:23:11 reviews: fanfic.jobs.crawl_reviews(11748920) (b8b9b637-7a80-4955-9fc5-23a981e098b2)
13:23:28 reviews: Job OK (b8b9b637-7a80-4955-9fc5-23a981e098b2)
13:23:28 Result is kept for 500 seconds
13:23:28 
13:23:28 *** Listening on chapters, profiles, reviews...
13:23:28 reviews: fanfic.jobs.crawl_reviews(11748927) (f0b7bcd9-ac05-4563-9163-e66782f67936)
2017-02-09 13:23:33 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 21:23:33.399561', 11748927, 240247550, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (522 characters truncated) ... le="color:gray">chapter 27 . <span data-xutime="1470042473">8/1/2016</span> </small><div style="margin-top:5px">Omg this is so good</div></td>\n</tr>'), ('2017-02-09 21:23:33.399565', 11748927, 240193781, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6361732&amp;r ... (978 characters truncated) ... > </small><div style="margin-top:5px">I am totally in love with this story. Its soooooo cute. 3 your writing. Can\'t wait for more.</div></td>\n</tr>'), ('2017-02-09 21:23:33.399567', 11748927, 232663449, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4391395&amp;r ... (850 characters truncated) ... 2/4/2016</span> </small><div style="margin-top:5px">You know, I would "favor" and "follow" your story right away again, if I could!</div></td>\n</tr>'), ('2017-02-09 21:23:33.399570', 11748927, 232644185, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5790533&amp;r ... (769 characters truncated) ... >  <small style="color:gray">chapter 18 . <span data-xutime="1454544074">2/3/2016</span> </small><div style="margin-top:5px">Update</div></td>\n</tr>'), ('2017-02-09 21:23:33.399572', 11748927, 232460419, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7227856&amp;r ... (1140 characters truncated) ...  complicated relationship with Sirius. <br>\n<br>\nI will definitely keep reading when I get a chance. Awesome work and keep it up!</div></td>\n</tr>'), ('2017-02-09 21:23:33.399573', 11748927, 232260576, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4391395&amp;r ... (1340 characters truncated) ... admit it then. <br>\nAnd I\'m looking forward to see their friendship develop. <br>\nThanks for this wonderful story! <br>\nFea :-)</div></td>\n</tr>'), ('2017-02-09 21:23:33.399575', 11748927, 232245216, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (529 characters truncated) ... ay">chapter 1 . <span data-xutime="1453573628">1/23/2016</span> </small><div style="margin-top:5px">Please update it\'s amaaaaazing</div></td>\n</tr>'), ('2017-02-09 21:23:33.399577', 11748927, 240247550, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (522 characters truncated) ... le="color:gray">chapter 27 . <span data-xutime="1470042473">8/1/2016</span> </small><div style="margin-top:5px">Omg this is so good</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-09 21:23:33.399587', 11748927, 232260576, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4391395&amp;r ... (1340 characters truncated) ... admit it then. <br>\nAnd I\'m looking forward to see their friendship develop. <br>\nThanks for this wonderful story! <br>\nFea :-)</div></td>\n</tr>'), ('2017-02-09 21:23:33.399589', 11748927, 232245216, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (529 characters truncated) ... ay">chapter 1 . <span data-xutime="1453573628">1/23/2016</span> </small><div style="margin-top:5px">Please update it\'s amaaaaazing</div></td>\n</tr>'))]
13:23:33 reviews: Job OK (f0b7bcd9-ac05-4563-9163-e66782f67936)
13:23:33 Result is kept for 500 seconds
13:23:33 
13:23:33 *** Listening on chapters, profiles, reviews...
13:23:33 reviews: fanfic.jobs.crawl_reviews(11750463) (a6518872-17fd-452f-b662-3c1a13c68dee)
13:23:41 reviews: Job OK (a6518872-17fd-452f-b662-3c1a13c68dee)
13:23:41 Result is kept for 500 seconds
13:23:41 
13:23:41 *** Listening on chapters, profiles, reviews...
13:23:41 reviews: fanfic.jobs.crawl_reviews(11750606) (eadc8f92-1828-45a3-ba7d-b6ae0c86cc79)
13:24:02 reviews: Job OK (eadc8f92-1828-45a3-ba7d-b6ae0c86cc79)
13:24:02 Result is kept for 500 seconds
13:24:02 
13:24:02 *** Listening on chapters, profiles, reviews...
13:24:02 reviews: fanfic.jobs.crawl_reviews(11750613) (fc60a11f-b87d-4abf-bf8c-7020e5d3422e)
13:24:50 reviews: Job OK (fc60a11f-b87d-4abf-bf8c-7020e5d3422e)
13:24:50 Result is kept for 500 seconds
13:24:50 
13:24:50 *** Listening on chapters, profiles, reviews...
13:24:50 reviews: fanfic.jobs.crawl_reviews(11750662) (943efb9c-be80-403e-8a8d-a60c961871cb)
13:24:59 reviews: Job OK (943efb9c-be80-403e-8a8d-a60c961871cb)
13:24:59 Result is kept for 500 seconds
13:25:00 
13:25:00 *** Listening on chapters, profiles, reviews...
13:25:00 reviews: fanfic.jobs.crawl_reviews(11751790) (c6871197-a2c2-4376-8aa7-ee84f2fbe7d1)
2017-02-09 13:25:01 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/11751790/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
13:25:01 reviews: Job OK (c6871197-a2c2-4376-8aa7-ee84f2fbe7d1)
13:25:01 Result is kept for 500 seconds
13:25:01 
13:25:01 *** Listening on chapters, profiles, reviews...
13:25:01 reviews: fanfic.jobs.crawl_reviews(11752057) (07f09df2-ec16-43fc-853f-21d4ea6193f4)
13:25:39 reviews: Job OK (07f09df2-ec16-43fc-853f-21d4ea6193f4)
13:25:39 Result is kept for 500 seconds
13:25:39 
13:25:39 *** Listening on chapters, profiles, reviews...
13:25:39 reviews: fanfic.jobs.crawl_reviews(11752462) (0a6c1ba4-4c68-4e99-b060-b9a0e10f15a1)
13:26:48 reviews: Job OK (0a6c1ba4-4c68-4e99-b060-b9a0e10f15a1)
13:26:48 Result is kept for 500 seconds
13:26:48 
13:26:48 *** Listening on chapters, profiles, reviews...
13:26:48 reviews: fanfic.jobs.crawl_reviews(11753446) (1492bf47-4776-42fc-b153-89f3f836e4dd)
13:32:41 reviews: Job OK (1492bf47-4776-42fc-b153-89f3f836e4dd)
13:32:41 Result is kept for 500 seconds
13:32:41 
13:32:41 *** Listening on chapters, profiles, reviews...
13:32:41 reviews: fanfic.jobs.crawl_reviews(11753877) (c3a9a6c2-276f-44e2-9d07-6acb8545cd95)
13:34:49 reviews: Job OK (c3a9a6c2-276f-44e2-9d07-6acb8545cd95)
13:34:49 Result is kept for 500 seconds
13:34:49 
13:34:49 *** Listening on chapters, profiles, reviews...
13:34:49 reviews: fanfic.jobs.crawl_reviews(11754902) (07eb5638-5bda-4178-aec9-859a031d7c3c)
13:34:54 reviews: Job OK (07eb5638-5bda-4178-aec9-859a031d7c3c)
13:34:54 Result is kept for 500 seconds
13:34:54 
13:34:54 *** Listening on chapters, profiles, reviews...
13:34:54 reviews: fanfic.jobs.crawl_reviews(11755864) (86c8cc83-8ec2-43a7-8f90-6cd96fc3ad45)
13:36:47 reviews: Job OK (86c8cc83-8ec2-43a7-8f90-6cd96fc3ad45)
13:36:47 Result is kept for 500 seconds
13:36:47 
13:36:47 *** Listening on chapters, profiles, reviews...
13:36:47 reviews: fanfic.jobs.crawl_reviews(11755930) (716f1dcd-d707-4f3d-8619-00a5071c8b4b)
13:38:02 reviews: Job OK (716f1dcd-d707-4f3d-8619-00a5071c8b4b)
13:38:02 Result is kept for 500 seconds
13:38:02 
13:38:02 *** Listening on chapters, profiles, reviews...
13:38:02 reviews: fanfic.jobs.crawl_reviews(11756047) (df62f3c7-bb10-468c-9b82-bd5c2d9879b2)
13:38:15 reviews: Job OK (df62f3c7-bb10-468c-9b82-bd5c2d9879b2)
13:38:15 Result is kept for 500 seconds
13:38:15 
13:38:15 *** Listening on chapters, profiles, reviews...
13:38:15 reviews: fanfic.jobs.crawl_reviews(11756147) (aefcf2ac-84ce-4a93-a85e-78d31ba8315d)
13:38:21 reviews: Job OK (aefcf2ac-84ce-4a93-a85e-78d31ba8315d)
13:38:21 Result is kept for 500 seconds
13:38:21 
13:38:21 *** Listening on chapters, profiles, reviews...
13:38:21 reviews: fanfic.jobs.crawl_reviews(11756161) (e56c1ca8-f856-4902-afd1-024ff805a87f)
13:42:13 reviews: Job OK (e56c1ca8-f856-4902-afd1-024ff805a87f)
13:42:13 Result is kept for 500 seconds
13:42:13 
13:42:13 *** Listening on chapters, profiles, reviews...
13:42:13 reviews: fanfic.jobs.crawl_reviews(11756179) (b921dc2e-8625-4762-9835-068c0d18d21d)
13:44:19 reviews: Job OK (b921dc2e-8625-4762-9835-068c0d18d21d)
13:44:19 Result is kept for 500 seconds
13:44:19 
13:44:19 *** Listening on chapters, profiles, reviews...
13:44:19 reviews: fanfic.jobs.crawl_reviews(11758291) (2ee02a84-e548-4311-b5ec-2933a062bc88)
13:45:21 reviews: Job OK (2ee02a84-e548-4311-b5ec-2933a062bc88)
13:45:21 Result is kept for 500 seconds
13:45:21 
13:45:21 *** Listening on chapters, profiles, reviews...
13:45:21 reviews: fanfic.jobs.crawl_reviews(11758587) (c4427d5f-8a43-4e33-84fa-844c33e6d175)
13:45:42 reviews: Job OK (c4427d5f-8a43-4e33-84fa-844c33e6d175)
13:45:42 Result is kept for 500 seconds
13:45:42 
13:45:42 *** Listening on chapters, profiles, reviews...
13:45:42 reviews: fanfic.jobs.crawl_reviews(11758746) (5ac9bc53-fb60-4186-8d2d-b530ddeffd96)
13:48:38 reviews: Job OK (5ac9bc53-fb60-4186-8d2d-b530ddeffd96)
13:48:38 Result is kept for 500 seconds
13:48:38 
13:48:38 *** Listening on chapters, profiles, reviews...
13:48:38 reviews: fanfic.jobs.crawl_reviews(11758822) (963fd8a4-6962-47cb-a4a3-3c8fcf2b284f)
13:48:44 reviews: Job OK (963fd8a4-6962-47cb-a4a3-3c8fcf2b284f)
13:48:44 Result is kept for 500 seconds
13:48:44 
13:48:44 *** Listening on chapters, profiles, reviews...
13:48:44 reviews: fanfic.jobs.crawl_reviews(11758961) (02d2cce8-2092-4629-be5d-74ee6fa29082)
13:51:22 reviews: Job OK (02d2cce8-2092-4629-be5d-74ee6fa29082)
13:51:22 Result is kept for 500 seconds
13:51:22 
13:51:22 *** Listening on chapters, profiles, reviews...
13:51:22 reviews: fanfic.jobs.crawl_reviews(11761312) (b7595b55-b74b-4464-a5f3-58b7b613e6ca)
13:56:12 reviews: Job OK (b7595b55-b74b-4464-a5f3-58b7b613e6ca)
13:56:12 Result is kept for 500 seconds
13:56:12 
13:56:12 *** Listening on chapters, profiles, reviews...
13:56:12 reviews: fanfic.jobs.crawl_reviews(11761403) (8d6d1f7c-8d40-4537-95fc-12d3846cd8f9)
13:56:27 reviews: Job OK (8d6d1f7c-8d40-4537-95fc-12d3846cd8f9)
13:56:27 Result is kept for 500 seconds
13:56:27 
13:56:27 *** Listening on chapters, profiles, reviews...
13:56:27 reviews: fanfic.jobs.crawl_reviews(11761914) (3510c376-0490-48ea-bb5a-1d0ee898238c)
13:56:31 reviews: Job OK (3510c376-0490-48ea-bb5a-1d0ee898238c)
13:56:31 Result is kept for 500 seconds
13:56:31 
13:56:31 *** Listening on chapters, profiles, reviews...
13:56:31 reviews: fanfic.jobs.crawl_reviews(11761990) (10af4a18-c594-4882-a768-27e44a03970b)
13:56:36 reviews: Job OK (10af4a18-c594-4882-a768-27e44a03970b)
13:56:36 Result is kept for 500 seconds
13:56:36 
13:56:36 *** Listening on chapters, profiles, reviews...
13:56:36 reviews: fanfic.jobs.crawl_reviews(11762850) (e434643b-d2ea-4a91-9f24-c632178ce37c)
14:04:39 reviews: Job OK (e434643b-d2ea-4a91-9f24-c632178ce37c)
14:04:39 Result is kept for 500 seconds
14:04:39 
14:04:39 *** Listening on chapters, profiles, reviews...
14:04:39 reviews: fanfic.jobs.crawl_reviews(11762909) (5dd31066-314a-48e6-b3f4-4e7ba5fcfbf2)
14:05:14 reviews: Job OK (5dd31066-314a-48e6-b3f4-4e7ba5fcfbf2)
14:05:14 Result is kept for 500 seconds
14:05:14 
14:05:14 *** Listening on chapters, profiles, reviews...
14:05:14 reviews: fanfic.jobs.crawl_reviews(11763756) (8c7b7ae6-0858-44be-aad4-ed6cbe9464fa)
14:05:30 reviews: Job OK (8c7b7ae6-0858-44be-aad4-ed6cbe9464fa)
14:05:30 Result is kept for 500 seconds
14:05:30 
14:05:30 *** Listening on chapters, profiles, reviews...
14:05:30 reviews: fanfic.jobs.crawl_reviews(11764057) (af491d93-1e7f-4637-b562-c99579c99316)
14:09:32 reviews: Job OK (af491d93-1e7f-4637-b562-c99579c99316)
14:09:32 Result is kept for 500 seconds
14:09:32 
14:09:32 *** Listening on chapters, profiles, reviews...
14:09:32 reviews: fanfic.jobs.crawl_reviews(11764385) (40c19d36-d1d7-4973-8529-d914a27652ef)
14:09:37 reviews: Job OK (40c19d36-d1d7-4973-8529-d914a27652ef)
14:09:37 Result is kept for 500 seconds
14:09:37 
14:09:37 *** Listening on chapters, profiles, reviews...
14:09:37 reviews: fanfic.jobs.crawl_reviews(11765481) (28c96dec-2956-470f-a703-92619e804f07)
2017-02-09 14:09:43 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 22:09:43.488960', 11765481, 242658523, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (577 characters truncated) ... 0/6/2016</span> </small><div style="margin-top:5px">Unrealistic. Hermione and Harry would end alone and bore themselves to death...</div></td>\n</tr>'), ('2017-02-09 22:09:43.488964', 11765481, 234159159, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4446515&amp;r ... (1529 characters truncated) ... ed out for themselves and were rewarded for it. <br>\n<br>\nDespite that I thank you for sharing and wish you well in your writing.</div></td>\n</tr>'), ('2017-02-09 22:09:43.488967', 11765481, 232778883, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5434235&amp;r ... (936 characters truncated) ... ta-xutime="1454824183">2/6/2016</span> </small><div style="margin-top:5px">Utterly amazing. I can\'t wait to read more of your work</div></td>\n</tr>'), ('2017-02-09 22:09:43.488969', 11765481, 232776200, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5434235&amp;r ... (992 characters truncated) ... e="margin-top:5px">I love this so so much. It feels so natural reading this. Like its the right instalment in the series. Thank you</div></td>\n</tr>'), ('2017-02-09 22:09:43.488971', 11765481, 232772786, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5434235&amp;r ... (922 characters truncated) ...  3 . <span data-xutime="1454814381">2/6/2016</span> </small><div style="margin-top:5px">There are no words for how much I love this</div></td>\n</tr>'), ('2017-02-09 22:09:43.488972', 11765481, 232772425, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5434235&amp;r ... (964 characters truncated) ... 16</span> </small><div style="margin-top:5px">Soooo this is basically what JKR herself would have written post Battle. I\'m in love</div></td>\n</tr>'), ('2017-02-09 22:09:43.488974', 11765481, 232768606, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5434235&amp;r ... (1266 characters truncated) ... soon as I saw Hermione say "our children" I got so excited! I\'m starting this story now and I can\'t wait! H/HR for life! Xoxoxoxo</div></td>\n</tr>'), ('2017-02-09 22:09:43.488976', 11765481, 232725346, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5582194&amp;r ... (828 characters truncated) ... pan data-xutime="1454719283">2/5/2016</span> </small><div style="margin-top:5px">Excellent story, very believable and written well.</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-09 22:09:43.488996', 11765481, 232725074, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3807234&amp;r ... (868 characters truncated) ... 2">2/5/2016</span> </small><div style="margin-top:5px">Have to say I agree with LBII, very much appreciate the good read, good job!</div></td>\n</tr>'), ('2017-02-09 22:09:43.488998', 11765481, 232645924, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3634279&amp;r ... (862 characters truncated) ... n> </small><div style="margin-top:5px">Nice little story! Thank you for sharing your time, talents and imagination with us readers.</div></td>\n</tr>'))]
14:09:43 reviews: Job OK (28c96dec-2956-470f-a703-92619e804f07)
14:09:43 Result is kept for 500 seconds
14:09:43 
14:09:43 *** Listening on chapters, profiles, reviews...
14:09:43 reviews: fanfic.jobs.crawl_reviews(11766244) (6d767d49-3e33-4833-9d50-06fc6acdc237)
14:11:10 reviews: Job OK (6d767d49-3e33-4833-9d50-06fc6acdc237)
14:11:10 Result is kept for 500 seconds
14:11:10 
14:11:10 *** Listening on chapters, profiles, reviews...
14:11:10 reviews: fanfic.jobs.crawl_reviews(11766483) (affa6dde-b834-4fae-b1c5-3580f12f9390)
14:11:57 reviews: Job OK (affa6dde-b834-4fae-b1c5-3580f12f9390)
14:11:57 Result is kept for 500 seconds
14:11:57 
14:11:57 *** Listening on chapters, profiles, reviews...
14:11:57 reviews: fanfic.jobs.crawl_reviews(11767424) (1197a767-025c-4095-942e-9ad5626e3f38)
14:12:23 reviews: Job OK (1197a767-025c-4095-942e-9ad5626e3f38)
14:12:23 Result is kept for 500 seconds
14:12:23 
14:12:23 *** Listening on chapters, profiles, reviews...
14:12:23 reviews: fanfic.jobs.crawl_reviews(11767981) (58c9ca89-b318-4657-a798-98327326a7c8)
14:12:39 reviews: Job OK (58c9ca89-b318-4657-a798-98327326a7c8)
14:12:39 Result is kept for 500 seconds
14:12:39 
14:12:39 *** Listening on chapters, profiles, reviews...
14:12:39 reviews: fanfic.jobs.crawl_reviews(11767990) (40429c5b-f6ff-4ffa-bbce-4db41f9a7127)
14:14:29 reviews: Job OK (40429c5b-f6ff-4ffa-bbce-4db41f9a7127)
14:14:29 Result is kept for 500 seconds
14:14:29 
14:14:29 *** Listening on chapters, profiles, reviews...
14:14:29 reviews: fanfic.jobs.crawl_reviews(11769405) (a1bdca32-545e-4d40-a60a-1db50ef49b24)
14:14:59 reviews: Job OK (a1bdca32-545e-4d40-a60a-1db50ef49b24)
14:14:59 Result is kept for 500 seconds
14:14:59 
14:14:59 *** Listening on chapters, profiles, reviews...
14:14:59 reviews: fanfic.jobs.crawl_reviews(11769861) (a63ed2f6-c424-4c43-a223-c96bc73170e6)
2017-02-09 14:15:04 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 22:15:04.763637', 11769861, 245652634, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8309823&amp;r ... (984 characters truncated) ... 6! Please continue writing! You\'re great! You have inspired me to write my own Fanfic! I hope I can be as good of a writer as you!</div></td>\n</tr>'), ('2017-02-09 22:15:04.763642', 11769861, 245520180, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8309823&amp;r ... (801 characters truncated) ... :gray">chapter 39 . <span data-xutime="1483108984">12/30/2016</span> </small><div style="margin-top:5px">Really enjoying it so far!</div></td>\n</tr>'), ('2017-02-09 22:15:04.763645', 11769861, 245377702, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (543 characters truncated) ... . <span data-xutime="1482784619">12/26/2016</span> </small><div style="margin-top:5px">That was so good! I loved it! Brilliant! ️️️</div></td>\n</tr>'), ('2017-02-09 22:15:04.763647', 11769861, 243916809, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1795081&amp;r ... (3159 characters truncated) ... tter universe, but what is the point of writing OCs into a story where they do absolutely nothing to benefit the story they are in?</div></td>\n</tr>'), ('2017-02-09 22:15:04.763649', 11769861, 243857216, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7842941&amp;r ... (1111 characters truncated) ...  and obviously I can\'t wait to find out more about what\'s happened to Draco because he\'s Draco...duh. Anyway please update soon!</div></td>\n</tr>'), ('2017-02-09 22:15:04.763651', 11769861, 243826820, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7842941&amp;r ... (964 characters truncated) ... ory and I can\'t wait to see how Kat and Draco\'s relationship will develop because they are so cute together and are both amazing.</div></td>\n</tr>'), ('2017-02-09 22:15:04.763652', 11769861, 243791395, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (692 characters truncated) ... like kathrine it\'s not even funny. I am the only slitheryn in a family of grifindors and hufflepuffs so it gets annoying sometimes</div></td>\n</tr>'), ('2017-02-09 22:15:04.763654', 11769861, 241587564, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5602446&amp;r ... (898 characters truncated) ... px">This is a very good read, the character development is splendid and so is the increasing divide between the sisters, good work.</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-09 22:15:04.763686', 11769861, 235399355, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7691420&amp;r ... (874 characters truncated) ... tyle="color:gray">chapter 5 . <span data-xutime="1460079248">4/7/2016</span> </small><div style="margin-top:5px">please update soon</div></td>\n</tr>'), ('2017-02-09 22:15:04.763687', 11769861, 233360865, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1189807&amp;r ... (1764 characters truncated) ...  easier to understand if you stated it at the beginning that it switched to Iz\'s POV, just to avoid confusion. Update soon please!</div></td>\n</tr>'))]
14:15:04 reviews: Job OK (a63ed2f6-c424-4c43-a223-c96bc73170e6)
14:15:04 Result is kept for 500 seconds
14:15:04 Cleaning registries for queue: chapters
14:15:04 Cleaning registries for queue: profiles
14:15:04 Cleaning registries for queue: reviews
14:15:04 
14:15:04 *** Listening on chapters, profiles, reviews...
14:15:04 reviews: fanfic.jobs.crawl_reviews(11772554) (2e79abe8-43de-4a6e-bb89-13d5b87a5be0)
14:16:35 reviews: Job OK (2e79abe8-43de-4a6e-bb89-13d5b87a5be0)
14:16:35 Result is kept for 500 seconds
14:16:35 
14:16:35 *** Listening on chapters, profiles, reviews...
14:16:35 reviews: fanfic.jobs.crawl_reviews(11772961) (d8df18d3-fc4e-4933-bae6-08a1da78f519)
14:17:02 reviews: Job OK (d8df18d3-fc4e-4933-bae6-08a1da78f519)
14:17:02 Result is kept for 500 seconds
14:17:02 
14:17:02 *** Listening on chapters, profiles, reviews...
14:17:02 reviews: fanfic.jobs.crawl_reviews(11773199) (3a13bc95-8414-4b4c-92ae-f63751867edb)
14:22:02 reviews: Job OK (3a13bc95-8414-4b4c-92ae-f63751867edb)
14:22:02 Result is kept for 500 seconds
14:22:02 
14:22:02 *** Listening on chapters, profiles, reviews...
14:22:02 reviews: fanfic.jobs.crawl_reviews(11773427) (4654e8be-792d-428f-9006-0b94599f35b4)
14:22:07 reviews: Job OK (4654e8be-792d-428f-9006-0b94599f35b4)
14:22:07 Result is kept for 500 seconds
14:22:07 
14:22:07 *** Listening on chapters, profiles, reviews...
14:22:07 reviews: fanfic.jobs.crawl_reviews(11773877) (6264de24-188a-467a-99ab-25e4f91f56fc)
14:23:03 reviews: Job OK (6264de24-188a-467a-99ab-25e4f91f56fc)
14:23:03 Result is kept for 500 seconds
14:23:03 
14:23:03 *** Listening on chapters, profiles, reviews...
14:23:03 reviews: fanfic.jobs.crawl_reviews(11774142) (f882d2b0-a347-449e-8452-a3ea9379a2bf)
14:23:56 reviews: Job OK (f882d2b0-a347-449e-8452-a3ea9379a2bf)
14:23:56 Result is kept for 500 seconds
14:23:56 
14:23:56 *** Listening on chapters, profiles, reviews...
14:23:56 reviews: fanfic.jobs.crawl_reviews(11775496) (5fd4b23d-a929-4fc4-82eb-e145a3bbe882)
14:25:12 reviews: Job OK (5fd4b23d-a929-4fc4-82eb-e145a3bbe882)
14:25:12 Result is kept for 500 seconds
14:25:12 
14:25:12 *** Listening on chapters, profiles, reviews...
14:25:12 reviews: fanfic.jobs.crawl_reviews(11775901) (5f4afedf-2d79-498c-b06e-c4ad92d4a233)
2017-02-09 14:25:17 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 22:25:17.299322', 11775901, 246199829, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (914 characters truncated) ... I simply cannot wait to read a traditional, Medieval style Remus x Tonks wedding and I feel that you will be able to do it justice.</div></td>\n</tr>'), ('2017-02-09 22:25:17.299326', 11775901, 243658998, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (536 characters truncated) ... ter 12 . <span data-xutime="1478175977">11/3/2016</span> </small><div style="margin-top:5px">Loved the story! Hope you update soon!</div></td>\n</tr>'), ('2017-02-09 22:25:17.299328', 11775901, 242004747, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4045949&amp;r ... (901 characters truncated) ...  data-xutime="1474153507">9/17/2016</span> </small><div style="margin-top:5px">Interesting story. I wonder when Peter betrays them.</div></td>\n</tr>'), ('2017-02-09 22:25:17.299330', 11775901, 240209139, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7736337&amp;r ... (897 characters truncated) ... love this AU... I\'m story you find it hard to finish, but it \'s fun to read. Think your for pursuing it, in any form you like! ;)</div></td>\n</tr>'), ('2017-02-09 22:25:17.299332', 11775901, 238767114, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7999749&amp;r ... (870 characters truncated) ... e="color:gray">chapter 10 . <span data-xutime="1467159055">6/28/2016</span> </small><div style="margin-top:5px">I like this so far!</div></td>\n</tr>'), ('2017-02-09 22:25:17.299334', 11775901, 238683424, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7736337&amp;r ... (980 characters truncated) ... med real and I ma always excited to see the développement of the relationship between James and Lily. Can\'t wait to read the rest.</div></td>\n</tr>'), ('2017-02-09 22:25:17.299336', 11775901, 237288975, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7736337&amp;r ... (839 characters truncated) ... 8">5/23/2016</span> </small><div style="margin-top:5px">Wow! I think the ending was exactly what it was supposed to be... Congrats!</div></td>\n</tr>'), ('2017-02-09 22:25:17.299338', 11775901, 236431378, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7736337&amp;r ... (798 characters truncated) ... >chapter 8 . <span data-xutime="1462213835">5/2/2016</span> </small><div style="margin-top:5px">This Storm was realistic! Good job!</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-09 22:25:17.299377', 11775901, 232980720, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7398417&amp;r ... (1261 characters truncated) ... lly, I\'m giving you constructive critism, and, like I said, I would be happy to edit your stories for you before you post them. :)</div></td>\n</tr>'), ('2017-02-09 22:25:17.299379', 11775901, 232801555, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4597318&amp;r ... (939 characters truncated) ... /span> </small><div style="margin-top:5px">This is a sweet story. It just shows that some people can be nice to the less fortunate.</div></td>\n</tr>'))]
14:25:17 reviews: Job OK (5f4afedf-2d79-498c-b06e-c4ad92d4a233)
14:25:17 Result is kept for 500 seconds
14:25:17 
14:25:17 *** Listening on chapters, profiles, reviews...
14:25:17 reviews: fanfic.jobs.crawl_reviews(11776402) (532511c3-83c7-4e76-aa46-f7c401e60d0a)
14:34:57 reviews: Job OK (532511c3-83c7-4e76-aa46-f7c401e60d0a)
14:34:57 Result is kept for 500 seconds
14:34:57 
14:34:57 *** Listening on chapters, profiles, reviews...
14:34:57 reviews: fanfic.jobs.crawl_reviews(11776541) (34f82662-3208-435b-9206-a5346e087a06)
14:35:06 reviews: Job OK (34f82662-3208-435b-9206-a5346e087a06)
14:35:06 Result is kept for 500 seconds
14:35:06 
14:35:06 *** Listening on chapters, profiles, reviews...
14:35:06 reviews: fanfic.jobs.crawl_reviews(11777648) (8ac3a0c0-da01-4161-a838-87d9a0afb7df)
14:36:14 reviews: Job OK (8ac3a0c0-da01-4161-a838-87d9a0afb7df)
14:36:14 Result is kept for 500 seconds
14:36:14 
14:36:14 *** Listening on chapters, profiles, reviews...
14:36:14 reviews: fanfic.jobs.crawl_reviews(11777845) (69cda8bb-3d6a-4a9e-b068-bb5cc63b8df8)
14:36:28 reviews: Job OK (69cda8bb-3d6a-4a9e-b068-bb5cc63b8df8)
14:36:28 Result is kept for 500 seconds
14:36:28 
14:36:28 *** Listening on chapters, profiles, reviews...
14:36:28 reviews: fanfic.jobs.crawl_reviews(11778489) (ef337096-5b0a-43a0-aea7-57d909cfe353)
14:36:39 reviews: Job OK (ef337096-5b0a-43a0-aea7-57d909cfe353)
14:36:39 Result is kept for 500 seconds
14:36:39 
14:36:39 *** Listening on chapters, profiles, reviews...
14:36:39 reviews: fanfic.jobs.crawl_reviews(11779160) (81e90bcd-c553-4713-a892-007f2a853bcf)
14:37:37 reviews: Job OK (81e90bcd-c553-4713-a892-007f2a853bcf)
14:37:37 Result is kept for 500 seconds
14:37:37 
14:37:37 *** Listening on chapters, profiles, reviews...
14:37:37 reviews: fanfic.jobs.crawl_reviews(11780875) (f46ef724-beaf-47aa-8273-df39085a1e4b)
2017-02-09 14:37:40 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 22:37:40.667926', 11780875, 246964613, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7303817&amp;r ... (880 characters truncated) ... l style="color:gray">chapter 15 . <span data-xutime="1486524047">2/7</span> </small><div style="margin-top:5px">Soooooooo adorable.</div></td>\n</tr>'), ('2017-02-09 22:37:40.667930', 11780875, 246193597, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (541 characters truncated) ... 3 . <span data-xutime="1484635054">1/16</span> </small><div style="margin-top:5px">Pretty good original story keep up the good work</div></td>\n</tr>'), ('2017-02-09 22:37:40.667933', 11780875, 244671523, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3631613&amp;r ... (908 characters truncated) ... er 12 . <span data-xutime="1480979403">12/5/2016</span> </small><div style="margin-top:5px">I hope you continue this amazing story!</div></td>\n</tr>'), ('2017-02-09 22:37:40.667935', 11780875, 243019795, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7303817&amp;r ... (930 characters truncated) ... e="1476707208">10/17/2016</span> </small><div style="margin-top:5px">Oh the ending sosad but this is great cant wait for the update</div></td>\n</tr>'), ('2017-02-09 22:37:40.667937', 11780875, 242354494, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3631613&amp;r ... (1309 characters truncated) ... ve Harry. Not that I don\'t love Ginny, who I hope will show up soon, but I think Ben and Harry would be cute. Anyways great story!</div></td>\n</tr>'), ('2017-02-09 22:37:40.667938', 11780875, 241859032, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6254014&amp;r ... (1254 characters truncated) ...  sentence said both potions instead of what I believe was supposed to say positions and a sentence that said thank instead of than.</div></td>\n</tr>'), ('2017-02-09 22:37:40.667940', 11780875, 238996424, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (646 characters truncated) ... dom and couldn\'t help reading it all the way through. I love the idea and the characters, you\'ve got to keep going. Go Ravenclaw!</div></td>\n</tr>'), ('2017-02-09 22:37:40.667942', 11780875, 238996393, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (855 characters truncated) ... e Fred and Hermione, also I\'m glad Cedric gets someone that isn\'t Cho Chang. Over all I think It\'s very well written. Keep going</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-09 22:37:40.667966', 11780875, 236435157, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7303817&amp;r ... (915 characters truncated) ... pan data-xutime="1462220717">5/2/2016</span> </small><div style="margin-top:5px">This is awesome I can\'t wait for the next chapter</div></td>\n</tr>'), ('2017-02-09 22:37:40.667968', 11780875, 236127943, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6803217&amp;r ... (860 characters truncated) ... 8349">4/25/2016</span> </small><div style="margin-top:5px">OMG I LOVE THIS SO PLS PLS PLS WRITE MORE KLEDRIC/CEDKLEE MOMENTS PLSSSS</div></td>\n</tr>'))]
14:37:40 reviews: Job OK (f46ef724-beaf-47aa-8273-df39085a1e4b)
14:37:40 Result is kept for 500 seconds
14:37:40 
14:37:40 *** Listening on chapters, profiles, reviews...
14:37:40 reviews: fanfic.jobs.crawl_reviews(11781616) (2f216e11-5366-4ab7-b3d3-7778cca5b6c2)
14:41:27 reviews: Job OK (2f216e11-5366-4ab7-b3d3-7778cca5b6c2)
14:41:27 Result is kept for 500 seconds
14:41:27 
14:41:27 *** Listening on chapters, profiles, reviews...
14:41:27 reviews: fanfic.jobs.crawl_reviews(11782884) (8b1e58b3-9706-4184-a69c-372924e7a072)
14:42:41 reviews: Job OK (8b1e58b3-9706-4184-a69c-372924e7a072)
14:42:41 Result is kept for 500 seconds
14:42:41 
14:42:41 *** Listening on chapters, profiles, reviews...
14:42:41 reviews: fanfic.jobs.crawl_reviews(11782949) (45a46791-1d6b-4e83-84b1-14142ae0194a)
14:44:29 reviews: Job OK (45a46791-1d6b-4e83-84b1-14142ae0194a)
14:44:29 Result is kept for 500 seconds
14:44:29 
14:44:29 *** Listening on chapters, profiles, reviews...
14:44:29 reviews: fanfic.jobs.crawl_reviews(11783790) (8c4517c4-0ba4-4d03-85ba-b934e772af67)
2017-02-09 14:44:34 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 22:44:34.863068', 11783790, 240686794, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3003035&amp;r ... (1468 characters truncated) ... ple like marauder stories. <br>\n<br>\nAnyway, it\'s an interesting story, and I\'d like to know how it goes. Hope you update soon!</div></td>\n</tr>'), ('2017-02-09 22:44:34.863073', 11783790, 240033478, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3053232&amp;r ... (1143 characters truncated) ... l stay in character. I love your writing style ans can not wait for the next chapter!<br>\nWith well wishes <br>\nThe Mad Desperado</div></td>\n</tr>'), ('2017-02-09 22:44:34.863076', 11783790, 233338531, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5540686&amp;r ... (885 characters truncated) ... gray">chapter 7 . <span data-xutime="1455933106">2/19/2016</span> </small><div style="margin-top:5px">FEELS!~ I LOVE THIS SO MUCH A</div></td>\n</tr>'), ('2017-02-09 22:44:34.863078', 11783790, 233313166, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4249873&amp;r ... (1077 characters truncated) ... s the four as children instead of the normal characters (Harry/Ron/hermione etc). It\'s kind of refreshing to see *new* characters!</div></td>\n</tr>'), ('2017-02-09 22:44:34.863080', 11783790, 240686794, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3003035&amp;r ... (1468 characters truncated) ... ple like marauder stories. <br>\n<br>\nAnyway, it\'s an interesting story, and I\'d like to know how it goes. Hope you update soon!</div></td>\n</tr>'), ('2017-02-09 22:44:34.863082', 11783790, 240033478, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3053232&amp;r ... (1143 characters truncated) ... l stay in character. I love your writing style ans can not wait for the next chapter!<br>\nWith well wishes <br>\nThe Mad Desperado</div></td>\n</tr>'), ('2017-02-09 22:44:34.863084', 11783790, 233338531, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5540686&amp;r ... (885 characters truncated) ... gray">chapter 7 . <span data-xutime="1455933106">2/19/2016</span> </small><div style="margin-top:5px">FEELS!~ I LOVE THIS SO MUCH A</div></td>\n</tr>'), ('2017-02-09 22:44:34.863086', 11783790, 233313166, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4249873&amp;r ... (1077 characters truncated) ... s the four as children instead of the normal characters (Harry/Ron/hermione etc). It\'s kind of refreshing to see *new* characters!</div></td>\n</tr>'))]
14:44:34 reviews: Job OK (8c4517c4-0ba4-4d03-85ba-b934e772af67)
14:44:34 Result is kept for 500 seconds
14:44:34 
14:44:34 *** Listening on chapters, profiles, reviews...
14:44:34 reviews: fanfic.jobs.crawl_reviews(11785226) (27860c60-a7ad-40c1-9433-12889c3f30c0)
14:44:39 reviews: Job OK (27860c60-a7ad-40c1-9433-12889c3f30c0)
14:44:39 Result is kept for 500 seconds
14:44:39 
14:44:39 *** Listening on chapters, profiles, reviews...
14:44:39 reviews: fanfic.jobs.crawl_reviews(11785779) (a31a51ab-ec9a-42d1-a42a-164a4145463b)
14:45:03 reviews: Job OK (a31a51ab-ec9a-42d1-a42a-164a4145463b)
14:45:03 Result is kept for 500 seconds
14:45:03 
14:45:03 *** Listening on chapters, profiles, reviews...
14:45:03 reviews: fanfic.jobs.crawl_reviews(11786606) (938a8690-f393-4049-8011-33a66395ee41)
14:45:37 reviews: Job OK (938a8690-f393-4049-8011-33a66395ee41)
14:45:37 Result is kept for 500 seconds
14:45:37 
14:45:37 *** Listening on chapters, profiles, reviews...
14:45:37 reviews: fanfic.jobs.crawl_reviews(11790377) (77ab4973-43b6-49d9-a222-dd926586e1c7)
14:50:28 reviews: Job OK (77ab4973-43b6-49d9-a222-dd926586e1c7)
14:50:28 Result is kept for 500 seconds
14:50:28 
14:50:28 *** Listening on chapters, profiles, reviews...
14:50:28 reviews: fanfic.jobs.crawl_reviews(11790442) (eaa0e545-6740-44a0-b120-98f6a3dd49fe)
14:50:33 reviews: Job OK (eaa0e545-6740-44a0-b120-98f6a3dd49fe)
14:50:33 Result is kept for 500 seconds
14:50:33 
14:50:33 *** Listening on chapters, profiles, reviews...
14:50:33 reviews: fanfic.jobs.crawl_reviews(11792471) (9ae71918-dab1-441f-b577-09f674f6c3f9)
14:52:06 reviews: Job OK (9ae71918-dab1-441f-b577-09f674f6c3f9)
14:52:06 Result is kept for 500 seconds
14:52:06 
14:52:06 *** Listening on chapters, profiles, reviews...
14:52:06 reviews: fanfic.jobs.crawl_reviews(11793088) (e889a52e-552b-4cb6-ae18-b3817677f3fd)
15:07:03 reviews: Job OK (e889a52e-552b-4cb6-ae18-b3817677f3fd)
15:07:03 Result is kept for 500 seconds
15:07:03 
15:07:03 *** Listening on chapters, profiles, reviews...
15:07:03 reviews: fanfic.jobs.crawl_reviews(11794006) (882657b3-33b2-4aac-8bd2-f40c522ed9b2)
15:07:16 reviews: Job OK (882657b3-33b2-4aac-8bd2-f40c522ed9b2)
15:07:16 Result is kept for 500 seconds
15:07:16 
15:07:16 *** Listening on chapters, profiles, reviews...
15:07:16 reviews: fanfic.jobs.crawl_reviews(11795322) (c87d9856-a519-4ea1-ae79-ccf097d34906)
15:08:53 reviews: Job OK (c87d9856-a519-4ea1-ae79-ccf097d34906)
15:08:53 Result is kept for 500 seconds
15:08:53 
15:08:53 *** Listening on chapters, profiles, reviews...
15:08:53 reviews: fanfic.jobs.crawl_reviews(11795843) (51588518-43a7-490d-9c51-60c480207ac9)
15:08:58 reviews: Job OK (51588518-43a7-490d-9c51-60c480207ac9)
15:08:58 Result is kept for 500 seconds
15:08:58 
15:08:58 *** Listening on chapters, profiles, reviews...
15:08:58 reviews: fanfic.jobs.crawl_reviews(11796563) (0aa8e9d8-f116-49a9-bdbf-643b2bc085d9)
15:10:07 reviews: Job OK (0aa8e9d8-f116-49a9-bdbf-643b2bc085d9)
15:10:07 Result is kept for 500 seconds
15:10:07 
15:10:07 *** Listening on chapters, profiles, reviews...
15:10:07 reviews: fanfic.jobs.crawl_reviews(11796690) (79592a89-18ea-4639-8e2c-37a2812504e7)
15:10:59 reviews: Job OK (79592a89-18ea-4639-8e2c-37a2812504e7)
15:10:59 Result is kept for 500 seconds
15:10:59 
15:10:59 *** Listening on chapters, profiles, reviews...
15:10:59 reviews: fanfic.jobs.crawl_reviews(11798373) (dadc6098-7558-49e0-b277-e7b449cdcda3)
15:11:20 reviews: Job OK (dadc6098-7558-49e0-b277-e7b449cdcda3)
15:11:20 Result is kept for 500 seconds
15:11:20 
15:11:20 *** Listening on chapters, profiles, reviews...
15:11:20 reviews: fanfic.jobs.crawl_reviews(11798682) (3e6ea99d-b347-445a-b2e7-a00047a07678)
15:11:40 reviews: Job OK (3e6ea99d-b347-445a-b2e7-a00047a07678)
15:11:40 Result is kept for 500 seconds
15:11:40 
15:11:40 *** Listening on chapters, profiles, reviews...
15:11:40 reviews: fanfic.jobs.crawl_reviews(11798795) (4ae40515-4e2a-45cf-801a-25c62dbb797b)
15:12:03 reviews: Job OK (4ae40515-4e2a-45cf-801a-25c62dbb797b)
15:12:03 Result is kept for 500 seconds
15:12:03 
15:12:03 *** Listening on chapters, profiles, reviews...
15:12:03 reviews: fanfic.jobs.crawl_reviews(11799046) (bc4ac969-7c72-4551-b4c3-82480aea54a6)
15:12:16 reviews: Job OK (bc4ac969-7c72-4551-b4c3-82480aea54a6)
15:12:16 Result is kept for 500 seconds
15:12:16 
15:12:16 *** Listening on chapters, profiles, reviews...
15:12:16 reviews: fanfic.jobs.crawl_reviews(11800072) (5875c7cf-1dde-4ce7-a6eb-f0343496f237)
15:12:24 reviews: Job OK (5875c7cf-1dde-4ce7-a6eb-f0343496f237)
15:12:24 Result is kept for 500 seconds
15:12:24 
15:12:24 *** Listening on chapters, profiles, reviews...
15:12:24 reviews: fanfic.jobs.crawl_reviews(11801144) (d15fc4ce-bd1f-4f6e-93f1-f1a5776653e4)
15:13:29 reviews: Job OK (d15fc4ce-bd1f-4f6e-93f1-f1a5776653e4)
15:13:29 Result is kept for 500 seconds
15:13:29 
15:13:29 *** Listening on chapters, profiles, reviews...
15:13:29 reviews: fanfic.jobs.crawl_reviews(11801402) (c6ea9afe-def2-4f72-bc5b-7f7b9893320d)
2017-02-09 15:13:32 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 23:13:32.429308', 11801402, 246879382, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4931015&amp;r ... (1387 characters truncated) ... et exposure for your story and people get attached to things they have to look forward too and you get to really know your readers.</div></td>\n</tr>'), ('2017-02-09 23:13:32.429312', 11801402, 246879382, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4931015&amp;r ... (1387 characters truncated) ... et exposure for your story and people get attached to things they have to look forward too and you get to really know your readers.</div></td>\n</tr>'))]
15:13:32 reviews: Job OK (c6ea9afe-def2-4f72-bc5b-7f7b9893320d)
15:13:32 Result is kept for 500 seconds
15:13:32 
15:13:32 *** Listening on chapters, profiles, reviews...
15:13:32 reviews: fanfic.jobs.crawl_reviews(11801427) (2dfb79e9-6d6f-496f-ae43-d8a6ed46a963)
15:14:10 reviews: Job OK (2dfb79e9-6d6f-496f-ae43-d8a6ed46a963)
15:14:10 Result is kept for 500 seconds
15:14:11 
15:14:11 *** Listening on chapters, profiles, reviews...
15:14:11 reviews: fanfic.jobs.crawl_reviews(11802242) (b7c41069-6d9c-4707-8372-6303521521af)
15:14:16 reviews: Job OK (b7c41069-6d9c-4707-8372-6303521521af)
15:14:16 Result is kept for 500 seconds
15:14:16 
15:14:16 *** Listening on chapters, profiles, reviews...
15:14:16 reviews: fanfic.jobs.crawl_reviews(11802503) (ee1b9895-fb5b-45c4-b97b-483387c7e147)
2017-02-09 15:27:42 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 23:27:42.422957', 11802503, 247025025, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8348465&amp;r ... (923 characters truncated) ... n data-xutime="1486681201">15m</span> </small><div style="margin-top:5px">Aw man... Roddy... My heart is breaking right now for him</div></td>\n</tr>'), ('2017-02-09 23:27:42.422964', 11802503, 247024900, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7122714&amp;r ... (914 characters truncated) ... 67 . <span data-xutime="1486680900">20m</span> </small><div style="margin-top:5px">yay Kingsley! so much love for him this chapter!</div></td>\n</tr>'), ('2017-02-09 23:27:42.422966', 11802503, 247024658, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8348465&amp;r ... (920 characters truncated) ... span data-xutime="1486680408">28m</span> </small><div style="margin-top:5px">Aw man... This is going to be heartbreaking isn\'t it.</div></td>\n</tr>'), ('2017-02-09 23:27:42.422968', 11802503, 247024145, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2577372&amp;r ... (1001 characters truncated) ... Thomas is helping her with the curse that Voldemort put on her. And that was definitely an interesting reaction from Harry and Ron.</div></td>\n</tr>'), ('2017-02-09 23:27:42.422970', 11802503, 247023649, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8348465&amp;r ... (1024 characters truncated) ... ing to catching up the more I\'m dreading what I\'ll read next. That\'s a good thing though, it\'s rare I\'m this invested in a WIP</div></td>\n</tr>'), ('2017-02-09 23:27:42.422972', 11802503, 247022578, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8348465&amp;r ... (1132 characters truncated) ... ne thought he was a squib. Roddy may have saved Neville\'s life at that moment but he was almost the reason he lost it a few times.</div></td>\n</tr>'), ('2017-02-09 23:27:42.422974', 11802503, 247021456, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8348465&amp;r ... (981 characters truncated) ... argin-top:5px">Gods I hate her so much. What are the odds that she\'s somehow altered her memories like Slughorn tried to do in HBP</div></td>\n</tr>'), ('2017-02-09 23:27:42.422976', 11802503, 247020265, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8348465&amp;r ... (1067 characters truncated) ...  too much of a pacifist to know what to do. <br>\n<br>\nAlso, Kings and Dolohov, I want to smack their too-arrogant heads together.</div></td>\n</tr>')  ... displaying 10 of 3358 total bound parameter sets ...  ('2017-02-09 23:27:42.429423', 11802503, 233395299, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6845098&amp;r ... (880 characters truncated) ... l><div style="margin-top:5px">Absolutely love your stories, love the little corner that you have made in the Harry Potter universe.</div></td>\n</tr>'), ('2017-02-09 23:27:42.429425', 11802503, 233394994, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3936591&amp;r ... (1102 characters truncated) ... rd to where you go with this one. And I absolutely love how you\'re writing kings. Also Idris is the perfect head cannon for kings!</div></td>\n</tr>'))]
15:27:42 reviews: Job OK (ee1b9895-fb5b-45c4-b97b-483387c7e147)
15:27:42 Result is kept for 500 seconds
15:27:42 Cleaning registries for queue: chapters
15:27:42 Cleaning registries for queue: profiles
15:27:42 Cleaning registries for queue: reviews
15:27:42 
15:27:42 *** Listening on chapters, profiles, reviews...
15:27:42 reviews: fanfic.jobs.crawl_reviews(11802554) (10f5d792-f0d2-4771-a61f-047203f21479)
15:27:48 reviews: Job OK (10f5d792-f0d2-4771-a61f-047203f21479)
15:27:48 Result is kept for 500 seconds
15:27:48 
15:27:48 *** Listening on chapters, profiles, reviews...
15:27:48 reviews: fanfic.jobs.crawl_reviews(11802924) (6391db62-0fee-46d9-b448-c3f3afafdcc2)
15:28:51 reviews: Job OK (6391db62-0fee-46d9-b448-c3f3afafdcc2)
15:28:51 Result is kept for 500 seconds
15:28:51 
15:28:51 *** Listening on chapters, profiles, reviews...
15:28:51 reviews: fanfic.jobs.crawl_reviews(11803043) (8a084030-bc37-4120-bb2f-e9615639d7af)
15:29:13 reviews: Job OK (8a084030-bc37-4120-bb2f-e9615639d7af)
15:29:13 Result is kept for 500 seconds
15:29:13 
15:29:13 *** Listening on chapters, profiles, reviews...
15:29:13 reviews: fanfic.jobs.crawl_reviews(11803792) (3fa4ad56-0454-4ac0-9fca-1806cff560f8)
2017-02-09 15:29:17 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 23:29:17.784624', 11803792, 244608994, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7935771&amp;r ... (900 characters truncated) ... style="margin-top:5px">I just read this in one go! Amazing fic! I hope to see carina in more adventures and to Know more about her.</div></td>\n</tr>'), ('2017-02-09 23:29:17.784628', 11803792, 244526703, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8136796&amp;r ... (2032 characters truncated) ... \'s curse is removed. There\'s other questions that I can\'t think of right now but yeah xD I think we all want a sequel... please.</div></td>\n</tr>'), ('2017-02-09 23:29:17.784631', 11803792, 242843334, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (602 characters truncated) ... iv style="margin-top:5px">This is really interesting. It\'s sad that she accepts being forgotten or being referred as a crazy girl.</div></td>\n</tr>'), ('2017-02-09 23:29:17.784633', 11803792, 242802049, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5467256&amp;r ... (797 characters truncated) ... "color:gray">chapter 28 . <span data-xutime="1476142518">10/10/2016</span> </small><div style="margin-top:5px">Now that is awesome!</div></td>\n</tr>'), ('2017-02-09 23:29:17.784635', 11803792, 242798233, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5467256&amp;r ... (1163 characters truncated) ...  why she said earlier that Leo wouldn\'t like to see her at night. Anyways, I really like this story a lot and plan to continue it.</div></td>\n</tr>'), ('2017-02-09 23:29:17.784637', 11803792, 242795348, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4579283&amp;r ... (1114 characters truncated) ... rn eyes and she is a sixth year. Am I missing something? Was the first chapter a flash forward? And if so, how did she get younger?</div></td>\n</tr>'), ('2017-02-09 23:29:17.784638', 11803792, 236711926, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7818778&amp;r ... (889 characters truncated) ... n-top:5px">! Very very interesting story! It\'s a shame that there are no other reviews on it! I\'ll def be keeping tabs on this :3</div></td>\n</tr>'), ('2017-02-09 23:29:17.784640', 11803792, 244608994, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7935771&amp;r ... (900 characters truncated) ... style="margin-top:5px">I just read this in one go! Amazing fic! I hope to see carina in more adventures and to Know more about her.</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-09 23:29:17.784650', 11803792, 242795348, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4579283&amp;r ... (1114 characters truncated) ... rn eyes and she is a sixth year. Am I missing something? Was the first chapter a flash forward? And if so, how did she get younger?</div></td>\n</tr>'), ('2017-02-09 23:29:17.784651', 11803792, 236711926, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7818778&amp;r ... (889 characters truncated) ... n-top:5px">! Very very interesting story! It\'s a shame that there are no other reviews on it! I\'ll def be keeping tabs on this :3</div></td>\n</tr>'))]
15:29:17 reviews: Job OK (3fa4ad56-0454-4ac0-9fca-1806cff560f8)
15:29:17 Result is kept for 500 seconds
15:29:17 
15:29:17 *** Listening on chapters, profiles, reviews...
15:29:17 reviews: fanfic.jobs.crawl_reviews(11803931) (b62a46e7-3c58-4286-8ee8-47f444386643)
15:29:23 reviews: Job OK (b62a46e7-3c58-4286-8ee8-47f444386643)
15:29:23 Result is kept for 500 seconds
15:29:23 
15:29:23 *** Listening on chapters, profiles, reviews...
15:29:23 reviews: fanfic.jobs.crawl_reviews(11804029) (5c6b1188-4ebd-4e1e-a284-c798cace84e9)
15:29:59 reviews: Job OK (5c6b1188-4ebd-4e1e-a284-c798cace84e9)
15:29:59 Result is kept for 500 seconds
15:29:59 
15:29:59 *** Listening on chapters, profiles, reviews...
15:29:59 reviews: fanfic.jobs.crawl_reviews(11804873) (c4ff1dc6-9077-4946-b910-2a830be73bf4)
15:30:45 reviews: Job OK (c4ff1dc6-9077-4946-b910-2a830be73bf4)
15:30:45 Result is kept for 500 seconds
15:30:45 
15:30:45 *** Listening on chapters, profiles, reviews...
15:30:45 reviews: fanfic.jobs.crawl_reviews(11804886) (280db05e-9c3e-4016-956d-8b3fccf814d2)
2017-02-09 15:30:50 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 23:30:50.444091', 11804886, 235201910, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7553132&amp;r ... (865 characters truncated) ... 4/3/2016</span> </small><div style="margin-top:5px">Oohhh...James Potter?! That\'s gonna be interesting! Hope to see part two soon!</div></td>\n</tr>'), ('2017-02-09 23:30:50.444095', 11804886, 234587044, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7553132&amp;r ... (876 characters truncated) ... span> </small><div style="margin-top:5px">An update! Yay! A Fleur chapter? Cool. I\'m surprised you haven\'t done one on Tonks yet.</div></td>\n</tr>'), ('2017-02-09 23:30:50.444098', 11804886, 234159759, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7553132&amp;r ... (844 characters truncated) ... xutime="1457628035">3/10/2016</span> </small><div style="margin-top:5px">Great story so far! Can\'t wait to see how this turns out!</div></td>\n</tr>'), ('2017-02-09 23:30:50.444100', 11804886, 233707970, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1168170&amp;r ... (885 characters truncated) ... ">chapter 7 . <span data-xutime="1456683857">2/28/2016</span> </small><div style="margin-top:5px">Okay Sirius found the family book</div></td>\n</tr>'), ('2017-02-09 23:30:50.444101', 11804886, 235201910, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7553132&amp;r ... (865 characters truncated) ... 4/3/2016</span> </small><div style="margin-top:5px">Oohhh...James Potter?! That\'s gonna be interesting! Hope to see part two soon!</div></td>\n</tr>'), ('2017-02-09 23:30:50.444103', 11804886, 234587044, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7553132&amp;r ... (876 characters truncated) ... span> </small><div style="margin-top:5px">An update! Yay! A Fleur chapter? Cool. I\'m surprised you haven\'t done one on Tonks yet.</div></td>\n</tr>'), ('2017-02-09 23:30:50.444105', 11804886, 234159759, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7553132&amp;r ... (844 characters truncated) ... xutime="1457628035">3/10/2016</span> </small><div style="margin-top:5px">Great story so far! Can\'t wait to see how this turns out!</div></td>\n</tr>'), ('2017-02-09 23:30:50.444107', 11804886, 233707970, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1168170&amp;r ... (885 characters truncated) ... ">chapter 7 . <span data-xutime="1456683857">2/28/2016</span> </small><div style="margin-top:5px">Okay Sirius found the family book</div></td>\n</tr>'))]
15:30:50 reviews: Job OK (280db05e-9c3e-4016-956d-8b3fccf814d2)
15:30:50 Result is kept for 500 seconds
15:30:50 
15:30:50 *** Listening on chapters, profiles, reviews...
15:30:50 reviews: fanfic.jobs.crawl_reviews(11804980) (04c6d01e-b454-4193-9438-dc156f907a08)
15:32:19 reviews: Job OK (04c6d01e-b454-4193-9438-dc156f907a08)
15:32:19 Result is kept for 500 seconds
15:32:19 
15:32:19 *** Listening on chapters, profiles, reviews...
15:32:19 reviews: fanfic.jobs.crawl_reviews(11805613) (b799caf9-cff4-497a-af6c-886d8a250819)
15:32:49 reviews: Job OK (b799caf9-cff4-497a-af6c-886d8a250819)
15:32:49 Result is kept for 500 seconds
15:32:49 
15:32:49 *** Listening on chapters, profiles, reviews...
15:32:49 reviews: fanfic.jobs.crawl_reviews(11806845) (b8aaa4ec-0218-40bd-8d39-ecee1e0d3504)
15:34:27 reviews: Job OK (b8aaa4ec-0218-40bd-8d39-ecee1e0d3504)
15:34:27 Result is kept for 500 seconds
15:34:27 
15:34:27 *** Listening on chapters, profiles, reviews...
15:34:27 reviews: fanfic.jobs.crawl_reviews(11807757) (29cac2bf-a4c9-4c6a-82ef-34bdfab4f9b7)
15:36:12 reviews: Job OK (29cac2bf-a4c9-4c6a-82ef-34bdfab4f9b7)
15:36:12 Result is kept for 500 seconds
15:36:12 
15:36:12 *** Listening on chapters, profiles, reviews...
15:36:12 reviews: fanfic.jobs.crawl_reviews(11808762) (ce02d25e-56d6-45bc-82d3-f6227f78180e)
15:37:17 reviews: Job OK (ce02d25e-56d6-45bc-82d3-f6227f78180e)
15:37:17 Result is kept for 500 seconds
15:37:17 
15:37:17 *** Listening on chapters, profiles, reviews...
15:37:17 reviews: fanfic.jobs.crawl_reviews(11809031) (4096088e-d295-49ab-bf34-bf5a0d2e1fd4)
15:37:34 reviews: Job OK (4096088e-d295-49ab-bf34-bf5a0d2e1fd4)
15:37:34 Result is kept for 500 seconds
15:37:34 
15:37:34 *** Listening on chapters, profiles, reviews...
15:37:34 reviews: fanfic.jobs.crawl_reviews(11809267) (19f7bca8-8b1b-4e5e-bd62-e60ca60ad602)
15:38:37 reviews: Job OK (19f7bca8-8b1b-4e5e-bd62-e60ca60ad602)
15:38:37 Result is kept for 500 seconds
15:38:37 
15:38:37 *** Listening on chapters, profiles, reviews...
15:38:37 reviews: fanfic.jobs.crawl_reviews(11810164) (5d2ecfe7-9cae-4d68-8616-56e10d5d6424)
15:38:42 reviews: Job OK (5d2ecfe7-9cae-4d68-8616-56e10d5d6424)
15:38:42 Result is kept for 500 seconds
15:38:42 
15:38:42 *** Listening on chapters, profiles, reviews...
15:38:42 reviews: fanfic.jobs.crawl_reviews(11811708) (36c50157-8d3a-432a-92bc-c8d1d171ffa0)
15:38:48 reviews: Job OK (36c50157-8d3a-432a-92bc-c8d1d171ffa0)
15:38:48 Result is kept for 500 seconds
15:38:48 
15:38:48 *** Listening on chapters, profiles, reviews...
15:38:48 reviews: fanfic.jobs.crawl_reviews(11811719) (c3e3049d-f2a0-47fd-9757-cd1c4dc07401)
15:40:53 reviews: Job OK (c3e3049d-f2a0-47fd-9757-cd1c4dc07401)
15:40:53 Result is kept for 500 seconds
15:40:54 
15:40:54 *** Listening on chapters, profiles, reviews...
15:40:54 reviews: fanfic.jobs.crawl_reviews(11812531) (1367b3cc-455f-4b50-a7e5-41343cb61a87)
15:42:33 reviews: Job OK (1367b3cc-455f-4b50-a7e5-41343cb61a87)
15:42:33 Result is kept for 500 seconds
15:42:33 
15:42:33 *** Listening on chapters, profiles, reviews...
15:42:33 reviews: fanfic.jobs.crawl_reviews(11814146) (68cab682-ae17-48b4-bdc1-feca5425a261)
15:43:06 reviews: Job OK (68cab682-ae17-48b4-bdc1-feca5425a261)
15:43:06 Result is kept for 500 seconds
15:43:06 
15:43:06 *** Listening on chapters, profiles, reviews...
15:43:06 reviews: fanfic.jobs.crawl_reviews(11815411) (e9ef3038-9fb0-4645-be63-7089e01a6390)
2017-02-09 15:43:11 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 23:43:11.622374', 11815411, 239433340, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7185802&amp;r ... (847 characters truncated) ... e="1468518797">7/14/2016</span> </small><div style="margin-top:5px">when do u think you will update. I\'m really enjoying your book</div></td>\n</tr>'), ('2017-02-09 23:43:11.622379', 11815411, 239433340, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7185802&amp;r ... (847 characters truncated) ... e="1468518797">7/14/2016</span> </small><div style="margin-top:5px">when do u think you will update. I\'m really enjoying your book</div></td>\n</tr>'))]
15:43:11 reviews: Job OK (e9ef3038-9fb0-4645-be63-7089e01a6390)
15:43:11 Result is kept for 500 seconds
15:43:11 
15:43:11 *** Listening on chapters, profiles, reviews...
15:43:11 reviews: fanfic.jobs.crawl_reviews(11815472) (0712406f-9e49-4d1b-b741-5dfcfc1791bd)
15:43:20 reviews: Job OK (0712406f-9e49-4d1b-b741-5dfcfc1791bd)
15:43:20 Result is kept for 500 seconds
15:43:20 
15:43:20 *** Listening on chapters, profiles, reviews...
15:43:20 reviews: fanfic.jobs.crawl_reviews(11815544) (0c5c36c7-eaa7-48e5-bd09-02b456808504)
15:44:56 reviews: Job OK (0c5c36c7-eaa7-48e5-bd09-02b456808504)
15:44:56 Result is kept for 500 seconds
15:44:56 
15:44:56 *** Listening on chapters, profiles, reviews...
15:44:56 reviews: fanfic.jobs.crawl_reviews(11816264) (f4073bc1-8497-44e8-a9a1-fd0993584993)
15:46:25 reviews: Job OK (f4073bc1-8497-44e8-a9a1-fd0993584993)
15:46:25 Result is kept for 500 seconds
15:46:25 
15:46:25 *** Listening on chapters, profiles, reviews...
15:46:25 reviews: fanfic.jobs.crawl_reviews(11816332) (60803fad-3bab-4d50-9de7-8c0b511fc9d4)
2017-02-09 15:46:29 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 23:46:29.714694', 11816332, 243796379, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4499515&amp;r ... (815 characters truncated) ... color:gray">chapter 13 . <span data-xutime="1478691181">11/9/2016</span> </small><div style="margin-top:5px">Wish you would update.</div></td>\n</tr>'), ('2017-02-09 23:46:29.714698', 11816332, 239909455, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7643556&amp;r ... (1037 characters truncated) ... e my absolute favorite "Cute, generous and a good kisser...I think you may be a keeper." Cutest non-intentional pun ever, congrats.</div></td>\n</tr>'), ('2017-02-09 23:46:29.714700', 11816332, 237068923, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7749403&amp;r ... (929 characters truncated) ... me="1463590831">5/18/2016</span> </small><div style="margin-top:5px">THIS IS AMAZING PLEASE PLEASE PLEASE UPDATE! ALSO CLIFFHANGER!</div></td>\n</tr>'), ('2017-02-09 23:46:29.714702', 11816332, 234450293, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2847023&amp;r ... (1120 characters truncated) ...  need more of this, please! <br>\nI begg you, I need more of this! This is really, really, really, really good!<br>\nRead us later!</div></td>\n</tr>'), ('2017-02-09 23:46:29.714704', 11816332, 234296909, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4499515&amp;r ... (1184 characters truncated) ... hat just put up with it, especially Marcus/Oliver make it especially worthwhile like I hinted previously. So keep up the good work.</div></td>\n</tr>'), ('2017-02-09 23:46:29.714706', 11816332, 234160216, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6603837&amp;r ... (919 characters truncated) ... ata-xutime="1457628972">3/10/2016</span> </small><div style="margin-top:5px">Oliver! Please update soon I need to know what happens</div></td>\n</tr>'), ('2017-02-09 23:46:29.714708', 11816332, 234122370, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5022570&amp;r ... (938 characters truncated) ... /9/2016</span> </small><div style="margin-top:5px">Ugh soooooooo wrong yet sooooooo good. This story is amazing. Keep it up please!</div></td>\n</tr>'), ('2017-02-09 23:46:29.714710', 11816332, 234077170, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (667 characters truncated) ... tory. I can\'t believe that you updated so quickly too! I can\'t wait to see where your story goes and it is reallllllllly good. :D</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-09 23:46:29.714738', 11816332, 233930607, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6438922&amp;r ... (1175 characters truncated) ... nd Malfoy are also amazing, I just read a bunch of stories about them, so I\'ve become used to them. <br>\nAmazing, amazing, story.</div></td>\n</tr>'), ('2017-02-09 23:46:29.714740', 11816332, 233842359, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (546 characters truncated) ... pan data-xutime="1456956483">3/2/2016</span> </small><div style="margin-top:5px">This is fantastic! I eagerly await new chapters :)</div></td>\n</tr>'))]
15:46:29 reviews: Job OK (60803fad-3bab-4d50-9de7-8c0b511fc9d4)
15:46:29 Result is kept for 500 seconds
15:46:29 
15:46:29 *** Listening on chapters, profiles, reviews...
15:46:29 reviews: fanfic.jobs.crawl_reviews(11816388) (5a5dc96c-fa76-42a3-8fc5-6c7a87f085ca)
15:46:35 reviews: Job OK (5a5dc96c-fa76-42a3-8fc5-6c7a87f085ca)
15:46:35 Result is kept for 500 seconds
15:46:35 
15:46:35 *** Listening on chapters, profiles, reviews...
15:46:35 reviews: fanfic.jobs.crawl_reviews(11817220) (67e29f95-4ee0-4434-b4a4-b5cd31869da2)
15:47:59 reviews: Job OK (67e29f95-4ee0-4434-b4a4-b5cd31869da2)
15:47:59 Result is kept for 500 seconds
15:47:59 
15:47:59 *** Listening on chapters, profiles, reviews...
15:47:59 reviews: fanfic.jobs.crawl_reviews(11818437) (d604c901-5a4d-4848-8d22-37d52092f8bb)
15:49:26 reviews: Job OK (d604c901-5a4d-4848-8d22-37d52092f8bb)
15:49:26 Result is kept for 500 seconds
15:49:26 
15:49:26 *** Listening on chapters, profiles, reviews...
15:49:26 reviews: fanfic.jobs.crawl_reviews(11818522) (ce840d3b-08a2-4c2e-a2f4-3f82b5e2fc5b)
15:51:44 reviews: Job OK (ce840d3b-08a2-4c2e-a2f4-3f82b5e2fc5b)
15:51:44 Result is kept for 500 seconds
15:51:44 
15:51:44 *** Listening on chapters, profiles, reviews...
15:51:44 reviews: fanfic.jobs.crawl_reviews(11819431) (8139f5c6-91ee-4a96-b976-f4ea5307688a)
15:58:39 reviews: Job OK (8139f5c6-91ee-4a96-b976-f4ea5307688a)
15:58:39 Result is kept for 500 seconds
15:58:39 
15:58:39 *** Listening on chapters, profiles, reviews...
15:58:39 reviews: fanfic.jobs.crawl_reviews(11820659) (7ce3bbf1-2ccb-47d9-a394-af617b0aaf20)
2017-02-09 15:58:44 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 23:58:44.261361', 11820659, 245784771, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3775885&amp;r ... (836 characters truncated) ... "1483684162">1/5</span> </small><div style="margin-top:5px">Omg I absolutely love this story! Please please please please continue!</div></td>\n</tr>'), ('2017-02-09 23:58:44.261365', 11820659, 245032160, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6846245&amp;r ... (937 characters truncated) ...  It\'s really good and so far one of my favorites Draco/oc. Hope you find inspiration and publish often, you are an amazing writer!</div></td>\n</tr>'), ('2017-02-09 23:58:44.261367', 11820659, 243120132, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (599 characters truncated) ... span> </small><div style="margin-top:5px">I need to know what happens next! I can not wait for the next update. Please update soon!</div></td>\n</tr>'), ('2017-02-09 23:58:44.261369', 11820659, 240315240, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5311208&amp;r ... (833 characters truncated) ... a-xutime="1470361711">8/4/2016</span> </small><div style="margin-top:5px">this is a brilliant read i hope to read the chapter soon️</div></td>\n</tr>'), ('2017-02-09 23:58:44.261371', 11820659, 240300617, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8068915&amp;r ... (971 characters truncated) ... s Wondering If You Are Carrying On With The Story? <br>\n<br>\nOnce again a great read xx<br>\n<br>\nISolemnlySwearThatImUpToNoG00d</div></td>\n</tr>'), ('2017-02-09 23:58:44.261373', 11820659, 240218199, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (578 characters truncated) ... 31/2016</span> </small><div style="margin-top:5px">Loving this so far, Draco/OC is one of my favourites to read, please update soon</div></td>\n</tr>'), ('2017-02-09 23:58:44.261375', 11820659, 240041967, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7802075&amp;r ... (948 characters truncated) ... cter and Cedric was portrayed really well. And Draco... he is always perfect 3 XD<br>\nKeep up the incredible work!<br>\ndragonrush</div></td>\n</tr>'), ('2017-02-09 23:58:44.261377', 11820659, 239812109, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5853478&amp;r ... (987 characters truncated) ... in-top:5px">I\'ve been waiting on the update for ages! Glad it\'s up! Also I really enjoy this fic and hope you continue with it c:</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-09 23:58:44.261408', 11820659, 233917826, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (499 characters truncated) ...  Guest <small style="color:gray">chapter 1 . <span data-xutime="1456962608">3/2/2016</span> </small><div style="margin-top:5px">ohh</div></td>\n</tr>'), ('2017-02-09 23:58:44.261410', 11820659, 233845681, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7376047&amp;r ... (986 characters truncated) ... ly! Draco/oc stories are one of my favorites so I\'m super excited to see where you go with this. Can\'t wait for the next chapter!</div></td>\n</tr>'))]
15:58:44 reviews: Job OK (7ce3bbf1-2ccb-47d9-a394-af617b0aaf20)
15:58:44 Result is kept for 500 seconds
15:58:44 
15:58:44 *** Listening on chapters, profiles, reviews...
15:58:44 reviews: fanfic.jobs.crawl_reviews(11822383) (eb308721-d28b-41b6-bde7-21c8c94c4a0f)
2017-02-09 15:58:49 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-09 23:58:49.787478', 11822383, 237468974, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7798715&amp;r ... (941 characters truncated) ... /28/2016</span> </small><div style="margin-top:5px">I can\'t wait for more, will Draco get pregnant just like Theo did? More please</div></td>\n</tr>'), ('2017-02-09 23:58:49.787482', 11822383, 234728073, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5857123&amp;r ... (1195 characters truncated) ... y. Are there Harpy holidays? I can\'t remember how often it was they all got together. I\'m looking forward to the next chapter! :)</div></td>\n</tr>'), ('2017-02-09 23:58:49.787484', 11822383, 234136615, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3360005&amp;r ... (899 characters truncated) ... y">chapter 33 . <span data-xutime="1457574526">3/9/2016</span> </small><div style="margin-top:5px">Interesting can\'t wait for more</div></td>\n</tr>'), ('2017-02-09 23:58:49.787486', 11822383, 234106502, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2665963&amp;r ... (998 characters truncated) ... px">Hi I \'m super excited to be able to continue with this story because the truth is fantastic. So I send all clubs in the world.</div></td>\n</tr>'), ('2017-02-09 23:58:49.787488', 11822383, 233992246, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5857123&amp;r ... (1010 characters truncated) ... ck when Harpy Wings had it, and I\'m really excited that you\'re going to continue it! I\'m looking forward to the next chapter. :)</div></td>\n</tr>'), ('2017-02-09 23:58:49.787490', 11822383, 237468974, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7798715&amp;r ... (941 characters truncated) ... /28/2016</span> </small><div style="margin-top:5px">I can\'t wait for more, will Draco get pregnant just like Theo did? More please</div></td>\n</tr>'), ('2017-02-09 23:58:49.787492', 11822383, 234728073, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5857123&amp;r ... (1195 characters truncated) ... y. Are there Harpy holidays? I can\'t remember how often it was they all got together. I\'m looking forward to the next chapter! :)</div></td>\n</tr>'), ('2017-02-09 23:58:49.787494', 11822383, 234136615, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3360005&amp;r ... (899 characters truncated) ... y">chapter 33 . <span data-xutime="1457574526">3/9/2016</span> </small><div style="margin-top:5px">Interesting can\'t wait for more</div></td>\n</tr>'), ('2017-02-09 23:58:49.787496', 11822383, 234106502, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2665963&amp;r ... (998 characters truncated) ... px">Hi I \'m super excited to be able to continue with this story because the truth is fantastic. So I send all clubs in the world.</div></td>\n</tr>'), ('2017-02-09 23:58:49.787497', 11822383, 233992246, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5857123&amp;r ... (1010 characters truncated) ... ck when Harpy Wings had it, and I\'m really excited that you\'re going to continue it! I\'m looking forward to the next chapter. :)</div></td>\n</tr>'))]
15:58:49 reviews: Job OK (eb308721-d28b-41b6-bde7-21c8c94c4a0f)
15:58:49 Result is kept for 500 seconds
15:58:49 
15:58:49 *** Listening on chapters, profiles, reviews...
15:58:49 reviews: fanfic.jobs.crawl_reviews(11822457) (81dd0e5b-981f-46d0-b6b8-aea74e262645)
15:59:35 reviews: Job OK (81dd0e5b-981f-46d0-b6b8-aea74e262645)
15:59:35 Result is kept for 500 seconds
15:59:35 
15:59:35 *** Listening on chapters, profiles, reviews...
15:59:35 reviews: fanfic.jobs.crawl_reviews(11822729) (c82ae1e4-2361-4fb3-8104-dbb75269a6b1)
16:00:14 reviews: Job OK (c82ae1e4-2361-4fb3-8104-dbb75269a6b1)
16:00:14 Result is kept for 500 seconds
16:00:14 
16:00:14 *** Listening on chapters, profiles, reviews...
16:00:14 reviews: fanfic.jobs.crawl_reviews(11822876) (62018990-513d-49b8-88e7-5636addce405)
16:00:24 reviews: Job OK (62018990-513d-49b8-88e7-5636addce405)
16:00:24 Result is kept for 500 seconds
16:00:24 
16:00:24 *** Listening on chapters, profiles, reviews...
16:00:24 reviews: fanfic.jobs.crawl_reviews(11823160) (3b7b5ce8-d426-400b-9f5e-5f63a07e5739)
16:00:34 reviews: Job OK (3b7b5ce8-d426-400b-9f5e-5f63a07e5739)
16:00:34 Result is kept for 500 seconds
16:00:34 
16:00:34 *** Listening on chapters, profiles, reviews...
16:00:34 reviews: fanfic.jobs.crawl_reviews(11824352) (321f715f-397d-45d9-b16e-9fd259f57232)
2017-02-09 16:00:40 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 00:00:40.102019', 11824352, 245285104, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (627 characters truncated) ... ">It\'s nice to know he can walk through fire and has superhuman strength but can\'t get out of some vines and fire, go fucking die</div></td>\n</tr>'), ('2017-02-10 00:00:40.102024', 11824352, 244297106, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (545 characters truncated) ... r 4 . <span data-xutime="1480022434">11/24/2016</span> </small><div style="margin-top:5px">oh my gosh. his fcking eye. that\'s a...</div></td>\n</tr>'), ('2017-02-10 00:00:40.102026', 11824352, 244296762, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (565 characters truncated) ... ime="1480021494">11/24/2016</span> </small><div style="margin-top:5px">LMAOOOOOO IM CRYING. HUFFLEPUFF IS SO PITIFUL IN THIS STORY.</div></td>\n</tr>'), ('2017-02-10 00:00:40.102028', 11824352, 244296427, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (792 characters truncated) ... ingly? like what is this harry potter crossover spoof with dragonball z or naruto biz and why have i never come upon this until now</div></td>\n</tr>'), ('2017-02-10 00:00:40.102030', 11824352, 241741458, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2012121&amp;r ... (1109 characters truncated) ... ommon problem but I am still going to stop reading here. <br>\nHoping you, the author, get some sense and delete this evil Gary Stu</div></td>\n</tr>'), ('2017-02-10 00:00:40.102031', 11824352, 241741326, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2012121&amp;r ... (1227 characters truncated) ... hat scene was disgustingly put. Most of this I\'ve been willing to assume was parody, but that\'s just yikes. Also with McGonagall.</div></td>\n</tr>'), ('2017-02-10 00:00:40.102033', 11824352, 241741197, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2012121&amp;r ... (1122 characters truncated) ...  at this rate. Also were you saying that hes a white guy w martial arts training who took on a Japanese name and acts like this? Ew</div></td>\n</tr>'), ('2017-02-10 00:00:40.102035', 11824352, 241741093, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2012121&amp;r ... (1207 characters truncated) ... nts: how old is he? The students are 11-17. If he continues thinking like that I hope he ends up dead.<br>\nOtherwise, okay chapter</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-10 00:00:40.102074', 11824352, 234012585, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (644 characters truncated) ... pure gold. Love your descriptive language, and this "Tim" character is probably the biggest troll ever. Gotta love that sports bra.</div></td>\n</tr>'), ('2017-02-10 00:00:40.102076', 11824352, 233943421, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=624829&amp;rw ... (1545 characters truncated) ... ing another muggle. Hagrid is also pretty anti-muggle. He would kick up a fuss with Harry living with a muggle instead of a wizard.</div></td>\n</tr>'))]
16:00:40 reviews: Job OK (321f715f-397d-45d9-b16e-9fd259f57232)
16:00:40 Result is kept for 500 seconds
16:00:40 
16:00:40 *** Listening on chapters, profiles, reviews...
16:00:40 reviews: fanfic.jobs.crawl_reviews(11824636) (6ce5b101-2817-422f-8558-243f20dc804c)
16:01:39 reviews: Job OK (6ce5b101-2817-422f-8558-243f20dc804c)
16:01:39 Result is kept for 500 seconds
16:01:39 
16:01:39 *** Listening on chapters, profiles, reviews...
16:01:39 reviews: fanfic.jobs.crawl_reviews(11824939) (0d68efe9-e7ad-4ac9-bd22-deaa8337f98d)
16:01:53 reviews: Job OK (0d68efe9-e7ad-4ac9-bd22-deaa8337f98d)
16:01:53 Result is kept for 500 seconds
16:01:53 
16:01:53 *** Listening on chapters, profiles, reviews...
16:01:53 reviews: fanfic.jobs.crawl_reviews(11825109) (a75fad42-0924-466c-b9d9-83fc54ad6734)
16:02:32 reviews: Job OK (a75fad42-0924-466c-b9d9-83fc54ad6734)
16:02:32 Result is kept for 500 seconds
16:02:32 
16:02:32 *** Listening on chapters, profiles, reviews...
16:02:32 reviews: fanfic.jobs.crawl_reviews(11825327) (0c278259-b5b5-45af-b75d-012457a3773e)
16:04:43 reviews: Job OK (0c278259-b5b5-45af-b75d-012457a3773e)
16:04:43 Result is kept for 500 seconds
16:04:43 
16:04:43 *** Listening on chapters, profiles, reviews...
16:04:43 reviews: fanfic.jobs.crawl_reviews(11825585) (fe7507e1-ffce-4589-af7c-2482db06967d)
16:12:53 reviews: Job OK (fe7507e1-ffce-4589-af7c-2482db06967d)
16:12:53 Result is kept for 500 seconds
16:12:53 
16:12:53 *** Listening on chapters, profiles, reviews...
16:12:53 reviews: fanfic.jobs.crawl_reviews(11825888) (501c4912-9719-4e2d-80fb-b68ee49af1cb)
16:15:03 reviews: Job OK (501c4912-9719-4e2d-80fb-b68ee49af1cb)
16:15:03 Result is kept for 500 seconds
16:15:03 
16:15:03 *** Listening on chapters, profiles, reviews...
16:15:03 reviews: fanfic.jobs.crawl_reviews(11826429) (1b152d91-ecc4-4eac-8ae6-d43df9a47ce8)
16:22:44 reviews: Job OK (1b152d91-ecc4-4eac-8ae6-d43df9a47ce8)
16:22:44 Result is kept for 500 seconds
16:22:44 
16:22:44 *** Listening on chapters, profiles, reviews...
16:22:44 reviews: fanfic.jobs.crawl_reviews(11826548) (b5a69395-a8e4-4d5f-b99b-3ab1c5ecd272)
16:27:06 reviews: Job OK (b5a69395-a8e4-4d5f-b99b-3ab1c5ecd272)
16:27:06 Result is kept for 500 seconds
16:27:06 
16:27:06 *** Listening on chapters, profiles, reviews...
16:27:06 reviews: fanfic.jobs.crawl_reviews(11826581) (9e6ca7ae-85c3-4bfd-bb04-e82456527268)
16:29:19 reviews: Job OK (9e6ca7ae-85c3-4bfd-bb04-e82456527268)
16:29:19 Result is kept for 500 seconds
16:29:19 Cleaning registries for queue: chapters
16:29:19 Cleaning registries for queue: profiles
16:29:19 Cleaning registries for queue: reviews
16:29:19 
16:29:19 *** Listening on chapters, profiles, reviews...
16:29:19 reviews: fanfic.jobs.crawl_reviews(11827316) (b560bc43-35aa-40e8-bdc9-4d14b4ad276a)
16:32:46 reviews: Job OK (b560bc43-35aa-40e8-bdc9-4d14b4ad276a)
16:32:46 Result is kept for 500 seconds
16:32:46 
16:32:46 *** Listening on chapters, profiles, reviews...
16:32:46 reviews: fanfic.jobs.crawl_reviews(11827664) (d2243212-8ee5-405b-89bb-205d905792c3)
16:32:54 reviews: Job OK (d2243212-8ee5-405b-89bb-205d905792c3)
16:32:54 Result is kept for 500 seconds
16:32:54 
16:32:54 *** Listening on chapters, profiles, reviews...
16:32:54 reviews: fanfic.jobs.crawl_reviews(11829688) (4db549bf-b723-43cc-9bff-d6bcf8d1b060)
16:33:03 reviews: Job OK (4db549bf-b723-43cc-9bff-d6bcf8d1b060)
16:33:03 Result is kept for 500 seconds
16:33:03 
16:33:03 *** Listening on chapters, profiles, reviews...
16:33:03 reviews: fanfic.jobs.crawl_reviews(11829846) (9181bd47-3efb-4c8b-b045-929e16f483b4)
16:33:33 reviews: Job OK (9181bd47-3efb-4c8b-b045-929e16f483b4)
16:33:33 Result is kept for 500 seconds
16:33:33 
16:33:33 *** Listening on chapters, profiles, reviews...
16:33:33 reviews: fanfic.jobs.crawl_reviews(11830063) (5081bb7e-9b11-4c07-934b-3232bf2c5683)
16:33:47 reviews: Job OK (5081bb7e-9b11-4c07-934b-3232bf2c5683)
16:33:47 Result is kept for 500 seconds
16:33:47 
16:33:47 *** Listening on chapters, profiles, reviews...
16:33:47 reviews: fanfic.jobs.crawl_reviews(11830655) (ee567726-3898-4b38-9d07-4338110c54ea)
16:34:33 reviews: Job OK (ee567726-3898-4b38-9d07-4338110c54ea)
16:34:33 Result is kept for 500 seconds
16:34:33 
16:34:33 *** Listening on chapters, profiles, reviews...
16:34:33 reviews: fanfic.jobs.crawl_reviews(11831002) (1fa29f46-18d7-4e1d-a207-ce8651ce1da8)
16:35:11 reviews: Job OK (1fa29f46-18d7-4e1d-a207-ce8651ce1da8)
16:35:11 Result is kept for 500 seconds
16:35:11 
16:35:11 *** Listening on chapters, profiles, reviews...
16:35:11 reviews: fanfic.jobs.crawl_reviews(11831350) (307dd7cf-1e96-4273-a49c-36e097b5651b)
16:36:17 reviews: Job OK (307dd7cf-1e96-4273-a49c-36e097b5651b)
16:36:17 Result is kept for 500 seconds
16:36:17 
16:36:17 *** Listening on chapters, profiles, reviews...
16:36:17 reviews: fanfic.jobs.crawl_reviews(11833745) (1f0d579c-0d77-448c-80c6-91a23dbab06d)
16:39:38 reviews: Job OK (1f0d579c-0d77-448c-80c6-91a23dbab06d)
16:39:38 Result is kept for 500 seconds
16:39:38 
16:39:38 *** Listening on chapters, profiles, reviews...
16:39:38 reviews: fanfic.jobs.crawl_reviews(11835036) (bbc07327-7902-429b-8bb5-17f3605e7425)
2017-02-09 16:39:43 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 00:39:43.256176', 11835036, 243272824, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8401444&amp;r ... (935 characters truncated) ... 5px">This story feels like the author has taken a interesting turn from HP and leaves me with a refreshing afterthought if you will</div></td>\n</tr>'), ('2017-02-10 00:39:43.256180', 11835036, 242719298, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6633772&amp;r ... (1313 characters truncated) ...  Get a beta reader to make this a lot better. <br>\nDon\'t give up! It\'s not my cup of tea but you\'ve got an interesting concept.</div></td>\n</tr>'), ('2017-02-10 00:39:43.256182', 11835036, 240676202, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2069720&amp;r ... (1157 characters truncated) ... chapter. Sometimes you might need to read them several times to catch your mistakes. All in all you\'ve good story going. Nice job.</div></td>\n</tr>'), ('2017-02-10 00:39:43.256184', 11835036, 239397674, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7956588&amp;r ... (1703 characters truncated) ... not in my outline, I will start another story. There is no reason to have only one story at a time going.<br>\n<br>\nGood luck. :-)</div></td>\n</tr>'), ('2017-02-10 00:39:43.256186', 11835036, 239306719, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7624969&amp;r ... (2017 characters truncated) ... y is so weak. JK rowling may of had her story planned out when she wrote it but i am different i write in the present nowhere else.</div></td>\n</tr>'), ('2017-02-10 00:39:43.256188', 11835036, 239071304, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1740 characters truncated) ... g close to these raw elements shapes the magic from a young age to have the ability to control the elements. <br>\n<br>\nGood Luck!</div></td>\n</tr>'), ('2017-02-10 00:39:43.256190', 11835036, 238396361, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7941029&amp;r ... (816 characters truncated) ... e="color:gray">chapter 22 . <span data-xutime="1466406601">6/20/2016</span> </small><div style="margin-top:5px">Getting interesting</div></td>\n</tr>'), ('2017-02-10 00:39:43.256192', 11835036, 235320278, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (684 characters truncated) ... ow many new fanfics out there will be focusing on the new school JK Rowling made.<br>\n<br>\nAlso, Canada is part of North America.</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-10 00:39:43.256205', 11835036, 238396361, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7941029&amp;r ... (816 characters truncated) ... e="color:gray">chapter 22 . <span data-xutime="1466406601">6/20/2016</span> </small><div style="margin-top:5px">Getting interesting</div></td>\n</tr>'), ('2017-02-10 00:39:43.256207', 11835036, 235320278, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (684 characters truncated) ... ow many new fanfics out there will be focusing on the new school JK Rowling made.<br>\n<br>\nAlso, Canada is part of North America.</div></td>\n</tr>'))]
16:39:43 reviews: Job OK (bbc07327-7902-429b-8bb5-17f3605e7425)
16:39:43 Result is kept for 500 seconds
16:39:43 
16:39:43 *** Listening on chapters, profiles, reviews...
16:39:43 reviews: fanfic.jobs.crawl_reviews(11835369) (8fbf987c-2052-421a-ad59-e732ed39152a)
2017-02-09 16:39:48 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 00:39:48.595307', 11835369, 235540822, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7413350&amp;r ... (967 characters truncated) ... nger but it\'s enough of one to leave me wondering what will come n! My heart is all full of warm fuzzy feelings from this chapter!</div></td>\n</tr>'), ('2017-02-10 00:39:48.595314', 11835369, 235348242, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7413350&amp;r ... (877 characters truncated) ... /span> </small><div style="margin-top:5px">Awwwww. This is so sweet! Severus is just amazing! I just want to hug the couple Hahaha.</div></td>\n</tr>'), ('2017-02-10 00:39:48.595316', 11835369, 235081574, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2652328&amp;r ... (1129 characters truncated) ... eing a matchmaker with them in this story I bet thinking at Severus would be a good boyfriends for her in this story I bet big time</div></td>\n</tr>'), ('2017-02-10 00:39:48.595318', 11835369, 235041135, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2652328&amp;r ... (1213 characters truncated) ...  story big time and I bet they are falling love with one infer in this story put I think they don\'t know at in this story big time</div></td>\n</tr>'), ('2017-02-10 00:39:48.595320', 11835369, 234711489, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (572 characters truncated) ... ">3/23/2016</span> </small><div style="margin-top:5px">Hey :)<br>\n<br>\nNice idea for a story. I really hope youll update it soon.</div></td>\n</tr>'), ('2017-02-10 00:39:48.595322', 11835369, 234632820, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=804298&amp;rw ... (953 characters truncated) ... </span> </small><div style="margin-top:5px">I\'ve said before I\'m not much of a HP fan, but your story has me captured. Good work!</div></td>\n</tr>'), ('2017-02-10 00:39:48.595324', 11835369, 234386152, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (586 characters truncated) ... an> </small><div style="margin-top:5px">You\'ve got a really good writing style. It\'s a good revision of the HP story. Keep it up.</div></td>\n</tr>'), ('2017-02-10 00:39:48.595326', 11835369, 234221053, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (732 characters truncated) ... \n<br>\nIt\'s an interesting take on the beginning of the HP series. I\'m interested in seeing where this story is going. Koodo\'s!</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-10 00:39:48.595339', 11835369, 234386152, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (586 characters truncated) ... an> </small><div style="margin-top:5px">You\'ve got a really good writing style. It\'s a good revision of the HP story. Keep it up.</div></td>\n</tr>'), ('2017-02-10 00:39:48.595341', 11835369, 234221053, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (732 characters truncated) ... \n<br>\nIt\'s an interesting take on the beginning of the HP series. I\'m interested in seeing where this story is going. Koodo\'s!</div></td>\n</tr>'))]
16:39:48 reviews: Job OK (8fbf987c-2052-421a-ad59-e732ed39152a)
16:39:48 Result is kept for 500 seconds
16:39:48 
16:39:48 *** Listening on chapters, profiles, reviews...
16:39:48 reviews: fanfic.jobs.crawl_reviews(11835899) (a04b078d-e1d7-4644-894a-025a86d477fa)
16:40:24 reviews: Job OK (a04b078d-e1d7-4644-894a-025a86d477fa)
16:40:24 Result is kept for 500 seconds
16:40:24 
16:40:24 *** Listening on chapters, profiles, reviews...
16:40:24 reviews: fanfic.jobs.crawl_reviews(11837384) (19dd7e95-d0d7-4d7a-a96a-e7c188cc15c7)
16:40:30 reviews: Job OK (19dd7e95-d0d7-4d7a-a96a-e7c188cc15c7)
16:40:30 Result is kept for 500 seconds
16:40:30 
16:40:30 *** Listening on chapters, profiles, reviews...
16:40:30 reviews: fanfic.jobs.crawl_reviews(11838099) (82d4c213-052b-4a6f-835a-ebdec6b73b1c)
16:40:47 reviews: Job OK (82d4c213-052b-4a6f-835a-ebdec6b73b1c)
16:40:47 Result is kept for 500 seconds
16:40:47 
16:40:47 *** Listening on chapters, profiles, reviews...
16:40:47 reviews: fanfic.jobs.crawl_reviews(11838111) (7c22f31f-e6ea-4614-84b1-80e4f0be73cd)
16:40:56 reviews: Job OK (7c22f31f-e6ea-4614-84b1-80e4f0be73cd)
16:40:56 Result is kept for 500 seconds
16:40:56 
16:40:56 *** Listening on chapters, profiles, reviews...
16:40:56 reviews: fanfic.jobs.crawl_reviews(11840149) (a093058e-26be-414d-b201-204bb5a8124a)
2017-02-09 16:41:02 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 00:41:02.071684', 11840149, 243663926, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=705691&amp;rw ... (923 characters truncated) ...  could still be around. Mor needs him. Not saying he shouldnt follow his heart but if Mor wont abandon dolph how could he his twin.</div></td>\n</tr>'), ('2017-02-10 00:41:02.071688', 11840149, 234536567, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1323473&amp;r ... (2623 characters truncated) ... plating writing for a while now. <br>\n<br>\nAnyway, I\'ll wrap this up. Perfect ending to a great story, keep up the good work. :)</div></td>\n</tr>'), ('2017-02-10 00:41:02.071690', 11840149, 243663926, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=705691&amp;rw ... (923 characters truncated) ...  could still be around. Mor needs him. Not saying he shouldnt follow his heart but if Mor wont abandon dolph how could he his twin.</div></td>\n</tr>'), ('2017-02-10 00:41:02.071693', 11840149, 234536567, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1323473&amp;r ... (2623 characters truncated) ... plating writing for a while now. <br>\n<br>\nAnyway, I\'ll wrap this up. Perfect ending to a great story, keep up the good work. :)</div></td>\n</tr>'))]
16:41:02 reviews: Job OK (a093058e-26be-414d-b201-204bb5a8124a)
16:41:02 Result is kept for 500 seconds
16:41:02 
16:41:02 *** Listening on chapters, profiles, reviews...
16:41:02 reviews: fanfic.jobs.crawl_reviews(11840916) (30b0e9e4-6573-4c24-b5b6-2b6197d6fd13)
16:41:43 reviews: Job OK (30b0e9e4-6573-4c24-b5b6-2b6197d6fd13)
16:41:43 Result is kept for 500 seconds
16:41:43 
16:41:43 *** Listening on chapters, profiles, reviews...
16:41:43 reviews: fanfic.jobs.crawl_reviews(11842761) (62dea990-262f-464f-83e3-4b2af54efa28)
16:42:08 reviews: Job OK (62dea990-262f-464f-83e3-4b2af54efa28)
16:42:08 Result is kept for 500 seconds
16:42:08 
16:42:08 *** Listening on chapters, profiles, reviews...
16:42:08 reviews: fanfic.jobs.crawl_reviews(11844023) (12ec6f97-4768-45ec-9c64-2dc4887e98cf)
16:42:26 reviews: Job OK (12ec6f97-4768-45ec-9c64-2dc4887e98cf)
16:42:26 Result is kept for 500 seconds
16:42:26 
16:42:26 *** Listening on chapters, profiles, reviews...
16:42:26 reviews: fanfic.jobs.crawl_reviews(11844769) (b2aeb9fd-3ea9-4743-8e60-8dbbed869123)
16:43:35 reviews: Job OK (b2aeb9fd-3ea9-4743-8e60-8dbbed869123)
16:43:35 Result is kept for 500 seconds
16:43:35 
16:43:35 *** Listening on chapters, profiles, reviews...
16:43:35 reviews: fanfic.jobs.crawl_reviews(11845481) (11c7dc93-faef-40cd-83f2-08f94db7eff4)
2017-02-09 16:50:56 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 00:50:56.264791', 11845481, 247027621, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2129602&amp;r ... (906 characters truncated) ...  data-xutime="1486686908">7m</span> </small><div style="margin-top:5px">*Bites nails* How exciting, even if Draco is disappointing.</div></td>\n</tr>'), ('2017-02-10 00:50:56.264798', 11845481, 247027459, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2129602&amp;r ... (919 characters truncated) ... "1486686594">12m</span> </small><div style="margin-top:5px">Neville and Pansy are interesting. I wonder what has happened to Harry.</div></td>\n</tr>'), ('2017-02-10 00:50:56.264800', 11845481, 247027101, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2129602&amp;r ... (869 characters truncated) ... style="color:gray">chapter 14 . <span data-xutime="1486685751">26m</span> </small><div style="margin-top:5px">I like the new Pansy.</div></td>\n</tr>'), ('2017-02-10 00:50:56.264802', 11845481, 247026796, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2129602&amp;r ... (895 characters truncated) ...  13 . <span data-xutime="1486685101">37m</span> </small><div style="margin-top:5px">I hope Skeeter gets the book thrown at her. lol</div></td>\n</tr>'), ('2017-02-10 00:50:56.264804', 11845481, 247026481, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2129602&amp;r ... (890 characters truncated) ... apter 12 . <span data-xutime="1486684430">48m</span> </small><div style="margin-top:5px">I love the point system. Fabulous chapter.</div></td>\n</tr>'), ('2017-02-10 00:50:56.264806', 11845481, 247026061, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2443018&amp;r ... (1277 characters truncated) ... l characters, the plot is riveting, and Neville and Pansy are adorable. Your Narcissa is awesome :-) hope to read new chapter doon!</div></td>\n</tr>'), ('2017-02-10 00:50:56.264808', 11845481, 247009405, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3896668&amp;r ... (911 characters truncated) ... pter 49 . <span data-xutime="1486640353">13h</span> </small><div style="margin-top:5px">Thank you for updating! Love the story :):)</div></td>\n</tr>'), ('2017-02-10 00:50:56.264809', 11845481, 247007879, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2129602&amp;r ... (876 characters truncated) ... color:gray">chapter 11 . <span data-xutime="1486633810">14h</span> </small><div style="margin-top:5px">I am so enjoying your story.</div></td>\n</tr>')  ... displaying 10 of 1765 total bound parameter sets ...  ('2017-02-10 00:50:56.268099', 11845481, 234457765, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4389794&amp;r ... (781 characters truncated) ... small style="color:gray">chapter 1 . <span data-xutime="1458227940">3/17/2016</span> </small><div style="margin-top:5px">nice story</div></td>\n</tr>'), ('2017-02-10 00:50:56.268101', 11845481, 234453906, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4506215&amp;r ... (946 characters truncated) ... an> </small><div style="margin-top:5px">This is great! Harry and Hermione will be raised together by Sirius and probably Remus too!</div></td>\n</tr>'))]
16:50:56 reviews: Job OK (11c7dc93-faef-40cd-83f2-08f94db7eff4)
16:50:56 Result is kept for 500 seconds
16:50:56 
16:50:56 *** Listening on chapters, profiles, reviews...
16:50:56 reviews: fanfic.jobs.crawl_reviews(11845969) (55d7e4e1-cacc-43b4-8a28-a015872bb41d)
16:51:06 reviews: Job OK (55d7e4e1-cacc-43b4-8a28-a015872bb41d)
16:51:06 Result is kept for 500 seconds
16:51:06 
16:51:06 *** Listening on chapters, profiles, reviews...
16:51:06 reviews: fanfic.jobs.crawl_reviews(11846409) (b8a05915-efe3-44b9-a463-fac4cc31d9ca)
16:51:09 reviews: Job OK (b8a05915-efe3-44b9-a463-fac4cc31d9ca)
16:51:09 Result is kept for 500 seconds
16:51:09 
16:51:09 *** Listening on chapters, profiles, reviews...
16:51:09 reviews: fanfic.jobs.crawl_reviews(11846454) (05c9650a-a018-41fe-b3ac-600e2c667c26)
2017-02-09 16:51:14 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 00:51:14.336384', 11846454, 236784207, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2633444&amp;r ... (1130 characters truncated) ... ad he was into that dark wizard he defeated when was younger.<br>\n<br>\nRon can be a twit sometimes but he ain\'t that bad really.</div></td>\n</tr>'), ('2017-02-10 00:51:14.336388', 11846454, 236783653, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2633444&amp;r ... (1096 characters truncated) ... nes i really felt for when they got killed off mate.<br>\n<br>\nThat House Negus vs. Ravenclaw chapter was my favourite one so far.</div></td>\n</tr>'), ('2017-02-10 00:51:14.336390', 11846454, 236783079, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2633444&amp;r ... (1039 characters truncated) ... et that the crew apart from Barry are adults.<br>\n<br>\nI would have preferred if they were all 11 but meh your fic is still good.</div></td>\n</tr>'), ('2017-02-10 00:51:14.336392', 11846454, 236782117, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2633444&amp;r ... (1120 characters truncated) ... <br>\n<br>\nHehehe House Negus? I also like Barry. He is just a kid in a dream hoping for better like so many dudes i grew up with.</div></td>\n</tr>'), ('2017-02-10 00:51:14.336394', 11846454, 236781617, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2633444&amp;r ... (1155 characters truncated) ... be the funniest thing i have ever seen since Dave Chappelle\'s The Black White Supremacist skit brah.<br>\n<br>\nFucking Awesome 8)</div></td>\n</tr>'), ('2017-02-10 00:51:14.336396', 11846454, 236780922, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2633444&amp;r ... (1022 characters truncated) ... Aw man this is the shit!<br>\n<br>\nNever read anything like this. <br>\n<br>\nHogwarts is about to go with these dudes rolling in.</div></td>\n</tr>'), ('2017-02-10 00:51:14.336398', 11846454, 234638276, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=358482&amp;rw ... (980 characters truncated) ... </small><div style="margin-top:5px">Vaguely reminds me of my wu-tang raises harry idea. Adding to follows to read as soon as I can.</div></td>\n</tr>'), ('2017-02-10 00:51:14.336400', 11846454, 234511844, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2499993&amp;r ... (1145 characters truncated) ... t direction. <br>\nKey &amp; Peele and the Wayans brothers would be proud.<br>\nI can\'t wait to see the other reviews.<br>\nBravo!</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-10 00:51:14.336413', 11846454, 234638276, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=358482&amp;rw ... (980 characters truncated) ... </small><div style="margin-top:5px">Vaguely reminds me of my wu-tang raises harry idea. Adding to follows to read as soon as I can.</div></td>\n</tr>'), ('2017-02-10 00:51:14.336415', 11846454, 234511844, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2499993&amp;r ... (1145 characters truncated) ... t direction. <br>\nKey &amp; Peele and the Wayans brothers would be proud.<br>\nI can\'t wait to see the other reviews.<br>\nBravo!</div></td>\n</tr>'))]
16:51:14 reviews: Job OK (05c9650a-a018-41fe-b3ac-600e2c667c26)
16:51:14 Result is kept for 500 seconds
16:51:14 
16:51:14 *** Listening on chapters, profiles, reviews...
16:51:14 reviews: fanfic.jobs.crawl_reviews(11846665) (99f04c34-2134-47ea-9297-0a228ecdf134)
16:51:44 reviews: Job OK (99f04c34-2134-47ea-9297-0a228ecdf134)
16:51:44 Result is kept for 500 seconds
16:51:44 
16:51:44 *** Listening on chapters, profiles, reviews...
16:51:44 reviews: fanfic.jobs.crawl_reviews(11846988) (abfedd2b-106f-44c3-bbe3-9c343c6cbbba)
16:51:56 reviews: Job OK (abfedd2b-106f-44c3-bbe3-9c343c6cbbba)
16:51:56 Result is kept for 500 seconds
16:51:56 
16:51:56 *** Listening on chapters, profiles, reviews...
16:51:56 reviews: fanfic.jobs.crawl_reviews(11847045) (15908ef3-1645-4b38-9399-cde25707938c)
16:52:08 reviews: Job OK (15908ef3-1645-4b38-9399-cde25707938c)
16:52:08 Result is kept for 500 seconds
16:52:08 
16:52:08 *** Listening on chapters, profiles, reviews...
16:52:08 reviews: fanfic.jobs.crawl_reviews(11847330) (16c7b36b-8a3f-4efc-badf-dc9afae2de75)
16:54:50 reviews: Job OK (16c7b36b-8a3f-4efc-badf-dc9afae2de75)
16:54:50 Result is kept for 500 seconds
16:54:50 
16:54:50 *** Listening on chapters, profiles, reviews...
16:54:50 reviews: fanfic.jobs.crawl_reviews(11851712) (a844208a-a3f0-4f04-b4ca-462288f52f64)
16:55:00 reviews: Job OK (a844208a-a3f0-4f04-b4ca-462288f52f64)
16:55:00 Result is kept for 500 seconds
16:55:00 
16:55:00 *** Listening on chapters, profiles, reviews...
16:55:00 reviews: fanfic.jobs.crawl_reviews(11852696) (f51dffdd-2dca-4be0-b15e-b75a829bbf6f)
16:55:23 reviews: Job OK (f51dffdd-2dca-4be0-b15e-b75a829bbf6f)
16:55:23 Result is kept for 500 seconds
16:55:23 
16:55:23 *** Listening on chapters, profiles, reviews...
16:55:23 reviews: fanfic.jobs.crawl_reviews(11853160) (40dabaa3-484e-483d-9652-60d6273c277e)
16:55:33 reviews: Job OK (40dabaa3-484e-483d-9652-60d6273c277e)
16:55:33 Result is kept for 500 seconds
16:55:33 
16:55:33 *** Listening on chapters, profiles, reviews...
16:55:33 reviews: fanfic.jobs.crawl_reviews(11855297) (b634ca88-148a-4823-b9b4-4545837c4386)
16:55:46 reviews: Job OK (b634ca88-148a-4823-b9b4-4545837c4386)
16:55:46 Result is kept for 500 seconds
16:55:46 
16:55:46 *** Listening on chapters, profiles, reviews...
16:55:46 reviews: fanfic.jobs.crawl_reviews(11858146) (1c925cbc-9215-4b0c-a83d-934007bb3c81)
16:58:15 reviews: Job OK (1c925cbc-9215-4b0c-a83d-934007bb3c81)
16:58:15 Result is kept for 500 seconds
16:58:15 
16:58:15 *** Listening on chapters, profiles, reviews...
16:58:15 reviews: fanfic.jobs.crawl_reviews(11858167) (86dff577-03dc-434a-84c4-921bc494c414)
17:00:27 reviews: Job OK (86dff577-03dc-434a-84c4-921bc494c414)
17:00:27 Result is kept for 500 seconds
17:00:27 
17:00:27 *** Listening on chapters, profiles, reviews...
17:00:27 reviews: fanfic.jobs.crawl_reviews(11858949) (cfb9ddfb-54ac-4a96-b8a7-0bdddb1595d4)
17:00:32 reviews: Job OK (cfb9ddfb-54ac-4a96-b8a7-0bdddb1595d4)
17:00:32 Result is kept for 500 seconds
17:00:32 
17:00:32 *** Listening on chapters, profiles, reviews...
17:00:32 reviews: fanfic.jobs.crawl_reviews(11860137) (1c77d2bc-4d5c-460e-90be-377c5cbbe7df)
17:01:33 reviews: Job OK (1c77d2bc-4d5c-460e-90be-377c5cbbe7df)
17:01:33 Result is kept for 500 seconds
17:01:33 
17:01:33 *** Listening on chapters, profiles, reviews...
17:01:33 reviews: fanfic.jobs.crawl_reviews(11860258) (903f6d14-3bf6-4d13-a2e6-23464bcbee18)
17:01:45 reviews: Job OK (903f6d14-3bf6-4d13-a2e6-23464bcbee18)
17:01:45 Result is kept for 500 seconds
17:01:45 
17:01:45 *** Listening on chapters, profiles, reviews...
17:01:45 reviews: fanfic.jobs.crawl_reviews(11860415) (26d810dd-478c-409e-9c72-d1cbb9682237)
17:03:48 reviews: Job OK (26d810dd-478c-409e-9c72-d1cbb9682237)
17:03:48 Result is kept for 500 seconds
17:03:48 
17:03:48 *** Listening on chapters, profiles, reviews...
17:03:48 reviews: fanfic.jobs.crawl_reviews(11860644) (52a4804d-5d76-4f40-9ef9-d4ecb179cf79)
17:03:57 reviews: Job OK (52a4804d-5d76-4f40-9ef9-d4ecb179cf79)
17:03:57 Result is kept for 500 seconds
17:03:57 
17:03:57 *** Listening on chapters, profiles, reviews...
17:03:57 reviews: fanfic.jobs.crawl_reviews(11861232) (60fedf7c-b795-4fba-bd39-b44d884f0f43)
2017-02-09 17:04:02 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 01:04:02.449694', 11861232, 240619318, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6837655&amp;r ... (825 characters truncated) ...  1 . <span data-xutime="1471016108">8/12/2016</span> </small><div style="margin-top:5px">So glad you updated! Can\'t wait for more!</div></td>\n</tr>'), ('2017-02-10 01:04:02.449699', 11861232, 239494642, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6684710&amp;r ... (1370 characters truncated) ... S: Sorry if something is wrong in writing, but I\'m from Brazil and I had to use google translator to pass that to the English haha</div></td>\n</tr>'), ('2017-02-10 01:04:02.449701', 11861232, 239225427, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4518094&amp;r ... (1717 characters truncated) ...  <br>\nIt\'s been almost a month since the last update, but I really hope there\'s more coming soon! Please? <br>\nAwesome writing!</div></td>\n</tr>'), ('2017-02-10 01:04:02.449703', 11861232, 238340041, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6837655&amp;r ... (882 characters truncated) ... mall><div style="margin-top:5px">I just binge read all 19 chapters and I fricking love this story, I really hope you update soon :)</div></td>\n</tr>'), ('2017-02-10 01:04:02.449705', 11861232, 236817090, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5316141&amp;r ... (925 characters truncated) ... "1463026764">5/11/2016</span> </small><div style="margin-top:5px">SO INTENSE AND LESTRANGE... OH MY... WHAT T HE HECK IS GOING ON?!</div></td>\n</tr>'), ('2017-02-10 01:04:02.449707', 11861232, 236472937, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (632 characters truncated) ... a! Angst! Yesh! I can\'t wait for the update :) you\'re a skilled writer and the way you portray them well, in my eyes, is spot on.</div></td>\n</tr>'), ('2017-02-10 01:04:02.449708', 11861232, 236274937, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (548 characters truncated) ... an data-xutime="1461885461">4/28/2016</span> </small><div style="margin-top:5px">Great chapter. Can\'t wait for the next update. :)</div></td>\n</tr>'), ('2017-02-10 01:04:02.449710', 11861232, 235791488, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5316141&amp;r ... (1090 characters truncated) ... l and shallow? Boy of I could I would climb through this phone and punch so hard in the shnozz I would break your know indefinitely</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-10 01:04:02.449745', 11861232, 235303359, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3084763&amp;r ... (894 characters truncated) ... chapter 9 . <span data-xutime="1459884924">4/5/2016</span> </small><div style="margin-top:5px">Interesting story so far enjoying it</div></td>\n</tr>'), ('2017-02-10 01:04:02.449747', 11861232, 235051290, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7643238&amp;r ... (894 characters truncated) ... 6 . <span data-xutime="1459394556">3/30/2016</span> </small><div style="margin-top:5px">So excited can\'t wait for the next chapter</div></td>\n</tr>'))]
17:04:02 reviews: Job OK (60fedf7c-b795-4fba-bd39-b44d884f0f43)
17:04:02 Result is kept for 500 seconds
17:04:02 
17:04:02 *** Listening on chapters, profiles, reviews...
17:04:02 reviews: fanfic.jobs.crawl_reviews(11862230) (4d132e26-a669-4330-82aa-85ff15c8dcb1)
17:07:22 reviews: Job OK (4d132e26-a669-4330-82aa-85ff15c8dcb1)
17:07:22 Result is kept for 500 seconds
17:07:22 
17:07:22 *** Listening on chapters, profiles, reviews...
17:07:22 reviews: fanfic.jobs.crawl_reviews(11862560) (45a6a80e-0de4-4d9f-9270-85cd5f1583eb)
17:08:00 reviews: Job OK (45a6a80e-0de4-4d9f-9270-85cd5f1583eb)
17:08:00 Result is kept for 500 seconds
17:08:00 
17:08:00 *** Listening on chapters, profiles, reviews...
17:08:00 reviews: fanfic.jobs.crawl_reviews(11863209) (baf2fc44-a90e-4d3f-ba78-dc158a7621f3)
17:10:47 reviews: Job OK (baf2fc44-a90e-4d3f-ba78-dc158a7621f3)
17:10:47 Result is kept for 500 seconds
17:10:47 
17:10:47 *** Listening on chapters, profiles, reviews...
17:10:47 reviews: fanfic.jobs.crawl_reviews(11863248) (dac55f35-9cf2-43b5-815a-2cdc0c8c005a)
17:11:58 reviews: Job OK (dac55f35-9cf2-43b5-815a-2cdc0c8c005a)
17:11:58 Result is kept for 500 seconds
17:11:58 
17:11:58 *** Listening on chapters, profiles, reviews...
17:11:58 reviews: fanfic.jobs.crawl_reviews(11863465) (6b08a05b-a5a0-4187-bbc8-38e294926fba)
17:16:25 reviews: Job OK (6b08a05b-a5a0-4187-bbc8-38e294926fba)
17:16:25 Result is kept for 500 seconds
17:16:25 
17:16:25 *** Listening on chapters, profiles, reviews...
17:16:25 reviews: fanfic.jobs.crawl_reviews(11863658) (ab6dd7d3-f3cc-4665-875e-0b5daa88bde3)
17:17:05 reviews: Job OK (ab6dd7d3-f3cc-4665-875e-0b5daa88bde3)
17:17:05 Result is kept for 500 seconds
17:17:05 
17:17:05 *** Listening on chapters, profiles, reviews...
17:17:05 reviews: fanfic.jobs.crawl_reviews(11866263) (2ef6a703-688b-4011-813c-ff092031c9ec)
17:18:20 reviews: Job OK (2ef6a703-688b-4011-813c-ff092031c9ec)
17:18:20 Result is kept for 500 seconds
17:18:20 
17:18:20 *** Listening on chapters, profiles, reviews...
17:18:20 reviews: fanfic.jobs.crawl_reviews(11866355) (4c524df1-18b1-457f-8763-7bf586efd228)
17:18:32 reviews: Job OK (4c524df1-18b1-457f-8763-7bf586efd228)
17:18:32 Result is kept for 500 seconds
17:18:32 
17:18:32 *** Listening on chapters, profiles, reviews...
17:18:32 reviews: fanfic.jobs.crawl_reviews(11866852) (256433e1-2260-4729-974e-463c5a259bde)
17:19:20 reviews: Job OK (256433e1-2260-4729-974e-463c5a259bde)
17:19:20 Result is kept for 500 seconds
17:19:20 
17:19:20 *** Listening on chapters, profiles, reviews...
17:19:20 reviews: fanfic.jobs.crawl_reviews(11866992) (6fdc23a3-bc82-4332-ac07-fd8585f79d99)
17:19:44 reviews: Job OK (6fdc23a3-bc82-4332-ac07-fd8585f79d99)
17:19:44 Result is kept for 500 seconds
17:19:44 
17:19:44 *** Listening on chapters, profiles, reviews...
17:19:44 reviews: fanfic.jobs.crawl_reviews(11867729) (a0151f18-a330-4448-ac7f-d4828429b65e)
17:24:13 reviews: Job OK (a0151f18-a330-4448-ac7f-d4828429b65e)
17:24:13 Result is kept for 500 seconds
17:24:13 
17:24:13 *** Listening on chapters, profiles, reviews...
17:24:13 reviews: fanfic.jobs.crawl_reviews(11868509) (5cd4161d-1aa9-4881-9e71-6dc0eceef674)
17:27:03 reviews: Job OK (5cd4161d-1aa9-4881-9e71-6dc0eceef674)
17:27:03 Result is kept for 500 seconds
17:27:03 
17:27:03 *** Listening on chapters, profiles, reviews...
17:27:03 reviews: fanfic.jobs.crawl_reviews(11868662) (8b644148-c8a3-413d-8b9c-ee22fd11e284)
17:27:27 reviews: Job OK (8b644148-c8a3-413d-8b9c-ee22fd11e284)
17:27:27 Result is kept for 500 seconds
17:27:27 
17:27:27 *** Listening on chapters, profiles, reviews...
17:27:27 reviews: fanfic.jobs.crawl_reviews(11868945) (8028549e-0cf9-4e27-b87c-c15c5b2596a6)
17:30:39 reviews: Job OK (8028549e-0cf9-4e27-b87c-c15c5b2596a6)
17:30:39 Result is kept for 500 seconds
17:30:39 Cleaning registries for queue: chapters
17:30:39 Cleaning registries for queue: profiles
17:30:39 Cleaning registries for queue: reviews
17:30:39 
17:30:39 *** Listening on chapters, profiles, reviews...
17:30:39 reviews: fanfic.jobs.crawl_reviews(11869151) (fa9549f4-4db7-4e0a-916c-24403940f580)
17:32:21 reviews: Job OK (fa9549f4-4db7-4e0a-916c-24403940f580)
17:32:21 Result is kept for 500 seconds
17:32:21 
17:32:21 *** Listening on chapters, profiles, reviews...
17:32:21 reviews: fanfic.jobs.crawl_reviews(11871202) (691d08d3-5b00-433a-bd3e-ca36b2efd706)
17:32:37 reviews: Job OK (691d08d3-5b00-433a-bd3e-ca36b2efd706)
17:32:37 Result is kept for 500 seconds
17:32:37 
17:32:37 *** Listening on chapters, profiles, reviews...
17:32:37 reviews: fanfic.jobs.crawl_reviews(11872363) (1f2467e2-0db1-48da-bc04-afccf11ef61b)
2017-02-09 17:32:43 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 01:32:43.643454', 11872363, 241142052, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7581010&amp;r ... (878 characters truncated) ...  </small><div style="margin-top:5px">Hahha XD<br>\n<br>\nThanks for your comment, glad you agree! :3<br>\n<br>\nAnyways, thumbs up!</div></td>\n</tr>'), ('2017-02-10 01:32:43.643459', 11872363, 240870378, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7581010&amp;r ... (806 characters truncated) ... "color:gray">chapter 3 . <span data-xutime="1471554018">8/18/2016</span> </small><div style="margin-top:5px">Hahha, lol on you Rose</div></td>\n</tr>'), ('2017-02-10 01:32:43.643461', 11872363, 235266290, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (589 characters truncated) ... /2016</span> </small><div style="margin-top:5px">Error: Albus Sirius Potter is wrong<br>\nIt is supposed to be Albus Severus Potter</div></td>\n</tr>'), ('2017-02-10 01:32:43.643463', 11872363, 235090435, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7683248&amp;r ... (843 characters truncated) ... . <span data-xutime="1459475007">3/31/2016</span> </small><div style="margin-top:5px">Amazing so far I can\'t wait for u to update!</div></td>\n</tr>'), ('2017-02-10 01:32:43.643465', 11872363, 241142052, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7581010&amp;r ... (878 characters truncated) ...  </small><div style="margin-top:5px">Hahha XD<br>\n<br>\nThanks for your comment, glad you agree! :3<br>\n<br>\nAnyways, thumbs up!</div></td>\n</tr>'), ('2017-02-10 01:32:43.643467', 11872363, 240870378, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7581010&amp;r ... (806 characters truncated) ... "color:gray">chapter 3 . <span data-xutime="1471554018">8/18/2016</span> </small><div style="margin-top:5px">Hahha, lol on you Rose</div></td>\n</tr>'), ('2017-02-10 01:32:43.643469', 11872363, 235266290, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (589 characters truncated) ... /2016</span> </small><div style="margin-top:5px">Error: Albus Sirius Potter is wrong<br>\nIt is supposed to be Albus Severus Potter</div></td>\n</tr>'), ('2017-02-10 01:32:43.643471', 11872363, 235090435, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7683248&amp;r ... (843 characters truncated) ... . <span data-xutime="1459475007">3/31/2016</span> </small><div style="margin-top:5px">Amazing so far I can\'t wait for u to update!</div></td>\n</tr>'))]
17:32:43 reviews: Job OK (1f2467e2-0db1-48da-bc04-afccf11ef61b)
17:32:43 Result is kept for 500 seconds
17:32:43 
17:32:43 *** Listening on chapters, profiles, reviews...
17:32:43 reviews: fanfic.jobs.crawl_reviews(11873285) (debf1188-748a-4379-a9ab-4dfda9f7a2a0)
17:32:49 reviews: Job OK (debf1188-748a-4379-a9ab-4dfda9f7a2a0)
17:32:49 Result is kept for 500 seconds
17:32:49 
17:32:49 *** Listening on chapters, profiles, reviews...
17:32:49 reviews: fanfic.jobs.crawl_reviews(11873709) (6f9d9366-dbc6-408a-bf65-00182db72e8a)
2017-02-09 17:32:55 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 01:32:55.147249', 11873709, 242007447, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2428240&amp;r ... (971 characters truncated) ...  style="margin-top:5px">I loved the first story a great deal. I am loving the dual chapters and find both stories brilliant so far.</div></td>\n</tr>'), ('2017-02-10 01:32:55.147253', 11873709, 241902591, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4829856&amp;r ... (1200 characters truncated) ...  it publically in this review if I am ;) And ahh, it\'s interesting to see the machinations starting at the end here with the king.</div></td>\n</tr>'), ('2017-02-10 01:32:55.147256', 11873709, 239616469, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (557 characters truncated) ... time="1468894817">7/18/2016</span> </small><div style="margin-top:5px">Tom<br>\nAnother wonderful chapter. I enjoyed it immensely..</div></td>\n</tr>'), ('2017-02-10 01:32:55.147258', 11873709, 239484472, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6887690&amp;r ... (825 characters truncated) ... utime="1468624067">7/15/2016</span> </small><div style="margin-top:5px">great chapter, loving this story so much. keep them coming.</div></td>\n</tr>'), ('2017-02-10 01:32:55.147260', 11873709, 238662717, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3496781&amp;r ... (832 characters truncated) ... 1466958603">6/26/2016</span> </small><div style="margin-top:5px">I love this story and look forward to following to its completion.</div></td>\n</tr>'), ('2017-02-10 01:32:55.147262', 11873709, 237748861, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6887690&amp;r ... (806 characters truncated) ... er 4 . <span data-xutime="1465048450">6/4/2016</span> </small><div style="margin-top:5px">Awesome chapter, loving the story so far.</div></td>\n</tr>'), ('2017-02-10 01:32:55.147264', 11873709, 236599725, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6887690&amp;r ... (861 characters truncated) ... /small><div style="margin-top:5px">Very good chapter. I really like the way you are telling both stories, and can\'t wait for more.</div></td>\n</tr>'), ('2017-02-10 01:32:55.147265', 11873709, 236596920, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7221997&amp;r ... (896 characters truncated) ... :5px">Another great chapter. Looking forward to seeing where Utred\'s story goes now with everything that was revealed this chaper.</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-10 01:32:55.147305', 11873709, 235777286, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5832284&amp;r ... (1158 characters truncated) ... t Luke and I had to pull it. I haven\'t posted here yet but that\'s only because my only internet access at the moment is my phone.</div></td>\n</tr>'), ('2017-02-10 01:32:55.147307', 11873709, 235207142, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2321417&amp;r ... (1006 characters truncated) ... ctions has always appealed to my love of history. This rework has captured my interest and I look forward to reading more.<br>\nTom</div></td>\n</tr>'))]
17:32:55 reviews: Job OK (6f9d9366-dbc6-408a-bf65-00182db72e8a)
17:32:55 Result is kept for 500 seconds
17:32:55 
17:32:55 *** Listening on chapters, profiles, reviews...
17:32:55 reviews: fanfic.jobs.crawl_reviews(11873821) (b1749af0-e129-4d8e-8404-e2cc2a94c46b)
17:33:04 reviews: Job OK (b1749af0-e129-4d8e-8404-e2cc2a94c46b)
17:33:04 Result is kept for 500 seconds
17:33:04 
17:33:04 *** Listening on chapters, profiles, reviews...
17:33:04 reviews: fanfic.jobs.crawl_reviews(11874602) (9698bf1f-1bee-4cc9-aa15-292ac7c1582e)
17:36:07 reviews: Job OK (9698bf1f-1bee-4cc9-aa15-292ac7c1582e)
17:36:07 Result is kept for 500 seconds
17:36:07 
17:36:07 *** Listening on chapters, profiles, reviews...
17:36:07 reviews: fanfic.jobs.crawl_reviews(11874719) (1d5cbf2c-a8f7-4110-a9eb-a5cc9349d304)
17:36:37 reviews: Job OK (1d5cbf2c-a8f7-4110-a9eb-a5cc9349d304)
17:36:37 Result is kept for 500 seconds
17:36:37 
17:36:37 *** Listening on chapters, profiles, reviews...
17:36:37 reviews: fanfic.jobs.crawl_reviews(11875450) (35402dfd-ccdd-47f8-95f8-728d0182f179)
17:37:11 reviews: Job OK (35402dfd-ccdd-47f8-95f8-728d0182f179)
17:37:11 Result is kept for 500 seconds
17:37:11 
17:37:11 *** Listening on chapters, profiles, reviews...
17:37:11 reviews: fanfic.jobs.crawl_reviews(11876273) (583e002f-fc4b-4a46-8a28-a1ec4fc92e16)
17:37:50 reviews: Job OK (583e002f-fc4b-4a46-8a28-a1ec4fc92e16)
17:37:50 Result is kept for 500 seconds
17:37:50 
17:37:50 *** Listening on chapters, profiles, reviews...
17:37:50 reviews: fanfic.jobs.crawl_reviews(11876985) (3f5def37-8e07-40b7-9837-118e701883e6)
17:38:16 reviews: Job OK (3f5def37-8e07-40b7-9837-118e701883e6)
17:38:16 Result is kept for 500 seconds
17:38:16 
17:38:16 *** Listening on chapters, profiles, reviews...
17:38:16 reviews: fanfic.jobs.crawl_reviews(11877475) (25e3ad4e-551b-4f84-a5ed-fcdd3d650ebb)
17:39:42 reviews: Job OK (25e3ad4e-551b-4f84-a5ed-fcdd3d650ebb)
17:39:42 Result is kept for 500 seconds
17:39:42 
17:39:42 *** Listening on chapters, profiles, reviews...
17:39:42 reviews: fanfic.jobs.crawl_reviews(11878319) (bacd1d9c-565f-4723-b39e-39707f543ee7)
17:40:34 reviews: Job OK (bacd1d9c-565f-4723-b39e-39707f543ee7)
17:40:34 Result is kept for 500 seconds
17:40:34 
17:40:34 *** Listening on chapters, profiles, reviews...
17:40:34 reviews: fanfic.jobs.crawl_reviews(11878656) (c8683a3a-d9b5-4b48-9853-951d22244f24)
2017-02-09 17:50:33 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 01:50:33.176306', 11878656, 247028125, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8050648&amp;r ... (1025 characters truncated) ... to do it though. I really loved how Harry vetted Draco a bit, tested him. and I think he\'s right, Ron will be much more difficult.</div></td>\n</tr>'), ('2017-02-10 01:50:33.176311', 11878656, 247027582, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8050648&amp;r ... (1129 characters truncated) ... is...dare I say, nice? I\'m so excited to see where this goes! I\'m guessing obliviation for Hermione\'s parents. eeep!<br>\nxoxo L</div></td>\n</tr>'), ('2017-02-10 01:50:33.176313', 11878656, 246986508, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1521173&amp;r ... (919 characters truncated) ... ="1486583621">2/8</span> </small><div style="margin-top:5px">Looooved Marked. Great story, interesting plot, awesome twist! Thanks!</div></td>\n</tr>'), ('2017-02-10 01:50:33.176315', 11878656, 246812322, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8446311&amp;r ... (1163 characters truncated) ... ay in my job with incognito mode google page.<br>\nYou make my day! Please, make more thing like this, I live for things like this.</div></td>\n</tr>'), ('2017-02-10 01:50:33.176317', 11878656, 246658051, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7643020&amp;r ... (911 characters truncated) ... there was just no way to know! I need some time to myself to recover from this but that was a crazy ride. you\'re an amazing writer</div></td>\n</tr>'), ('2017-02-10 01:50:33.176319', 11878656, 246657481, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7643020&amp;r ... (836 characters truncated) ... 0">1/29</span> </small><div style="margin-top:5px">okay I\'m willingly putting my heart in your hands again. I\'m trusting you here</div></td>\n</tr>'), ('2017-02-10 01:50:33.176321', 11878656, 246657143, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7643020&amp;r ... (824 characters truncated) ... e="1485759365">1/29</span> </small><div style="margin-top:5px">*sobs grossly* please keep your promise! please have a happy ending!</div></td>\n</tr>'), ('2017-02-10 01:50:33.176323', 11878656, 246655863, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7643020&amp;r ... (802 characters truncated) ...  29 . <span data-xutime="1485756519">1/29</span> </small><div style="margin-top:5px">a/n I DON\'T BELIEVE YOU HOW COULD YOU DO THIS</div></td>\n</tr>')  ... displaying 10 of 2393 total bound parameter sets ...  ('2017-02-10 01:50:33.180883', 11878656, 235239828, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6976319&amp;r ... (1025 characters truncated) ... esting. .. Malfoy in muggle world? Theo among Death Eaters? Very very interesting!<br>\n<br>\nCan\'t wait for the next chapter! :))</div></td>\n</tr>'), ('2017-02-10 01:50:33.180885', 11878656, 235239177, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1899259&amp;r ... (912 characters truncated) ...  1 . <span data-xutime="1459756848">4/4/2016</span> </small><div style="margin-top:5px">Yay Theo! Im so excited to see more of him.</div></td>\n</tr>'))]
17:50:33 reviews: Job OK (c8683a3a-d9b5-4b48-9853-951d22244f24)
17:50:33 Result is kept for 500 seconds
17:50:33 
17:50:33 *** Listening on chapters, profiles, reviews...
17:50:33 reviews: fanfic.jobs.crawl_reviews(11878863) (6dc2f328-ae7c-4ad7-b23f-1e3064a3fcfc)
17:58:05 reviews: Job OK (6dc2f328-ae7c-4ad7-b23f-1e3064a3fcfc)
17:58:05 Result is kept for 500 seconds
17:58:05 
17:58:05 *** Listening on chapters, profiles, reviews...
17:58:05 reviews: fanfic.jobs.crawl_reviews(11879425) (828ba00f-cf48-4d80-80a7-6825ea7e1e4a)
17:58:23 reviews: Job OK (828ba00f-cf48-4d80-80a7-6825ea7e1e4a)
17:58:23 Result is kept for 500 seconds
17:58:23 
17:58:23 *** Listening on chapters, profiles, reviews...
17:58:23 reviews: fanfic.jobs.crawl_reviews(11879493) (130a527a-a76f-46fb-a420-7d960d713983)
18:00:34 reviews: Job OK (130a527a-a76f-46fb-a420-7d960d713983)
18:00:34 Result is kept for 500 seconds
18:00:34 
18:00:34 *** Listening on chapters, profiles, reviews...
18:00:34 reviews: fanfic.jobs.crawl_reviews(11880520) (3a7ccb0f-d1cf-440f-925f-3ba3df4aa1e5)
18:01:09 reviews: Job OK (3a7ccb0f-d1cf-440f-925f-3ba3df4aa1e5)
18:01:09 Result is kept for 500 seconds
18:01:09 
18:01:09 *** Listening on chapters, profiles, reviews...
18:01:09 reviews: fanfic.jobs.crawl_reviews(11880794) (c40c4a97-4c65-4d3e-85a9-b5789a0d9d9b)
18:01:18 reviews: Job OK (c40c4a97-4c65-4d3e-85a9-b5789a0d9d9b)
18:01:18 Result is kept for 500 seconds
18:01:18 
18:01:18 *** Listening on chapters, profiles, reviews...
18:01:18 reviews: fanfic.jobs.crawl_reviews(11880837) (43557508-255a-418f-adf3-b474e5531a97)
18:02:22 reviews: Job OK (43557508-255a-418f-adf3-b474e5531a97)
18:02:22 Result is kept for 500 seconds
18:02:22 
18:02:22 *** Listening on chapters, profiles, reviews...
18:02:22 reviews: fanfic.jobs.crawl_reviews(11883501) (e74b4538-8ce8-4997-8d80-4374e68b4859)
18:02:27 reviews: Job OK (e74b4538-8ce8-4997-8d80-4374e68b4859)
18:02:27 Result is kept for 500 seconds
18:02:27 
18:02:27 *** Listening on chapters, profiles, reviews...
18:02:27 reviews: fanfic.jobs.crawl_reviews(11884662) (749c1a1e-2679-4a8c-9ce7-443f862ddb89)
18:04:37 reviews: Job OK (749c1a1e-2679-4a8c-9ce7-443f862ddb89)
18:04:37 Result is kept for 500 seconds
18:04:37 
18:04:37 *** Listening on chapters, profiles, reviews...
18:04:37 reviews: fanfic.jobs.crawl_reviews(11885163) (c9f8d372-76a2-4b2c-b275-42a84677551d)
18:08:06 reviews: Job OK (c9f8d372-76a2-4b2c-b275-42a84677551d)
18:08:06 Result is kept for 500 seconds
18:08:06 
18:08:06 *** Listening on chapters, profiles, reviews...
18:08:06 reviews: fanfic.jobs.crawl_reviews(11885490) (b5a53ac3-fc13-414a-bb7c-5b245b42dcb1)
18:08:48 reviews: Job OK (b5a53ac3-fc13-414a-bb7c-5b245b42dcb1)
18:08:48 Result is kept for 500 seconds
18:08:48 
18:08:48 *** Listening on chapters, profiles, reviews...
18:08:48 reviews: fanfic.jobs.crawl_reviews(11885728) (23d7a2ea-105b-4a41-b8c5-c377b81728e7)
18:09:02 reviews: Job OK (23d7a2ea-105b-4a41-b8c5-c377b81728e7)
18:09:02 Result is kept for 500 seconds
18:09:02 
18:09:02 *** Listening on chapters, profiles, reviews...
18:09:02 reviews: fanfic.jobs.crawl_reviews(11886972) (cbd366db-cffa-4a26-8d97-341427d3c936)
2017-02-09 18:09:07 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 02:09:07.847161', 11886972, 245104646, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6624162&amp;r ... (1444 characters truncated) ... WEET THINGS HES DONE, SIRIUSLY, WHERE DO YOU EVEN GET ALL THESE IDEAS FROM, YOU\'RE AMAZING. (The chocolate frogs is too adorable )</div></td>\n</tr>'), ('2017-02-10 02:09:07.847165', 11886972, 244150249, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3372350&amp;r ... (1091 characters truncated) ... s half expecting her to die at some point and him to say "goodbye darling" and my heart to be broken so im glad that didn\'t happen</div></td>\n</tr>'), ('2017-02-10 02:09:07.847168', 11886972, 239999990, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (595 characters truncated) ... mall><div style="margin-top:5px">Well, at least we know it wasn\'t grievously diminished. Or Harry Potter would be lacking a Harry.</div></td>\n</tr>'), ('2017-02-10 02:09:07.847170', 11886972, 238680035, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7531008&amp;r ... (1066 characters truncated) ... d laugh and I didn\'t stop reading. The entire story was just amazing and you\'re an amazing author. Please never give up writing ️</div></td>\n</tr>'), ('2017-02-10 02:09:07.847172', 11886972, 237967693, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7615140&amp;r ... (1090 characters truncated) ...  close too it. That fanfic was amazing, but let me tell you, this is amazing. Congratulations on the job well done, amazingly done.</div></td>\n</tr>'), ('2017-02-10 02:09:07.847174', 11886972, 237032042, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7057627&amp;r ... (879 characters truncated) ... ll><div style="margin-top:5px">THE MOST AMAZING STORY EVER ! LOVE IT ,you are an AMAZING author .you don\'t know how much I cried !</div></td>\n</tr>'), ('2017-02-10 02:09:07.847176', 11886972, 245104646, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6624162&amp;r ... (1444 characters truncated) ... WEET THINGS HES DONE, SIRIUSLY, WHERE DO YOU EVEN GET ALL THESE IDEAS FROM, YOU\'RE AMAZING. (The chocolate frogs is too adorable )</div></td>\n</tr>'), ('2017-02-10 02:09:07.847178', 11886972, 244150249, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3372350&amp;r ... (1091 characters truncated) ... s half expecting her to die at some point and him to say "goodbye darling" and my heart to be broken so im glad that didn\'t happen</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-10 02:09:07.847183', 11886972, 237967693, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7615140&amp;r ... (1090 characters truncated) ...  close too it. That fanfic was amazing, but let me tell you, this is amazing. Congratulations on the job well done, amazingly done.</div></td>\n</tr>'), ('2017-02-10 02:09:07.847185', 11886972, 237032042, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7057627&amp;r ... (879 characters truncated) ... ll><div style="margin-top:5px">THE MOST AMAZING STORY EVER ! LOVE IT ,you are an AMAZING author .you don\'t know how much I cried !</div></td>\n</tr>'))]
18:09:07 reviews: Job OK (cbd366db-cffa-4a26-8d97-341427d3c936)
18:09:07 Result is kept for 500 seconds
18:09:07 
18:09:07 *** Listening on chapters, profiles, reviews...
18:09:07 reviews: fanfic.jobs.crawl_reviews(11887762) (c3ce50b7-b537-4b3a-9194-be7341e70bd5)
2017-02-09 18:09:12 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 02:09:12.748759', 11887762, 245904882, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8147395&amp;r ... (820 characters truncated) ... ray">chapter 36 . <span data-xutime="1483950647">1/9</span> </small><div style="margin-top:5px">I liked this... I liked it a lot :)</div></td>\n</tr>'), ('2017-02-10 02:09:12.748767', 11887762, 239473903, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4978981&amp;r ... (888 characters truncated) ... olor:gray">chapter 32 . <span data-xutime="1468602803">7/15/2016</span> </small><div style="margin-top:5px">finacee... its fiancee?</div></td>\n</tr>'), ('2017-02-10 02:09:12.748769', 11887762, 239471042, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4978981&amp;r ... (878 characters truncated) ... l style="color:gray">chapter 26 . <span data-xutime="1468597147">7/15/2016</span> </small><div style="margin-top:5px">poor ginny XD</div></td>\n</tr>'), ('2017-02-10 02:09:12.748772', 11887762, 239470951, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4978981&amp;r ... (909 characters truncated) ...  . <span data-xutime="1468597014">7/15/2016</span> </small><div style="margin-top:5px">isnt it supposed to be \'barely\' notbarley"</div></td>\n</tr>'), ('2017-02-10 02:09:12.748774', 11887762, 239470211, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4978981&amp;r ... (941 characters truncated) ... ">7/15/2016</span> </small><div style="margin-top:5px">"i get sore and cranky around full moon" sounds like my period... hahahahaha</div></td>\n</tr>'), ('2017-02-10 02:09:12.748776', 11887762, 239469282, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4978981&amp;r ... (929 characters truncated) ... ="1468593918">7/15/2016</span> </small><div style="margin-top:5px">this trip to the past was random but i\'m taking it pretty well.</div></td>\n</tr>'), ('2017-02-10 02:09:12.748779', 11887762, 239464427, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4978981&amp;r ... (897 characters truncated) ... ">chapter 9 . <span data-xutime="1468582260">7/15/2016</span> </small><div style="margin-top:5px">this story deserves more honestly</div></td>\n</tr>'), ('2017-02-10 02:09:12.748781', 11887762, 238101218, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7104359&amp;r ... (1053 characters truncated) ... s an awesome character for the namesake of some of Hogwarts best pranksters(only the Weasley twins or descendants could best them.)</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-10 02:09:12.748806', 11887762, 235778430, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7236553&amp;r ... (788 characters truncated) ... >  <small style="color:gray">chapter 15 . <span data-xutime="1460853504">4/16/2016</span> </small><div style="margin-top:5px">NOPE!</div></td>\n</tr>'), ('2017-02-10 02:09:12.748809', 11887762, 235778328, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7236553&amp;r ... (931 characters truncated) ... ong as u don\'t put James Sirius Potter with a girlfriend. If you do that, i\'m out ( unless their name is chloe!.) #fictionalcrush</div></td>\n</tr>'))]
18:09:12 reviews: Job OK (c3ce50b7-b537-4b3a-9194-be7341e70bd5)
18:09:12 Result is kept for 500 seconds
18:09:12 
18:09:12 *** Listening on chapters, profiles, reviews...
18:09:12 reviews: fanfic.jobs.crawl_reviews(11888152) (8ae650ba-c774-4e72-9212-6445b0661f54)
18:09:18 reviews: Job OK (8ae650ba-c774-4e72-9212-6445b0661f54)
18:09:18 Result is kept for 500 seconds
18:09:18 
18:09:18 *** Listening on chapters, profiles, reviews...
18:09:18 reviews: fanfic.jobs.crawl_reviews(11888579) (103bb8e1-8668-4acf-8142-86e4ab778007)
2017-02-09 18:09:22 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 02:09:22.699856', 11888579, 246198166, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4011323&amp;r ... (861 characters truncated) ...  <small style="color:gray">chapter 28 . <span data-xutime="1484649284">1/17</span> </small><div style="margin-top:5px">Great story.</div></td>\n</tr>'), ('2017-02-10 02:09:22.699860', 11888579, 235978424, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=828088&amp;rw ... (880 characters truncated) ... style="margin-top:5px">I enjoy reading your stories and this one was pretty good, even if I don\'t particularly like HP/GW pairing.</div></td>\n</tr>'), ('2017-02-10 02:09:22.699862', 11888579, 235599522, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (578 characters truncated) ... 595">4/10/2016</span> </small><div style="margin-top:5px">Please Please keep writing your stories I love each and every one of them</div></td>\n</tr>'), ('2017-02-10 02:09:22.699864', 11888579, 235589086, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1526339&amp;r ... (865 characters truncated) ... span> </small><div style="margin-top:5px">thank you for this story. Sequel please, more on their fids thank you. loved it uture and</div></td>\n</tr>'), ('2017-02-10 02:09:22.699866', 11888579, 235541172, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1816754&amp;r ... (1011 characters truncated) ... g upset about the vision, but he is majorly overreacting. Why did he bother to come back if he\'s going to be miserable on purpose?</div></td>\n</tr>'), ('2017-02-10 02:09:22.699868', 11888579, 235540942, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1816754&amp;r ... (1061 characters truncated) ... tupid, he can do things on his own. I\'m glad Harry and Ginny got back together, but I wouldn\'t have expected her to be so...mean.</div></td>\n</tr>'), ('2017-02-10 02:09:22.699870', 11888579, 235540638, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1816754&amp;r ... (966 characters truncated) ... le="margin-top:5px">I don\'t blame Harry for not wanting to talk to Hermione. Glad he\'s talking to someone, but wish it was Ginny.</div></td>\n</tr>'), ('2017-02-10 02:09:22.699872', 11888579, 235540580, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1816754&amp;r ... (1298 characters truncated) ... Where is Ginny? Harry used the Imperius Curse during the Gringotts escape so Ron and Hermione already knew he used an Unforgivable.</div></td>\n</tr>')  ... displaying 10 of 18 total bound parameter sets ...  ('2017-02-10 02:09:22.699889', 11888579, 235540580, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1816754&amp;r ... (1298 characters truncated) ... Where is Ginny? Harry used the Imperius Curse during the Gringotts escape so Ron and Hermione already knew he used an Unforgivable.</div></td>\n</tr>'), ('2017-02-10 02:09:22.699891', 11888579, 235500889, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7061951&amp;r ... (867 characters truncated) ... all style="color:gray">chapter 28 . <span data-xutime="1460287915">4/10/2016</span> </small><div style="margin-top:5px">Loved this!</div></td>\n</tr>'))]
18:09:22 reviews: Job OK (103bb8e1-8668-4acf-8142-86e4ab778007)
18:09:22 Result is kept for 500 seconds
18:09:22 
18:09:22 *** Listening on chapters, profiles, reviews...
18:09:22 reviews: fanfic.jobs.crawl_reviews(11890461) (60f7458f-4fd8-44fb-bbab-7f6861870cab)
18:09:31 reviews: Job OK (60f7458f-4fd8-44fb-bbab-7f6861870cab)
18:09:31 Result is kept for 500 seconds
18:09:31 
18:09:31 *** Listening on chapters, profiles, reviews...
18:09:31 reviews: fanfic.jobs.crawl_reviews(11891422) (64cd51ec-c0f7-45ce-becb-e1e659185586)
18:09:41 reviews: Job OK (64cd51ec-c0f7-45ce-becb-e1e659185586)
18:09:41 Result is kept for 500 seconds
18:09:41 
18:09:41 *** Listening on chapters, profiles, reviews...
18:09:41 reviews: fanfic.jobs.crawl_reviews(11892968) (9cf949b7-96d2-41f2-989b-c6929e10eb76)
18:10:08 reviews: Job OK (9cf949b7-96d2-41f2-989b-c6929e10eb76)
18:10:08 Result is kept for 500 seconds
18:10:08 
18:10:08 *** Listening on chapters, profiles, reviews...
18:10:08 reviews: fanfic.jobs.crawl_reviews(11893392) (939055ba-aa16-4123-836a-19f3293be500)
18:10:17 reviews: Job OK (939055ba-aa16-4123-836a-19f3293be500)
18:10:17 Result is kept for 500 seconds
18:10:17 
18:10:17 *** Listening on chapters, profiles, reviews...
18:10:17 reviews: fanfic.jobs.crawl_reviews(11894165) (cc24bb36-2e6e-4e6e-a294-dd8f5919550d)
18:16:22 reviews: Job OK (cc24bb36-2e6e-4e6e-a294-dd8f5919550d)
18:16:22 Result is kept for 500 seconds
18:16:22 
18:16:22 *** Listening on chapters, profiles, reviews...
18:16:22 reviews: fanfic.jobs.crawl_reviews(11894380) (6447e6c3-b5d4-4757-ba27-9b998cb1bf62)
18:17:23 reviews: Job OK (6447e6c3-b5d4-4757-ba27-9b998cb1bf62)
18:17:23 Result is kept for 500 seconds
18:17:23 
18:17:23 *** Listening on chapters, profiles, reviews...
18:17:23 reviews: fanfic.jobs.crawl_reviews(11894482) (4e6593db-e8c3-441b-be1a-3e55e22d3663)
18:17:27 reviews: Job OK (4e6593db-e8c3-441b-be1a-3e55e22d3663)
18:17:27 Result is kept for 500 seconds
18:17:27 
18:17:27 *** Listening on chapters, profiles, reviews...
18:17:27 reviews: fanfic.jobs.crawl_reviews(11895291) (4220ac86-fa55-4afb-be04-da31de60ebd2)
18:18:12 reviews: Job OK (4220ac86-fa55-4afb-be04-da31de60ebd2)
18:18:12 Result is kept for 500 seconds
18:18:12 
18:18:12 *** Listening on chapters, profiles, reviews...
18:18:12 reviews: fanfic.jobs.crawl_reviews(11895717) (0e7eae2b-e629-4edb-93f1-91019c2f2ad7)
18:18:39 reviews: Job OK (0e7eae2b-e629-4edb-93f1-91019c2f2ad7)
18:18:39 Result is kept for 500 seconds
18:18:39 
18:18:39 *** Listening on chapters, profiles, reviews...
18:18:39 reviews: fanfic.jobs.crawl_reviews(11896247) (caf04f88-b040-47ab-840b-fe4f2bddec8a)
18:21:33 reviews: Job OK (caf04f88-b040-47ab-840b-fe4f2bddec8a)
18:21:33 Result is kept for 500 seconds
18:21:33 
18:21:33 *** Listening on chapters, profiles, reviews...
18:21:33 reviews: fanfic.jobs.crawl_reviews(11896633) (d117e5cc-ccab-462a-975c-f0b4252be09e)
2017-02-09 18:21:39 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 02:21:39.256222', 11896633, 238053930, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5931383&amp;r ... (941 characters truncated) ... 465689435">6/11/2016</span> </small><div style="margin-top:5px">Amazing story! I read the continuation of it, too - also wonderful!</div></td>\n</tr>'), ('2017-02-10 02:21:39.256227', 11896633, 236524469, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (513 characters truncated) ... 67 <small style="color:gray">chapter 1 . <span data-xutime="1462230393">5/2/2016</span> </small><div style="margin-top:5px">Like it</div></td>\n</tr>'), ('2017-02-10 02:21:39.256229', 11896633, 238053930, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5931383&amp;r ... (941 characters truncated) ... 465689435">6/11/2016</span> </small><div style="margin-top:5px">Amazing story! I read the continuation of it, too - also wonderful!</div></td>\n</tr>'), ('2017-02-10 02:21:39.256231', 11896633, 236524469, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (513 characters truncated) ... 67 <small style="color:gray">chapter 1 . <span data-xutime="1462230393">5/2/2016</span> </small><div style="margin-top:5px">Like it</div></td>\n</tr>'))]
18:21:39 reviews: Job OK (d117e5cc-ccab-462a-975c-f0b4252be09e)
18:21:39 Result is kept for 500 seconds
18:21:39 
18:21:39 *** Listening on chapters, profiles, reviews...
18:21:39 reviews: fanfic.jobs.crawl_reviews(11897136) (f4c6934f-bf07-4f24-ab5f-9a58a7af28ae)
18:22:07 reviews: Job OK (f4c6934f-bf07-4f24-ab5f-9a58a7af28ae)
18:22:07 Result is kept for 500 seconds
18:22:07 
18:22:07 *** Listening on chapters, profiles, reviews...
18:22:07 reviews: fanfic.jobs.crawl_reviews(11897583) (097f11d7-153e-4a60-a123-5c5e0b084737)
18:24:00 reviews: Job OK (097f11d7-153e-4a60-a123-5c5e0b084737)
18:24:00 Result is kept for 500 seconds
18:24:00 
18:24:00 *** Listening on chapters, profiles, reviews...
18:24:00 reviews: fanfic.jobs.crawl_reviews(11898497) (f6a896b6-48f5-437f-baeb-8b13f76e3730)
2017-02-09 18:24:06 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 02:24:06.439197', 11898497, 245921914, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (553 characters truncated) ... a-xutime="1483995636">1/9</span> </small><div style="margin-top:5px">I woud have liket it moare if she had been a huffelpuf but idk</div></td>\n</tr>'), ('2017-02-10 02:24:06.439202', 11898497, 245558500, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6938380&amp;r ... (1035 characters truncated) ...  the ending (in the best way possible). I give my heart to this fic. And once I\'m done crying I\'m gonna read it all over again...</div></td>\n</tr>'), ('2017-02-10 02:24:06.439204', 11898497, 245558469, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6938380&amp;r ... (890 characters truncated) ... or:gray">chapter 34 . <span data-xutime="1483194001">12/31/2016</span> </small><div style="margin-top:5px">I\'m not crying... am I?</div></td>\n</tr>'), ('2017-02-10 02:24:06.439206', 11898497, 245473625, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6938380&amp;r ... (997 characters truncated) ... Well, yes it DID took them long but... hell it is just prefect 3 too bad it\'s the middlr of the night and I can\'t keep reading xD</div></td>\n</tr>'), ('2017-02-10 02:24:06.439208', 11898497, 245473624, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6938380&amp;r ... (997 characters truncated) ... Well, yes it DID took them long but... hell it is just prefect 3 too bad it\'s the middlr of the night and I can\'t keep reading xD</div></td>\n</tr>'), ('2017-02-10 02:24:06.439210', 11898497, 245473623, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6938380&amp;r ... (997 characters truncated) ... Well, yes it DID took them long but... hell it is just prefect 3 too bad it\'s the middlr of the night and I can\'t keep reading xD</div></td>\n</tr>'), ('2017-02-10 02:24:06.439212', 11898497, 245375320, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6938380&amp;r ... (944 characters truncated) ... 2/26/2016</span> </small><div style="margin-top:5px">I am speechless...it is so terrible yet so good. I love the sory even more now</div></td>\n</tr>'), ('2017-02-10 02:24:06.439214', 11898497, 245174383, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6938380&amp;r ... (1005 characters truncated) ...  is great amd so full of suprises! It\'s nice that you\'re not hurying the plot and take time to write about everything and nothing</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-10 02:24:06.439241', 11898497, 241477602, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6981106&amp;r ... (931 characters truncated) ... e literally laughed out loud and cried whilst reading. And everything just seemed true to character and realistic. Really loved it!</div></td>\n</tr>'), ('2017-02-10 02:24:06.439243', 11898497, 237145097, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2202987&amp;r ... (906 characters truncated) ... . <span data-xutime="1463760596">5/20/2016</span> </small><div style="margin-top:5px">Great story! Such a sad ending. Keep writing!</div></td>\n</tr>'))]
18:24:06 reviews: Job OK (f6a896b6-48f5-437f-baeb-8b13f76e3730)
18:24:06 Result is kept for 500 seconds
18:24:06 
18:24:06 *** Listening on chapters, profiles, reviews...
18:24:06 reviews: fanfic.jobs.crawl_reviews(11898648) (425a7408-d0ce-4a9d-92d0-6d4b4ea0953b)
18:42:55 reviews: Job OK (425a7408-d0ce-4a9d-92d0-6d4b4ea0953b)
18:42:55 Result is kept for 500 seconds
18:42:55 Cleaning registries for queue: chapters
18:42:55 Cleaning registries for queue: profiles
18:42:55 Cleaning registries for queue: reviews
18:42:55 
18:42:55 *** Listening on chapters, profiles, reviews...
18:42:55 reviews: fanfic.jobs.crawl_reviews(11898796) (f98e1b38-875f-45eb-99f1-615d1abf1c7f)
2017-02-09 18:43:01 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 02:43:01.212809', 11898796, 239045762, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (540 characters truncated) ... chapter 23 . <span data-xutime="1467731581">7/5/2016</span> </small><div style="margin-top:5px">23 chapters and I\'m still confused</div></td>\n</tr>'), ('2017-02-10 02:43:01.212814', 11898796, 238581410, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2464084&amp;r ... (877 characters truncated) ... 6</span> </small><div style="margin-top:5px">I\'m enjoying this story quite a bit. Congratulations, I hope you continue on with it.</div></td>\n</tr>'), ('2017-02-10 02:43:01.212817', 11898796, 235851491, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4040693&amp;r ... (1019 characters truncated) ... Hey loved the 1st part!<br>\nEagarly waiting for a update!<br>\nWaiting to see what you plan on doing with these lovely characters!</div></td>\n</tr>'), ('2017-02-10 02:43:01.212819', 11898796, 239045762, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (540 characters truncated) ... chapter 23 . <span data-xutime="1467731581">7/5/2016</span> </small><div style="margin-top:5px">23 chapters and I\'m still confused</div></td>\n</tr>'), ('2017-02-10 02:43:01.212821', 11898796, 238581410, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2464084&amp;r ... (877 characters truncated) ... 6</span> </small><div style="margin-top:5px">I\'m enjoying this story quite a bit. Congratulations, I hope you continue on with it.</div></td>\n</tr>'), ('2017-02-10 02:43:01.212823', 11898796, 235851491, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4040693&amp;r ... (1019 characters truncated) ... Hey loved the 1st part!<br>\nEagarly waiting for a update!<br>\nWaiting to see what you plan on doing with these lovely characters!</div></td>\n</tr>'))]
18:43:01 reviews: Job OK (f98e1b38-875f-45eb-99f1-615d1abf1c7f)
18:43:01 Result is kept for 500 seconds
18:43:01 
18:43:01 *** Listening on chapters, profiles, reviews...
18:43:01 reviews: fanfic.jobs.crawl_reviews(11899922) (ee4f5b30-036a-4546-9dfc-fe5e93cd0996)
18:45:42 reviews: Job OK (ee4f5b30-036a-4546-9dfc-fe5e93cd0996)
18:45:42 Result is kept for 500 seconds
18:45:42 
18:45:42 *** Listening on chapters, profiles, reviews...
18:45:42 reviews: fanfic.jobs.crawl_reviews(11902510) (fb36a900-f6db-4140-8e8a-66d35cec0b83)
18:46:19 reviews: Job OK (fb36a900-f6db-4140-8e8a-66d35cec0b83)
18:46:19 Result is kept for 500 seconds
18:46:19 
18:46:19 *** Listening on chapters, profiles, reviews...
18:46:19 reviews: fanfic.jobs.crawl_reviews(11902827) (958e56fd-d428-496d-a380-c0a008105b23)
2017-02-09 18:46:23 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 02:46:23.752407', 11902827, 236051616, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6756238&amp;r ... (903 characters truncated) ... >chapter 4 . <span data-xutime="1461428549">4/23/2016</span> </small><div style="margin-top:5px">Wow! Awesome! I really like it. :)</div></td>\n</tr>'), ('2017-02-10 02:46:23.752412', 11902827, 235990453, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4011323&amp;r ... (939 characters truncated) ... 016</span> </small><div style="margin-top:5px">Greyback is a nasty person and he seems to enjoy making people squirm and be afraid.</div></td>\n</tr>'), ('2017-02-10 02:46:23.752414', 11902827, 235859599, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6756238&amp;r ... (1010 characters truncated) ... was really awesome! I love it, especially because one of the things that fascinate me most in Harry Potter is different generations</div></td>\n</tr>'), ('2017-02-10 02:46:23.752416', 11902827, 236051616, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6756238&amp;r ... (903 characters truncated) ... >chapter 4 . <span data-xutime="1461428549">4/23/2016</span> </small><div style="margin-top:5px">Wow! Awesome! I really like it. :)</div></td>\n</tr>'), ('2017-02-10 02:46:23.752418', 11902827, 235990453, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4011323&amp;r ... (939 characters truncated) ... 016</span> </small><div style="margin-top:5px">Greyback is a nasty person and he seems to enjoy making people squirm and be afraid.</div></td>\n</tr>'), ('2017-02-10 02:46:23.752420', 11902827, 235859599, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6756238&amp;r ... (1010 characters truncated) ... was really awesome! I love it, especially because one of the things that fascinate me most in Harry Potter is different generations</div></td>\n</tr>'))]
18:46:23 reviews: Job OK (958e56fd-d428-496d-a380-c0a008105b23)
18:46:23 Result is kept for 500 seconds
18:46:23 
18:46:23 *** Listening on chapters, profiles, reviews...
18:46:23 reviews: fanfic.jobs.crawl_reviews(11904112) (6f08ca88-f879-4f0f-b8c7-950896d146a9)
18:46:37 reviews: Job OK (6f08ca88-f879-4f0f-b8c7-950896d146a9)
18:46:37 Result is kept for 500 seconds
18:46:37 
18:46:37 *** Listening on chapters, profiles, reviews...
18:46:37 reviews: fanfic.jobs.crawl_reviews(11904941) (9d38cc14-e918-47fa-a42a-2af02f96b4cc)
18:47:01 reviews: Job OK (9d38cc14-e918-47fa-a42a-2af02f96b4cc)
18:47:01 Result is kept for 500 seconds
18:47:01 
18:47:01 *** Listening on chapters, profiles, reviews...
18:47:01 reviews: fanfic.jobs.crawl_reviews(11905283) (84449c0a-009d-4329-9248-853de1c36d14)
2017-02-09 18:47:02 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/11905283/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
18:47:02 reviews: Job OK (84449c0a-009d-4329-9248-853de1c36d14)
18:47:02 Result is kept for 500 seconds
18:47:02 
18:47:02 *** Listening on chapters, profiles, reviews...
18:47:02 reviews: fanfic.jobs.crawl_reviews(11907469) (41c14594-aeee-480a-8765-812bf033e1fc)
18:47:08 reviews: Job OK (41c14594-aeee-480a-8765-812bf033e1fc)
18:47:08 Result is kept for 500 seconds
18:47:08 
18:47:08 *** Listening on chapters, profiles, reviews...
18:47:08 reviews: fanfic.jobs.crawl_reviews(11909251) (4ab3ab78-9e05-4c4f-adb8-b8f38b15130e)
18:47:28 reviews: Job OK (4ab3ab78-9e05-4c4f-adb8-b8f38b15130e)
18:47:28 Result is kept for 500 seconds
18:47:28 
18:47:28 *** Listening on chapters, profiles, reviews...
18:47:28 reviews: fanfic.jobs.crawl_reviews(11910031) (4a67f5be-c46b-478d-80be-089242a01cad)
18:47:33 reviews: Job OK (4a67f5be-c46b-478d-80be-089242a01cad)
18:47:33 Result is kept for 500 seconds
18:47:33 
18:47:33 *** Listening on chapters, profiles, reviews...
18:47:33 reviews: fanfic.jobs.crawl_reviews(11910794) (16c64b7a-e979-43ad-8fc3-b7722659a578)
18:47:47 reviews: Job OK (16c64b7a-e979-43ad-8fc3-b7722659a578)
18:47:47 Result is kept for 500 seconds
18:47:47 
18:47:47 *** Listening on chapters, profiles, reviews...
18:47:47 reviews: fanfic.jobs.crawl_reviews(11910994) (49f58759-34c1-4aab-b8cd-46f55449b275)
18:52:07 reviews: Job OK (49f58759-34c1-4aab-b8cd-46f55449b275)
18:52:07 Result is kept for 500 seconds
18:52:07 
18:52:07 *** Listening on chapters, profiles, reviews...
18:52:07 reviews: fanfic.jobs.crawl_reviews(11911074) (0d009771-b760-41a6-b925-772f9732ffaf)
18:55:21 reviews: Job OK (0d009771-b760-41a6-b925-772f9732ffaf)
18:55:21 Result is kept for 500 seconds
18:55:21 
18:55:21 *** Listening on chapters, profiles, reviews...
18:55:21 reviews: fanfic.jobs.crawl_reviews(11911320) (b9809694-8c72-4721-8483-b81c34169ee4)
18:56:13 reviews: Job OK (b9809694-8c72-4721-8483-b81c34169ee4)
18:56:13 Result is kept for 500 seconds
18:56:13 
18:56:13 *** Listening on chapters, profiles, reviews...
18:56:13 reviews: fanfic.jobs.crawl_reviews(11911497) (fad7801e-6b9a-41b3-8963-be9d223b70bd)
19:00:52 reviews: Job OK (fad7801e-6b9a-41b3-8963-be9d223b70bd)
19:00:52 Result is kept for 500 seconds
19:00:52 
19:00:52 *** Listening on chapters, profiles, reviews...
19:00:52 reviews: fanfic.jobs.crawl_reviews(11911789) (e075ff03-5f69-429f-b955-02bfdda39368)
19:01:14 reviews: Job OK (e075ff03-5f69-429f-b955-02bfdda39368)
19:01:14 Result is kept for 500 seconds
19:01:14 
19:01:14 *** Listening on chapters, profiles, reviews...
19:01:14 reviews: fanfic.jobs.crawl_reviews(11912434) (70ff52c0-1c5f-4ec4-a0b6-00eeb3f13887)
19:02:38 reviews: Job OK (70ff52c0-1c5f-4ec4-a0b6-00eeb3f13887)
19:02:38 Result is kept for 500 seconds
19:02:38 
19:02:38 *** Listening on chapters, profiles, reviews...
19:02:38 reviews: fanfic.jobs.crawl_reviews(11913447) (811e5da9-b76c-4fb2-8934-bfef644cd562)
19:05:44 reviews: Job OK (811e5da9-b76c-4fb2-8934-bfef644cd562)
19:05:44 Result is kept for 500 seconds
19:05:44 
19:05:44 *** Listening on chapters, profiles, reviews...
19:05:44 reviews: fanfic.jobs.crawl_reviews(11913733) (064fe143-90b4-4aaf-b924-c9ab45bec1b4)
19:07:10 reviews: Job OK (064fe143-90b4-4aaf-b924-c9ab45bec1b4)
19:07:10 Result is kept for 500 seconds
19:07:10 
19:07:10 *** Listening on chapters, profiles, reviews...
19:07:10 reviews: fanfic.jobs.crawl_reviews(11916139) (fe9f3d42-0f86-469d-9822-160fe06c2543)
19:07:45 reviews: Job OK (fe9f3d42-0f86-469d-9822-160fe06c2543)
19:07:45 Result is kept for 500 seconds
19:07:45 
19:07:45 *** Listening on chapters, profiles, reviews...
19:07:45 reviews: fanfic.jobs.crawl_reviews(11916243) (e6a4dbd1-1bb6-4512-b394-9f33c83c4774)
19:19:06 reviews: Job OK (e6a4dbd1-1bb6-4512-b394-9f33c83c4774)
19:19:06 Result is kept for 500 seconds
19:19:06 
19:19:06 *** Listening on chapters, profiles, reviews...
19:19:06 reviews: fanfic.jobs.crawl_reviews(11916476) (5286e719-081f-4ded-b9c7-5ee89a6a9f51)
19:19:26 reviews: Job OK (5286e719-081f-4ded-b9c7-5ee89a6a9f51)
19:19:26 Result is kept for 500 seconds
19:19:26 
19:19:26 *** Listening on chapters, profiles, reviews...
19:19:26 reviews: fanfic.jobs.crawl_reviews(11918557) (cd73129c-01bb-41b2-bd9d-30eae46e23b2)
19:19:53 reviews: Job OK (cd73129c-01bb-41b2-bd9d-30eae46e23b2)
19:19:53 Result is kept for 500 seconds
19:19:53 
19:19:53 *** Listening on chapters, profiles, reviews...
19:19:53 reviews: fanfic.jobs.crawl_reviews(11918850) (1691ee0e-f8b6-4091-9902-d6b39723cf45)
2017-02-09 19:19:58 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 03:19:58.779488', 11918850, 245755586, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1966443&amp;r ... (1692 characters truncated) ... D SERIOUSLY FABULOUS AND SERIOUSLY FANTASTIC WRITER!<br>\n<br>\nDON\'T STOP BEING SERIOUSLY AWESOME!<br>\n<br>\nFAN-READER! Anna :)</div></td>\n</tr>'), ('2017-02-10 03:19:58.779492', 11918850, 241570747, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1108930&amp;r ... (872 characters truncated) ... lor:gray">chapter 9 . <span data-xutime="1473110631">9/5/2016</span> </small><div style="margin-top:5px">I really love this fanfic!</div></td>\n</tr>'), ('2017-02-10 03:19:58.779495', 11918850, 241415037, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6776325&amp;r ... (1055 characters truncated) ...  thought I always thought Snape would make comment before, going all mind reading and stuff :P but it\'s a super story, keep it up!</div></td>\n</tr>'), ('2017-02-10 03:19:58.779497', 11918850, 241107368, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1828603&amp;r ... (918 characters truncated) ... utime="1472067030">8/24/2016</span> </small><div style="margin-top:5px">Thank you for the great update! I can\'t wait to read more.</div></td>\n</tr>'), ('2017-02-10 03:19:58.779499', 11918850, 241057965, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1966443&amp;r ... (1468 characters truncated) ... IOUSLY FABULOUS AND SERIOUSLY FANTASTIC WRITER!<br>\n<br>\nDON\'T STOP BEING SERIOUSLY AWESOME!<br>\n<br>\nYour FAN-READER! Anna :3</div></td>\n</tr>'), ('2017-02-10 03:19:58.779500', 11918850, 239738109, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4060390&amp;r ... (868 characters truncated) ...  <small style="color:gray">chapter 7 . <span data-xutime="1469150599">7/21/2016</span> </small><div style="margin-top:5px">Continue</div></td>\n</tr>'), ('2017-02-10 03:19:58.779502', 11918850, 237307859, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1966443&amp;r ... (1511 characters truncated) ... ND SERIOUSLY FABULOUS AND SERIOUSLY FANTASTIC WRITER!<br>\n<br>\nDON\'T STOP BEING SERIOUSLY AWESOME!<br>\nYour FAN-READER! Anna :3</div></td>\n</tr>'), ('2017-02-10 03:19:58.779504', 11918850, 237306814, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7321138&amp;r ... (961 characters truncated) ...  </small><div style="margin-top:5px">Oh no! I really hope Draco doesn\'t turn to his old ways with Harry. Loving the story as well!</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-10 03:19:58.779539', 11918850, 236471266, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7442548&amp;r ... (932 characters truncated) ... s story saved to read for a while now I struggled a bit at the start but I am so glad I kept on reading. It\'s amazing well done :)</div></td>\n</tr>'), ('2017-02-10 03:19:58.779540', 11918850, 236285302, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7321138&amp;r ... (889 characters truncated) ... "color:gray">chapter 5 . <span data-xutime="1461904648">4/28/2016</span> </small><div style="margin-top:5px">This story is amazing!</div></td>\n</tr>'))]
19:19:58 reviews: Job OK (1691ee0e-f8b6-4091-9902-d6b39723cf45)
19:19:58 Result is kept for 500 seconds
19:19:58 
19:19:58 *** Listening on chapters, profiles, reviews...
19:19:58 reviews: fanfic.jobs.crawl_reviews(11920258) (1b6ba082-2c92-4a74-891e-e24c4f9db4e3)
19:21:22 reviews: Job OK (1b6ba082-2c92-4a74-891e-e24c4f9db4e3)
19:21:22 Result is kept for 500 seconds
19:21:22 
19:21:22 *** Listening on chapters, profiles, reviews...
19:21:22 reviews: fanfic.jobs.crawl_reviews(11920554) (133c56fe-8090-478f-b8bb-1ea9d2181a23)
19:22:12 reviews: Job OK (133c56fe-8090-478f-b8bb-1ea9d2181a23)
19:22:12 Result is kept for 500 seconds
19:22:12 
19:22:12 *** Listening on chapters, profiles, reviews...
19:22:12 reviews: fanfic.jobs.crawl_reviews(11921019) (5cb42278-5e71-4cf2-9bc1-c84fbc40d993)
2017-02-09 19:22:16 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 03:22:16.897918', 11921019, 246318175, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8302634&amp;r ... (819 characters truncated) ... gray">chapter 24 . <span data-xutime="1484944013">1/20</span> </small><div style="margin-top:5px">This is a great story. I love it!</div></td>\n</tr>'), ('2017-02-10 03:22:16.897922', 11921019, 242555551, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (814 characters truncated) ... interesting plot lines like this with well developed characters get less reads then the same rehashed stuff out there. Keep it up:)</div></td>\n</tr>'), ('2017-02-10 03:22:16.897925', 11921019, 241774609, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (813 characters truncated) ... e I\'ve read and I absolutely LOVED Max. Are you going to write something else for these characters? I NEED TO KNOW MORE ABOUT MAX.</div></td>\n</tr>'), ('2017-02-10 03:22:16.897927', 11921019, 241579845, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7996773&amp;r ... (897 characters truncated) ... 2016</span> </small><div style="margin-top:5px">I just spent 4 days reading this, please make a year 2 one. You\'re a great writer.</div></td>\n</tr>'), ('2017-02-10 03:22:16.897929', 11921019, 240991523, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (636 characters truncated) ...  really great and I can\'t wait for more. However, the last two chapters have been really hard to rwad. Please fix them if you can.</div></td>\n</tr>'), ('2017-02-10 03:22:16.897930', 11921019, 240888033, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (519 characters truncated) ... "color:gray">chapter 2 . <span data-xutime="1471413422">8/16/2016</span> </small><div style="margin-top:5px">This story is so great</div></td>\n</tr>'), ('2017-02-10 03:22:16.897932', 11921019, 240810249, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7565871&amp;r ... (1042 characters truncated) ... 6.0pt; line-height: 107%; font-family: \'Times New Roman\',serif;" /span/p. At the end of every sentence? It makes it hard to read.</div></td>\n</tr>'), ('2017-02-10 03:22:16.897934', 11921019, 237138351, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5025774&amp;r ... (1120 characters truncated) ... tuff they\'ll get up to. I wonder why Max/Vladimir kept looking down when they caught caught.<br>\nUpdate soon~<br>\n-AngelofDarkus</div></td>\n</tr>')  ... displaying 10 of 18 total bound parameter sets ...  ('2017-02-10 03:22:16.897951', 11921019, 237138351, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5025774&amp;r ... (1120 characters truncated) ... tuff they\'ll get up to. I wonder why Max/Vladimir kept looking down when they caught caught.<br>\nUpdate soon~<br>\n-AngelofDarkus</div></td>\n</tr>'), ('2017-02-10 03:22:16.897953', 11921019, 236760751, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7688940&amp;r ... (1047 characters truncated) ...  you portray the characters and I can\'t wait to see where you take them and this story. I will be constantly checking for updates!</div></td>\n</tr>'))]
19:22:16 reviews: Job OK (5cb42278-5e71-4cf2-9bc1-c84fbc40d993)
19:22:16 Result is kept for 500 seconds
19:22:16 
19:22:16 *** Listening on chapters, profiles, reviews...
19:22:16 reviews: fanfic.jobs.crawl_reviews(11921319) (5720c954-4420-4893-8f4b-88243aa51dba)
19:22:31 reviews: Job OK (5720c954-4420-4893-8f4b-88243aa51dba)
19:22:31 Result is kept for 500 seconds
19:22:31 
19:22:31 *** Listening on chapters, profiles, reviews...
19:22:31 reviews: fanfic.jobs.crawl_reviews(11921815) (6ad96cbd-8762-4c0b-991e-1e13706b401e)
19:22:46 reviews: Job OK (6ad96cbd-8762-4c0b-991e-1e13706b401e)
19:22:46 Result is kept for 500 seconds
19:22:46 
19:22:46 *** Listening on chapters, profiles, reviews...
19:22:46 reviews: fanfic.jobs.crawl_reviews(11921960) (e42719cc-3ce6-4c60-9a3d-1baca3bc550a)
19:27:11 reviews: Job OK (e42719cc-3ce6-4c60-9a3d-1baca3bc550a)
19:27:11 Result is kept for 500 seconds
19:27:11 
19:27:11 *** Listening on chapters, profiles, reviews...
19:27:11 reviews: fanfic.jobs.crawl_reviews(11921992) (0a98fc17-999d-41b8-b428-6250b3ce51a8)
19:30:35 reviews: Job OK (0a98fc17-999d-41b8-b428-6250b3ce51a8)
19:30:35 Result is kept for 500 seconds
19:30:35 
19:30:35 *** Listening on chapters, profiles, reviews...
19:30:35 reviews: fanfic.jobs.crawl_reviews(11922116) (4d14f388-ab39-46d3-a7da-b6a3f4b3524c)
19:31:43 reviews: Job OK (4d14f388-ab39-46d3-a7da-b6a3f4b3524c)
19:31:43 Result is kept for 500 seconds
19:31:43 
19:31:43 *** Listening on chapters, profiles, reviews...
19:31:43 reviews: fanfic.jobs.crawl_reviews(11922615) (79d8814b-0b4d-44b1-b888-0d793f5e9232)
19:37:19 reviews: Job OK (79d8814b-0b4d-44b1-b888-0d793f5e9232)
19:37:19 Result is kept for 500 seconds
19:37:19 
19:37:19 *** Listening on chapters, profiles, reviews...
19:37:19 reviews: fanfic.jobs.crawl_reviews(11923379) (fc97d5f3-f940-4b48-8901-5f503e8566a3)
19:38:02 reviews: Job OK (fc97d5f3-f940-4b48-8901-5f503e8566a3)
19:38:02 Result is kept for 500 seconds
19:38:02 
19:38:02 *** Listening on chapters, profiles, reviews...
19:38:02 reviews: fanfic.jobs.crawl_reviews(11923792) (54b94144-7830-4a16-b7cb-860ea9a32ba0)
19:50:12 reviews: Job OK (54b94144-7830-4a16-b7cb-860ea9a32ba0)
19:50:12 Result is kept for 500 seconds
19:50:12 Cleaning registries for queue: chapters
19:50:12 Cleaning registries for queue: profiles
19:50:12 Cleaning registries for queue: reviews
19:50:12 
19:50:12 *** Listening on chapters, profiles, reviews...
19:50:12 reviews: fanfic.jobs.crawl_reviews(11923807) (3b465490-6325-4c9b-b0c4-9013bd7479c0)
19:50:35 reviews: Job OK (3b465490-6325-4c9b-b0c4-9013bd7479c0)
19:50:35 Result is kept for 500 seconds
19:50:35 
19:50:35 *** Listening on chapters, profiles, reviews...
19:50:35 reviews: fanfic.jobs.crawl_reviews(11923878) (b16a7e18-8439-4e83-b1bb-863df39a91d2)
19:50:40 reviews: Job OK (b16a7e18-8439-4e83-b1bb-863df39a91d2)
19:50:40 Result is kept for 500 seconds
19:50:40 
19:50:40 *** Listening on chapters, profiles, reviews...
19:50:40 reviews: fanfic.jobs.crawl_reviews(11924901) (80f5d6ab-3b2f-4fd0-ab16-20306bfa0c4b)
19:52:00 reviews: Job OK (80f5d6ab-3b2f-4fd0-ab16-20306bfa0c4b)
19:52:00 Result is kept for 500 seconds
19:52:00 
19:52:00 *** Listening on chapters, profiles, reviews...
19:52:00 reviews: fanfic.jobs.crawl_reviews(11925078) (ca2f2b6e-b903-449a-a9eb-8ed86aa2e09e)
19:53:00 reviews: Job OK (ca2f2b6e-b903-449a-a9eb-8ed86aa2e09e)
19:53:00 Result is kept for 500 seconds
19:53:00 
19:53:00 *** Listening on chapters, profiles, reviews...
19:53:00 reviews: fanfic.jobs.crawl_reviews(11925612) (bd5b8f0d-4d17-494d-9b61-dae1a2469dae)
19:53:36 reviews: Job OK (bd5b8f0d-4d17-494d-9b61-dae1a2469dae)
19:53:36 Result is kept for 500 seconds
19:53:36 
19:53:36 *** Listening on chapters, profiles, reviews...
19:53:36 reviews: fanfic.jobs.crawl_reviews(11926465) (9dd9f0a3-0ff2-4cf9-a665-a2eef47da2c7)
19:55:12 reviews: Job OK (9dd9f0a3-0ff2-4cf9-a665-a2eef47da2c7)
19:55:12 Result is kept for 500 seconds
19:55:12 
19:55:12 *** Listening on chapters, profiles, reviews...
19:55:12 reviews: fanfic.jobs.crawl_reviews(11927302) (a2a9fa0c-924e-4ed1-a24b-26707aabfef5)
19:58:11 reviews: Job OK (a2a9fa0c-924e-4ed1-a24b-26707aabfef5)
19:58:11 Result is kept for 500 seconds
19:58:11 
19:58:11 *** Listening on chapters, profiles, reviews...
19:58:11 reviews: fanfic.jobs.crawl_reviews(11929267) (aaa208f9-f0be-4dee-b1ef-d3fba0ec6c3f)
19:58:17 reviews: Job OK (aaa208f9-f0be-4dee-b1ef-d3fba0ec6c3f)
19:58:17 Result is kept for 500 seconds
19:58:17 
19:58:17 *** Listening on chapters, profiles, reviews...
19:58:17 reviews: fanfic.jobs.crawl_reviews(11929318) (92b9a9f0-0e4c-4541-aef9-538770777a7f)
2017-02-09 19:58:21 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 03:58:21.301327', 11929318, 240419578, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (538 characters truncated) ... >chapter 3 . <span data-xutime="1470591229">8/7/2016</span> </small><div style="margin-top:5px">What happened to becoming Animagus?</div></td>\n</tr>'), ('2017-02-10 03:58:21.301333', 11929318, 240419578, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (538 characters truncated) ... >chapter 3 . <span data-xutime="1470591229">8/7/2016</span> </small><div style="margin-top:5px">What happened to becoming Animagus?</div></td>\n</tr>'))]
19:58:21 reviews: Job OK (92b9a9f0-0e4c-4541-aef9-538770777a7f)
19:58:21 Result is kept for 500 seconds
19:58:21 
19:58:21 *** Listening on chapters, profiles, reviews...
19:58:21 reviews: fanfic.jobs.crawl_reviews(11929418) (0130bf61-4951-432e-b76b-7057dc8fd637)
19:58:53 reviews: Job OK (0130bf61-4951-432e-b76b-7057dc8fd637)
19:58:53 Result is kept for 500 seconds
19:58:53 
19:58:53 *** Listening on chapters, profiles, reviews...
19:58:53 reviews: fanfic.jobs.crawl_reviews(11929644) (acb830ce-cbe5-41d3-9003-251aa0d0b37c)
20:00:23 reviews: Job OK (acb830ce-cbe5-41d3-9003-251aa0d0b37c)
20:00:23 Result is kept for 500 seconds
20:00:23 
20:00:23 *** Listening on chapters, profiles, reviews...
20:00:23 reviews: fanfic.jobs.crawl_reviews(11930530) (1e759ac8-7612-49a6-add9-f91131a72636)
20:03:13 reviews: Job OK (1e759ac8-7612-49a6-add9-f91131a72636)
20:03:13 Result is kept for 500 seconds
20:03:13 
20:03:13 *** Listening on chapters, profiles, reviews...
20:03:13 reviews: fanfic.jobs.crawl_reviews(11931564) (6cd91965-3e07-4c83-9fb1-a1f546487d91)
20:08:03 reviews: Job OK (6cd91965-3e07-4c83-9fb1-a1f546487d91)
20:08:03 Result is kept for 500 seconds
20:08:03 
20:08:03 *** Listening on chapters, profiles, reviews...
20:08:03 reviews: fanfic.jobs.crawl_reviews(11933512) (16ac4b58-63d5-41f2-880a-aed07b839c27)
20:11:13 reviews: Job OK (16ac4b58-63d5-41f2-880a-aed07b839c27)
20:11:13 Result is kept for 500 seconds
20:11:13 
20:11:13 *** Listening on chapters, profiles, reviews...
20:11:13 reviews: fanfic.jobs.crawl_reviews(11933572) (94c3b084-d128-4fe4-8025-675f7de8d423)
20:11:25 reviews: Job OK (94c3b084-d128-4fe4-8025-675f7de8d423)
20:11:25 Result is kept for 500 seconds
20:11:25 
20:11:25 *** Listening on chapters, profiles, reviews...
20:11:25 reviews: fanfic.jobs.crawl_reviews(11933896) (fa98e79a-7c6a-482c-9694-c200d6577ec1)
20:11:41 reviews: Job OK (fa98e79a-7c6a-482c-9694-c200d6577ec1)
20:11:41 Result is kept for 500 seconds
20:11:41 
20:11:41 *** Listening on chapters, profiles, reviews...
20:11:41 reviews: fanfic.jobs.crawl_reviews(11934804) (89de81d2-2c61-4935-a44f-553d72d32f48)
20:11:48 reviews: Job OK (89de81d2-2c61-4935-a44f-553d72d32f48)
20:11:48 Result is kept for 500 seconds
20:11:48 
20:11:48 *** Listening on chapters, profiles, reviews...
20:11:48 reviews: fanfic.jobs.crawl_reviews(11935367) (18c62b08-59b4-44e9-a729-cd627fab267d)
20:11:56 reviews: Job OK (18c62b08-59b4-44e9-a729-cd627fab267d)
20:11:56 Result is kept for 500 seconds
20:11:56 
20:11:56 *** Listening on chapters, profiles, reviews...
20:11:56 reviews: fanfic.jobs.crawl_reviews(11935508) (50cabedc-6c18-4623-b6ef-af5c6b90f5a2)
20:12:06 reviews: Job OK (50cabedc-6c18-4623-b6ef-af5c6b90f5a2)
20:12:06 Result is kept for 500 seconds
20:12:06 
20:12:06 *** Listening on chapters, profiles, reviews...
20:12:06 reviews: fanfic.jobs.crawl_reviews(11936311) (16147706-630a-4466-b6c7-ed1f6d572745)
20:13:23 reviews: Job OK (16147706-630a-4466-b6c7-ed1f6d572745)
20:13:23 Result is kept for 500 seconds
20:13:23 
20:13:23 *** Listening on chapters, profiles, reviews...
20:13:23 reviews: fanfic.jobs.crawl_reviews(11937610) (bfed288a-217f-4449-a32a-fa1084ceb921)
20:13:28 reviews: Job OK (bfed288a-217f-4449-a32a-fa1084ceb921)
20:13:28 Result is kept for 500 seconds
20:13:28 
20:13:28 *** Listening on chapters, profiles, reviews...
20:13:28 reviews: fanfic.jobs.crawl_reviews(11937834) (cf75c67c-f9f2-4e61-bd03-067a3a0e5901)
20:13:37 reviews: Job OK (cf75c67c-f9f2-4e61-bd03-067a3a0e5901)
20:13:37 Result is kept for 500 seconds
20:13:37 
20:13:37 *** Listening on chapters, profiles, reviews...
20:13:37 reviews: fanfic.jobs.crawl_reviews(11938186) (17f5013f-851e-4ec6-bbe5-eedff2902432)
20:16:02 reviews: Job OK (17f5013f-851e-4ec6-bbe5-eedff2902432)
20:16:02 Result is kept for 500 seconds
20:16:02 
20:16:02 *** Listening on chapters, profiles, reviews...
20:16:02 reviews: fanfic.jobs.crawl_reviews(11939463) (6e1b3137-ff6f-4dcb-a275-17ec9d376b72)
2017-02-09 20:16:08 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 04:16:08.612697', 11939463, 245148016, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7468187&amp;r ... (861 characters truncated) ... 2200356">12/19/2016</span> </small><div style="margin-top:5px">A fresh plot with creative writing equals a great story...Well-done!</div></td>\n</tr>'), ('2017-02-10 04:16:08.612701', 11939463, 242581525, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6463369&amp;r ... (1009 characters truncated) ... \'s Godric and Salazar(if that\'s even the right spelling lol) but you accidentally spelt it with a Z. Also I\'m loving this story!</div></td>\n</tr>'), ('2017-02-10 04:16:08.612704', 11939463, 239857193, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4981314&amp;r ... (908 characters truncated) ... ="color:gray">chapter 1 . <span data-xutime="1469400971">7/24/2016</span> </small><div style="margin-top:5px">This gonna be awesome</div></td>\n</tr>'), ('2017-02-10 04:16:08.612706', 11939463, 238227246, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1629454&amp;r ... (1008 characters truncated) ... posite sex. That would make them fraternal twins. Otherwise,l am enjoying the story. Love that little James is so taken with Draco.</div></td>\n</tr>'), ('2017-02-10 04:16:08.612708', 11939463, 238077350, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1893720&amp;r ... (1183 characters truncated) ... more. I\'m sick of them being parents so fast, I was hoping to enjoy the ride of them evolving more before or if they had children.</div></td>\n</tr>'), ('2017-02-10 04:16:08.612710', 11939463, 238073825, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1893720&amp;r ... (1033 characters truncated) ... two together, I cant stand the fakeness of \'my dearest\' and \'my darling\' just had to say that. liking the fic othet than that..</div></td>\n</tr>'), ('2017-02-10 04:16:08.612712', 11939463, 238072489, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1893720&amp;r ... (921 characters truncated) ...  . <span data-xutime="1465730710">6/12/2016</span> </small><div style="margin-top:5px">the moment wasn\'t lost. that was beautiful.</div></td>\n</tr>'), ('2017-02-10 04:16:08.612714', 11939463, 237830478, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1733278&amp;r ... (1301 characters truncated) ... ild up to the perfect marriage and then rebuilding their love after the accident... Just... ahhh! Absolutely perfect and wonderful!</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-10 04:16:08.612742', 11939463, 236765610, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5728043&amp;r ... (839 characters truncated) ... utime="1462920037">5/10/2016</span> </small><div style="margin-top:5px">Love love love this story! Looking forward to reading more!</div></td>\n</tr>'), ('2017-02-10 04:16:08.612744', 11939463, 236764237, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3874688&amp;r ... (965 characters truncated) ... > </small><div style="margin-top:5px">I love it! I love it! I LOVE It! ️️️ Please continue with your story, I am in love. Congrats!</div></td>\n</tr>'))]
20:16:08 reviews: Job OK (6e1b3137-ff6f-4dcb-a275-17ec9d376b72)
20:16:08 Result is kept for 500 seconds
20:16:08 
20:16:08 *** Listening on chapters, profiles, reviews...
20:16:08 reviews: fanfic.jobs.crawl_reviews(11942420) (9161d5d0-ee52-4f55-a217-4d32673ae76f)
20:16:41 reviews: Job OK (9161d5d0-ee52-4f55-a217-4d32673ae76f)
20:16:41 Result is kept for 500 seconds
20:16:41 
20:16:41 *** Listening on chapters, profiles, reviews...
20:16:41 reviews: fanfic.jobs.crawl_reviews(11943635) (92305b43-fcb8-4fa5-bba7-162fc6e15932)
20:18:47 reviews: Job OK (92305b43-fcb8-4fa5-bba7-162fc6e15932)
20:18:47 Result is kept for 500 seconds
20:18:48 
20:18:48 *** Listening on chapters, profiles, reviews...
20:18:48 reviews: fanfic.jobs.crawl_reviews(11944747) (929a0ab8-dec5-4db9-a316-f65d578517ab)
20:19:18 reviews: Job OK (929a0ab8-dec5-4db9-a316-f65d578517ab)
20:19:18 Result is kept for 500 seconds
20:19:18 
20:19:18 *** Listening on chapters, profiles, reviews...
20:19:18 reviews: fanfic.jobs.crawl_reviews(11945544) (d768d08c-243e-48a3-9dd1-1da572e7f4d9)
20:20:12 reviews: Job OK (d768d08c-243e-48a3-9dd1-1da572e7f4d9)
20:20:12 Result is kept for 500 seconds
20:20:12 
20:20:12 *** Listening on chapters, profiles, reviews...
20:20:12 reviews: fanfic.jobs.crawl_reviews(11946284) (45ed2799-a695-4f1f-9e7a-8d62b504f6c5)
20:24:01 reviews: Job OK (45ed2799-a695-4f1f-9e7a-8d62b504f6c5)
20:24:01 Result is kept for 500 seconds
20:24:01 
20:24:01 *** Listening on chapters, profiles, reviews...
20:24:01 reviews: fanfic.jobs.crawl_reviews(11948586) (7305769a-fd31-45db-b7de-44bc8e6b7ceb)
2017-02-09 20:24:06 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 04:24:06.545865', 11948586, 244494339, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2777733&amp;r ... (1163 characters truncated) ... , there is also the fact you haven\'t done much with Lupin\'s teaching and haven\'t made any mention about Sirius escaping Azkaban.</div></td>\n</tr>'), ('2017-02-10 04:24:06.545869', 11948586, 241896855, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4999737&amp;r ... (938 characters truncated) ... ry 2 days ago and I just finished reading it. I just wanted to say that this was a really good story and I did enjoy reading it. :)</div></td>\n</tr>'), ('2017-02-10 04:24:06.545871', 11948586, 240121084, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6773548&amp;r ... (1530 characters truncated) ... ally at the end of the year to found out Harry\'s godfather crisis, switching secret keeper stuff and werewolf teacher at the boot.</div></td>\n</tr>'), ('2017-02-10 04:24:06.545873', 11948586, 238230783, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=82131&amp;rwi ... (843 characters truncated) ... a-xutime="1466051835">6/15/2016</span> </small><div style="margin-top:5px">Totally non-canon, but I still enjoyed it a lot. Thanks!</div></td>\n</tr>'), ('2017-02-10 04:24:06.545875', 11948586, 238001564, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6354692&amp;r ... (4195 characters truncated) ... to write a sequel. now. :D<br>\nVale et maior fias! (sorry about typos and lack of capitalization, I\'m typing this on my phone :P)</div></td>\n</tr>'), ('2017-02-10 04:24:06.545877', 11948586, 237825148, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (626 characters truncated) ... x">Great Story. I hope there will be a sequel to this. I thought the character of Petunia Dursley in particular was very well done.</div></td>\n</tr>'), ('2017-02-10 04:24:06.545879', 11948586, 237268173, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7343098&amp;r ... (903 characters truncated) ... ll style="color:gray">chapter 16 . <span data-xutime="1464020877">5/23/2016</span> </small><div style="margin-top:5px">More please!</div></td>\n</tr>'), ('2017-02-10 04:24:06.545881', 11948586, 237195395, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (550 characters truncated) ...  data-xutime="1463696696">5/19/2016</span> </small><div style="margin-top:5px">Very nice! Thank You for the hours of entertainment!</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-10 04:24:06.545908', 11948586, 237001693, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=661417&amp;rw ... (893 characters truncated) ... ><div style="margin-top:5px">Quite an enjoyable story. I liked your take on the Dursleys, have not seen one quite like that before.</div></td>\n</tr>'), ('2017-02-10 04:24:06.545910', 11948586, 236988857, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4146730&amp;r ... (916 characters truncated) ... or:gray">chapter 16 . <span data-xutime="1463415654">5/16/2016</span> </small><div style="margin-top:5px">Great chapter update soon</div></td>\n</tr>'))]
20:24:06 reviews: Job OK (7305769a-fd31-45db-b7de-44bc8e6b7ceb)
20:24:06 Result is kept for 500 seconds
20:24:06 
20:24:06 *** Listening on chapters, profiles, reviews...
20:24:06 reviews: fanfic.jobs.crawl_reviews(11949461) (6e6c152d-0f6a-4ddd-9959-9a0fc202656f)
20:24:20 reviews: Job OK (6e6c152d-0f6a-4ddd-9959-9a0fc202656f)
20:24:20 Result is kept for 500 seconds
20:24:20 
20:24:20 *** Listening on chapters, profiles, reviews...
20:24:20 reviews: fanfic.jobs.crawl_reviews(11950093) (fefe0ebb-eb5f-415f-817b-02aae558f701)
20:24:43 reviews: Job OK (fefe0ebb-eb5f-415f-817b-02aae558f701)
20:24:43 Result is kept for 500 seconds
20:24:43 
20:24:43 *** Listening on chapters, profiles, reviews...
20:24:43 reviews: fanfic.jobs.crawl_reviews(11950451) (5a646bc1-5d00-495f-8065-63fc38528001)
20:30:13 reviews: Job OK (5a646bc1-5d00-495f-8065-63fc38528001)
20:30:13 Result is kept for 500 seconds
20:30:13 
20:30:13 *** Listening on chapters, profiles, reviews...
20:30:13 reviews: fanfic.jobs.crawl_reviews(11950816) (e661af80-603f-483c-9137-403bf0b58b3e)
20:47:11 reviews: Job OK (e661af80-603f-483c-9137-403bf0b58b3e)
20:47:11 Result is kept for 500 seconds
20:47:11 
20:47:11 *** Listening on chapters, profiles, reviews...
20:47:11 reviews: fanfic.jobs.crawl_reviews(11951348) (d3a4757b-0a5d-4ff1-9a1b-4aef3efa96dd)
20:47:52 reviews: Job OK (d3a4757b-0a5d-4ff1-9a1b-4aef3efa96dd)
20:47:52 Result is kept for 500 seconds
20:47:52 
20:47:52 *** Listening on chapters, profiles, reviews...
20:47:52 reviews: fanfic.jobs.crawl_reviews(11951439) (db075d2a-89ba-44da-ae6a-66085760a5ef)
2017-02-09 20:47:58 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 04:47:58.414139', 11951439, 243512451, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (724 characters truncated) ... t a CEO at Grunnings; he\'d have a much nicer house if he was a CEO. And his girlfriend already being a dentist is unrealistic too.</div></td>\n</tr>'), ('2017-02-10 04:47:58.414143', 11951439, 242813118, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2293010&amp;r ... (924 characters truncated) ... y had also landed her dream job as a dentist.<br>\nWas she older than him? She would have to study a few years to become a dentist.</div></td>\n</tr>'), ('2017-02-10 04:47:58.414146', 11951439, 240096221, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5242946&amp;r ... (1170 characters truncated) ...  they communicate? her mother can\'t have told her about witches and wizards without telling her that they write letters using owl.</div></td>\n</tr>'), ('2017-02-10 04:47:58.414148', 11951439, 239732807, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5577791&amp;r ... (824 characters truncated) ... chapter 22 . <span data-xutime="1469140544">7/21/2016</span> </small><div style="margin-top:5px">Yay they won! Thanks for updating!</div></td>\n</tr>'), ('2017-02-10 04:47:58.414150', 11951439, 239277394, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=293911&amp;rw ... (859 characters truncated) ... 854">7/10/2016</span> </small><div style="margin-top:5px">Heck of a cliffhanger there! Enjoying the story and hope you update soon.</div></td>\n</tr>'), ('2017-02-10 04:47:58.414151', 11951439, 239053141, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=82131&amp;rwi ... (875 characters truncated) ... /small><div style="margin-top:5px">I’m enjoying your story. My only gripe is that you keep bouncing between present and past tense.</div></td>\n</tr>'), ('2017-02-10 04:47:58.414153', 11951439, 239045268, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5577791&amp;r ... (837 characters truncated) ... <span data-xutime="1467730600">7/5/2016</span> </small><div style="margin-top:5px">Not again! Thanks for updating! I hate dementors</div></td>\n</tr>'), ('2017-02-10 04:47:58.414155', 11951439, 238978286, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1081 characters truncated) ... ite a review cause I dont have all the time I would want I apreciate your dedication. Love, hugs and a beg for an update,<br>\nNim.</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-10 04:47:58.414192', 11951439, 237159830, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (4393 characters truncated) ...  you to consider in the future... vague few ideas for another sort of story you might try if you write more Dursley centric fics...</div></td>\n</tr>'), ('2017-02-10 04:47:58.414193', 11951439, 237158876, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5577791&amp;r ... (966 characters truncated) ... e soon! Oh shit this has to do with the new book release cursed child? Your story is so detailed! You should have way more reviews!</div></td>\n</tr>'))]
20:47:58 reviews: Job OK (db075d2a-89ba-44da-ae6a-66085760a5ef)
20:47:58 Result is kept for 500 seconds
20:47:58 
20:47:58 *** Listening on chapters, profiles, reviews...
20:47:58 reviews: fanfic.jobs.crawl_reviews(11951854) (820b1988-37de-4fee-a458-bc9a980f2730)
20:48:16 reviews: Job OK (820b1988-37de-4fee-a458-bc9a980f2730)
20:48:16 Result is kept for 500 seconds
20:48:16 
20:48:16 *** Listening on chapters, profiles, reviews...
20:48:16 reviews: fanfic.jobs.crawl_reviews(11951885) (b6fa8ee7-69bd-4f58-af3e-9bf5e6f87441)
20:48:56 reviews: Job OK (b6fa8ee7-69bd-4f58-af3e-9bf5e6f87441)
20:48:56 Result is kept for 500 seconds
20:48:56 
20:48:56 *** Listening on chapters, profiles, reviews...
20:48:56 reviews: fanfic.jobs.crawl_reviews(11952010) (bb029e3b-62c2-42ea-8e0e-dc20ac08caba)
20:49:10 reviews: Job OK (bb029e3b-62c2-42ea-8e0e-dc20ac08caba)
20:49:10 Result is kept for 500 seconds
20:49:10 
20:49:10 *** Listening on chapters, profiles, reviews...
20:49:10 reviews: fanfic.jobs.crawl_reviews(11952600) (5a03e7e0-ab52-4a73-b7f4-c8214d33e879)
20:49:34 reviews: Job OK (5a03e7e0-ab52-4a73-b7f4-c8214d33e879)
20:49:34 Result is kept for 500 seconds
20:49:34 
20:49:34 *** Listening on chapters, profiles, reviews...
20:49:34 reviews: fanfic.jobs.crawl_reviews(11953152) (81135519-1ef3-4638-80e7-6cb8503b6099)
20:49:39 reviews: Job OK (81135519-1ef3-4638-80e7-6cb8503b6099)
20:49:39 Result is kept for 500 seconds
20:49:39 
20:49:39 *** Listening on chapters, profiles, reviews...
20:49:39 reviews: fanfic.jobs.crawl_reviews(11953341) (42be2005-196d-42f7-afd7-3b2e94f2364c)
20:50:38 reviews: Job OK (42be2005-196d-42f7-afd7-3b2e94f2364c)
20:50:38 Result is kept for 500 seconds
20:50:38 Cleaning registries for queue: chapters
20:50:38 Cleaning registries for queue: profiles
20:50:38 Cleaning registries for queue: reviews
20:50:38 
20:50:38 *** Listening on chapters, profiles, reviews...
20:50:38 reviews: fanfic.jobs.crawl_reviews(11954796) (2aae3bba-630c-47e1-8519-d56cd45070bb)
20:51:24 reviews: Job OK (2aae3bba-630c-47e1-8519-d56cd45070bb)
20:51:24 Result is kept for 500 seconds
20:51:24 
20:51:24 *** Listening on chapters, profiles, reviews...
20:51:24 reviews: fanfic.jobs.crawl_reviews(11955570) (b45734c9-14b6-4b9a-a27d-d302dacd2c8a)
20:56:11 reviews: Job OK (b45734c9-14b6-4b9a-a27d-d302dacd2c8a)
20:56:11 Result is kept for 500 seconds
20:56:11 
20:56:11 *** Listening on chapters, profiles, reviews...
20:56:11 reviews: fanfic.jobs.crawl_reviews(11955574) (cee4f241-0ff4-4f5a-8c6e-89df70fbc809)
20:59:26 reviews: Job OK (cee4f241-0ff4-4f5a-8c6e-89df70fbc809)
20:59:26 Result is kept for 500 seconds
20:59:26 
20:59:26 *** Listening on chapters, profiles, reviews...
20:59:26 reviews: fanfic.jobs.crawl_reviews(11956922) (3f99d9da-aceb-4340-a332-c78cc9232be1)
21:01:21 reviews: Job OK (3f99d9da-aceb-4340-a332-c78cc9232be1)
21:01:21 Result is kept for 500 seconds
21:01:21 
21:01:21 *** Listening on chapters, profiles, reviews...
21:01:21 reviews: fanfic.jobs.crawl_reviews(11957359) (0e76900b-c945-4ebb-93ee-53aa3f36baa5)
21:02:32 reviews: Job OK (0e76900b-c945-4ebb-93ee-53aa3f36baa5)
21:02:32 Result is kept for 500 seconds
21:02:32 
21:02:32 *** Listening on chapters, profiles, reviews...
21:02:32 reviews: fanfic.jobs.crawl_reviews(11959536) (976bed2b-a002-4883-be0e-9262ff2268c1)
21:02:41 reviews: Job OK (976bed2b-a002-4883-be0e-9262ff2268c1)
21:02:41 Result is kept for 500 seconds
21:02:41 
21:02:41 *** Listening on chapters, profiles, reviews...
21:02:41 reviews: fanfic.jobs.crawl_reviews(11959613) (305be874-9ce5-4887-b73e-f0e48a1bea20)
21:03:24 reviews: Job OK (305be874-9ce5-4887-b73e-f0e48a1bea20)
21:03:24 Result is kept for 500 seconds
21:03:24 
21:03:24 *** Listening on chapters, profiles, reviews...
21:03:24 reviews: fanfic.jobs.crawl_reviews(11959644) (c09d0a68-c9f7-46ed-89bd-30a9c984ea06)
2017-02-09 21:03:28 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 05:03:28.727469', 11959644, 243402100, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7206060&amp;r ... (833 characters truncated) ... n data-xutime="1477695263">10/28/2016</span> </small><div style="margin-top:5px">really enjoying this fic so far please update soon</div></td>\n</tr>'), ('2017-02-10 05:03:28.727474', 11959644, 243402100, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7206060&amp;r ... (833 characters truncated) ... n data-xutime="1477695263">10/28/2016</span> </small><div style="margin-top:5px">really enjoying this fic so far please update soon</div></td>\n</tr>'))]
21:03:28 reviews: Job OK (c09d0a68-c9f7-46ed-89bd-30a9c984ea06)
21:03:28 Result is kept for 500 seconds
21:03:28 
21:03:28 *** Listening on chapters, profiles, reviews...
21:03:28 reviews: fanfic.jobs.crawl_reviews(11959837) (f1438633-1a70-4219-9b46-4cd3ce858064)
21:04:32 reviews: Job OK (f1438633-1a70-4219-9b46-4cd3ce858064)
21:04:32 Result is kept for 500 seconds
21:04:32 
21:04:32 *** Listening on chapters, profiles, reviews...
21:04:32 reviews: fanfic.jobs.crawl_reviews(11962029) (9f811499-cb19-4ed6-923b-d180673cf5ed)
21:04:59 reviews: Job OK (9f811499-cb19-4ed6-923b-d180673cf5ed)
21:04:59 Result is kept for 500 seconds
21:04:59 
21:04:59 *** Listening on chapters, profiles, reviews...
21:04:59 reviews: fanfic.jobs.crawl_reviews(11962963) (50642a4b-aaa7-4efb-b5bb-17f724b4623f)
21:05:12 reviews: Job OK (50642a4b-aaa7-4efb-b5bb-17f724b4623f)
21:05:12 Result is kept for 500 seconds
21:05:12 
21:05:12 *** Listening on chapters, profiles, reviews...
21:05:12 reviews: fanfic.jobs.crawl_reviews(11963202) (19b263e6-269a-41c2-86e3-436e6714fac1)
21:08:14 reviews: Job OK (19b263e6-269a-41c2-86e3-436e6714fac1)
21:08:14 Result is kept for 500 seconds
21:08:14 
21:08:14 *** Listening on chapters, profiles, reviews...
21:08:14 reviews: fanfic.jobs.crawl_reviews(11965672) (3f45f5aa-5cd7-47e4-91f8-ab2f24d9120d)
21:08:20 reviews: Job OK (3f45f5aa-5cd7-47e4-91f8-ab2f24d9120d)
21:08:20 Result is kept for 500 seconds
21:08:20 
21:08:20 *** Listening on chapters, profiles, reviews...
21:08:20 reviews: fanfic.jobs.crawl_reviews(11968657) (bb5c3326-1bd3-4ba8-880c-2783e9570ef1)
21:09:44 reviews: Job OK (bb5c3326-1bd3-4ba8-880c-2783e9570ef1)
21:09:44 Result is kept for 500 seconds
21:09:44 
21:09:44 *** Listening on chapters, profiles, reviews...
21:09:44 reviews: fanfic.jobs.crawl_reviews(11968867) (d852c4e0-d20d-4743-a49c-99d73bab96b4)
21:09:57 reviews: Job OK (d852c4e0-d20d-4743-a49c-99d73bab96b4)
21:09:57 Result is kept for 500 seconds
21:09:57 
21:09:57 *** Listening on chapters, profiles, reviews...
21:09:57 reviews: fanfic.jobs.crawl_reviews(11971379) (1a5e7196-5032-416f-8093-397d59681811)
21:10:35 reviews: Job OK (1a5e7196-5032-416f-8093-397d59681811)
21:10:35 Result is kept for 500 seconds
21:10:35 
21:10:35 *** Listening on chapters, profiles, reviews...
21:10:35 reviews: fanfic.jobs.crawl_reviews(11972103) (6578974e-85d2-47f7-8949-c3013388e9e4)
2017-02-09 21:10:40 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 05:10:40.486308', 11972103, 237966602, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (577 characters truncated) ... 2016</span> </small><div style="margin-top:5px">So exciting! Can\'t wait for the next chapters! J.K. Rowling could use your talent!</div></td>\n</tr>'), ('2017-02-10 05:10:40.486314', 11972103, 237565972, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (529 characters truncated) ... y">chapter 2 . <span data-xutime="1464658735">5/30/2016</span> </small><div style="margin-top:5px">Fantastic, can\'t wait for more!</div></td>\n</tr>'), ('2017-02-10 05:10:40.486317', 11972103, 237541035, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5668614&amp;r ... (969 characters truncated) ... 92">5/30/2016</span> </small><div style="margin-top:5px">I am so curious to see where this goes and who exactly Bel\'s parents are.</div></td>\n</tr>'), ('2017-02-10 05:10:40.486319', 11972103, 237966602, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (577 characters truncated) ... 2016</span> </small><div style="margin-top:5px">So exciting! Can\'t wait for the next chapters! J.K. Rowling could use your talent!</div></td>\n</tr>'), ('2017-02-10 05:10:40.486321', 11972103, 237565972, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (529 characters truncated) ... y">chapter 2 . <span data-xutime="1464658735">5/30/2016</span> </small><div style="margin-top:5px">Fantastic, can\'t wait for more!</div></td>\n</tr>'), ('2017-02-10 05:10:40.486323', 11972103, 237541035, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5668614&amp;r ... (969 characters truncated) ... 92">5/30/2016</span> </small><div style="margin-top:5px">I am so curious to see where this goes and who exactly Bel\'s parents are.</div></td>\n</tr>'))]
21:10:40 reviews: Job OK (6578974e-85d2-47f7-8949-c3013388e9e4)
21:10:40 Result is kept for 500 seconds
21:10:40 
21:10:40 *** Listening on chapters, profiles, reviews...
21:10:40 reviews: fanfic.jobs.crawl_reviews(11972394) (eb92c314-943b-42dd-9e85-6685927d5eaf)
21:10:45 reviews: Job OK (eb92c314-943b-42dd-9e85-6685927d5eaf)
21:10:45 Result is kept for 500 seconds
21:10:45 
21:10:45 *** Listening on chapters, profiles, reviews...
21:10:45 reviews: fanfic.jobs.crawl_reviews(11975546) (ea2f44a2-e80f-42d7-9d09-0407a7e64da7)
21:13:46 reviews: Job OK (ea2f44a2-e80f-42d7-9d09-0407a7e64da7)
21:13:46 Result is kept for 500 seconds
21:13:46 
21:13:46 *** Listening on chapters, profiles, reviews...
21:13:46 reviews: fanfic.jobs.crawl_reviews(11976184) (bce4564a-0808-4444-b575-35da522394db)
21:14:15 reviews: Job OK (bce4564a-0808-4444-b575-35da522394db)
21:14:15 Result is kept for 500 seconds
21:14:15 
21:14:15 *** Listening on chapters, profiles, reviews...
21:14:15 reviews: fanfic.jobs.crawl_reviews(11977074) (dd67081a-f819-440f-8640-5fc26383c64a)
21:14:56 reviews: Job OK (dd67081a-f819-440f-8640-5fc26383c64a)
21:14:56 Result is kept for 500 seconds
21:14:56 
21:14:56 *** Listening on chapters, profiles, reviews...
21:14:56 reviews: fanfic.jobs.crawl_reviews(11977325) (333e25de-afa0-4f10-89ad-0871fa5c2910)
2017-02-09 21:14:58 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/11977325/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
21:14:58 reviews: Job OK (333e25de-afa0-4f10-89ad-0871fa5c2910)
21:14:58 Result is kept for 500 seconds
21:14:58 
21:14:58 *** Listening on chapters, profiles, reviews...
21:14:58 reviews: fanfic.jobs.crawl_reviews(11978189) (ba7ed35e-da2a-49b0-bcc7-a9fced45f81c)
21:15:21 reviews: Job OK (ba7ed35e-da2a-49b0-bcc7-a9fced45f81c)
21:15:21 Result is kept for 500 seconds
21:15:21 
21:15:21 *** Listening on chapters, profiles, reviews...
21:15:21 reviews: fanfic.jobs.crawl_reviews(11979142) (5e2df477-0d68-49b3-80b0-b752eafc7abc)
21:16:07 reviews: Job OK (5e2df477-0d68-49b3-80b0-b752eafc7abc)
21:16:07 Result is kept for 500 seconds
21:16:07 
21:16:07 *** Listening on chapters, profiles, reviews...
21:16:07 reviews: fanfic.jobs.crawl_reviews(11979368) (c54f8e6a-f56a-47d8-b4f1-ff60365368df)
21:19:27 reviews: Job OK (c54f8e6a-f56a-47d8-b4f1-ff60365368df)
21:19:27 Result is kept for 500 seconds
21:19:27 
21:19:27 *** Listening on chapters, profiles, reviews...
21:19:27 reviews: fanfic.jobs.crawl_reviews(11979416) (00d80964-3d6f-48e3-bb50-e971630f75a8)
21:19:46 reviews: Job OK (00d80964-3d6f-48e3-bb50-e971630f75a8)
21:19:46 Result is kept for 500 seconds
21:19:46 
21:19:46 *** Listening on chapters, profiles, reviews...
21:19:46 reviews: fanfic.jobs.crawl_reviews(11981524) (69ac820e-d353-4714-a96b-7e900299349c)
21:19:51 reviews: Job OK (69ac820e-d353-4714-a96b-7e900299349c)
21:19:51 Result is kept for 500 seconds
21:19:51 
21:19:51 *** Listening on chapters, profiles, reviews...
21:19:51 reviews: fanfic.jobs.crawl_reviews(11981776) (0ca2fe12-30fc-4547-b61d-332957a2a3e5)
21:23:29 reviews: Job OK (0ca2fe12-30fc-4547-b61d-332957a2a3e5)
21:23:29 Result is kept for 500 seconds
21:23:29 
21:23:29 *** Listening on chapters, profiles, reviews...
21:23:29 reviews: fanfic.jobs.crawl_reviews(11982002) (c956cc03-3bd0-4899-bb37-c1fa47b715c4)
21:23:38 reviews: Job OK (c956cc03-3bd0-4899-bb37-c1fa47b715c4)
21:23:38 Result is kept for 500 seconds
21:23:38 
21:23:38 *** Listening on chapters, profiles, reviews...
21:23:38 reviews: fanfic.jobs.crawl_reviews(11983962) (3766e12b-44af-4593-9584-b634015373d3)
21:23:48 reviews: Job OK (3766e12b-44af-4593-9584-b634015373d3)
21:23:48 Result is kept for 500 seconds
21:23:48 
21:23:48 *** Listening on chapters, profiles, reviews...
21:23:48 reviews: fanfic.jobs.crawl_reviews(11984075) (212d4a4c-d617-4224-b59e-00cf6654de08)
2017-02-09 21:23:53 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 05:23:53.143811', 11984075, 246941874, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (652 characters truncated) ... tinuation. Could do with some proof reading and the bathroom play isn\'t really my thing but I was quite entertained by your story.</div></td>\n</tr>'), ('2017-02-10 05:23:53.143816', 11984075, 244229491, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (562 characters truncated) ... ="1479839704">11/22/2016</span> </small><div style="margin-top:5px">Are you still writing this? I hope you didn\'t get discouraged.</div></td>\n</tr>'), ('2017-02-10 05:23:53.143819', 11984075, 243345465, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5759984&amp;r ... (1060 characters truncated) ...  like bits and peices i wanna read more of Hermione actually dominating Hadiee not just using her but other than that this is great</div></td>\n</tr>'), ('2017-02-10 05:23:53.143821', 11984075, 241993089, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=577345&amp;rw ... (1390 characters truncated) ... n and then end of lemon, but there isn\'t anything in that part of the story. If you plan on doing an m story put the lemons in it.</div></td>\n</tr>'), ('2017-02-10 05:23:53.143823', 11984075, 239430091, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (737 characters truncated) ... number to. <br>\n600099046<br>\nAt HP dot adult-fanfiction dot org<br>\n<br>\nOr no spaces<br>\nhp. adult-fanfiction ? no 600099046</div></td>\n</tr>'), ('2017-02-10 05:23:53.143825', 11984075, 239429647, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1552 characters truncated) ... le/Female <br>\n<br>\nContent Tags : Anal Anthro BDSM Beast Bigotry Ds FD Fet FF GB Humil M/s OC Slave Spank TF Trans WIP WS \'""""</div></td>\n</tr>'), ('2017-02-10 05:23:53.143827', 11984075, 239004009, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5247670&amp;r ... (866 characters truncated) ...   <small style="color:gray">chapter 9 . <span data-xutime="1467645184">7/4/2016</span> </small><div style="margin-top:5px">,umHarem</div></td>\n</tr>'), ('2017-02-10 05:23:53.143829', 11984075, 238278753, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1164 characters truncated) ... ugh I\'m wondering just what is going on with the Dursleys. Also if Petunia happens to have a blocked creature inheritance as well.</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-10 05:23:53.143852', 11984075, 238131459, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (766 characters truncated) ... dn\'t work for freshening the air, though. I can only imagine that Mrs. Weasley got it from a book on plagues during an Egypt trip.</div></td>\n</tr>'), ('2017-02-10 05:23:53.143854', 11984075, 237873154, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2180084&amp;r ... (885 characters truncated) ...  style="margin-top:5px">Please check spelling and word usage. I enjoy where your story is going. Please find a beta reader to help.</div></td>\n</tr>'))]
21:23:53 reviews: Job OK (212d4a4c-d617-4224-b59e-00cf6654de08)
21:23:53 Result is kept for 500 seconds
21:23:53 
21:23:53 *** Listening on chapters, profiles, reviews...
21:23:53 reviews: fanfic.jobs.crawl_reviews(11984396) (5948884a-bde3-47be-afb6-69405cccd164)
21:24:00 reviews: Job OK (5948884a-bde3-47be-afb6-69405cccd164)
21:24:00 Result is kept for 500 seconds
21:24:00 
21:24:00 *** Listening on chapters, profiles, reviews...
21:24:00 reviews: fanfic.jobs.crawl_reviews(11984787) (180590bb-286e-44b9-9ce1-a15717d337cf)
21:25:26 reviews: Job OK (180590bb-286e-44b9-9ce1-a15717d337cf)
21:25:26 Result is kept for 500 seconds
21:25:26 
21:25:26 *** Listening on chapters, profiles, reviews...
21:25:26 reviews: fanfic.jobs.crawl_reviews(11984815) (6d25a08b-97fb-4a99-9ec7-fe098a8cc55c)
21:26:51 reviews: Job OK (6d25a08b-97fb-4a99-9ec7-fe098a8cc55c)
21:26:51 Result is kept for 500 seconds
21:26:51 
21:26:51 *** Listening on chapters, profiles, reviews...
21:26:51 reviews: fanfic.jobs.crawl_reviews(11985313) (40106d14-1b95-4248-bca8-d4320198f746)
21:27:54 reviews: Job OK (40106d14-1b95-4248-bca8-d4320198f746)
21:27:54 Result is kept for 500 seconds
21:27:54 
21:27:54 *** Listening on chapters, profiles, reviews...
21:27:54 reviews: fanfic.jobs.crawl_reviews(11985844) (068b01b2-1779-4a52-a9b4-48f1efda003c)
21:28:14 reviews: Job OK (068b01b2-1779-4a52-a9b4-48f1efda003c)
21:28:14 Result is kept for 500 seconds
21:28:14 
21:28:14 *** Listening on chapters, profiles, reviews...
21:28:14 reviews: fanfic.jobs.crawl_reviews(11987759) (f39823a9-ab15-43c6-a367-7796594fd533)
21:30:20 reviews: Job OK (f39823a9-ab15-43c6-a367-7796594fd533)
21:30:20 Result is kept for 500 seconds
21:30:20 
21:30:20 *** Listening on chapters, profiles, reviews...
21:30:20 reviews: fanfic.jobs.crawl_reviews(11990559) (7f273bee-5d03-41aa-856c-7c9fdf303f3a)
21:31:33 reviews: Job OK (7f273bee-5d03-41aa-856c-7c9fdf303f3a)
21:31:33 Result is kept for 500 seconds
21:31:33 
21:31:33 *** Listening on chapters, profiles, reviews...
21:31:33 reviews: fanfic.jobs.crawl_reviews(11992452) (16571ee7-9641-4728-bf9e-83b7c5b91e11)
21:31:59 reviews: Job OK (16571ee7-9641-4728-bf9e-83b7c5b91e11)
21:31:59 Result is kept for 500 seconds
21:31:59 
21:31:59 *** Listening on chapters, profiles, reviews...
21:31:59 reviews: fanfic.jobs.crawl_reviews(11992486) (031d0692-08ae-4288-a4d6-bd858b06f1c7)
21:32:24 reviews: Job OK (031d0692-08ae-4288-a4d6-bd858b06f1c7)
21:32:24 Result is kept for 500 seconds
21:32:24 
21:32:24 *** Listening on chapters, profiles, reviews...
21:32:24 reviews: fanfic.jobs.crawl_reviews(11992649) (3fc52e84-5572-45fa-9fc4-13932d7c9e44)
21:33:46 reviews: Job OK (3fc52e84-5572-45fa-9fc4-13932d7c9e44)
21:33:46 Result is kept for 500 seconds
21:33:46 
21:33:46 *** Listening on chapters, profiles, reviews...
21:33:46 reviews: fanfic.jobs.crawl_reviews(11993043) (17648d36-61e3-49db-81c2-0b963bc31022)
21:35:20 reviews: Job OK (17648d36-61e3-49db-81c2-0b963bc31022)
21:35:20 Result is kept for 500 seconds
21:35:20 
21:35:20 *** Listening on chapters, profiles, reviews...
21:35:20 reviews: fanfic.jobs.crawl_reviews(11993131) (3890cdb1-a9a7-4d61-94a4-a4f34d475ab5)
21:35:26 reviews: Job OK (3890cdb1-a9a7-4d61-94a4-a4f34d475ab5)
21:35:26 Result is kept for 500 seconds
21:35:26 
21:35:26 *** Listening on chapters, profiles, reviews...
21:35:26 reviews: fanfic.jobs.crawl_reviews(11993731) (97dd19ba-b977-4d0d-ad6b-1a61f9fb5234)
21:35:32 reviews: Job OK (97dd19ba-b977-4d0d-ad6b-1a61f9fb5234)
21:35:32 Result is kept for 500 seconds
21:35:32 
21:35:32 *** Listening on chapters, profiles, reviews...
21:35:32 reviews: fanfic.jobs.crawl_reviews(11993835) (c6c34de4-6d00-4216-a64d-ef2479b043c2)
21:36:34 reviews: Job OK (c6c34de4-6d00-4216-a64d-ef2479b043c2)
21:36:34 Result is kept for 500 seconds
21:36:34 
21:36:34 *** Listening on chapters, profiles, reviews...
21:36:34 reviews: fanfic.jobs.crawl_reviews(11994544) (bb0c697a-33de-46cb-8e3c-87bef2adb012)
21:36:59 reviews: Job OK (bb0c697a-33de-46cb-8e3c-87bef2adb012)
21:36:59 Result is kept for 500 seconds
21:36:59 
21:36:59 *** Listening on chapters, profiles, reviews...
21:36:59 reviews: fanfic.jobs.crawl_reviews(11994979) (e9cb4cd0-c731-4723-9979-fae6e92d9ce0)
2017-02-09 21:37:04 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 05:37:04.329292', 11994979, 243886695, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1540 characters truncated) ... ncertain point. Is Tom mortally wounded? Is there a redemption for him? Your story seems to be winding down but it\'s not complete.</div></td>\n</tr>'), ('2017-02-10 05:37:04.329296', 11994979, 243189937, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4301542&amp;r ... (988 characters truncated) ... <div style="margin-top:5px">I can\'t understand why they would call this boy Tom Riddle. It just feeds the prejudice already there.</div></td>\n</tr>'), ('2017-02-10 05:37:04.329298', 11994979, 242345224, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (624 characters truncated) ... x">i\'ll read whatever you end up doing with this story, honestly, i just enjoy the idea and the tom riddle you\'ve written so much</div></td>\n</tr>'), ('2017-02-10 05:37:04.329300', 11994979, 240372319, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6058843&amp;r ... (1570 characters truncated) ...  just feel like there\'s not enough character development and it\'s causing the story to lose its charm. Sorry, I had to stop here.</div></td>\n</tr>'), ('2017-02-10 05:37:04.329302', 11994979, 238318583, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2302522&amp;r ... (890 characters truncated) ... yle="color:gray">chapter 50 . <span data-xutime="1466249074">6/18/2016</span> </small><div style="margin-top:5px">Interesting stuff</div></td>\n</tr>'), ('2017-02-10 05:37:04.329304', 11994979, 238226311, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3945804&amp;r ... (902 characters truncated) ... >chapter 3 . <span data-xutime="1466044304">6/15/2016</span> </small><div style="margin-top:5px">no! get him out of that orphanage!</div></td>\n</tr>'), ('2017-02-10 05:37:04.329306', 11994979, 243886695, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1540 characters truncated) ... ncertain point. Is Tom mortally wounded? Is there a redemption for him? Your story seems to be winding down but it\'s not complete.</div></td>\n</tr>'), ('2017-02-10 05:37:04.329308', 11994979, 243189937, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4301542&amp;r ... (988 characters truncated) ... <div style="margin-top:5px">I can\'t understand why they would call this boy Tom Riddle. It just feeds the prejudice already there.</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-10 05:37:04.329314', 11994979, 238318583, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2302522&amp;r ... (890 characters truncated) ... yle="color:gray">chapter 50 . <span data-xutime="1466249074">6/18/2016</span> </small><div style="margin-top:5px">Interesting stuff</div></td>\n</tr>'), ('2017-02-10 05:37:04.329316', 11994979, 238226311, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3945804&amp;r ... (902 characters truncated) ... >chapter 3 . <span data-xutime="1466044304">6/15/2016</span> </small><div style="margin-top:5px">no! get him out of that orphanage!</div></td>\n</tr>'))]
21:37:04 reviews: Job OK (e9cb4cd0-c731-4723-9979-fae6e92d9ce0)
21:37:04 Result is kept for 500 seconds
21:37:04 
21:37:04 *** Listening on chapters, profiles, reviews...
21:37:04 reviews: fanfic.jobs.crawl_reviews(11995244) (501c9baf-cf87-41eb-b767-57c46dd89907)
21:37:43 reviews: Job OK (501c9baf-cf87-41eb-b767-57c46dd89907)
21:37:43 Result is kept for 500 seconds
21:37:43 
21:37:43 *** Listening on chapters, profiles, reviews...
21:37:43 reviews: fanfic.jobs.crawl_reviews(11995519) (0375ba98-e8cc-4e6a-a1fa-c8c784258e7e)
21:41:53 reviews: Job OK (0375ba98-e8cc-4e6a-a1fa-c8c784258e7e)
21:41:53 Result is kept for 500 seconds
21:41:53 
21:41:53 *** Listening on chapters, profiles, reviews...
21:41:53 reviews: fanfic.jobs.crawl_reviews(11995576) (78c0070e-454b-48bb-b63b-77c5e8d15d45)
21:52:45 reviews: Job OK (78c0070e-454b-48bb-b63b-77c5e8d15d45)
21:52:45 Result is kept for 500 seconds
21:52:45 Cleaning registries for queue: chapters
21:52:45 Cleaning registries for queue: profiles
21:52:45 Cleaning registries for queue: reviews
21:52:45 
21:52:45 *** Listening on chapters, profiles, reviews...
21:52:45 reviews: fanfic.jobs.crawl_reviews(11996386) (da02383c-5e16-49cd-9932-1a636fe11c6a)
21:53:13 reviews: Job OK (da02383c-5e16-49cd-9932-1a636fe11c6a)
21:53:13 Result is kept for 500 seconds
21:53:13 
21:53:13 *** Listening on chapters, profiles, reviews...
21:53:13 reviews: fanfic.jobs.crawl_reviews(11996609) (0e884068-1fed-49eb-9792-19a1fc459385)
21:54:03 reviews: Job OK (0e884068-1fed-49eb-9792-19a1fc459385)
21:54:03 Result is kept for 500 seconds
21:54:03 
21:54:03 *** Listening on chapters, profiles, reviews...
21:54:03 reviews: fanfic.jobs.crawl_reviews(11996893) (3ef0206c-a262-44a9-a08e-233ca24492b7)
21:59:29 reviews: Job OK (3ef0206c-a262-44a9-a08e-233ca24492b7)
21:59:29 Result is kept for 500 seconds
21:59:29 
21:59:29 *** Listening on chapters, profiles, reviews...
21:59:29 reviews: fanfic.jobs.crawl_reviews(11998472) (31afcb84-350a-4c3d-9ef8-4f6c8c50de58)
2017-02-09 21:59:33 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 05:59:33.977369', 11998472, 246081623, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8642712&amp;r ... (1025 characters truncated) ... hope you continue with a sequel, this read exceptionally well. I\'m not ashamed to admit I read this in a single day. Keep writing!</div></td>\n</tr>'), ('2017-02-10 05:59:33.977373', 11998472, 243126297, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7686127&amp;r ... (1079 characters truncated) ... ontrived that Sirius happened to be there at that time with every thing else going on and that they didn\'t look for the rat sooner</div></td>\n</tr>'), ('2017-02-10 05:59:33.977376', 11998472, 243096997, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7686127&amp;r ... (821 characters truncated) ... ">chapter 1 . <span data-xutime="1476903684">10/19/2016</span> </small><div style="margin-top:5px">NM my last review from chapter 2</div></td>\n</tr>'), ('2017-02-10 05:59:33.977378', 11998472, 243096792, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7686127&amp;r ... (921 characters truncated) ... hy, for what reason did naming the boyfriend Harry seem like a good idea to you? first off its just weird and second its confusing.</div></td>\n</tr>'), ('2017-02-10 05:59:33.977379', 11998472, 241108663, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6773681&amp;r ... (833 characters truncated) ... 17 . <span data-xutime="1472069757">8/24/2016</span> </small><div style="margin-top:5px">Good story, looking forward to the sequel.</div></td>\n</tr>'), ('2017-02-10 05:59:33.977381', 11998472, 240300630, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4352315&amp;r ... (1048 characters truncated) ... -prongs being friends with Ron, but the story is intriguing so I kept with it and glad that i did. Can\'t wait for the summer hols.</div></td>\n</tr>'), ('2017-02-10 05:59:33.977383', 11998472, 240210290, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3322048&amp;r ... (868 characters truncated) ... 42948">8/2/2016</span> </small><div style="margin-top:5px">Very good story, I love Harmony pairing. This CANNOT be the end. Please?</div></td>\n</tr>'), ('2017-02-10 05:59:33.977385', 11998472, 240173089, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4374405&amp;r ... (873 characters truncated) ... 1/2016</span> </small><div style="margin-top:5px">Ad is going to bribe HP to go live at Durskaban and has kidnapped his sister too!</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-10 05:59:33.977424', 11998472, 238866641, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=726763&amp;rw ... (1049 characters truncated) ... found the first person narrative too confusing and had to give up, sorry. You may want to consider re-doing it in the third person.</div></td>\n</tr>'), ('2017-02-10 05:59:33.977426', 11998472, 238248330, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4352315&amp;r ... (1164 characters truncated) ... ng us is: Harry\'s POV etc. That it is less confusing for us readers. Keep up the good work and I can\'t wait for the next chapter.</div></td>\n</tr>'))]
21:59:34 reviews: Job OK (31afcb84-350a-4c3d-9ef8-4f6c8c50de58)
21:59:34 Result is kept for 500 seconds
21:59:34 
21:59:34 *** Listening on chapters, profiles, reviews...
21:59:34 reviews: fanfic.jobs.crawl_reviews(11998576) (17b1aebd-7a39-4c09-a795-553c1d1467b4)
2017-02-09 21:59:39 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 05:59:39.113680', 11998576, 239897723, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2387999&amp;r ... (1193 characters truncated) ... ding her interactions it is obvious that part of it is due to some internal troubles, but still I love all of them the more for it.</div></td>\n</tr>'), ('2017-02-10 05:59:39.113685', 11998576, 239395455, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (646 characters truncated) ...  OOC! I love that, though, it makes for good reading. This story is just generally very funny in a smart kind of way. Keep writing!</div></td>\n</tr>'), ('2017-02-10 05:59:39.113687', 11998576, 239350469, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2387999&amp;r ... (1115 characters truncated) ... Black is aware of her situation now. Is she sick because of overworking her magic with a wand? Looking forward to the next chapter.</div></td>\n</tr>'), ('2017-02-10 05:59:39.113689', 11998576, 239327922, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2387999&amp;r ... (1063 characters truncated) ... and Katica are part Vela or rather full Vela with the way they both attract men. ;) Great story and you\'re welcome for the review.</div></td>\n</tr>'), ('2017-02-10 05:59:39.113691', 11998576, 239318863, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2387999&amp;r ... (1048 characters truncated) ... reverse harem story. Sorry if I\'m wrong. Wow things have got so interesting. I wonder what is going on with all of the secrets. :D</div></td>\n</tr>'), ('2017-02-10 05:59:39.113693', 11998576, 239316886, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2387999&amp;r ... (989 characters truncated) ... :5px">Uh oh I see where this is going, well it can\'t be any more obvious, but still it will be terribly hard for Katica to accept.</div></td>\n</tr>'), ('2017-02-10 05:59:39.113695', 11998576, 239314464, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2387999&amp;r ... (1080 characters truncated) ... up! I wonder why the teachers care so much about Slytherin and Gryffindor students being friends. If anything they should be happy.</div></td>\n</tr>'), ('2017-02-10 05:59:39.113696', 11998576, 239304754, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2387999&amp;r ... (930 characters truncated) ... 1468262135">7/11/2016</span> </small><div style="margin-top:5px">I love how you switch back to the children from Katica\'s parents.</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-10 05:59:39.113728', 11998576, 238455006, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4840928&amp;r ... (866 characters truncated) ... 016</span> </small><div style="margin-top:5px">There is a plot! Somewhat. I guess. Characterization is good too, when you write it.</div></td>\n</tr>'), ('2017-02-10 05:59:39.113729', 11998576, 238293503, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (525 characters truncated) ... ="color:gray">chapter 2 . <span data-xutime="1466193254">6/17/2016</span> </small><div style="margin-top:5px">I like your story :-)</div></td>\n</tr>'))]
21:59:39 reviews: Job OK (17b1aebd-7a39-4c09-a795-553c1d1467b4)
21:59:39 Result is kept for 500 seconds
21:59:39 
21:59:39 *** Listening on chapters, profiles, reviews...
21:59:39 reviews: fanfic.jobs.crawl_reviews(11999331) (41f116f5-9525-4d30-b1ec-e2f079d42ab2)
22:01:58 reviews: Job OK (41f116f5-9525-4d30-b1ec-e2f079d42ab2)
22:01:58 Result is kept for 500 seconds
22:01:58 
22:01:58 *** Listening on chapters, profiles, reviews...
22:01:58 reviews: fanfic.jobs.crawl_reviews(11999670) (d741b93e-738f-441e-a720-5717d9bf3f9a)
22:02:03 reviews: Job OK (d741b93e-738f-441e-a720-5717d9bf3f9a)
22:02:03 Result is kept for 500 seconds
22:02:03 
22:02:03 *** Listening on chapters, profiles, reviews...
22:02:03 reviews: fanfic.jobs.crawl_reviews(11999946) (647d5a01-32de-4e90-8445-a79e2a4676ec)
22:02:19 reviews: Job OK (647d5a01-32de-4e90-8445-a79e2a4676ec)
22:02:19 Result is kept for 500 seconds
22:02:19 
22:02:19 *** Listening on chapters, profiles, reviews...
22:02:19 reviews: fanfic.jobs.crawl_reviews(12000341) (9f97c47a-46d6-4349-9c5f-dfd1bdfb2780)
2017-02-09 22:02:20 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/12000341/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
22:02:20 reviews: Job OK (9f97c47a-46d6-4349-9c5f-dfd1bdfb2780)
22:02:20 Result is kept for 500 seconds
22:02:20 
22:02:20 *** Listening on chapters, profiles, reviews...
22:02:20 reviews: fanfic.jobs.crawl_reviews(12000377) (14c09014-83d4-4ca6-b36b-999926350ccf)
22:03:01 reviews: Job OK (14c09014-83d4-4ca6-b36b-999926350ccf)
22:03:01 Result is kept for 500 seconds
22:03:01 
22:03:01 *** Listening on chapters, profiles, reviews...
22:03:01 reviews: fanfic.jobs.crawl_reviews(12001201) (1b0927b3-a8aa-4a30-9ea1-1b53ae5fe5f6)
2017-02-09 22:03:06 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 06:03:06.249671', 12001201, 243148922, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1601 characters truncated) ...  similar vein to this one (in my head I\'m imagining a story on the founders). <br>\nThank you for creating such a beautiful story!</div></td>\n</tr>'), ('2017-02-10 06:03:06.249676', 12001201, 242726425, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7120554&amp;r ... (1085 characters truncated) ... ly Aberforth and Arianna. This the result when a good story and a good writing are combined - something great. You rock I\'m a fan!</div></td>\n</tr>'), ('2017-02-10 06:03:06.249678', 12001201, 242644535, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3333229&amp;r ... (1110 characters truncated) ... owling would be very impressed by this. it is literally everything I could have wanted from a closer look at this story. thank you!</div></td>\n</tr>'), ('2017-02-10 06:03:06.249680', 12001201, 242177758, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (991 characters truncated) ... nd the mystery behind them all. I really thoroughly enjoyed this whole fic, and I think the ending was brilliant too. Amazing work!</div></td>\n</tr>'), ('2017-02-10 06:03:06.249682', 12001201, 241177891, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (887 characters truncated) ... small style="color:gray">chapter 7 . <span data-xutime="1472229334">8/26/2016</span> </small><div style="margin-top:5px">OOH CREEPY</div></td>\n</tr>'), ('2017-02-10 06:03:06.249684', 12001201, 240954645, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7234770&amp;r ... (1040 characters truncated) ... imagine them in your mind. I genuinely cannot put into words how much I love this, and I\'m very much anticipating the next update!</div></td>\n</tr>'), ('2017-02-10 06:03:06.249686', 12001201, 240262417, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6392499&amp;r ... (936 characters truncated) ... 50966">8/3/2016</span> </small><div style="margin-top:5px">Excellent work. You\'re writing is highly commendable. <br>\nKeep it up!</div></td>\n</tr>'), ('2017-02-10 06:03:06.249688', 12001201, 240252137, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4041010&amp;r ... (983 characters truncated) ... op:5px">This is truly one of the best pieces of fanfiction I have ever read ! It\'s a delight to read, many thanks for writing it !</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-10 06:03:06.249712', 12001201, 239346996, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6392499&amp;r ... (904 characters truncated) ... ter 2 . <span data-xutime="1468344753">7/12/2016</span> </small><div style="margin-top:5px">This story is really good. Update soon!</div></td>\n</tr>'), ('2017-02-10 06:03:06.249714', 12001201, 238630508, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6736467&amp;r ... (968 characters truncated) ...  blown away by your imagery (and feeling quite sad, because it wasn\'t done at the time). I\'m so glad you\'ve finally finished it!</div></td>\n</tr>'))]
22:03:06 reviews: Job OK (1b0927b3-a8aa-4a30-9ea1-1b53ae5fe5f6)
22:03:06 Result is kept for 500 seconds
22:03:06 
22:03:06 *** Listening on chapters, profiles, reviews...
22:03:06 reviews: fanfic.jobs.crawl_reviews(12001653) (59a5131a-799e-4745-b679-cfa8a53853e6)
22:04:13 reviews: Job OK (59a5131a-799e-4745-b679-cfa8a53853e6)
22:04:13 Result is kept for 500 seconds
22:04:13 
22:04:13 *** Listening on chapters, profiles, reviews...
22:04:13 reviews: fanfic.jobs.crawl_reviews(12004695) (33b4900b-66cd-4930-b090-1a5ca8c5bdad)
22:06:03 reviews: Job OK (33b4900b-66cd-4930-b090-1a5ca8c5bdad)
22:06:03 Result is kept for 500 seconds
22:06:03 
22:06:03 *** Listening on chapters, profiles, reviews...
22:06:03 reviews: fanfic.jobs.crawl_reviews(12005632) (5374fff8-1c50-49bb-add4-89bb1d6c1571)
22:06:16 reviews: Job OK (5374fff8-1c50-49bb-add4-89bb1d6c1571)
22:06:16 Result is kept for 500 seconds
22:06:16 
22:06:16 *** Listening on chapters, profiles, reviews...
22:06:16 reviews: fanfic.jobs.crawl_reviews(12006946) (27692754-7b94-4333-8b2c-d8eeb5d690ca)
22:06:24 reviews: Job OK (27692754-7b94-4333-8b2c-d8eeb5d690ca)
22:06:24 Result is kept for 500 seconds
22:06:24 
22:06:24 *** Listening on chapters, profiles, reviews...
22:06:24 reviews: fanfic.jobs.crawl_reviews(12008082) (556fef75-f82b-4d4b-8f66-7204da82c6c1)
22:06:29 reviews: Job OK (556fef75-f82b-4d4b-8f66-7204da82c6c1)
22:06:29 Result is kept for 500 seconds
22:06:29 
22:06:29 *** Listening on chapters, profiles, reviews...
22:06:29 reviews: fanfic.jobs.crawl_reviews(12008782) (8e6bef80-0cbc-4416-a6e0-98c1d82ad804)
22:06:47 reviews: Job OK (8e6bef80-0cbc-4416-a6e0-98c1d82ad804)
22:06:47 Result is kept for 500 seconds
22:06:47 
22:06:47 *** Listening on chapters, profiles, reviews...
22:06:47 reviews: fanfic.jobs.crawl_reviews(12011689) (c8ce0fd3-e2a6-4a25-94c3-c732604eecaa)
22:12:59 reviews: Job OK (c8ce0fd3-e2a6-4a25-94c3-c732604eecaa)
22:12:59 Result is kept for 500 seconds
22:12:59 
22:12:59 *** Listening on chapters, profiles, reviews...
22:12:59 reviews: fanfic.jobs.crawl_reviews(12014275) (02b30850-afa0-4054-b776-9429cfc9c288)
22:13:27 reviews: Job OK (02b30850-afa0-4054-b776-9429cfc9c288)
22:13:27 Result is kept for 500 seconds
22:13:27 
22:13:27 *** Listening on chapters, profiles, reviews...
22:13:27 reviews: fanfic.jobs.crawl_reviews(12016543) (367f411d-b872-4214-8406-2b72daa570ba)
22:20:25 reviews: Job OK (367f411d-b872-4214-8406-2b72daa570ba)
22:20:25 Result is kept for 500 seconds
22:20:25 
22:20:25 *** Listening on chapters, profiles, reviews...
22:20:25 reviews: fanfic.jobs.crawl_reviews(12017737) (c18e14e4-a4a6-4f7b-b11c-7568c30d8b14)
22:21:07 reviews: Job OK (c18e14e4-a4a6-4f7b-b11c-7568c30d8b14)
22:21:07 Result is kept for 500 seconds
22:21:07 
22:21:07 *** Listening on chapters, profiles, reviews...
22:21:07 reviews: fanfic.jobs.crawl_reviews(12020392) (a94c4cb7-cf86-4c18-9c82-e6a8f2ad180c)
22:25:43 reviews: Job OK (a94c4cb7-cf86-4c18-9c82-e6a8f2ad180c)
22:25:43 Result is kept for 500 seconds
22:25:43 
22:25:43 *** Listening on chapters, profiles, reviews...
22:25:43 reviews: fanfic.jobs.crawl_reviews(12021318) (be913a74-c46d-41a4-8572-57093ba0fbe3)
22:28:43 reviews: Job OK (be913a74-c46d-41a4-8572-57093ba0fbe3)
22:28:43 Result is kept for 500 seconds
22:28:43 
22:28:43 *** Listening on chapters, profiles, reviews...
22:28:43 reviews: fanfic.jobs.crawl_reviews(12021867) (afd1162a-8b08-4adb-8d99-509556254b69)
22:29:15 reviews: Job OK (afd1162a-8b08-4adb-8d99-509556254b69)
22:29:15 Result is kept for 500 seconds
22:29:15 
22:29:15 *** Listening on chapters, profiles, reviews...
22:29:15 reviews: fanfic.jobs.crawl_reviews(12022003) (ef0ec6b9-2925-40c5-a2b9-0fed321d9fc7)
22:30:06 reviews: Job OK (ef0ec6b9-2925-40c5-a2b9-0fed321d9fc7)
22:30:06 Result is kept for 500 seconds
22:30:06 
22:30:06 *** Listening on chapters, profiles, reviews...
22:30:06 reviews: fanfic.jobs.crawl_reviews(12022253) (a74a7e67-428f-46a2-afa8-1e74c6bc946a)
22:31:12 reviews: Job OK (a74a7e67-428f-46a2-afa8-1e74c6bc946a)
22:31:12 Result is kept for 500 seconds
22:31:12 
22:31:12 *** Listening on chapters, profiles, reviews...
22:31:12 reviews: fanfic.jobs.crawl_reviews(12023403) (e431524a-1cb0-4773-a072-1e9ec28cde15)
22:31:18 reviews: Job OK (e431524a-1cb0-4773-a072-1e9ec28cde15)
22:31:18 Result is kept for 500 seconds
22:31:18 
22:31:18 *** Listening on chapters, profiles, reviews...
22:31:18 reviews: fanfic.jobs.crawl_reviews(12023778) (8e4f8eb1-df8f-4a8c-b636-bafc6abc6a4f)
22:31:42 reviews: Job OK (8e4f8eb1-df8f-4a8c-b636-bafc6abc6a4f)
22:31:42 Result is kept for 500 seconds
22:31:42 
22:31:42 *** Listening on chapters, profiles, reviews...
22:31:42 reviews: fanfic.jobs.crawl_reviews(12026134) (20229a7f-f477-4df9-848b-578773312e8a)
22:34:56 reviews: Job OK (20229a7f-f477-4df9-848b-578773312e8a)
22:34:56 Result is kept for 500 seconds
22:34:56 
22:34:56 *** Listening on chapters, profiles, reviews...
22:34:56 reviews: fanfic.jobs.crawl_reviews(12027127) (5ed88a27-6dc7-4acb-849e-c0545cdca5c1)
2017-02-09 22:35:02 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 06:35:02.639078', 12027127, 240249159, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6943542&amp;r ... (798 characters truncated) ...  <small style="color:gray">chapter 1 . <span data-xutime="1470221717">8/3/2016</span> </small><div style="margin-top:5px">good plit</div></td>\n</tr>'), ('2017-02-10 06:35:02.639083', 12027127, 239611318, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5235276&amp;r ... (981 characters truncated) ... 547">7/18/2016</span> </small><div style="margin-top:5px">Has really no one reviewed this yet? Pity, because this story is awesome!</div></td>\n</tr>'), ('2017-02-10 06:35:02.639085', 12027127, 240249159, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6943542&amp;r ... (798 characters truncated) ...  <small style="color:gray">chapter 1 . <span data-xutime="1470221717">8/3/2016</span> </small><div style="margin-top:5px">good plit</div></td>\n</tr>'), ('2017-02-10 06:35:02.639087', 12027127, 239611318, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5235276&amp;r ... (981 characters truncated) ... 547">7/18/2016</span> </small><div style="margin-top:5px">Has really no one reviewed this yet? Pity, because this story is awesome!</div></td>\n</tr>'))]
22:35:02 reviews: Job OK (5ed88a27-6dc7-4acb-849e-c0545cdca5c1)
22:35:02 Result is kept for 500 seconds
22:35:02 
22:35:02 *** Listening on chapters, profiles, reviews...
22:35:02 reviews: fanfic.jobs.crawl_reviews(12027782) (18602cb7-6a17-4ac4-88ef-f6e3379e7a39)
22:37:09 reviews: Job OK (18602cb7-6a17-4ac4-88ef-f6e3379e7a39)
22:37:09 Result is kept for 500 seconds
22:37:09 
22:37:09 *** Listening on chapters, profiles, reviews...
22:37:09 reviews: fanfic.jobs.crawl_reviews(12028585) (80e71349-1903-4c87-90a0-b4b2ab843fb8)
22:37:14 reviews: Job OK (80e71349-1903-4c87-90a0-b4b2ab843fb8)
22:37:14 Result is kept for 500 seconds
22:37:14 
22:37:14 *** Listening on chapters, profiles, reviews...
22:37:14 reviews: fanfic.jobs.crawl_reviews(12029106) (3fc3aad5-d5ca-4bee-bd73-95cef420db98)
22:37:27 reviews: Job OK (3fc3aad5-d5ca-4bee-bd73-95cef420db98)
22:37:27 Result is kept for 500 seconds
22:37:27 
22:37:27 *** Listening on chapters, profiles, reviews...
22:37:27 reviews: fanfic.jobs.crawl_reviews(12031516) (4c124b96-433f-429a-80f0-8bef2b542619)
22:37:37 reviews: Job OK (4c124b96-433f-429a-80f0-8bef2b542619)
22:37:37 Result is kept for 500 seconds
22:37:37 
22:37:37 *** Listening on chapters, profiles, reviews...
22:37:37 reviews: fanfic.jobs.crawl_reviews(12033213) (9550bada-ee6a-4c8b-af1f-d3c646ca8bb7)
2017-02-09 22:37:42 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 06:37:42.078838', 12033213, 247029134, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7127914&amp;r ... (826 characters truncated) ... gray">chapter 34 . <span data-xutime="1486690283">5h</span> </small><div style="margin-top:5px">pleeeeease hurry with a new chapter</div></td>\n</tr>'), ('2017-02-10 06:37:42.078842', 12033213, 245747115, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4828900&amp;r ... (9296 characters truncated) ... find out about ancestry especially on possible magical relatives." Mia replied, "Thanks Aunt Lily." Lily Potter nee Evans vanished.</div></td>\n</tr>'), ('2017-02-10 06:37:42.078844', 12033213, 244745856, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (547 characters truncated) ...  34 . <span data-xutime="1480992991">12/5/2016</span> </small><div style="margin-top:5px">This was amazing hurry with the next one.</div></td>\n</tr>'), ('2017-02-10 06:37:42.078846', 12033213, 244666640, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (638 characters truncated) ... nly one that pulled my Fantastic Beats and Where to Find Them copy out when Hagrid told the class to? I even read the introduction.</div></td>\n</tr>'), ('2017-02-10 06:37:42.078848', 12033213, 244348576, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8272720&amp;r ... (956 characters truncated) ... 1480169709">11/26/2016</span> </small><div style="margin-top:5px">Update please, I\'ve read all you Mia stories and their all great</div></td>\n</tr>'), ('2017-02-10 06:37:42.078850', 12033213, 244137695, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7127914&amp;r ... (885 characters truncated) ... </span> </small><div style="margin-top:5px">this is really good sorry it took me so long to read it it took abit for me to get time</div></td>\n</tr>'), ('2017-02-10 06:37:42.078852', 12033213, 243847541, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (582 characters truncated) ... 016</span> </small><div style="margin-top:5px">Selina That was amazing! I can\'t wait to see what happens next, please update soon.</div></td>\n</tr>'), ('2017-02-10 06:37:42.078854', 12033213, 242037314, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (536 characters truncated) ... pter 25 . <span data-xutime="1474053482">9/16/2016</span> </small><div style="margin-top:5px">Love the chapter, please update soon.</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-10 06:37:42.078894', 12033213, 240368530, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (538 characters truncated) ... er 1 . <span data-xutime="1470305904">8/4/2016</span> </small><div style="margin-top:5px">Amazing story! I really love your series!</div></td>\n</tr>'), ('2017-02-10 06:37:42.078896', 12033213, 239437697, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7669259&amp;r ... (1083 characters truncated) ... Little Sister and of course Mia gets the Little Sister that will probably give us a fair amount of angst. Can\'t wait to read more!</div></td>\n</tr>'))]
22:37:42 reviews: Job OK (9550bada-ee6a-4c8b-af1f-d3c646ca8bb7)
22:37:42 Result is kept for 500 seconds
22:37:42 
22:37:42 *** Listening on chapters, profiles, reviews...
22:37:42 reviews: fanfic.jobs.crawl_reviews(12033498) (2e56e376-0d34-4f05-9a18-ac76b32484ee)
22:37:48 reviews: Job OK (2e56e376-0d34-4f05-9a18-ac76b32484ee)
22:37:48 Result is kept for 500 seconds
22:37:48 
22:37:48 *** Listening on chapters, profiles, reviews...
22:37:48 reviews: fanfic.jobs.crawl_reviews(12033548) (f4184c71-3536-4c1c-849d-cba2ebc06fb8)
22:37:54 reviews: Job OK (f4184c71-3536-4c1c-849d-cba2ebc06fb8)
22:37:54 Result is kept for 500 seconds
22:37:54 
22:37:54 *** Listening on chapters, profiles, reviews...
22:37:54 reviews: fanfic.jobs.crawl_reviews(12033778) (828021d1-b6d3-421e-8dc4-101705b1e113)
22:41:09 reviews: Job OK (828021d1-b6d3-421e-8dc4-101705b1e113)
22:41:09 Result is kept for 500 seconds
22:41:09 
22:41:09 *** Listening on chapters, profiles, reviews...
22:41:09 reviews: fanfic.jobs.crawl_reviews(12034578) (9ea53a6e-101e-438d-a413-956bc030ffb5)
22:43:14 reviews: Job OK (9ea53a6e-101e-438d-a413-956bc030ffb5)
22:43:14 Result is kept for 500 seconds
22:43:14 
22:43:14 *** Listening on chapters, profiles, reviews...
22:43:14 reviews: fanfic.jobs.crawl_reviews(12034992) (1e077146-a4ce-4960-9770-3d6656e1c1b5)
22:43:25 reviews: Job OK (1e077146-a4ce-4960-9770-3d6656e1c1b5)
22:43:25 Result is kept for 500 seconds
22:43:25 
22:43:25 *** Listening on chapters, profiles, reviews...
22:43:25 reviews: fanfic.jobs.crawl_reviews(12035366) (2d8fc6e0-39a8-423c-94bd-fe7d2fd2503c)
22:43:41 reviews: Job OK (2d8fc6e0-39a8-423c-94bd-fe7d2fd2503c)
22:43:41 Result is kept for 500 seconds
22:43:41 
22:43:41 *** Listening on chapters, profiles, reviews...
22:43:41 reviews: fanfic.jobs.crawl_reviews(12036678) (6bb88b5e-36b3-4aea-a42b-415a9ef25464)
2017-02-09 22:43:46 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 06:43:46.340617', 12036678, 245079645, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3969889&amp;r ... (1109 characters truncated) ... n Harry and Ginny would have taken a wooden spoon to his foolishness long before this. <br>\n<br>\nYou may also want to get a beta.</div></td>\n</tr>'), ('2017-02-10 06:43:46.340621', 12036678, 245047516, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (752 characters truncated) ...  longer. Would be nice to see them team up together :)<br>\nAlso, hope the next instalment of after the war will come soon as well!</div></td>\n</tr>'), ('2017-02-10 06:43:46.340624', 12036678, 244844450, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1108 characters truncated) ... ;) )!<br>\nKeep going! But don\'t let it interfere too much with real life tasks - I don\'t want you to in the end be forever gone!</div></td>\n</tr>'), ('2017-02-10 06:43:46.340626', 12036678, 244642188, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6236144&amp;r ... (971 characters truncated) ... ed with the wrong people him and ollie need to stick to the gryffindor guns and stop being idiots prank but prank wisely and fairly</div></td>\n</tr>'), ('2017-02-10 06:43:46.340628', 12036678, 242665950, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6236144&amp;r ... (1005 characters truncated) ... bottom and he better also get flunked by louis as well because they need a good team and he Is going to ruin everything for himself</div></td>\n</tr>'), ('2017-02-10 06:43:46.340630', 12036678, 241757083, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (654 characters truncated) ... e war before u continue after the epilogue. U really left us hanging at a pretty crucial point. Right before a damn battle? Really?</div></td>\n</tr>'), ('2017-02-10 06:43:46.340632', 12036678, 239848972, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1934291&amp;r ... (1343 characters truncated) ... your writing goes I have always enjoyed it but was disappointed to see that this story is incomplete though it is marked otherwise.</div></td>\n</tr>'), ('2017-02-10 06:43:46.340634', 12036678, 239707510, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5221976&amp;r ... (1223 characters truncated) ...  are poor so no teacher would and the other players dont like him so I\'m confused to why the choice. other then that good story...</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-10 06:43:46.340665', 12036678, 239101584, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5438503&amp;r ... (836 characters truncated) ... apter 2 . <span data-xutime="1467845766">7/6/2016</span> </small><div style="margin-top:5px">I want to ask you of something please?</div></td>\n</tr>'), ('2017-02-10 06:43:46.340667', 12036678, 239101242, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5438503&amp;r ... (877 characters truncated) ... 7/6/2016</span> </small><div style="margin-top:5px">Hello can you please get back to me in some way so I can talk to you privately?</div></td>\n</tr>'))]
22:43:46 reviews: Job OK (6bb88b5e-36b3-4aea-a42b-415a9ef25464)
22:43:46 Result is kept for 500 seconds
22:43:46 
22:43:46 *** Listening on chapters, profiles, reviews...
22:43:46 reviews: fanfic.jobs.crawl_reviews(12036750) (35a2903c-d8d5-4097-a052-aab053af6a07)
22:43:59 reviews: Job OK (35a2903c-d8d5-4097-a052-aab053af6a07)
22:43:59 Result is kept for 500 seconds
22:43:59 
22:43:59 *** Listening on chapters, profiles, reviews...
22:43:59 reviews: fanfic.jobs.crawl_reviews(12039068) (4081e9ce-ff40-4e51-ba2b-151d41dcb66d)
22:44:06 reviews: Job OK (4081e9ce-ff40-4e51-ba2b-151d41dcb66d)
22:44:06 Result is kept for 500 seconds
22:44:06 
22:44:06 *** Listening on chapters, profiles, reviews...
22:44:06 reviews: fanfic.jobs.crawl_reviews(12040833) (60b1b088-4e0b-46d5-b662-154c733da28d)
22:46:27 reviews: Job OK (60b1b088-4e0b-46d5-b662-154c733da28d)
22:46:27 Result is kept for 500 seconds
22:46:27 
22:46:27 *** Listening on chapters, profiles, reviews...
22:46:27 reviews: fanfic.jobs.crawl_reviews(12041286) (17c866c3-72dc-4c35-a559-3949570f69e7)
22:47:20 reviews: Job OK (17c866c3-72dc-4c35-a559-3949570f69e7)
22:47:20 Result is kept for 500 seconds
22:47:20 
22:47:20 *** Listening on chapters, profiles, reviews...
22:47:20 reviews: fanfic.jobs.crawl_reviews(12041560) (61edc390-9b28-4541-a758-965a3840fb6e)
22:50:27 reviews: Job OK (61edc390-9b28-4541-a758-965a3840fb6e)
22:50:27 Result is kept for 500 seconds
22:50:27 
22:50:27 *** Listening on chapters, profiles, reviews...
22:50:27 reviews: fanfic.jobs.crawl_reviews(12041781) (af589990-57b6-4c20-867f-859ae736e1e7)
22:50:33 reviews: Job OK (af589990-57b6-4c20-867f-859ae736e1e7)
22:50:33 Result is kept for 500 seconds
22:50:33 
22:50:33 *** Listening on chapters, profiles, reviews...
22:50:33 reviews: fanfic.jobs.crawl_reviews(12042798) (f90fe012-e7dc-49a0-ad60-fd770be61409)
22:50:47 reviews: Job OK (f90fe012-e7dc-49a0-ad60-fd770be61409)
22:50:47 Result is kept for 500 seconds
22:50:47 
22:50:47 *** Listening on chapters, profiles, reviews...
22:50:47 reviews: fanfic.jobs.crawl_reviews(12043627) (8ad6fd89-cd02-48bf-839b-9670d3c7c621)
22:51:27 reviews: Job OK (8ad6fd89-cd02-48bf-839b-9670d3c7c621)
22:51:27 Result is kept for 500 seconds
22:51:27 
22:51:27 *** Listening on chapters, profiles, reviews...
22:51:27 reviews: fanfic.jobs.crawl_reviews(12044318) (fb871d30-0650-415c-9d7a-3e2cedbfd286)
22:51:39 reviews: Job OK (fb871d30-0650-415c-9d7a-3e2cedbfd286)
22:51:39 Result is kept for 500 seconds
22:51:39 
22:51:39 *** Listening on chapters, profiles, reviews...
22:51:39 reviews: fanfic.jobs.crawl_reviews(12045308) (1825b4ba-ce72-47bb-8279-e28d7453522b)
2017-02-09 22:51:45 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 06:51:45.271944', 12045308, 245668808, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6319297&amp;r ... (1034 characters truncated) ... d I love it. All the angst is over. Bloody hell... I feel so emotionally drain. This was awesome, thank you so much for writing it.</div></td>\n</tr>'), ('2017-02-10 06:51:45.271949', 12045308, 244616911, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6558944&amp;r ... (1208 characters truncated) ... riting it and congrats ! You\'ve done a great job ! :)<br>\n<br>\n(PS: sorry for any mistakes, English isn\'t my first language...)</div></td>\n</tr>'), ('2017-02-10 06:51:45.271951', 12045308, 244520657, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6319297&amp;r ... (972 characters truncated) ... <div style="margin-top:5px">Oh my god, my heart has been broken. I love this so much. I love this. Thank you, thank you, thank you.</div></td>\n</tr>'), ('2017-02-10 06:51:45.271953', 12045308, 244519009, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6319297&amp;r ... (1186 characters truncated) ... \'t it?<br>\n<br>\nI now have marks from where I was digging my fingernail\'s into my palm. Jesus. I hate the Carrows. I HATE them.</div></td>\n</tr>'), ('2017-02-10 06:51:45.271955', 12045308, 244097118, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7247107&amp;r ... (1082 characters truncated) ... scriptions of the torture they\'re going through is impressive, even though it is pretty graphic. Can\'t wait for the next chapter!</div></td>\n</tr>'), ('2017-02-10 06:51:45.271957', 12045308, 242339843, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (740 characters truncated) ... t has this gut wrenching twist that I can\'t get enough of. Definitely going to rec to my friends. Hope to see more in the future!~</div></td>\n</tr>'), ('2017-02-10 06:51:45.271959', 12045308, 241821144, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4407550&amp;r ... (958 characters truncated) ... span> </small><div style="margin-top:5px">I was so glad you updated! Great heart wrenching chapter, can\'t wait until the next one!</div></td>\n</tr>'), ('2017-02-10 06:51:45.271961', 12045308, 241141791, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4407550&amp;r ... (1036 characters truncated) ... tten and heartbreaking. I can\'t wait for you to update and to see what happens in the next few chapters. I love this, well done :)</div></td>\n</tr>')  ... displaying 10 of 22 total bound parameter sets ...  ('2017-02-10 06:51:45.271985', 12045308, 240893824, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (537 characters truncated) ... 5 . <span data-xutime="1471431542">8/17/2016</span> </small><div style="margin-top:5px">Please never stop updating, this is amazing</div></td>\n</tr>'), ('2017-02-10 06:51:45.271987', 12045308, 240075075, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5530337&amp;r ... (1449 characters truncated) ... lle/Luna moments. (Big Nuna fan)<br>\n<br>\nThe plot is getting interesting and I\'m really looking forward to seeing what happens!</div></td>\n</tr>'))]
22:51:45 reviews: Job OK (1825b4ba-ce72-47bb-8279-e28d7453522b)
22:51:45 Result is kept for 500 seconds
22:51:45 
22:51:45 *** Listening on chapters, profiles, reviews...
22:51:45 reviews: fanfic.jobs.crawl_reviews(12045651) (8265c0bc-f6ea-4359-81a0-cdcd56336bc5)
22:52:58 reviews: Job OK (8265c0bc-f6ea-4359-81a0-cdcd56336bc5)
22:52:58 Result is kept for 500 seconds
22:52:58 Cleaning registries for queue: chapters
22:52:58 Cleaning registries for queue: profiles
22:52:58 Cleaning registries for queue: reviews
22:52:58 
22:52:58 *** Listening on chapters, profiles, reviews...
22:52:58 reviews: fanfic.jobs.crawl_reviews(12046790) (1ab57e94-11a2-4611-9786-24048cb5a327)
22:55:09 reviews: Job OK (1ab57e94-11a2-4611-9786-24048cb5a327)
22:55:09 Result is kept for 500 seconds
22:55:09 
22:55:09 *** Listening on chapters, profiles, reviews...
22:55:09 reviews: fanfic.jobs.crawl_reviews(12047493) (67ee443a-9ed6-4fce-8b1e-e944b7010077)
22:59:11 reviews: Job OK (67ee443a-9ed6-4fce-8b1e-e944b7010077)
22:59:11 Result is kept for 500 seconds
22:59:11 
22:59:11 *** Listening on chapters, profiles, reviews...
22:59:11 reviews: fanfic.jobs.crawl_reviews(12048619) (0af94a87-39d4-440a-a570-66a401a8c031)
23:09:03 reviews: Job OK (0af94a87-39d4-440a-a570-66a401a8c031)
23:09:03 Result is kept for 500 seconds
23:09:03 
23:09:03 *** Listening on chapters, profiles, reviews...
23:09:03 reviews: fanfic.jobs.crawl_reviews(12050130) (cb0dbaf6-c18b-4b74-b3ea-0a38749a1b2b)
23:09:25 reviews: Job OK (cb0dbaf6-c18b-4b74-b3ea-0a38749a1b2b)
23:09:25 Result is kept for 500 seconds
23:09:25 
23:09:25 *** Listening on chapters, profiles, reviews...
23:09:25 reviews: fanfic.jobs.crawl_reviews(12050441) (e72a35a8-bb14-4b7b-898f-4da9360886a1)
2017-02-09 23:09:31 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 07:09:31.868827', 12050441, 246607043, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5332261&amp;r ... (909 characters truncated) ... is not have more reviews and follows?! Sheesh, wish I could make everyone read it. Thanks for writing, though, and please continue!</div></td>\n</tr>'), ('2017-02-10 07:09:31.868831', 12050441, 246606948, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5332261&amp;r ... (1044 characters truncated) ... before, and I appreciate that you carved out your own story instead of following stereotypes. Great job. I don\'t want this to end.</div></td>\n</tr>'), ('2017-02-10 07:09:31.868834', 12050441, 241111311, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1265509&amp;r ... (1111 characters truncated) ...  really liked what you did with the characters and your work on their personalities and their families! i\'ve enjoyed it very much!</div></td>\n</tr>'), ('2017-02-10 07:09:31.868836', 12050441, 240429920, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6285951&amp;r ... (862 characters truncated) ... all style="color:gray">chapter 12 . <span data-xutime="1470610816">8/7/2016</span> </small><div style="margin-top:5px">I love this.</div></td>\n</tr>'), ('2017-02-10 07:09:31.868838', 12050441, 240150035, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (577 characters truncated) ... 1/2016</span> </small><div style="margin-top:5px">This is my favourite thing ever; it\'s just perfect. <br>\nKeep up the good work!</div></td>\n</tr>'), ('2017-02-10 07:09:31.868840', 12050441, 239865445, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5533404&amp;r ... (897 characters truncated) ... . <span data-xutime="1469415694">7/24/2016</span> </small><div style="margin-top:5px">WHY ON EARTH DOES THIS NOT HAVE MORE REVIEWS?</div></td>\n</tr>'), ('2017-02-10 07:09:31.868841', 12050441, 239837781, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7056450&amp;r ... (1183 characters truncated) ... e there is so much here to read, and I soooooo want to read more. you have done great in my opinion, and i eagerly await updates :)</div></td>\n</tr>'), ('2017-02-10 07:09:31.868843', 12050441, 239602502, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7382157&amp;r ... (921 characters truncated) ... ic. the way you portrayed each character was almost flawless. all in all, a fantastic piece of work and I\'m very excited for more.</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-10 07:09:31.868857', 12050441, 239837781, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7056450&amp;r ... (1183 characters truncated) ... e there is so much here to read, and I soooooo want to read more. you have done great in my opinion, and i eagerly await updates :)</div></td>\n</tr>'), ('2017-02-10 07:09:31.868858', 12050441, 239602502, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7382157&amp;r ... (921 characters truncated) ... ic. the way you portrayed each character was almost flawless. all in all, a fantastic piece of work and I\'m very excited for more.</div></td>\n</tr>'))]
23:09:31 reviews: Job OK (e72a35a8-bb14-4b7b-898f-4da9360886a1)
23:09:31 Result is kept for 500 seconds
23:09:31 
23:09:31 *** Listening on chapters, profiles, reviews...
23:09:31 reviews: fanfic.jobs.crawl_reviews(12050457) (65a0a456-51ac-4cfc-9722-2c1b8195b2c5)
23:09:57 reviews: Job OK (65a0a456-51ac-4cfc-9722-2c1b8195b2c5)
23:09:57 Result is kept for 500 seconds
23:09:57 
23:09:57 *** Listening on chapters, profiles, reviews...
23:09:57 reviews: fanfic.jobs.crawl_reviews(12050780) (31db27ad-6ced-4174-80a0-ba2251301f8e)
23:10:03 reviews: Job OK (31db27ad-6ced-4174-80a0-ba2251301f8e)
23:10:03 Result is kept for 500 seconds
23:10:03 
23:10:03 *** Listening on chapters, profiles, reviews...
23:10:03 reviews: fanfic.jobs.crawl_reviews(12051768) (94eabd8a-b06f-4a0c-b29b-95494b43e8bd)
23:10:23 reviews: Job OK (94eabd8a-b06f-4a0c-b29b-95494b43e8bd)
23:10:23 Result is kept for 500 seconds
23:10:23 
23:10:23 *** Listening on chapters, profiles, reviews...
23:10:23 reviews: fanfic.jobs.crawl_reviews(12053168) (8a348683-0bc3-4fea-9181-c8be101bf96c)
23:11:04 reviews: Job OK (8a348683-0bc3-4fea-9181-c8be101bf96c)
23:11:04 Result is kept for 500 seconds
23:11:04 
23:11:04 *** Listening on chapters, profiles, reviews...
23:11:04 reviews: fanfic.jobs.crawl_reviews(12053824) (926d8cca-f7f5-45c1-a041-5652489e8412)
23:11:32 reviews: Job OK (926d8cca-f7f5-45c1-a041-5652489e8412)
23:11:32 Result is kept for 500 seconds
23:11:32 
23:11:32 *** Listening on chapters, profiles, reviews...
23:11:32 reviews: fanfic.jobs.crawl_reviews(12054615) (28f856a5-2e9c-4128-9e5e-b0fec5583638)
23:13:24 reviews: Job OK (28f856a5-2e9c-4128-9e5e-b0fec5583638)
23:13:24 Result is kept for 500 seconds
23:13:24 
23:13:24 *** Listening on chapters, profiles, reviews...
23:13:24 reviews: fanfic.jobs.crawl_reviews(12054982) (ed99d7e6-9cff-447a-b4d9-5682247bf594)
23:14:57 reviews: Job OK (ed99d7e6-9cff-447a-b4d9-5682247bf594)
23:14:57 Result is kept for 500 seconds
23:14:57 
23:14:57 *** Listening on chapters, profiles, reviews...
23:14:57 reviews: fanfic.jobs.crawl_reviews(12054989) (55a4bd42-25be-4441-95cc-0fdc729bda24)
23:16:12 reviews: Job OK (55a4bd42-25be-4441-95cc-0fdc729bda24)
23:16:12 Result is kept for 500 seconds
23:16:12 
23:16:12 *** Listening on chapters, profiles, reviews...
23:16:12 reviews: fanfic.jobs.crawl_reviews(12055716) (152ebcab-94ca-4a07-9606-3cd0360349d0)
23:17:14 reviews: Job OK (152ebcab-94ca-4a07-9606-3cd0360349d0)
23:17:14 Result is kept for 500 seconds
23:17:14 
23:17:14 *** Listening on chapters, profiles, reviews...
23:17:14 reviews: fanfic.jobs.crawl_reviews(12056256) (35c46baf-b3c6-46f9-82ad-8687c3569aa4)
23:17:45 reviews: Job OK (35c46baf-b3c6-46f9-82ad-8687c3569aa4)
23:17:45 Result is kept for 500 seconds
23:17:45 
23:17:45 *** Listening on chapters, profiles, reviews...
23:17:45 reviews: fanfic.jobs.crawl_reviews(12056297) (2db6f6d6-8213-447c-95b0-7bbc9883ad66)
23:18:04 reviews: Job OK (2db6f6d6-8213-447c-95b0-7bbc9883ad66)
23:18:04 Result is kept for 500 seconds
23:18:04 
23:18:04 *** Listening on chapters, profiles, reviews...
23:18:04 reviews: fanfic.jobs.crawl_reviews(12057497) (92c1dd5f-0ff9-4eae-bef7-4dc32b332447)
23:20:06 reviews: Job OK (92c1dd5f-0ff9-4eae-bef7-4dc32b332447)
23:20:06 Result is kept for 500 seconds
23:20:06 
23:20:06 *** Listening on chapters, profiles, reviews...
23:20:06 reviews: fanfic.jobs.crawl_reviews(12057689) (988a664d-4d90-45e5-8034-93f316e5e44e)
23:26:07 reviews: Job OK (988a664d-4d90-45e5-8034-93f316e5e44e)
23:26:07 Result is kept for 500 seconds
23:26:07 
23:26:07 *** Listening on chapters, profiles, reviews...
23:26:07 reviews: fanfic.jobs.crawl_reviews(12058266) (26aef865-1d7f-4fc6-b0fe-d735ed8553db)
23:26:12 reviews: Job OK (26aef865-1d7f-4fc6-b0fe-d735ed8553db)
23:26:12 Result is kept for 500 seconds
23:26:12 
23:26:12 *** Listening on chapters, profiles, reviews...
23:26:12 reviews: fanfic.jobs.crawl_reviews(12058516) (259007d3-adee-49ab-8763-c49a5412ad13)
23:49:35 reviews: Job OK (259007d3-adee-49ab-8763-c49a5412ad13)
23:49:35 Result is kept for 500 seconds
23:49:35 
23:49:35 *** Listening on chapters, profiles, reviews...
23:49:35 reviews: fanfic.jobs.crawl_reviews(12060277) (59c9a562-be38-4dbd-a09c-3d334cb5c536)
2017-02-09 23:49:39 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 07:49:39.367707', 12060277, 243218562, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4784669&amp;r ... (1154 characters truncated) ...  and doesn\'t update for a bit, I\'ll cry a bit. I\'ll also understand because such greatness can only be in the world for so long.</div></td>\n</tr>'), ('2017-02-10 07:49:39.367712', 12060277, 242404278, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5204379&amp;r ... (926 characters truncated) ... 475137503">9/29/2016</span> </small><div style="margin-top:5px">Loved their interaction with each other and Harry is just adorable!</div></td>\n</tr>'), ('2017-02-10 07:49:39.367714', 12060277, 241721310, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7656020&amp;r ... (885 characters truncated) ... in-top:5px">Love your Cerridwen Sanctos, and love the Severus Snape she helps him become...<br>\n<br>\nLooking forward to the next.</div></td>\n</tr>'), ('2017-02-10 07:49:39.367717', 12060277, 241721141, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4125901&amp;r ... (1163 characters truncated) ... >\n<br>\nThis is definitely the best story I\'ve ever read and you should keep updating forever and always. :\'D<br>\n<br>\n-Hiniko</div></td>\n</tr>'), ('2017-02-10 07:49:39.367719', 12060277, 241561532, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6752439&amp;r ... (1004 characters truncated) ... so hard! Everything is perfect; Severus isn\'t a hot mess of self-hatred and Cerry brings me joy. A great first chapter!<br>\n~Aqua</div></td>\n</tr>'), ('2017-02-10 07:49:39.367721', 12060277, 241443900, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5204379&amp;r ... (916 characters truncated) ... xutime="1472827905">9/2/2016</span> </small><div style="margin-top:5px">This was amazing and funny as hell! Hope to read more soon!</div></td>\n</tr>'), ('2017-02-10 07:49:39.367723', 12060277, 240675261, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5708328&amp;r ... (1031 characters truncated) ...  pretty spot on! I took it for three years in high school. This story is really interesting me. I look forward to reading the rest.</div></td>\n</tr>'), ('2017-02-10 07:49:39.367725', 12060277, 239791283, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (632 characters truncated) ... ke this i think its funny but i do think shape and cerridiwin(can\'t spell sorry) got close a bit too quickly but its still good :)</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-10 07:49:39.367739', 12060277, 240675261, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5708328&amp;r ... (1031 characters truncated) ...  pretty spot on! I took it for three years in high school. This story is really interesting me. I look forward to reading the rest.</div></td>\n</tr>'), ('2017-02-10 07:49:39.367741', 12060277, 239791283, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (632 characters truncated) ... ke this i think its funny but i do think shape and cerridiwin(can\'t spell sorry) got close a bit too quickly but its still good :)</div></td>\n</tr>'))]
23:49:39 reviews: Job OK (59c9a562-be38-4dbd-a09c-3d334cb5c536)
23:49:39 Result is kept for 500 seconds
23:49:39 
23:49:39 *** Listening on chapters, profiles, reviews...
23:49:39 reviews: fanfic.jobs.crawl_reviews(12062984) (38deb513-8225-4651-804f-4b498b597613)
23:49:51 reviews: Job OK (38deb513-8225-4651-804f-4b498b597613)
23:49:51 Result is kept for 500 seconds
23:49:51 
23:49:51 *** Listening on chapters, profiles, reviews...
23:49:51 reviews: fanfic.jobs.crawl_reviews(12063058) (8a801414-5852-49f5-8ddf-bad0a434a0a5)
23:50:15 reviews: Job OK (8a801414-5852-49f5-8ddf-bad0a434a0a5)
23:50:15 Result is kept for 500 seconds
23:50:15 
23:50:15 *** Listening on chapters, profiles, reviews...
23:50:15 reviews: fanfic.jobs.crawl_reviews(12063460) (cdf722a6-fcfb-44be-bad3-9c1cbd78dbf6)
23:52:13 reviews: Job OK (cdf722a6-fcfb-44be-bad3-9c1cbd78dbf6)
23:52:13 Result is kept for 500 seconds
23:52:13 
23:52:13 *** Listening on chapters, profiles, reviews...
23:52:13 reviews: fanfic.jobs.crawl_reviews(12064715) (00951047-1c62-4290-beb1-768ab50bcf14)
23:52:41 reviews: Job OK (00951047-1c62-4290-beb1-768ab50bcf14)
23:52:41 Result is kept for 500 seconds
23:52:41 
23:52:41 *** Listening on chapters, profiles, reviews...
23:52:41 reviews: fanfic.jobs.crawl_reviews(12064820) (5cd800fd-d650-483f-aacb-bdc95f8eca01)
23:52:49 reviews: Job OK (5cd800fd-d650-483f-aacb-bdc95f8eca01)
23:52:49 Result is kept for 500 seconds
23:52:49 
23:52:49 *** Listening on chapters, profiles, reviews...
23:52:49 reviews: fanfic.jobs.crawl_reviews(12065887) (bea535b0-66d4-441d-93f6-46b2a88aea46)
23:54:01 reviews: Job OK (bea535b0-66d4-441d-93f6-46b2a88aea46)
23:54:01 Result is kept for 500 seconds
23:54:01 Cleaning registries for queue: chapters
23:54:01 Cleaning registries for queue: profiles
23:54:01 Cleaning registries for queue: reviews
23:54:01 
23:54:01 *** Listening on chapters, profiles, reviews...
23:54:01 reviews: fanfic.jobs.crawl_reviews(12065950) (bc952eed-02d3-4f47-a113-58a5764aed48)
23:54:31 reviews: Job OK (bc952eed-02d3-4f47-a113-58a5764aed48)
23:54:31 Result is kept for 500 seconds
23:54:31 
23:54:31 *** Listening on chapters, profiles, reviews...
23:54:31 reviews: fanfic.jobs.crawl_reviews(12067300) (e223bfd0-290a-4672-b858-f25eb95c8999)
23:58:10 reviews: Job OK (e223bfd0-290a-4672-b858-f25eb95c8999)
23:58:10 Result is kept for 500 seconds
23:58:10 
23:58:10 *** Listening on chapters, profiles, reviews...
23:58:10 reviews: fanfic.jobs.crawl_reviews(12068079) (7595b742-d4ae-4c62-bbd1-5a0a875d0cce)
00:00:15 reviews: Job OK (7595b742-d4ae-4c62-bbd1-5a0a875d0cce)
00:00:15 Result is kept for 500 seconds
00:00:15 
00:00:15 *** Listening on chapters, profiles, reviews...
00:00:15 reviews: fanfic.jobs.crawl_reviews(12068161) (c3f10112-53b3-437b-9fd2-39d4570602c7)
00:01:18 reviews: Job OK (c3f10112-53b3-437b-9fd2-39d4570602c7)
00:01:18 Result is kept for 500 seconds
00:01:18 
00:01:18 *** Listening on chapters, profiles, reviews...
00:01:18 reviews: fanfic.jobs.crawl_reviews(12068182) (9220b131-c8b3-4294-b38b-b018b8b7823c)
00:03:50 reviews: Job OK (9220b131-c8b3-4294-b38b-b018b8b7823c)
00:03:50 Result is kept for 500 seconds
00:03:50 
00:03:50 *** Listening on chapters, profiles, reviews...
00:03:50 reviews: fanfic.jobs.crawl_reviews(12069764) (0697b79b-06b9-4250-b6c9-1afce1b7358e)
2017-02-10 00:03:54 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:03:54.736949', 12069764, 243479185, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6758406&amp;r ... (962 characters truncated) ... ">10/30/2016</span> </small><div style="margin-top:5px">loved the story, congrats, this is going down as one of my top 3 H/Hr fics.</div></td>\n</tr>'), ('2017-02-10 08:03:54.736954', 12069764, 240373190, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (595 characters truncated) ... mall><div style="margin-top:5px">Fantastic story. One of the best I\'ve ever read. Loved your take on Magic. Thank you for writing.</div></td>\n</tr>'), ('2017-02-10 08:03:54.736957', 12069764, 240344995, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5073352&amp;r ... (977 characters truncated) ... 56">8/5/2016</span> </small><div style="margin-top:5px">right in the feels, well written. I would have liked more but c\'est la vie</div></td>\n</tr>'), ('2017-02-10 08:03:54.736959', 12069764, 243479185, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6758406&amp;r ... (962 characters truncated) ... ">10/30/2016</span> </small><div style="margin-top:5px">loved the story, congrats, this is going down as one of my top 3 H/Hr fics.</div></td>\n</tr>'), ('2017-02-10 08:03:54.736961', 12069764, 240373190, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (595 characters truncated) ... mall><div style="margin-top:5px">Fantastic story. One of the best I\'ve ever read. Loved your take on Magic. Thank you for writing.</div></td>\n</tr>'), ('2017-02-10 08:03:54.736963', 12069764, 240344995, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5073352&amp;r ... (977 characters truncated) ... 56">8/5/2016</span> </small><div style="margin-top:5px">right in the feels, well written. I would have liked more but c\'est la vie</div></td>\n</tr>'))]
00:03:54 reviews: Job OK (0697b79b-06b9-4250-b6c9-1afce1b7358e)
00:03:54 Result is kept for 500 seconds
00:03:54 
00:03:54 *** Listening on chapters, profiles, reviews...
00:03:54 reviews: fanfic.jobs.crawl_reviews(12071024) (1850f4bf-a89f-44e7-9646-95c0a2246785)
2017-02-10 00:03:56 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/12071024/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
00:03:56 reviews: Job OK (1850f4bf-a89f-44e7-9646-95c0a2246785)
00:03:56 Result is kept for 500 seconds
00:03:56 
00:03:56 *** Listening on chapters, profiles, reviews...
00:03:56 reviews: fanfic.jobs.crawl_reviews(12072766) (8e97bd6a-fa0e-49bf-84d5-5bdc8dcbb6fe)
00:06:07 reviews: Job OK (8e97bd6a-fa0e-49bf-84d5-5bdc8dcbb6fe)
00:06:07 Result is kept for 500 seconds
00:06:07 
00:06:07 *** Listening on chapters, profiles, reviews...
00:06:07 reviews: fanfic.jobs.crawl_reviews(12073797) (791b1656-641d-40e6-bd79-6811ad0a7bac)
00:06:16 reviews: Job OK (791b1656-641d-40e6-bd79-6811ad0a7bac)
00:06:16 Result is kept for 500 seconds
00:06:16 
00:06:16 *** Listening on chapters, profiles, reviews...
00:06:16 reviews: fanfic.jobs.crawl_reviews(12074744) (2af4a429-6ce0-4f17-89cf-3702273d872c)
00:06:25 reviews: Job OK (2af4a429-6ce0-4f17-89cf-3702273d872c)
00:06:25 Result is kept for 500 seconds
00:06:25 
00:06:25 *** Listening on chapters, profiles, reviews...
00:06:25 reviews: fanfic.jobs.crawl_reviews(12075872) (0d5cbe3f-fb81-40e4-a6b7-a088509266ff)
00:06:44 reviews: Job OK (0d5cbe3f-fb81-40e4-a6b7-a088509266ff)
00:06:44 Result is kept for 500 seconds
00:06:44 
00:06:44 *** Listening on chapters, profiles, reviews...
00:06:44 reviews: fanfic.jobs.crawl_reviews(12076137) (fad9c770-1b73-4cad-b6cc-4509a7141389)
00:07:27 reviews: Job OK (fad9c770-1b73-4cad-b6cc-4509a7141389)
00:07:27 Result is kept for 500 seconds
00:07:27 
00:07:27 *** Listening on chapters, profiles, reviews...
00:07:27 reviews: fanfic.jobs.crawl_reviews(12076594) (86b1dd9a-cf7a-4d81-8498-8b45c3f87b5c)
2017-02-10 00:07:33 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:07:33.577071', 12076594, 243853030, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7624328&amp;r ... (916 characters truncated) ... utime="1478845191">11/10/2016</span> </small><div style="margin-top:5px">aghhh i wish you could continue this! Amazing and adorable</div></td>\n</tr>'), ('2017-02-10 08:07:33.577090', 12076594, 243853030, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7624328&amp;r ... (916 characters truncated) ... utime="1478845191">11/10/2016</span> </small><div style="margin-top:5px">aghhh i wish you could continue this! Amazing and adorable</div></td>\n</tr>'))]
00:07:33 reviews: Job OK (86b1dd9a-cf7a-4d81-8498-8b45c3f87b5c)
00:07:33 Result is kept for 500 seconds
00:07:33 
00:07:33 *** Listening on chapters, profiles, reviews...
00:07:33 reviews: fanfic.jobs.crawl_reviews(12076771) (ce0ce7a9-7f24-4c48-8788-32d2fe12f25b)
00:07:56 reviews: Job OK (ce0ce7a9-7f24-4c48-8788-32d2fe12f25b)
00:07:56 Result is kept for 500 seconds
00:07:56 
00:07:56 *** Listening on chapters, profiles, reviews...
00:07:56 reviews: fanfic.jobs.crawl_reviews(12076911) (e47f5a5c-3784-4a4e-ac61-2c7101c5242f)
00:08:42 reviews: Job OK (e47f5a5c-3784-4a4e-ac61-2c7101c5242f)
00:08:42 Result is kept for 500 seconds
00:08:42 
00:08:42 *** Listening on chapters, profiles, reviews...
00:08:42 reviews: fanfic.jobs.crawl_reviews(12077554) (9a1a0976-5dcd-4900-a1e8-3db38c7f35cf)
00:08:48 reviews: Job OK (9a1a0976-5dcd-4900-a1e8-3db38c7f35cf)
00:08:48 Result is kept for 500 seconds
00:08:48 
00:08:48 *** Listening on chapters, profiles, reviews...
00:08:48 reviews: fanfic.jobs.crawl_reviews(12077688) (35fc23a6-8c14-4671-aaa3-58e948a07b95)
00:09:04 reviews: Job OK (35fc23a6-8c14-4671-aaa3-58e948a07b95)
00:09:04 Result is kept for 500 seconds
00:09:04 
00:09:04 *** Listening on chapters, profiles, reviews...
00:09:04 reviews: fanfic.jobs.crawl_reviews(12077794) (5bcbfcd7-3f5e-4d47-81da-859b29b6f36e)
00:09:10 reviews: Job OK (5bcbfcd7-3f5e-4d47-81da-859b29b6f36e)
00:09:10 Result is kept for 500 seconds
00:09:10 
00:09:10 *** Listening on chapters, profiles, reviews...
00:09:10 reviews: fanfic.jobs.crawl_reviews(12078201) (dbad3b6b-d68b-4125-9cf1-6e7414bde560)
2017-02-10 00:09:15 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:09:15.653469', 12078201, 244854016, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8427977&amp;r ... (1644 characters truncated) ... airytales. This story gets morphed from cold facts over a long intermediate stage to finally reach the state of a simplistic story.</div></td>\n</tr>'), ('2017-02-10 08:09:15.653473', 12078201, 244794290, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8427977&amp;r ... (1102 characters truncated) ... \nIt is still awful, that they have to run in the first place. But no fictional characters were hurt in the writing of these lines.</div></td>\n</tr>'), ('2017-02-10 08:09:15.653476', 12078201, 244733359, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8427977&amp;r ... (1549 characters truncated) ...  assume Bellatrix had gone insane in Azkaban but obviously you wanted her in that state of mind before she ever entered the prison.</div></td>\n</tr>'), ('2017-02-10 08:09:15.653478', 12078201, 244026045, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3456955&amp;r ... (988 characters truncated) ...  style="margin-top:5px">Thanks, a sad story, but so much of it became head cannon immediately, in dynamics if not In exact details.</div></td>\n</tr>'), ('2017-02-10 08:09:15.653480', 12078201, 242348112, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7199094&amp;r ... (1039 characters truncated) ... retation of the Harry Potter world, and your Mary Potter series, but I think I love this story the most. Thank your for writing it.</div></td>\n</tr>'), ('2017-02-10 08:09:15.653481', 12078201, 242343611, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7199094&amp;r ... (992 characters truncated) ... iv style="margin-top:5px">Damn. Your interpretation of the beginning of Bella\'s madness *hurts* in its innocence. It\'s beautiful.</div></td>\n</tr>'), ('2017-02-10 08:09:15.653483', 12078201, 244854016, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8427977&amp;r ... (1644 characters truncated) ... airytales. This story gets morphed from cold facts over a long intermediate stage to finally reach the state of a simplistic story.</div></td>\n</tr>'), ('2017-02-10 08:09:15.653485', 12078201, 244794290, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8427977&amp;r ... (1102 characters truncated) ... \nIt is still awful, that they have to run in the first place. But no fictional characters were hurt in the writing of these lines.</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-10 08:09:15.653491', 12078201, 242348112, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7199094&amp;r ... (1039 characters truncated) ... retation of the Harry Potter world, and your Mary Potter series, but I think I love this story the most. Thank your for writing it.</div></td>\n</tr>'), ('2017-02-10 08:09:15.653493', 12078201, 242343611, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7199094&amp;r ... (992 characters truncated) ... iv style="margin-top:5px">Damn. Your interpretation of the beginning of Bella\'s madness *hurts* in its innocence. It\'s beautiful.</div></td>\n</tr>'))]
00:09:15 reviews: Job OK (dbad3b6b-d68b-4125-9cf1-6e7414bde560)
00:09:15 Result is kept for 500 seconds
00:09:15 
00:09:15 *** Listening on chapters, profiles, reviews...
00:09:15 reviews: fanfic.jobs.crawl_reviews(12078497) (90607a26-6b31-4fd3-b48f-62c8f78cbde7)
00:12:03 reviews: Job OK (90607a26-6b31-4fd3-b48f-62c8f78cbde7)
00:12:03 Result is kept for 500 seconds
00:12:03 
00:12:03 *** Listening on chapters, profiles, reviews...
00:12:03 reviews: fanfic.jobs.crawl_reviews(12079388) (43fa4555-4c71-429f-bc77-45a75405afe1)
00:14:06 reviews: Job OK (43fa4555-4c71-429f-bc77-45a75405afe1)
00:14:06 Result is kept for 500 seconds
00:14:06 
00:14:06 *** Listening on chapters, profiles, reviews...
00:14:06 reviews: fanfic.jobs.crawl_reviews(12079410) (b7005c03-5f8a-4396-8a69-54b50bba6edd)
00:14:38 reviews: Job OK (b7005c03-5f8a-4396-8a69-54b50bba6edd)
00:14:38 Result is kept for 500 seconds
00:14:38 
00:14:38 *** Listening on chapters, profiles, reviews...
00:14:38 reviews: fanfic.jobs.crawl_reviews(12079948) (9ceb50f4-f7b5-4ed0-8615-0f4de053be02)
00:14:48 reviews: Job OK (9ceb50f4-f7b5-4ed0-8615-0f4de053be02)
00:14:48 Result is kept for 500 seconds
00:14:48 
00:14:48 *** Listening on chapters, profiles, reviews...
00:14:48 reviews: fanfic.jobs.crawl_reviews(12080141) (351fe2e2-adb1-41cc-af6f-cab0e62d1d1f)
00:15:29 reviews: Job OK (351fe2e2-adb1-41cc-af6f-cab0e62d1d1f)
00:15:29 Result is kept for 500 seconds
00:15:29 
00:15:29 *** Listening on chapters, profiles, reviews...
00:15:29 reviews: fanfic.jobs.crawl_reviews(12081716) (565ed76b-e850-4c59-948f-8a21c0d44d8c)
2017-02-10 00:15:35 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:15:35.963904', 12081716, 246639936, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5428022&amp;r ... (1440 characters truncated) ...  with a muggle since he must have been sheltered as a child...so he is kinda brain washed almost as much as his father and mother..</div></td>\n</tr>'), ('2017-02-10 08:15:35.963910', 12081716, 244451000, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2371936&amp;r ... (976 characters truncated) ... span> </small><div style="margin-top:5px">When you know the main oc is a Mary Sue, but the writing is so good that you don\'t care.</div></td>\n</tr>'), ('2017-02-10 08:15:35.963913', 12081716, 244322055, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (522 characters truncated) ... "color:gray">chapter 16 . <span data-xutime="1480097332">11/25/2016</span> </small><div style="margin-top:5px">Write moooorrrreeee!</div></td>\n</tr>'), ('2017-02-10 08:15:35.963915', 12081716, 243853561, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (645 characters truncated) ... first three words of your story, I already had his song in my head while I was reading it. Can\'t believe it was actually his song.</div></td>\n</tr>'), ('2017-02-10 08:15:35.963917', 12081716, 243837922, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7749357&amp;r ... (941 characters truncated) ...  so so much. It\'s amazing! I\'m really nervous about how things will go for draco. <br>\n(sorry if there are any grammar mistakes)</div></td>\n</tr>'), ('2017-02-10 08:15:35.963919', 12081716, 243225251, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7749357&amp;r ... (849 characters truncated) ... time="1477244971">10/23/2016</span> </small><div style="margin-top:5px">I looooooooove this story soon much ! It really is amazing!</div></td>\n</tr>'), ('2017-02-10 08:15:35.963921', 12081716, 243045756, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (614 characters truncated) ... argin-top:5px">Yay! I cant wait to read the next chapter! Cindy is so much like me! I would keep reading but i have to go to sleep.</div></td>\n</tr>'), ('2017-02-10 08:15:35.963923', 12081716, 242865961, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (565 characters truncated) ... 476307736">10/12/2016</span> </small><div style="margin-top:5px">Noooooooooooooo you have got to write the nxt chapter pllzzzzzzzzz</div></td>\n</tr>')  ... displaying 10 of 20 total bound parameter sets ...  ('2017-02-10 08:15:35.963945', 12081716, 242821642, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8185425&amp;r ... (1094 characters truncated) ... edom before he dies in the 5th book. After all he will still going to the ministry to protect harry since he is apart of the order.</div></td>\n</tr>'), ('2017-02-10 08:15:35.963947', 12081716, 240232588, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8097834&amp;r ... (903 characters truncated) ... chapter 1 . <span data-xutime="1470185605">8/2/2016</span> </small><div style="margin-top:5px">Loved how you used a Jon Cozart song</div></td>\n</tr>'))]
00:15:35 reviews: Job OK (565ed76b-e850-4c59-948f-8a21c0d44d8c)
00:15:36 Result is kept for 500 seconds
00:15:36 
00:15:36 *** Listening on chapters, profiles, reviews...
00:15:36 reviews: fanfic.jobs.crawl_reviews(12081861) (d957c78e-db47-4598-a63f-6c1296e8cf42)
00:15:46 reviews: Job OK (d957c78e-db47-4598-a63f-6c1296e8cf42)
00:15:46 Result is kept for 500 seconds
00:15:46 
00:15:46 *** Listening on chapters, profiles, reviews...
00:15:46 reviews: fanfic.jobs.crawl_reviews(12081909) (4e7d2621-0240-4b7b-b69c-002f5fee1984)
00:16:13 reviews: Job OK (4e7d2621-0240-4b7b-b69c-002f5fee1984)
00:16:13 Result is kept for 500 seconds
00:16:13 
00:16:13 *** Listening on chapters, profiles, reviews...
00:16:13 reviews: fanfic.jobs.crawl_reviews(12081939) (24f06796-4b64-4ed1-9bda-bdecdcd7570c)
2017-02-10 00:16:18 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:16:18.753867', 12081939, 243050117, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5276668&amp;r ... (814 characters truncated) ... or:gray">chapter 20 . <span data-xutime="1476776926">10/18/2016</span> </small><div style="margin-top:5px">Heart touching chapter..</div></td>\n</tr>'), ('2017-02-10 08:16:18.753872', 12081939, 242657112, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5276668&amp;r ... (869 characters truncated) ... /6/2016</span> </small><div style="margin-top:5px">Another good chapter.. where did you get the dragon fly idea? Mysterious island?</div></td>\n</tr>'), ('2017-02-10 08:16:18.753874', 12081939, 242470009, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (696 characters truncated) ... ng will be blank.. then you fill that with different character\'s point of view.. I would like to see Wendy\'s point of view also..</div></td>\n</tr>'), ('2017-02-10 08:16:18.753876', 12081939, 242458534, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (595 characters truncated) ... small><div style="margin-top:5px">I loved this chapter. It was kinda sweet. I can\'t wait to see how everyone else will get tested!</div></td>\n</tr>'), ('2017-02-10 08:16:18.753878', 12081939, 242378693, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5276668&amp;r ... (950 characters truncated) ... ng.. you have proven that you are great at changing plans and those came very good..<br>\n<br>\nEager to read next turn of events..</div></td>\n</tr>'), ('2017-02-10 08:16:18.753881', 12081939, 241619396, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (893 characters truncated) ... g just makes me feel uneasy... Maybe that was what u were going for? Though I love this story and can\'t wait for the next chapter!</div></td>\n</tr>'), ('2017-02-10 08:16:18.753883', 12081939, 241202581, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5738805&amp;r ... (1260 characters truncated) ... t\'s just that great. The friend fueds are a great way to add some drama and potential character growth. Can\'t wait for next time.</div></td>\n</tr>'), ('2017-02-10 08:16:18.753885', 12081939, 240495485, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5738805&amp;r ... (939 characters truncated) ... utime="1470747042">8/9/2016</span> </small><div style="margin-top:5px">The plot thickens... I can\'t wait to see what happens next.</div></td>\n</tr>')  ... displaying 10 of 18 total bound parameter sets ...  ('2017-02-10 08:16:18.753903', 12081939, 240495485, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5738805&amp;r ... (939 characters truncated) ... utime="1470747042">8/9/2016</span> </small><div style="margin-top:5px">The plot thickens... I can\'t wait to see what happens next.</div></td>\n</tr>'), ('2017-02-10 08:16:18.753905', 12081939, 240390336, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5738805&amp;r ... (918 characters truncated) ... pter 4 . <span data-xutime="1470528699">8/6/2016</span> </small><div style="margin-top:5px">This fic is awesome please update soon.</div></td>\n</tr>'))]
00:16:18 reviews: Job OK (24f06796-4b64-4ed1-9bda-bdecdcd7570c)
00:16:18 Result is kept for 500 seconds
00:16:18 
00:16:18 *** Listening on chapters, profiles, reviews...
00:16:18 reviews: fanfic.jobs.crawl_reviews(12082695) (5e92e185-3c59-48e5-bec4-f83ceac6012f)
00:16:47 reviews: Job OK (5e92e185-3c59-48e5-bec4-f83ceac6012f)
00:16:47 Result is kept for 500 seconds
00:16:47 
00:16:47 *** Listening on chapters, profiles, reviews...
00:16:47 reviews: fanfic.jobs.crawl_reviews(12085137) (4c8bab47-a50f-47a7-9c8f-773f9002d46c)
00:17:14 reviews: Job OK (4c8bab47-a50f-47a7-9c8f-773f9002d46c)
00:17:14 Result is kept for 500 seconds
00:17:14 
00:17:14 *** Listening on chapters, profiles, reviews...
00:17:14 reviews: fanfic.jobs.crawl_reviews(12085784) (9d927864-d5c7-4079-899d-f0483ca532b8)
2017-02-10 00:17:20 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:17:20.924166', 12085784, 243641897, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7955117&amp;r ... (856 characters truncated) ...  data-xutime="1478303720">11/4/2016</span> </small><div style="margin-top:5px">Wow. This last chapter was very good. Big thumbs up.</div></td>\n</tr>'), ('2017-02-10 08:17:20.924170', 12085784, 243631538, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (559 characters truncated) ... ime="1478278226">11/4/2016</span> </small><div style="margin-top:5px">This is just too grim and hopeless for me. Good luck with it.</div></td>\n</tr>'), ('2017-02-10 08:17:20.924173', 12085784, 243619387, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5909363&amp;r ... (1064 characters truncated) ... ver. The pain, the regret, the anger, the lashing out is devastating, and Hermione\'s sweet repentance is heartbreaking. Well done.</div></td>\n</tr>'), ('2017-02-10 08:17:20.924175', 12085784, 243618561, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5909363&amp;r ... (1076 characters truncated) ... dy. Time turners? A mysterious Malfoy? And was there a clue in the inter-department meeting, or was it truly a waste of time? Hmmm.</div></td>\n</tr>'), ('2017-02-10 08:17:20.924177', 12085784, 243610980, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (620 characters truncated) ... top:5px">I know she lost her parents, but at this point Hermione\'s not worth being in love with, and I\'m Dramione no matter what.</div></td>\n</tr>'), ('2017-02-10 08:17:20.924180', 12085784, 243268421, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (848 characters truncated) ... or Krum. A French accent elongates the \'e\'s and \'r\'s, turns \'s\'s into \'z\'s, and drops the \'h\'s at the beginning of words.</div></td>\n</tr>'), ('2017-02-10 08:17:20.924182', 12085784, 242878500, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4014777&amp;r ... (1027 characters truncated) ... more chapters, but if this is how it stands, I am afraid I\'ll have to go. Pity, because I really was enjoying the story very much.</div></td>\n</tr>'), ('2017-02-10 08:17:20.924184', 12085784, 242875119, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4014777&amp;r ... (857 characters truncated) ... 476326849">10/12/2016</span> </small><div style="margin-top:5px">Ooh. Was Bellatrix Polyjuiced and Molly Weasley got the wrong one?</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-10 08:17:20.924215', 12085784, 240516029, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3468112&amp;r ... (856 characters truncated) ... 6</span> </small><div style="margin-top:5px">Yes! All i want from a Dramione story. Slow build up, drama, Bellatrix. Keep it going.</div></td>\n</tr>'), ('2017-02-10 08:17:20.924217', 12085784, 240401401, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1018648&amp;r ... (830 characters truncated) ... span data-xutime="1470548492">8/6/2016</span> </small><div style="margin-top:5px">Wow. I\'m in awe. I love this stroy. So fabulous.</div></td>\n</tr>'))]
00:17:20 reviews: Job OK (9d927864-d5c7-4079-899d-f0483ca532b8)
00:17:20 Result is kept for 500 seconds
00:17:20 
00:17:20 *** Listening on chapters, profiles, reviews...
00:17:20 reviews: fanfic.jobs.crawl_reviews(12085793) (7ebfb0c6-d331-4208-9779-19b597bf39ba)
00:17:30 reviews: Job OK (7ebfb0c6-d331-4208-9779-19b597bf39ba)
00:17:30 Result is kept for 500 seconds
00:17:30 
00:17:30 *** Listening on chapters, profiles, reviews...
00:17:30 reviews: fanfic.jobs.crawl_reviews(12086572) (20f889f1-b091-4c51-9b04-790ef7a90672)
00:17:35 reviews: Job OK (20f889f1-b091-4c51-9b04-790ef7a90672)
00:17:35 Result is kept for 500 seconds
00:17:35 
00:17:35 *** Listening on chapters, profiles, reviews...
00:17:35 reviews: fanfic.jobs.crawl_reviews(12086723) (319818c1-4fdc-4682-ba0c-e067b1d1f9ab)
00:17:54 reviews: Job OK (319818c1-4fdc-4682-ba0c-e067b1d1f9ab)
00:17:54 Result is kept for 500 seconds
00:17:54 
00:17:54 *** Listening on chapters, profiles, reviews...
00:17:54 reviews: fanfic.jobs.crawl_reviews(12087047) (9a2b3d5a-e245-4cf9-9627-f7d30288bd82)
00:18:20 reviews: Job OK (9a2b3d5a-e245-4cf9-9627-f7d30288bd82)
00:18:20 Result is kept for 500 seconds
00:18:20 
00:18:20 *** Listening on chapters, profiles, reviews...
00:18:20 reviews: fanfic.jobs.crawl_reviews(12087748) (bcbcfb1f-c833-4f68-8c0d-977e9af3aebf)
00:18:43 reviews: Job OK (bcbcfb1f-c833-4f68-8c0d-977e9af3aebf)
00:18:43 Result is kept for 500 seconds
00:18:43 
00:18:43 *** Listening on chapters, profiles, reviews...
00:18:43 reviews: fanfic.jobs.crawl_reviews(12088250) (4ce04bac-4680-45e5-84d9-b857a5faea23)
00:19:12 reviews: Job OK (4ce04bac-4680-45e5-84d9-b857a5faea23)
00:19:12 Result is kept for 500 seconds
00:19:12 
00:19:12 *** Listening on chapters, profiles, reviews...
00:19:12 reviews: fanfic.jobs.crawl_reviews(12089217) (11ed5ab6-985a-4345-a04c-9762b6de0259)
00:20:12 reviews: Job OK (11ed5ab6-985a-4345-a04c-9762b6de0259)
00:20:12 Result is kept for 500 seconds
00:20:12 
00:20:12 *** Listening on chapters, profiles, reviews...
00:20:12 reviews: fanfic.jobs.crawl_reviews(12090753) (054afc70-eeec-4740-ad88-f17f56bd4c6e)
00:20:45 reviews: Job OK (054afc70-eeec-4740-ad88-f17f56bd4c6e)
00:20:45 Result is kept for 500 seconds
00:20:45 
00:20:45 *** Listening on chapters, profiles, reviews...
00:20:45 reviews: fanfic.jobs.crawl_reviews(12092256) (236078e7-92e7-4f25-a56c-55018105e139)
00:21:00 reviews: Job OK (236078e7-92e7-4f25-a56c-55018105e139)
00:21:00 Result is kept for 500 seconds
00:21:00 
00:21:00 *** Listening on chapters, profiles, reviews...
00:21:00 reviews: fanfic.jobs.crawl_reviews(12092408) (69c220f1-6841-487e-b29f-048467004305)
00:21:04 reviews: Job OK (69c220f1-6841-487e-b29f-048467004305)
00:21:04 Result is kept for 500 seconds
00:21:04 
00:21:04 *** Listening on chapters, profiles, reviews...
00:21:04 reviews: fanfic.jobs.crawl_reviews(12092811) (35f7d1fa-425e-4c80-b87d-e57a4b32c194)
2017-02-10 00:21:09 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:21:09.685602', 12092811, 244389304, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8476824&amp;r ... (1012 characters truncated) ... interactions Draco has with the people around him, they just add so much to him as a character. Should I hope for a sequel to this?</div></td>\n</tr>'), ('2017-02-10 08:21:09.685609', 12092811, 244188666, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3099905&amp;r ... (1303 characters truncated) ... n 2 D bad guys and you portrayed everyone very well, especially Crabbe n Hoyle. <br>\nHope to see more installments of this series!</div></td>\n</tr>'), ('2017-02-10 08:21:09.685611', 12092811, 242999267, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=656323&amp;rw ... (802 characters truncated) ... style="color:gray">chapter 22 . <span data-xutime="1476655857">10/16/2016</span> </small><div style="margin-top:5px">Great chapter!</div></td>\n</tr>'), ('2017-02-10 08:21:09.685613', 12092811, 241659116, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7891579&amp;r ... (1351 characters truncated) ... g you may have them killed off to account for why they did not go to Hogwarts, it will be interesting to see what you do with them.</div></td>\n</tr>'), ('2017-02-10 08:21:09.685615', 12092811, 241396444, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7940966&amp;r ... (915 characters truncated) ... :5px">OMG can I just say that I absolutely LOVE the way you write. This my friend is amazing seriously. I cant wait for the update!</div></td>\n</tr>'), ('2017-02-10 08:21:09.685617', 12092811, 240699771, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (919 characters truncated) ... r:gray">chapter 4 . <span data-xutime="1471191287">8/14/2016</span> </small><div style="margin-top:5px">love the crabbe interaction</div></td>\n</tr>'), ('2017-02-10 08:21:09.685620', 12092811, 240699761, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2135044&amp;r ... (908 characters truncated) ... style="color:gray">chapter 3 . <span data-xutime="1471191257">8/14/2016</span> </small><div style="margin-top:5px">love the letters</div></td>\n</tr>'), ('2017-02-10 08:21:09.685622', 12092811, 240625032, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2387999&amp;r ... (1012 characters truncated) ... x">It\'s fascinating to see things from Draco\'s point of view. The only thing not identical to canon would be him having siblings.</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-10 08:21:09.685652', 12092811, 240486150, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (510 characters truncated) ... l style="color:gray">chapter 1 . <span data-xutime="1470718350">8/8/2016</span> </small><div style="margin-top:5px">I\'m intrigued!</div></td>\n</tr>'), ('2017-02-10 08:21:09.685654', 12092811, 240486149, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (526 characters truncated) ... gray">chapter 1 . <span data-xutime="1470717512">8/8/2016</span> </small><div style="margin-top:5px">Awesome, please finish quickly</div></td>\n</tr>'))]
00:21:09 reviews: Job OK (35f7d1fa-425e-4c80-b87d-e57a4b32c194)
00:21:09 Result is kept for 500 seconds
00:21:09 
00:21:09 *** Listening on chapters, profiles, reviews...
00:21:09 reviews: fanfic.jobs.crawl_reviews(12093063) (a8d5dc8b-946c-47f0-98ab-35372e74b22a)
2017-02-10 00:21:14 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:21:14.028878', 12093063, 246171259, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5023661&amp;r ... (1216 characters truncated) ... es. Pero aún así me sigue entreteniendo.<br>\nPor favor no lo dejes, la paciencia es una virtud.<br>\n<br>\nHasta otra oportunidad.</div></td>\n</tr>'), ('2017-02-10 08:21:14.028883', 12093063, 246020770, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (605 characters truncated) ... e="margin-top:5px">You have to keep writing this fic. I have read each in this series and look forward to the next chapter. Please?</div></td>\n</tr>'), ('2017-02-10 08:21:14.028886', 12093063, 246171259, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5023661&amp;r ... (1216 characters truncated) ... es. Pero aún así me sigue entreteniendo.<br>\nPor favor no lo dejes, la paciencia es una virtud.<br>\n<br>\nHasta otra oportunidad.</div></td>\n</tr>'), ('2017-02-10 08:21:14.028888', 12093063, 246020770, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (605 characters truncated) ... e="margin-top:5px">You have to keep writing this fic. I have read each in this series and look forward to the next chapter. Please?</div></td>\n</tr>'))]
00:21:14 reviews: Job OK (a8d5dc8b-946c-47f0-98ab-35372e74b22a)
00:21:14 Result is kept for 500 seconds
00:21:14 
00:21:14 *** Listening on chapters, profiles, reviews...
00:21:14 reviews: fanfic.jobs.crawl_reviews(12094298) (7f97cbab-021d-4e5a-b486-b76ab2bd0f31)
00:22:02 reviews: Job OK (7f97cbab-021d-4e5a-b486-b76ab2bd0f31)
00:22:02 Result is kept for 500 seconds
00:22:02 
00:22:02 *** Listening on chapters, profiles, reviews...
00:22:02 reviews: fanfic.jobs.crawl_reviews(12094305) (a1e6d9fc-3d2e-48a7-ad2d-23e6dd0a558d)
00:22:31 reviews: Job OK (a1e6d9fc-3d2e-48a7-ad2d-23e6dd0a558d)
00:22:31 Result is kept for 500 seconds
00:22:31 
00:22:31 *** Listening on chapters, profiles, reviews...
00:22:31 reviews: fanfic.jobs.crawl_reviews(12094708) (637eda13-6555-4a4e-9293-8f9e795cf317)
2017-02-10 00:22:36 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:22:36.946544', 12094708, 240534593, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (659 characters truncated) ... nch word for "victory"). Apologies if this appears as a flame but it\'s massive pet peeve of mine when people spell her name wrong.</div></td>\n</tr>'), ('2017-02-10 08:22:36.946550', 12094708, 240534593, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (659 characters truncated) ... nch word for "victory"). Apologies if this appears as a flame but it\'s massive pet peeve of mine when people spell her name wrong.</div></td>\n</tr>'))]
00:22:36 reviews: Job OK (637eda13-6555-4a4e-9293-8f9e795cf317)
00:22:36 Result is kept for 500 seconds
00:22:36 
00:22:36 *** Listening on chapters, profiles, reviews...
00:22:36 reviews: fanfic.jobs.crawl_reviews(12096299) (186a1bc8-b8ee-45b0-8eab-f9c5987fcbf5)
00:22:47 reviews: Job OK (186a1bc8-b8ee-45b0-8eab-f9c5987fcbf5)
00:22:47 Result is kept for 500 seconds
00:22:47 
00:22:47 *** Listening on chapters, profiles, reviews...
00:22:47 reviews: fanfic.jobs.crawl_reviews(12096694) (6b2fc50d-c758-4203-a0e7-790df1e79799)
00:23:18 reviews: Job OK (6b2fc50d-c758-4203-a0e7-790df1e79799)
00:23:18 Result is kept for 500 seconds
00:23:18 
00:23:18 *** Listening on chapters, profiles, reviews...
00:23:18 reviews: fanfic.jobs.crawl_reviews(12097425) (8562c8bd-cbf8-47ca-ade0-0ee088209f3a)
2017-02-10 00:23:24 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:23:24.638815', 12097425, 241438194, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6287922&amp;r ... (905 characters truncated) ... > </small><div style="margin-top:5px">Hey there! <br>\n<br>\nYou\'re story is really awesome! I can\'t wait for the next chapter :D</div></td>\n</tr>'), ('2017-02-10 08:23:24.638820', 12097425, 241229327, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2105716&amp;r ... (918 characters truncated) ... pter 11 . <span data-xutime="1472344534">8/27/2016</span> </small><div style="margin-top:5px">Good story! Please update again soon!</div></td>\n</tr>'), ('2017-02-10 08:23:24.638822', 12097425, 241212525, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7175819&amp;r ... (809 characters truncated) ... ="color:gray">chapter 11 . <span data-xutime="1472310073">8/27/2016</span> </small><div style="margin-top:5px">thanks for updating!</div></td>\n</tr>'), ('2017-02-10 08:23:24.638825', 12097425, 240762238, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (530 characters truncated) ... y">chapter 10 . <span data-xutime="1471140476">8/13/2016</span> </small><div style="margin-top:5px">Really good <br>\nPlease finish</div></td>\n</tr>'), ('2017-02-10 08:23:24.638827', 12097425, 241438194, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6287922&amp;r ... (905 characters truncated) ... > </small><div style="margin-top:5px">Hey there! <br>\n<br>\nYou\'re story is really awesome! I can\'t wait for the next chapter :D</div></td>\n</tr>'), ('2017-02-10 08:23:24.638829', 12097425, 241229327, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2105716&amp;r ... (918 characters truncated) ... pter 11 . <span data-xutime="1472344534">8/27/2016</span> </small><div style="margin-top:5px">Good story! Please update again soon!</div></td>\n</tr>'), ('2017-02-10 08:23:24.638831', 12097425, 241212525, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7175819&amp;r ... (809 characters truncated) ... ="color:gray">chapter 11 . <span data-xutime="1472310073">8/27/2016</span> </small><div style="margin-top:5px">thanks for updating!</div></td>\n</tr>'), ('2017-02-10 08:23:24.638833', 12097425, 240762238, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (530 characters truncated) ... y">chapter 10 . <span data-xutime="1471140476">8/13/2016</span> </small><div style="margin-top:5px">Really good <br>\nPlease finish</div></td>\n</tr>'))]
00:23:24 reviews: Job OK (8562c8bd-cbf8-47ca-ade0-0ee088209f3a)
00:23:24 Result is kept for 500 seconds
00:23:24 
00:23:24 *** Listening on chapters, profiles, reviews...
00:23:24 reviews: fanfic.jobs.crawl_reviews(12101236) (d99e0305-9bb9-4238-a589-77ddc4d6b82c)
00:24:42 reviews: Job OK (d99e0305-9bb9-4238-a589-77ddc4d6b82c)
00:24:42 Result is kept for 500 seconds
00:24:42 
00:24:42 *** Listening on chapters, profiles, reviews...
00:24:42 reviews: fanfic.jobs.crawl_reviews(12101417) (ac74d9e0-b285-4325-884f-122e47c601d6)
00:25:11 reviews: Job OK (ac74d9e0-b285-4325-884f-122e47c601d6)
00:25:11 Result is kept for 500 seconds
00:25:11 
00:25:11 *** Listening on chapters, profiles, reviews...
00:25:11 reviews: fanfic.jobs.crawl_reviews(12102438) (3ae57a34-642a-4446-9dea-8a96a2b0802b)
00:25:20 reviews: Job OK (3ae57a34-642a-4446-9dea-8a96a2b0802b)
00:25:20 Result is kept for 500 seconds
00:25:20 
00:25:20 *** Listening on chapters, profiles, reviews...
00:25:20 reviews: fanfic.jobs.crawl_reviews(12102652) (1e39b551-6e8a-4271-a057-1df359adb925)
00:25:29 reviews: Job OK (1e39b551-6e8a-4271-a057-1df359adb925)
00:25:29 Result is kept for 500 seconds
00:25:29 
00:25:29 *** Listening on chapters, profiles, reviews...
00:25:29 reviews: fanfic.jobs.crawl_reviews(12103432) (403bb54d-15fc-457d-af76-c09a374de0c4)
00:26:15 reviews: Job OK (403bb54d-15fc-457d-af76-c09a374de0c4)
00:26:15 Result is kept for 500 seconds
00:26:15 
00:26:15 *** Listening on chapters, profiles, reviews...
00:26:15 reviews: fanfic.jobs.crawl_reviews(12103590) (614f8102-29d8-4b44-9b20-68498e24d9d5)
00:26:51 reviews: Job OK (614f8102-29d8-4b44-9b20-68498e24d9d5)
00:26:51 Result is kept for 500 seconds
00:26:51 
00:26:51 *** Listening on chapters, profiles, reviews...
00:26:51 reviews: fanfic.jobs.crawl_reviews(12104091) (b061aea0-7d2f-4571-b92f-6c5fbf2f7b2a)
00:27:11 reviews: Job OK (b061aea0-7d2f-4571-b92f-6c5fbf2f7b2a)
00:27:11 Result is kept for 500 seconds
00:27:11 
00:27:11 *** Listening on chapters, profiles, reviews...
00:27:11 reviews: fanfic.jobs.crawl_reviews(12104688) (764751a3-8e2d-4a17-9f79-cf8e211ccc8c)
00:34:34 reviews: Job OK (764751a3-8e2d-4a17-9f79-cf8e211ccc8c)
00:34:34 Result is kept for 500 seconds
00:34:34 
00:34:34 *** Listening on chapters, profiles, reviews...
00:34:34 reviews: fanfic.jobs.crawl_reviews(12106964) (03551535-a430-4d6d-8605-1c4b77561f5d)
2017-02-10 00:34:36 [scrapy] ERROR: Spider error processing <GET https://www.fanfiction.net/r/12106964/> (referer: None)
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "./fanfic/spiders/review.py", line 31, in parse
    re.search('reviewid=(?P<id>[0-9]+)', html)
AttributeError: 'NoneType' object has no attribute 'group'
00:34:36 reviews: Job OK (03551535-a430-4d6d-8605-1c4b77561f5d)
00:34:36 Result is kept for 500 seconds
00:34:36 
00:34:36 *** Listening on chapters, profiles, reviews...
00:34:36 reviews: fanfic.jobs.crawl_reviews(12107372) (4e9ae394-ca27-4b1d-a485-0760f0fcccbf)
00:34:50 reviews: Job OK (4e9ae394-ca27-4b1d-a485-0760f0fcccbf)
00:34:50 Result is kept for 500 seconds
00:34:50 
00:34:50 *** Listening on chapters, profiles, reviews...
00:34:50 reviews: fanfic.jobs.crawl_reviews(12108051) (33f79fb9-49a8-46cd-9e86-d9c881644806)
00:34:55 reviews: Job OK (33f79fb9-49a8-46cd-9e86-d9c881644806)
00:34:55 Result is kept for 500 seconds
00:34:55 
00:34:55 *** Listening on chapters, profiles, reviews...
00:34:55 reviews: fanfic.jobs.crawl_reviews(12110896) (dbcd06f9-a5d8-4286-bd59-3d8f3a0292c2)
00:35:00 reviews: Job OK (dbcd06f9-a5d8-4286-bd59-3d8f3a0292c2)
00:35:00 Result is kept for 500 seconds
00:35:00 
00:35:00 *** Listening on chapters, profiles, reviews...
00:35:00 reviews: fanfic.jobs.crawl_reviews(12115933) (5851093f-70da-4b5d-a0c7-c44f9190f062)
00:37:35 reviews: Job OK (5851093f-70da-4b5d-a0c7-c44f9190f062)
00:37:35 Result is kept for 500 seconds
00:37:35 
00:37:35 *** Listening on chapters, profiles, reviews...
00:37:35 reviews: fanfic.jobs.crawl_reviews(12117079) (e65d7dd3-6203-4052-ae73-4587abede344)
00:37:48 reviews: Job OK (e65d7dd3-6203-4052-ae73-4587abede344)
00:37:48 Result is kept for 500 seconds
00:37:48 
00:37:48 *** Listening on chapters, profiles, reviews...
00:37:48 reviews: fanfic.jobs.crawl_reviews(12117159) (d416e55d-7ee0-48c4-a154-6f78461b5965)
00:38:10 reviews: Job OK (d416e55d-7ee0-48c4-a154-6f78461b5965)
00:38:10 Result is kept for 500 seconds
00:38:10 
00:38:10 *** Listening on chapters, profiles, reviews...
00:38:10 reviews: fanfic.jobs.crawl_reviews(12117245) (b0ebf78b-4f88-42be-8a92-fa7cbf08a19d)
00:40:55 reviews: Job OK (b0ebf78b-4f88-42be-8a92-fa7cbf08a19d)
00:40:55 Result is kept for 500 seconds
00:40:55 
00:40:55 *** Listening on chapters, profiles, reviews...
00:40:55 reviews: fanfic.jobs.crawl_reviews(12117667) (29f48ecf-333a-42b8-acfd-2e036374f1e8)
2017-02-10 00:40:59 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:40:59.342355', 12117667, 244044327, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4181992&amp;r ... (1060 characters truncated) ... ngs. I love all your OC characters and can\'t wait for the next chapter. Please for the love of Odin update soon! I\'ll be waiting!</div></td>\n</tr>'), ('2017-02-10 08:40:59.342360', 12117667, 242837199, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8103207&amp;r ... (2168 characters truncated) ... thing huge. Except those two things, an awesome chapter and I hope to find what happens next, especially after that last paragraph!</div></td>\n</tr>'), ('2017-02-10 08:40:59.342362', 12117667, 242671986, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8103207&amp;r ... (1238 characters truncated) ... s chapter, able to be both serious and funny at the same time, now that\'s a talent. Looking forward to the next update for sure :D</div></td>\n</tr>'), ('2017-02-10 08:40:59.342364', 12117667, 242199484, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8103207&amp;r ... (1934 characters truncated) ... able to do that, and I applaud your writing style. Well as always I\'ve enjoyed this chapter and I look forward to the next update!</div></td>\n</tr>'), ('2017-02-10 08:40:59.342366', 12117667, 241797191, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8103207&amp;r ... (975 characters truncated) ... 1/2016</span> </small><div style="margin-top:5px">Oh shit, I forgot to mention the plot twist. Now I have to see what happens next.</div></td>\n</tr>'), ('2017-02-10 08:40:59.342368', 12117667, 241797142, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8103207&amp;r ... (1549 characters truncated) ...  can understand that\'s frustrating. But that\'s there loss for missing out. :D P.S. where did you get the names Astra and Brynjar?</div></td>\n</tr>'), ('2017-02-10 08:40:59.342370', 12117667, 241422739, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8103207&amp;r ... (1197 characters truncated) ... d this chapter definitely is just a well done. this is a really good story you have here, I look forward to see how this turns out.</div></td>\n</tr>'), ('2017-02-10 08:40:59.342372', 12117667, 241109195, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8103207&amp;r ... (932 characters truncated) ... pter 1 . <span data-xutime="1472070791">8/24/2016</span> </small><div style="margin-top:5px">Not a bad start. I\'ll give it a shot.</div></td>\n</tr>')  ... displaying 10 of 16 total bound parameter sets ...  ('2017-02-10 08:40:59.342386', 12117667, 241422739, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8103207&amp;r ... (1197 characters truncated) ... d this chapter definitely is just a well done. this is a really good story you have here, I look forward to see how this turns out.</div></td>\n</tr>'), ('2017-02-10 08:40:59.342388', 12117667, 241109195, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8103207&amp;r ... (932 characters truncated) ... pter 1 . <span data-xutime="1472070791">8/24/2016</span> </small><div style="margin-top:5px">Not a bad start. I\'ll give it a shot.</div></td>\n</tr>'))]
00:40:59 reviews: Job OK (29f48ecf-333a-42b8-acfd-2e036374f1e8)
00:40:59 Result is kept for 500 seconds
00:40:59 
00:40:59 *** Listening on chapters, profiles, reviews...
00:40:59 reviews: fanfic.jobs.crawl_reviews(12119082) (b76412d6-41e3-4759-9106-e92ff118436a)
00:42:26 reviews: Job OK (b76412d6-41e3-4759-9106-e92ff118436a)
00:42:26 Result is kept for 500 seconds
00:42:26 
00:42:26 *** Listening on chapters, profiles, reviews...
00:42:26 reviews: fanfic.jobs.crawl_reviews(12121002) (010d4db3-6adb-4744-8650-cf9f85d010ac)
2017-02-10 00:42:31 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:42:31.701366', 12121002, 241453128, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (995 characters truncated) ...  Marauder, good job!).<br>\nSo, keep going, I love you, have fun, don\'t give up and eat your vegetables.<br>\nThanks for the read!</div></td>\n</tr>'), ('2017-02-10 08:42:31.701370', 12121002, 241453128, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (995 characters truncated) ...  Marauder, good job!).<br>\nSo, keep going, I love you, have fun, don\'t give up and eat your vegetables.<br>\nThanks for the read!</div></td>\n</tr>'))]
00:42:31 reviews: Job OK (010d4db3-6adb-4744-8650-cf9f85d010ac)
00:42:31 Result is kept for 500 seconds
00:42:31 
00:42:31 *** Listening on chapters, profiles, reviews...
00:42:31 reviews: fanfic.jobs.crawl_reviews(12121323) (74d69964-299d-4bc3-99dd-ef777c0ec227)
00:43:32 reviews: Job OK (74d69964-299d-4bc3-99dd-ef777c0ec227)
00:43:32 Result is kept for 500 seconds
00:43:32 
00:43:32 *** Listening on chapters, profiles, reviews...
00:43:32 reviews: fanfic.jobs.crawl_reviews(12122013) (1a997b3e-f032-474a-b89d-2682f9b66e26)
2017-02-10 00:43:38 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:43:38.337610', 12122013, 244201504, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (511 characters truncated) ... l style="color:gray">chapter 4 . <span data-xutime="1479764262">11/21/2016</span> </small><div style="margin-top:5px">Please update</div></td>\n</tr>'), ('2017-02-10 08:43:38.337615', 12122013, 242943835, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1687291&amp;r ... (1053 characters truncated) ... character development so far, &amp; you aren\'t rushing the plot line. Keep up the good work! Looking forward to chapters 5 soon (:</div></td>\n</tr>'), ('2017-02-10 08:43:38.337617', 12122013, 242053122, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8172494&amp;r ... (892 characters truncated) ... yle="margin-top:5px">Loved this story! Please update! You portrayed the characters so well and . . . I LOVE IT! PLEASE UPDATE SOON!</div></td>\n</tr>'), ('2017-02-10 08:43:38.337619', 12122013, 241564327, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4495780&amp;r ... (923 characters truncated) ... ta-xutime="1473098610">9/5/2016</span> </small><div style="margin-top:5px">Love love love it! Can\'t wait for the next installment!</div></td>\n</tr>'), ('2017-02-10 08:43:38.337621', 12122013, 241385887, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5865914&amp;r ... (1083 characters truncated) ...  was... but I really liked that it wasn\'t co stant bickering and fighting between the marauders and Lily. Keep it up, I need more!</div></td>\n</tr>'), ('2017-02-10 08:43:38.337623', 12122013, 241272388, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8186512&amp;r ... (972 characters truncated) ... style="margin-top:5px">it was a really nice fanfic...who would\'ve thought James was this protective over lily ? it was cute though</div></td>\n</tr>'), ('2017-02-10 08:43:38.337625', 12122013, 244201504, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (511 characters truncated) ... l style="color:gray">chapter 4 . <span data-xutime="1479764262">11/21/2016</span> </small><div style="margin-top:5px">Please update</div></td>\n</tr>'), ('2017-02-10 08:43:38.337627', 12122013, 242943835, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1687291&amp;r ... (1053 characters truncated) ... character development so far, &amp; you aren\'t rushing the plot line. Keep up the good work! Looking forward to chapters 5 soon (:</div></td>\n</tr>')  ... displaying 10 of 12 total bound parameter sets ...  ('2017-02-10 08:43:38.337632', 12122013, 241385887, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5865914&amp;r ... (1083 characters truncated) ...  was... but I really liked that it wasn\'t co stant bickering and fighting between the marauders and Lily. Keep it up, I need more!</div></td>\n</tr>'), ('2017-02-10 08:43:38.337634', 12122013, 241272388, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8186512&amp;r ... (972 characters truncated) ... style="margin-top:5px">it was a really nice fanfic...who would\'ve thought James was this protective over lily ? it was cute though</div></td>\n</tr>'))]
00:43:38 reviews: Job OK (1a997b3e-f032-474a-b89d-2682f9b66e26)
00:43:38 Result is kept for 500 seconds
00:43:38 
00:43:38 *** Listening on chapters, profiles, reviews...
00:43:38 reviews: fanfic.jobs.crawl_reviews(12122125) (835b8ae9-3645-4d1c-b959-2916dfe4bf2b)
00:44:01 reviews: Job OK (835b8ae9-3645-4d1c-b959-2916dfe4bf2b)
00:44:01 Result is kept for 500 seconds
00:44:01 
00:44:01 *** Listening on chapters, profiles, reviews...
00:44:01 reviews: fanfic.jobs.crawl_reviews(12123765) (2ec2309e-e5e5-41e4-a716-5bec9d3fcf79)
00:44:32 reviews: Job OK (2ec2309e-e5e5-41e4-a716-5bec9d3fcf79)
00:44:32 Result is kept for 500 seconds
00:44:32 
00:44:32 *** Listening on chapters, profiles, reviews...
00:44:32 reviews: fanfic.jobs.crawl_reviews(12124000) (741d3d5d-5f3b-4e63-a8eb-a2c1b8ee8f0a)
00:44:53 reviews: Job OK (741d3d5d-5f3b-4e63-a8eb-a2c1b8ee8f0a)
00:44:53 Result is kept for 500 seconds
00:44:53 
00:44:53 *** Listening on chapters, profiles, reviews...
00:44:53 reviews: fanfic.jobs.crawl_reviews(12124827) (b192b823-baa8-4b57-aff5-cfb9ce645330)
00:45:21 reviews: Job OK (b192b823-baa8-4b57-aff5-cfb9ce645330)
00:45:21 Result is kept for 500 seconds
00:45:21 
00:45:21 *** Listening on chapters, profiles, reviews...
00:45:21 reviews: fanfic.jobs.crawl_reviews(12125300) (ef519264-7be2-4415-b3d0-d22bb7b122be)
00:45:59 reviews: Job OK (ef519264-7be2-4415-b3d0-d22bb7b122be)
00:45:59 Result is kept for 500 seconds
00:45:59 
00:45:59 *** Listening on chapters, profiles, reviews...
00:45:59 reviews: fanfic.jobs.crawl_reviews(12125463) (f15071c6-70af-4e83-976d-2413591a0d6a)
00:46:35 reviews: Job OK (f15071c6-70af-4e83-976d-2413591a0d6a)
00:46:35 Result is kept for 500 seconds
00:46:35 
00:46:35 *** Listening on chapters, profiles, reviews...
00:46:35 reviews: fanfic.jobs.crawl_reviews(12125851) (c98b7ece-7f71-4736-a1ab-7b8dadbda3bd)
00:46:41 reviews: Job OK (c98b7ece-7f71-4736-a1ab-7b8dadbda3bd)
00:46:41 Result is kept for 500 seconds
00:46:41 
00:46:41 *** Listening on chapters, profiles, reviews...
00:46:41 reviews: fanfic.jobs.crawl_reviews(12125943) (08140f4e-c7ed-424b-b638-3691d2c9bfaf)
00:46:54 reviews: Job OK (08140f4e-c7ed-424b-b638-3691d2c9bfaf)
00:46:54 Result is kept for 500 seconds
00:46:54 
00:46:54 *** Listening on chapters, profiles, reviews...
00:46:54 reviews: fanfic.jobs.crawl_reviews(12128399) (d33a6a23-b627-4a25-bf31-5f0f61bb9cf5)
00:47:06 reviews: Job OK (d33a6a23-b627-4a25-bf31-5f0f61bb9cf5)
00:47:06 Result is kept for 500 seconds
00:47:06 
00:47:06 *** Listening on chapters, profiles, reviews...
00:47:06 reviews: fanfic.jobs.crawl_reviews(12129370) (2ca73c0d-25e9-418a-9c16-1aac118de39c)
00:49:15 reviews: Job OK (2ca73c0d-25e9-418a-9c16-1aac118de39c)
00:49:15 Result is kept for 500 seconds
00:49:15 
00:49:15 *** Listening on chapters, profiles, reviews...
00:49:15 reviews: fanfic.jobs.crawl_reviews(12129426) (2d653548-4a5a-469d-b8da-3d17e06d9ecc)
00:51:09 reviews: Job OK (2d653548-4a5a-469d-b8da-3d17e06d9ecc)
00:51:09 Result is kept for 500 seconds
00:51:09 
00:51:09 *** Listening on chapters, profiles, reviews...
00:51:09 reviews: fanfic.jobs.crawl_reviews(12131161) (50fb6104-c405-4f50-95f7-811c0a919044)
2017-02-10 00:51:13 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:51:13.959177', 12131161, 245339101, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (542 characters truncated) ... 0 . <span data-xutime="1482660902">12/25/2016</span> </small><div style="margin-top:5px">OMG shil i read it lovvvvvveddddddd ittttt</div></td>\n</tr>'), ('2017-02-10 08:51:13.959182', 12131161, 245252012, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1874231&amp;r ... (978 characters truncated) ... l><div style="margin-top:5px">This is a really well written original story. I like that you followed the books more than the movies</div></td>\n</tr>'), ('2017-02-10 08:51:13.959185', 12131161, 244495608, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8411147&amp;r ... (922 characters truncated) ... ord I can form. Very well written and captivating. I hope you choose to continue as I a utterly enthralled by this hell of a twist.</div></td>\n</tr>'), ('2017-02-10 08:51:13.959187', 12131161, 242784387, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (531 characters truncated) ... chapter 18 . <span data-xutime="1475928808">10/8/2016</span> </small><div style="margin-top:5px">chapter 18- Amazing chapter!:-):-)</div></td>\n</tr>'), ('2017-02-10 08:51:13.959189', 12131161, 242727353, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1480375&amp;r ... (884 characters truncated) ...  style="color:gray">chapter 18 . <span data-xutime="1475964222">10/8/2016</span> </small><div style="margin-top:5px">Awaiting more.</div></td>\n</tr>'), ('2017-02-10 08:51:13.959191', 12131161, 242418092, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1480375&amp;r ... (884 characters truncated) ...  style="color:gray">chapter 16 . <span data-xutime="1475177976">9/29/2016</span> </small><div style="margin-top:5px">Awaiting more.</div></td>\n</tr>'), ('2017-02-10 08:51:13.959193', 12131161, 241928434, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8255071&amp;r ... (936 characters truncated) ... 1473958108">9/15/2016</span> </small><div style="margin-top:5px">another lovable CLIFFHANGER :-):-(( this chapter is "THE BEST" :))</div></td>\n</tr>'), ('2017-02-10 08:51:13.959195', 12131161, 241810868, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (713 characters truncated) ...  treat for me:-) u did a great work.. waiting for ur upcoming chapters... pls post it at as soon as possible! dont make us wait:(((</div></td>\n</tr>')  ... displaying 10 of 26 total bound parameter sets ...  ('2017-02-10 08:51:13.959229', 12131161, 241570754, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1480375&amp;r ... (882 characters truncated) ... ll style="color:gray">chapter 9 . <span data-xutime="1473110645">9/5/2016</span> </small><div style="margin-top:5px">Awaiting more.</div></td>\n</tr>'), ('2017-02-10 08:51:13.959231', 12131161, 241448730, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=699432&amp;rw ... (878 characters truncated) ... pan> </small><div style="margin-top:5px">I like the sound of this so far. I\'ve been looking for a good new Sirius story to read :)</div></td>\n</tr>'))]
00:51:13 reviews: Job OK (50fb6104-c405-4f50-95f7-811c0a919044)
00:51:13 Result is kept for 500 seconds
00:51:13 
00:51:13 *** Listening on chapters, profiles, reviews...
00:51:13 reviews: fanfic.jobs.crawl_reviews(12131274) (ea7ee981-455b-4840-aee7-0cbe54785333)
00:51:36 reviews: Job OK (ea7ee981-455b-4840-aee7-0cbe54785333)
00:51:36 Result is kept for 500 seconds
00:51:36 
00:51:36 *** Listening on chapters, profiles, reviews...
00:51:36 reviews: fanfic.jobs.crawl_reviews(12132319) (51298c05-7a15-4ce4-9852-30d89338498c)
2017-02-10 00:51:41 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:51:41.972184', 12132319, 246269839, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (539 characters truncated) ...  36 . <span data-xutime="1484641746">1/17</span> </small><div style="margin-top:5px">next one? please! let us know when you post it</div></td>\n</tr>'), ('2017-02-10 08:51:41.972191', 12132319, 246128863, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (514 characters truncated) ... tyle="color:gray">chapter 36 . <span data-xutime="1484325003">1/13</span> </small><div style="margin-top:5px">cant wait for book 5!</div></td>\n</tr>'), ('2017-02-10 08:51:41.972193', 12132319, 246019512, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=625434&amp;rw ... (1057 characters truncated) ... r her with one of the twins, *shrugs* their two of my favorite characters, so I love pairing them with ocs :) can\'t wait for more!</div></td>\n</tr>'), ('2017-02-10 08:51:41.972196', 12132319, 244370467, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3807234&amp;r ... (1212 characters truncated) ...  one of the Weasley twins? But, what ever direction you take her involvement in the story, I\'m sure it\'ll be great :) Keep it up!</div></td>\n</tr>'), ('2017-02-10 08:51:41.972198', 12132319, 243789328, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4142997&amp;r ... (1229 characters truncated) ... nda thought you would pair her with a Weasley twin just by their interactions but whoever she ends up with will be great I\'m sure.</div></td>\n</tr>'), ('2017-02-10 08:51:41.972200', 12132319, 241604135, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (1033 characters truncated) ...  days but finally I have read all the chapters! They are amazing! I wonder what Alicia will do in year 5. Update soon! Ciao ciao ;)</div></td>\n</tr>'), ('2017-02-10 08:51:41.972202', 12132319, 241486055, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5577791&amp;r ... (910 characters truncated) ... top:5px">Damn you update and finished a story in one day! I was wondering why I had so many emails! It will take me a while to read</div></td>\n</tr>'), ('2017-02-10 08:51:41.972204', 12132319, 246269839, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (539 characters truncated) ...  36 . <span data-xutime="1484641746">1/17</span> </small><div style="margin-top:5px">next one? please! let us know when you post it</div></td>\n</tr>')  ... displaying 10 of 14 total bound parameter sets ...  ('2017-02-10 08:51:41.972215', 12132319, 241604135, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6044320&amp;r ... (1033 characters truncated) ...  days but finally I have read all the chapters! They are amazing! I wonder what Alicia will do in year 5. Update soon! Ciao ciao ;)</div></td>\n</tr>'), ('2017-02-10 08:51:41.972217', 12132319, 241486055, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5577791&amp;r ... (910 characters truncated) ... top:5px">Damn you update and finished a story in one day! I was wondering why I had so many emails! It will take me a while to read</div></td>\n</tr>'))]
00:51:41 reviews: Job OK (51298c05-7a15-4ce4-9852-30d89338498c)
00:51:41 Result is kept for 500 seconds
00:51:42 
00:51:42 *** Listening on chapters, profiles, reviews...
00:51:42 reviews: fanfic.jobs.crawl_reviews(12132374) (f1ce727b-457e-48cc-9ef3-285f571b9280)
00:53:49 reviews: Job OK (f1ce727b-457e-48cc-9ef3-285f571b9280)
00:53:49 Result is kept for 500 seconds
00:53:49 
00:53:49 *** Listening on chapters, profiles, reviews...
00:53:49 reviews: fanfic.jobs.crawl_reviews(12133667) (85062f72-f62c-411a-89d6-457103302500)
2017-02-10 00:53:54 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:53:54.302797', 12133667, 246431593, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8682277&amp;r ... (939 characters truncated) ... "1485209265">1/23</span> </small><div style="margin-top:5px">You know... I had feels once... And now poof...feels...gone...murdered</div></td>\n</tr>'), ('2017-02-10 08:53:54.302803', 12133667, 246278367, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8420564&amp;r ... (904 characters truncated) ... px">I\'m crying so hard my soul hurts. It ended beautifully and I have a feeling the story will stay with me for the next few days.</div></td>\n</tr>'), ('2017-02-10 08:53:54.302805', 12133667, 245846175, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=3039893&amp;r ... (921 characters truncated) ... data-xutime="1483829360">1/7</span> </small><div style="margin-top:5px">I love this story so much. :) you\'re doing a marvelous job</div></td>\n</tr>'), ('2017-02-10 08:53:54.302808', 12133667, 245078676, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=2219856&amp;r ... (1024 characters truncated) ... , not sure I\'m going to be able to read any more of this. I get that it\'s character arc, and totally your story but jesus christ!</div></td>\n</tr>'), ('2017-02-10 08:53:54.302810', 12133667, 243257837, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1030 characters truncated) ... eaning ("I want Remus to know exactly what\'s happening" possibly my favourite moment).<br>\nSo yeah, just thought I\'d add that :)</div></td>\n</tr>'), ('2017-02-10 08:53:54.302812', 12133667, 243254474, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1032 characters truncated) ...  with Sirius (not that I ever needed much help) as well as Rose and Leo. And making me hate Bill Weasley, just a little bit though.</div></td>\n</tr>'), ('2017-02-10 08:53:54.302814', 12133667, 242972931, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (599 characters truncated) ... ll><div style="margin-top:5px">Omg I love this story so many parts almost made me cry! Please post on quotev if you get the chance!</div></td>\n</tr>'), ('2017-02-10 08:53:54.302816', 12133667, 242959489, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (554 characters truncated) ... a-xutime="1476386947">10/13/2016</span> </small><div style="margin-top:5px">An utterly beautiful read. I\'d say, 3 hours well spent</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-10 08:53:54.302856', 12133667, 241767312, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8093752&amp;r ... (948 characters truncated) ... nish. I\'m off to see if you\'ve created anymore stories. A fantastic read, which like a book I honestly couldn\'t put down. Bravo!</div></td>\n</tr>'), ('2017-02-10 08:53:54.302858', 12133667, 241614764, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (564 characters truncated) ... 1473034111">9/4/2016</span> </small><div style="margin-top:5px">This. Was. Beautiful. Thank you so much for sharing your creativity</div></td>\n</tr>'))]
00:53:54 reviews: Job OK (85062f72-f62c-411a-89d6-457103302500)
00:53:54 Result is kept for 500 seconds
00:53:54 
00:53:54 *** Listening on chapters, profiles, reviews...
00:53:54 reviews: fanfic.jobs.crawl_reviews(12133957) (79e35a31-170b-4635-90fa-99a50419e309)
2017-02-10 00:53:59 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:53:59.450771', 12133957, 242712013, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5698907&amp;r ... (915 characters truncated) ... xutime="1475925603">10/8/2016</span> </small><div style="margin-top:5px">You forgot to have Fluer talk with the redheaded Slytherin</div></td>\n</tr>'), ('2017-02-10 08:53:59.450776', 12133957, 242712013, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5698907&amp;r ... (915 characters truncated) ... xutime="1475925603">10/8/2016</span> </small><div style="margin-top:5px">You forgot to have Fluer talk with the redheaded Slytherin</div></td>\n</tr>'))]
00:53:59 reviews: Job OK (79e35a31-170b-4635-90fa-99a50419e309)
00:53:59 Result is kept for 500 seconds
00:53:59 
00:53:59 *** Listening on chapters, profiles, reviews...
00:53:59 reviews: fanfic.jobs.crawl_reviews(12136589) (34c8f9a0-6b35-4ac5-8f28-67561b57bd9c)
00:54:40 reviews: Job OK (34c8f9a0-6b35-4ac5-8f28-67561b57bd9c)
00:54:40 Result is kept for 500 seconds
00:54:40 Cleaning registries for queue: chapters
00:54:40 Cleaning registries for queue: profiles
00:54:40 Cleaning registries for queue: reviews
00:54:40 
00:54:40 *** Listening on chapters, profiles, reviews...
00:54:40 reviews: fanfic.jobs.crawl_reviews(12136997) (8aebc72c-cdd4-44c6-a613-fd368dbb813c)
00:55:30 reviews: Job OK (8aebc72c-cdd4-44c6-a613-fd368dbb813c)
00:55:30 Result is kept for 500 seconds
00:55:30 
00:55:30 *** Listening on chapters, profiles, reviews...
00:55:30 reviews: fanfic.jobs.crawl_reviews(12139336) (a8cbafa8-8a87-4fd1-8269-af3154692662)
00:55:56 reviews: Job OK (a8cbafa8-8a87-4fd1-8269-af3154692662)
00:55:56 Result is kept for 500 seconds
00:55:56 
00:55:56 *** Listening on chapters, profiles, reviews...
00:55:56 reviews: fanfic.jobs.crawl_reviews(12139909) (c28bf988-54f2-49e0-8ff1-be8729d5dcf8)
00:56:08 reviews: Job OK (c28bf988-54f2-49e0-8ff1-be8729d5dcf8)
00:56:08 Result is kept for 500 seconds
00:56:08 
00:56:08 *** Listening on chapters, profiles, reviews...
00:56:08 reviews: fanfic.jobs.crawl_reviews(12140324) (bd676ba9-26f7-4df6-8377-c548d6816a5f)
00:58:02 reviews: Job OK (bd676ba9-26f7-4df6-8377-c548d6816a5f)
00:58:02 Result is kept for 500 seconds
00:58:02 
00:58:02 *** Listening on chapters, profiles, reviews...
00:58:02 reviews: fanfic.jobs.crawl_reviews(12140556) (8da60c46-080f-479e-a8af-aa00d06e86c9)
2017-02-10 00:58:06 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 08:58:06.202903', 12140556, 245236328, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6013157&amp;r ... (1551 characters truncated) ... on of better authors of fanfiction they know they and their betas may miss things and appreciate help in catching the small things.</div></td>\n</tr>'), ('2017-02-10 08:58:06.202907', 12140556, 244391374, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8226175&amp;r ... (967 characters truncated) ...  hogwarts years where becoming a thing of the past. However this story, and a few others, have givin me hope. I thank you for that.</div></td>\n</tr>'), ('2017-02-10 08:58:06.202909', 12140556, 244377248, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1577229&amp;r ... (1058 characters truncated) ...  as it has some kind of gibberish about margins mixed in with the actual text. Just thought I\'d let you know. Overall great story.</div></td>\n</tr>'), ('2017-02-10 08:58:06.202911', 12140556, 244376279, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5025096&amp;r ... (878 characters truncated) ... color:gray">chapter 8 . <span data-xutime="1480231555">11/26/2016</span> </small><div style="margin-top:5px">Something goofed here.</div></td>\n</tr>'), ('2017-02-10 08:58:06.202913', 12140556, 244363869, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5176107&amp;r ... (798 characters truncated) ... tyle="color:gray">chapter 4 . <span data-xutime="1480205875">11/26/2016</span> </small><div style="margin-top:5px">Is this a slash?</div></td>\n</tr>'), ('2017-02-10 08:58:06.202915', 12140556, 244363635, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (633 characters truncated) ... Love the story it\'s different which I like but I can\'t read the last chapter #s and random symbols are everywhere hope you fix it</div></td>\n</tr>'), ('2017-02-10 08:58:06.202917', 12140556, 244361295, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1168170&amp;r ... (1066 characters truncated) ...  having problems to read because of the way it was show up. It\'s very distracting. Otherwise keep up the good work on the writing.</div></td>\n</tr>'), ('2017-02-10 08:58:06.202919', 12140556, 243754916, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (555 characters truncated) ... ta-xutime="1478575965">11/7/2016</span> </small><div style="margin-top:5px">I enjoyed your complexity of your characters. Well done</div></td>\n</tr>')  ... displaying 10 of 30 total bound parameter sets ...  ('2017-02-10 08:58:06.202958', 12140556, 242404974, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (567 characters truncated) ... 491">9/29/2016</span> </small><div style="margin-top:5px">I like te way this story is turning out, I would love to see it evolve...</div></td>\n</tr>'), ('2017-02-10 08:58:06.202959', 12140556, 241684200, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4757113&amp;r ... (872 characters truncated) ... <small style="color:gray">chapter 1 . <span data-xutime="1473378366">9/8/2016</span> </small><div style="margin-top:5px">I love it.</div></td>\n</tr>'))]
00:58:06 reviews: Job OK (8da60c46-080f-479e-a8af-aa00d06e86c9)
00:58:06 Result is kept for 500 seconds
00:58:06 
00:58:06 *** Listening on chapters, profiles, reviews...
00:58:06 reviews: fanfic.jobs.crawl_reviews(12140599) (3594fb7c-2c98-4128-9e73-affe9debb059)
00:58:36 reviews: Job OK (3594fb7c-2c98-4128-9e73-affe9debb059)
00:58:36 Result is kept for 500 seconds
00:58:36 
00:58:36 *** Listening on chapters, profiles, reviews...
00:58:36 reviews: fanfic.jobs.crawl_reviews(12141020) (30b7ad45-98cf-412e-96ab-6e789158436e)
00:59:19 reviews: Job OK (30b7ad45-98cf-412e-96ab-6e789158436e)
00:59:19 Result is kept for 500 seconds
00:59:19 
00:59:19 *** Listening on chapters, profiles, reviews...
00:59:19 reviews: fanfic.jobs.crawl_reviews(12141684) (a7a1d46b-fc7b-4cd5-903f-192c00cd52e7)
01:02:47 reviews: Job OK (a7a1d46b-fc7b-4cd5-903f-192c00cd52e7)
01:02:47 Result is kept for 500 seconds
01:02:47 
01:02:47 *** Listening on chapters, profiles, reviews...
01:02:47 reviews: fanfic.jobs.crawl_reviews(12142175) (54a869c5-4458-4db9-9ed9-419d7b863996)
01:03:14 reviews: Job OK (54a869c5-4458-4db9-9ed9-419d7b863996)
01:03:14 Result is kept for 500 seconds
01:03:14 
01:03:14 *** Listening on chapters, profiles, reviews...
01:03:14 reviews: fanfic.jobs.crawl_reviews(12147559) (12706de1-a9ce-452f-9b8c-a1addc7d013e)
01:03:23 reviews: Job OK (12706de1-a9ce-452f-9b8c-a1addc7d013e)
01:03:23 Result is kept for 500 seconds
01:03:23 
01:03:23 *** Listening on chapters, profiles, reviews...
01:03:23 reviews: fanfic.jobs.crawl_reviews(12148453) (fe910225-eacc-468d-9b86-3b33842318fd)
01:04:09 reviews: Job OK (fe910225-eacc-468d-9b86-3b33842318fd)
01:04:09 Result is kept for 500 seconds
01:04:09 
01:04:09 *** Listening on chapters, profiles, reviews...
01:04:09 reviews: fanfic.jobs.crawl_reviews(12148810) (2645b10e-8b4c-44fa-8e1e-67a7cf5ceece)
01:04:40 reviews: Job OK (2645b10e-8b4c-44fa-8e1e-67a7cf5ceece)
01:04:40 Result is kept for 500 seconds
01:04:40 
01:04:40 *** Listening on chapters, profiles, reviews...
01:04:40 reviews: fanfic.jobs.crawl_reviews(12149882) (43c32877-2acf-4f55-b8e6-0d5467ffa68d)
01:05:08 reviews: Job OK (43c32877-2acf-4f55-b8e6-0d5467ffa68d)
01:05:08 Result is kept for 500 seconds
01:05:08 
01:05:08 *** Listening on chapters, profiles, reviews...
01:05:08 reviews: fanfic.jobs.crawl_reviews(12149921) (8f8d2e85-ab69-4358-8aa0-480e8a9cf43e)
01:06:07 reviews: Job OK (8f8d2e85-ab69-4358-8aa0-480e8a9cf43e)
01:06:07 Result is kept for 500 seconds
01:06:07 
01:06:07 *** Listening on chapters, profiles, reviews...
01:06:07 reviews: fanfic.jobs.crawl_reviews(12154483) (33e2a93d-9049-4cd6-8ccb-2728236d38cb)
01:06:12 reviews: Job OK (33e2a93d-9049-4cd6-8ccb-2728236d38cb)
01:06:12 Result is kept for 500 seconds
01:06:12 
01:06:12 *** Listening on chapters, profiles, reviews...
01:06:12 reviews: fanfic.jobs.crawl_reviews(12155794) (8bf3130f-08c5-46cc-abd5-f9ff4ca229b8)
01:10:09 reviews: Job OK (8bf3130f-08c5-46cc-abd5-f9ff4ca229b8)
01:10:09 Result is kept for 500 seconds
01:10:09 
01:10:09 *** Listening on chapters, profiles, reviews...
01:10:09 reviews: fanfic.jobs.crawl_reviews(12155892) (240ad7aa-a61b-4fcb-bd27-8798f64200ba)
01:10:42 reviews: Job OK (240ad7aa-a61b-4fcb-bd27-8798f64200ba)
01:10:42 Result is kept for 500 seconds
01:10:42 
01:10:42 *** Listening on chapters, profiles, reviews...
01:10:42 reviews: fanfic.jobs.crawl_reviews(12156831) (de187a00-55c8-405b-ae8a-17f4ad4fe1c6)
01:10:56 reviews: Job OK (de187a00-55c8-405b-ae8a-17f4ad4fe1c6)
01:10:56 Result is kept for 500 seconds
01:10:56 
01:10:56 *** Listening on chapters, profiles, reviews...
01:10:56 reviews: fanfic.jobs.crawl_reviews(12157995) (ce812570-68cf-44cd-8959-213d38700e0b)
01:12:13 reviews: Job OK (ce812570-68cf-44cd-8959-213d38700e0b)
01:12:13 Result is kept for 500 seconds
01:12:13 
01:12:13 *** Listening on chapters, profiles, reviews...
01:12:13 reviews: fanfic.jobs.crawl_reviews(12159442) (7ef6ae71-3be4-4e3c-8b80-c7d3d211d0a4)
01:12:29 reviews: Job OK (7ef6ae71-3be4-4e3c-8b80-c7d3d211d0a4)
01:12:29 Result is kept for 500 seconds
01:12:29 
01:12:29 *** Listening on chapters, profiles, reviews...
01:12:29 reviews: fanfic.jobs.crawl_reviews(12160099) (951f9cf2-346a-4d89-b704-9d66e14f967c)
01:12:57 reviews: Job OK (951f9cf2-346a-4d89-b704-9d66e14f967c)
01:12:57 Result is kept for 500 seconds
01:12:57 
01:12:57 *** Listening on chapters, profiles, reviews...
01:12:57 reviews: fanfic.jobs.crawl_reviews(12161705) (4b751446-fb47-4366-b062-20ee834cee3a)
01:13:28 reviews: Job OK (4b751446-fb47-4366-b062-20ee834cee3a)
01:13:28 Result is kept for 500 seconds
01:13:28 
01:13:28 *** Listening on chapters, profiles, reviews...
01:13:28 reviews: fanfic.jobs.crawl_reviews(12161743) (c1156ab7-5e88-4360-8014-a3ef828fb27e)
01:13:42 reviews: Job OK (c1156ab7-5e88-4360-8014-a3ef828fb27e)
01:13:42 Result is kept for 500 seconds
01:13:42 
01:13:42 *** Listening on chapters, profiles, reviews...
01:13:42 reviews: fanfic.jobs.crawl_reviews(12162482) (5da8da38-f861-41cd-bc06-da5643ca4d8f)
01:13:53 reviews: Job OK (5da8da38-f861-41cd-bc06-da5643ca4d8f)
01:13:53 Result is kept for 500 seconds
01:13:53 
01:13:53 *** Listening on chapters, profiles, reviews...
01:13:53 reviews: fanfic.jobs.crawl_reviews(12162989) (6eb9830c-42e4-4522-8c3b-6dc2aa300d44)
01:14:05 reviews: Job OK (6eb9830c-42e4-4522-8c3b-6dc2aa300d44)
01:14:05 Result is kept for 500 seconds
01:14:05 
01:14:05 *** Listening on chapters, profiles, reviews...
01:14:05 reviews: fanfic.jobs.crawl_reviews(12163829) (96b285cc-bf11-4530-ba9f-a638146b291b)
01:14:17 reviews: Job OK (96b285cc-bf11-4530-ba9f-a638146b291b)
01:14:17 Result is kept for 500 seconds
01:14:17 
01:14:17 *** Listening on chapters, profiles, reviews...
01:14:17 reviews: fanfic.jobs.crawl_reviews(12164024) (7c2e0c72-bc77-4686-89f5-e7af3f388576)
01:28:51 reviews: Job OK (7c2e0c72-bc77-4686-89f5-e7af3f388576)
01:28:51 Result is kept for 500 seconds
01:28:51 
01:28:51 *** Listening on chapters, profiles, reviews...
01:28:51 reviews: fanfic.jobs.crawl_reviews(12164757) (483b7377-f733-4092-8723-6eb0ec6618ff)
01:29:22 reviews: Job OK (483b7377-f733-4092-8723-6eb0ec6618ff)
01:29:22 Result is kept for 500 seconds
01:29:22 
01:29:22 *** Listening on chapters, profiles, reviews...
01:29:22 reviews: fanfic.jobs.crawl_reviews(12167909) (9464107c-0a5e-42de-a1ec-f784610f0c96)
01:30:25 reviews: Job OK (9464107c-0a5e-42de-a1ec-f784610f0c96)
01:30:25 Result is kept for 500 seconds
01:30:25 
01:30:25 *** Listening on chapters, profiles, reviews...
01:30:25 reviews: fanfic.jobs.crawl_reviews(12168024) (01320754-5d1b-4a50-8b82-b25ad63c2b65)
2017-02-10 01:30:30 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 09:30:30.783002', 12168024, 246746697, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7332197&amp;r ... (796 characters truncated) ... :gray">chapter 1 . <span data-xutime="1485987244">2/1</span> </small><div style="margin-top:5px">750000 words... for smut. Im done.</div></td>\n</tr>'), ('2017-02-10 09:30:30.783006', 12168024, 246746697, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7332197&amp;r ... (796 characters truncated) ... :gray">chapter 1 . <span data-xutime="1485987244">2/1</span> </small><div style="margin-top:5px">750000 words... for smut. Im done.</div></td>\n</tr>'))]
01:30:30 reviews: Job OK (01320754-5d1b-4a50-8b82-b25ad63c2b65)
01:30:30 Result is kept for 500 seconds
01:30:30 
01:30:30 *** Listening on chapters, profiles, reviews...
01:30:30 reviews: fanfic.jobs.crawl_reviews(12168211) (bb3c6ca6-6d6b-4437-bc72-f93ccc3d4d86)
01:30:46 reviews: Job OK (bb3c6ca6-6d6b-4437-bc72-f93ccc3d4d86)
01:30:46 Result is kept for 500 seconds
01:30:46 
01:30:46 *** Listening on chapters, profiles, reviews...
01:30:46 reviews: fanfic.jobs.crawl_reviews(12168521) (7ce9cf89-e93f-444a-b224-07d5ec199898)
01:32:06 reviews: Job OK (7ce9cf89-e93f-444a-b224-07d5ec199898)
01:32:06 Result is kept for 500 seconds
01:32:06 
01:32:06 *** Listening on chapters, profiles, reviews...
01:32:06 reviews: fanfic.jobs.crawl_reviews(12169679) (0674d7d3-2f53-44a6-9bf8-183e6e62630d)
01:32:19 reviews: Job OK (0674d7d3-2f53-44a6-9bf8-183e6e62630d)
01:32:19 Result is kept for 500 seconds
01:32:19 
01:32:19 *** Listening on chapters, profiles, reviews...
01:32:19 reviews: fanfic.jobs.crawl_reviews(12170267) (c38ab2dc-d949-43df-aef0-a433f10742bf)
2017-02-10 01:32:24 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 09:32:24.851243', 12170267, 246391714, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7858204&amp;r ... (860 characters truncated) ... 22</span> </small><div style="margin-top:5px">I choked when he told her why he liked the book. Oh. My. God. Stab through the heart.</div></td>\n</tr>'), ('2017-02-10 09:32:24.851248', 12170267, 244125442, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (604 characters truncated) ... v style="margin-top:5px">Just finished reading this in one sitting as I am sick in bed. It was so sweet. I loved it. Thank you xoxo</div></td>\n</tr>'), ('2017-02-10 09:32:24.851250', 12170267, 242970561, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4724715&amp;r ... (873 characters truncated) ... 016</span> </small><div style="margin-top:5px">I always have a great time reading your stories, thank you for sharing them with us.</div></td>\n</tr>'), ('2017-02-10 09:32:24.851252', 12170267, 242896134, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5316419&amp;r ... (818 characters truncated) ... er 9 . <span data-xutime="1476388568">10/13/2016</span> </small><div style="margin-top:5px">What a great story! Thanks for sharing!</div></td>\n</tr>'), ('2017-02-10 09:32:24.851254', 12170267, 242891694, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5316419&amp;r ... (852 characters truncated) ... 92">10/13/2016</span> </small><div style="margin-top:5px">Loved day 17! This story is making a very dull day much brighter. Thanks!</div></td>\n</tr>'), ('2017-02-10 09:32:24.851256', 12170267, 242889810, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5316419&amp;r ... (954 characters truncated) ... ions and not just healer, patient interactions. Arimus is such a nice touch to the story (But I love owls). On to the next chapter!</div></td>\n</tr>'), ('2017-02-10 09:32:24.851258', 12170267, 242888634, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5316419&amp;r ... (833 characters truncated) ... ta-xutime="1476368154">10/13/2016</span> </small><div style="margin-top:5px">Fantastic first chapter! Can\'t wait to read the rest!</div></td>\n</tr>'), ('2017-02-10 09:32:24.851260', 12170267, 242552645, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1944277&amp;r ... (1045 characters truncated) ... ance to read. Beautiful story I loved every part it was written so well. I\'ve been glued to my phone all day! Thank you for this !</div></td>\n</tr>')  ... displaying 10 of 18 total bound parameter sets ...  ('2017-02-10 09:32:24.851277', 12170267, 242552645, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1944277&amp;r ... (1045 characters truncated) ... ance to read. Beautiful story I loved every part it was written so well. I\'ve been glued to my phone all day! Thank you for this !</div></td>\n</tr>'), ('2017-02-10 09:32:24.851279', 12170267, 242457630, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7931453&amp;r ... (1113 characters truncated) ... reading, a remarkable talent you have there.<br>\nI laughed, I cursed and I cried, especially at the lovely ending.<br>\nThank you.</div></td>\n</tr>'))]
01:32:24 reviews: Job OK (c38ab2dc-d949-43df-aef0-a433f10742bf)
01:32:24 Result is kept for 500 seconds
01:32:24 
01:32:24 *** Listening on chapters, profiles, reviews...
01:32:24 reviews: fanfic.jobs.crawl_reviews(12171387) (e3d4cb87-6bae-43ac-9892-3e4089d005aa)
01:34:16 reviews: Job OK (e3d4cb87-6bae-43ac-9892-3e4089d005aa)
01:34:16 Result is kept for 500 seconds
01:34:16 
01:34:16 *** Listening on chapters, profiles, reviews...
01:34:16 reviews: fanfic.jobs.crawl_reviews(12172231) (431ea147-c486-4187-88df-1070123a0401)
2017-02-10 01:34:21 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 09:34:21.032629', 12172231, 242506242, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6850265&amp;r ... (959 characters truncated) ...  be mad at Scorpius he hasn\'t done anything wrong! still loving this to bits by the way! possibly the best fanfiction I have read!</div></td>\n</tr>'), ('2017-02-10 09:34:21.032633', 12172231, 242488532, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6850265&amp;r ... (976 characters truncated) ... or now and it is so good! literally love all of it! but noooo rose talk to Scorpius!? loving this so much. you have got it perfect!</div></td>\n</tr>'), ('2017-02-10 09:34:21.032635', 12172231, 242506242, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6850265&amp;r ... (959 characters truncated) ...  be mad at Scorpius he hasn\'t done anything wrong! still loving this to bits by the way! possibly the best fanfiction I have read!</div></td>\n</tr>'), ('2017-02-10 09:34:21.032637', 12172231, 242488532, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6850265&amp;r ... (976 characters truncated) ... or now and it is so good! literally love all of it! but noooo rose talk to Scorpius!? loving this so much. you have got it perfect!</div></td>\n</tr>'))]
01:34:21 reviews: Job OK (431ea147-c486-4187-88df-1070123a0401)
01:34:21 Result is kept for 500 seconds
01:34:21 
01:34:21 *** Listening on chapters, profiles, reviews...
01:34:21 reviews: fanfic.jobs.crawl_reviews(12172351) (942560e7-9139-4021-a0c8-8efd44d6f0da)
2017-02-10 01:34:24 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 09:34:24.883028', 12172351, 244034936, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5316419&amp;r ... (897 characters truncated) ... op:5px">Okay...now I kinda wanna slap Severus...but only kinda, and I love when Hermione goes all bookwormy! Another great chapter!</div></td>\n</tr>'), ('2017-02-10 09:34:24.883032', 12172351, 244034249, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=5316419&amp;r ... (846 characters truncated) ... 007">11/16/2016</span> </small><div style="margin-top:5px">I\'m loving this story so much! UGH! I just want to slap Lily right now.</div></td>\n</tr>'), ('2017-02-10 09:34:24.883034', 12172351, 243767010, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7267758&amp;r ... (1061 characters truncated) ... . Severuse reaction! Then jumping to when the baby is sorted into hogwarts! Again fabulous story can\'t wait to here more from you!</div></td>\n</tr>'), ('2017-02-10 09:34:24.883036', 12172351, 243725759, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4724715&amp;r ... (900 characters truncated) ... rgin-top:5px">I am so happy to be able to read your stories again. I am in awe of your talent and thank you for sharing it with us.</div></td>\n</tr>'), ('2017-02-10 09:34:24.883038', 12172351, 243371160, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (677 characters truncated) ... and interweaving the two timelines together. I found the rest of the story elsewhere on the Internet so I\'m happily sated. Thanks!</div></td>\n</tr>'), ('2017-02-10 09:34:24.883040', 12172351, 242978465, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4724715&amp;r ... (906 characters truncated) ... top:5px">The back and forth of the story between times and your development of the tension is fabulous. Thank you for sharing this.</div></td>\n</tr>'), ('2017-02-10 09:34:24.883042', 12172351, 242950376, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7267758&amp;r ... (931 characters truncated) ... astic love this story, I hope Hermione just talks to Severus and doesn\'t judge him for the book of his past. Hope you update soon.</div></td>\n</tr>'), ('2017-02-10 09:34:24.883044', 12172351, 242778753, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8013079&amp;r ... (833 characters truncated) ... span data-xutime="1476082903">10/10/2016</span> </small><div style="margin-top:5px">Hope you could put up the correct chapters. :-)</div></td>\n</tr>')  ... displaying 10 of 24 total bound parameter sets ...  ('2017-02-10 09:34:24.883071', 12172351, 242503192, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4724715&amp;r ... (916 characters truncated) ... now that they each know the story from one perspective, I wonder if he knows the Grey Lady\'s side. Looking forward to finding out.</div></td>\n</tr>'), ('2017-02-10 09:34:24.883073', 12172351, 242484931, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4724715&amp;r ... (919 characters truncated) ... o happy to see this story again! :) I miss being able to reread my favorites and now you are enabling my reading habits, thank you!</div></td>\n</tr>'))]
01:34:24 reviews: Job OK (942560e7-9139-4021-a0c8-8efd44d6f0da)
01:34:24 Result is kept for 500 seconds
01:34:24 
01:34:24 *** Listening on chapters, profiles, reviews...
01:34:24 reviews: fanfic.jobs.crawl_reviews(12177140) (51a6568e-0f2d-4aa8-8333-7af0ab0940d7)
01:34:28 reviews: Job OK (51a6568e-0f2d-4aa8-8333-7af0ab0940d7)
01:34:28 Result is kept for 500 seconds
01:34:28 
01:34:28 *** Listening on chapters, profiles, reviews...
01:34:28 reviews: fanfic.jobs.crawl_reviews(12177542) (0a67b911-a78e-4805-bf1b-ac1e30fcac9b)
01:35:10 reviews: Job OK (0a67b911-a78e-4805-bf1b-ac1e30fcac9b)
01:35:10 Result is kept for 500 seconds
01:35:10 
01:35:10 *** Listening on chapters, profiles, reviews...
01:35:10 reviews: fanfic.jobs.crawl_reviews(12177951) (625d3e49-5dfe-4a0c-877e-0caedefba755)
01:36:00 reviews: Job OK (625d3e49-5dfe-4a0c-877e-0caedefba755)
01:36:00 Result is kept for 500 seconds
01:36:00 
01:36:00 *** Listening on chapters, profiles, reviews...
01:36:00 reviews: fanfic.jobs.crawl_reviews(12181042) (26ca0f65-fe92-4f86-af0d-2d3644f01791)
01:37:02 reviews: Job OK (26ca0f65-fe92-4f86-af0d-2d3644f01791)
01:37:02 Result is kept for 500 seconds
01:37:02 
01:37:02 *** Listening on chapters, profiles, reviews...
01:37:02 reviews: fanfic.jobs.crawl_reviews(12184104) (b59ad0fb-bd19-4073-8710-b0d07b2e4de0)
01:41:19 reviews: Job OK (b59ad0fb-bd19-4073-8710-b0d07b2e4de0)
01:41:19 Result is kept for 500 seconds
01:41:19 
01:41:19 *** Listening on chapters, profiles, reviews...
01:41:19 reviews: fanfic.jobs.crawl_reviews(12188463) (6d66e570-33ac-4751-986e-88097cb4cae3)
01:43:30 reviews: Job OK (6d66e570-33ac-4751-986e-88097cb4cae3)
01:43:30 Result is kept for 500 seconds
01:43:30 
01:43:30 *** Listening on chapters, profiles, reviews...
01:43:30 reviews: fanfic.jobs.crawl_reviews(12190932) (18b4e10a-6c56-46f0-928e-12e919547cf8)
01:44:45 reviews: Job OK (18b4e10a-6c56-46f0-928e-12e919547cf8)
01:44:45 Result is kept for 500 seconds
01:44:45 
01:44:45 *** Listening on chapters, profiles, reviews...
01:44:45 reviews: fanfic.jobs.crawl_reviews(12195574) (c346a47c-2ab7-4016-820d-ef2f820401af)
01:45:49 reviews: Job OK (c346a47c-2ab7-4016-820d-ef2f820401af)
01:45:49 Result is kept for 500 seconds
01:45:49 
01:45:49 *** Listening on chapters, profiles, reviews...
01:45:49 reviews: fanfic.jobs.crawl_reviews(12201337) (a1b463a5-1127-4c6a-8d77-184ed3aecc86)
01:46:48 reviews: Job OK (a1b463a5-1127-4c6a-8d77-184ed3aecc86)
01:46:48 Result is kept for 500 seconds
01:46:48 
01:46:48 *** Listening on chapters, profiles, reviews...
01:46:48 reviews: fanfic.jobs.crawl_reviews(12205182) (2bf8ad4e-22f5-4262-9585-8ef419bf50ae)
01:47:48 reviews: Job OK (2bf8ad4e-22f5-4262-9585-8ef419bf50ae)
01:47:48 Result is kept for 500 seconds
01:47:48 
01:47:48 *** Listening on chapters, profiles, reviews...
01:47:48 reviews: fanfic.jobs.crawl_reviews(12206649) (416db9f7-1717-494b-85d2-faab722bdb84)
2017-02-10 01:47:54 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 09:47:54.176706', 12206649, 246877080, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (1162 characters truncated) ... more of Harry and Scarlett. Ofc this is also your work so keep it up and I hope you enjoy writing it as much as I enjoy reading it.</div></td>\n</tr>'), ('2017-02-10 09:47:54.176713', 12206649, 245676197, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (676 characters truncated) ...  really looking forward to the second instalment! I loved Scarlett! I loved Todd and I loved how you switched up what was going on!</div></td>\n</tr>'), ('2017-02-10 09:47:54.176715', 12206649, 245584543, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1587109&amp;r ... (964 characters truncated) ... /span> </small><div style="margin-top:5px">I just read your whole story and I\'m so in love! I can\'t wait to read what\'s to come!</div></td>\n</tr>'), ('2017-02-10 09:47:54.176717', 12206649, 244542077, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8479034&amp;r ... (849 characters truncated) ... me="1480648464">12/1/2016</span> </small><div style="margin-top:5px">Ooooh I wonder how the rest of the book is going to turn out?!</div></td>\n</tr>'), ('2017-02-10 09:47:54.176719', 12206649, 244403327, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4601509&amp;r ... (944 characters truncated) ... 1/27/2016</span> </small><div style="margin-top:5px">"Oh no." is right...well, that\'s weird that Todd\'s shields weren\'t working.</div></td>\n</tr>'), ('2017-02-10 09:47:54.176721', 12206649, 243872362, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (527 characters truncated) ... or:gray">chapter 9 . <span data-xutime="1478729470">11/9/2016</span> </small><div style="margin-top:5px">Please write more chapters</div></td>\n</tr>'), ('2017-02-10 09:47:54.176723', 12206649, 243751586, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1227366&amp;r ... (1510 characters truncated) ...  really sure where you\'re heading with her, but I look forward to finding out. Hopefully its Harry or Draco. Can\'t wait for more.</div></td>\n</tr>'), ('2017-02-10 09:47:54.176725', 12206649, 243705506, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7285972&amp;r ... (1023 characters truncated) ... arlett and how she play a role with defeating Voldemort I can\'t wait for the next chapter please update soon keep up the good work</div></td>\n</tr>')  ... displaying 10 of 28 total bound parameter sets ...  ('2017-02-10 09:47:54.176760', 12206649, 243397056, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=8263485&amp;r ... (1008 characters truncated) ... ing, I like your OC as many normally put their OC\'s in Gryffindor. I like this story and I am looking forward to the next chapter.</div></td>\n</tr>'), ('2017-02-10 09:47:54.176762', 12206649, 243370328, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=6526556&amp;r ... (884 characters truncated) ... /a>  <small style="color:gray">chapter 1 . <span data-xutime="1477606324">10/27/2016</span> </small><div style="margin-top:5px">NO.</div></td>\n</tr>'))]
01:47:54 reviews: Job OK (416db9f7-1717-494b-85d2-faab722bdb84)
01:47:54 Result is kept for 500 seconds
01:47:54 
01:47:54 *** Listening on chapters, profiles, reviews...
01:47:54 reviews: fanfic.jobs.crawl_reviews(12212219) (13b4da15-73be-496e-9820-d5c0f943aaa5)
2017-02-10 01:47:59 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 09:47:59.703800', 12212219, 247029510, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1174251&amp;r ... (1000 characters truncated) ... art to a story. Would really enjoy reading the rest of it if you continue it. If not then let me know if some one else does please.</div></td>\n</tr>'), ('2017-02-10 09:47:59.703805', 12212219, 246218846, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (660 characters truncated) ... u\'un aurait regardé harry pendant son enfance!<br>\ndans les livres les dursleys ne sont devenus qu\'après l\'incident avec dobby.</div></td>\n</tr>'), ('2017-02-10 09:47:59.703807', 12212219, 244501496, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1030039&amp;r ... (919 characters truncated) ... 5px">i loved loved loved loved loved loved loved loved loved loved loved loved loved loved loved loved loved loved loved was great.</div></td>\n</tr>'), ('2017-02-10 09:47:59.703809', 12212219, 247029510, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1174251&amp;r ... (1000 characters truncated) ... art to a story. Would really enjoy reading the rest of it if you continue it. If not then let me know if some one else does please.</div></td>\n</tr>'), ('2017-02-10 09:47:59.703811', 12212219, 246218846, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="javascript:var%20t%20=%20xwindow(\'https://www.fanfiction ... (660 characters truncated) ... u\'un aurait regardé harry pendant son enfance!<br>\ndans les livres les dursleys ne sont devenus qu\'après l\'incident avec dobby.</div></td>\n</tr>'), ('2017-02-10 09:47:59.703813', 12212219, 244501496, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1030039&amp;r ... (919 characters truncated) ... 5px">i loved loved loved loved loved loved loved loved loved loved loved loved loved loved loved loved loved loved loved was great.</div></td>\n</tr>'))]
01:47:59 reviews: Job OK (13b4da15-73be-496e-9820-d5c0f943aaa5)
01:47:59 Result is kept for 500 seconds
01:47:59 
01:47:59 *** Listening on chapters, profiles, reviews...
01:47:59 reviews: fanfic.jobs.crawl_reviews(12213501) (5d203a70-24d0-4a18-b957-e6b56c16ef41)
01:48:13 reviews: Job OK (5d203a70-24d0-4a18-b957-e6b56c16ef41)
01:48:13 Result is kept for 500 seconds
01:48:13 
01:48:13 *** Listening on chapters, profiles, reviews...
01:48:13 reviews: fanfic.jobs.crawl_reviews(12214186) (3e5a2dc1-7bb1-4543-9322-1ec931a8b3bd)
01:49:49 reviews: Job OK (3e5a2dc1-7bb1-4543-9322-1ec931a8b3bd)
01:49:49 Result is kept for 500 seconds
01:49:49 
01:49:49 *** Listening on chapters, profiles, reviews...
01:49:49 reviews: fanfic.jobs.crawl_reviews(12216403) (386d1501-3ba5-4182-815e-b9df16356f3f)
2017-02-10 01:49:55 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 09:49:55.423120', 12216403, 244570663, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4692464&amp;r ... (959 characters truncated) ... u want more people to read you should cut it in at least 15 chapter. It is not manageable just like throwing 60000w into one chapt!</div></td>\n</tr>'), ('2017-02-10 09:49:55.423125', 12216403, 244538305, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1703795&amp;r ... (1172 characters truncated) ...  him with Draco. The premise was well-put, I found it to be quite interesting and an enjoyable read. Please write more if possible.</div></td>\n</tr>'), ('2017-02-10 09:49:55.423127', 12216403, 243623683, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7615983&amp;r ... (799 characters truncated) ... e="color:gray">chapter 1 . <span data-xutime="1478254789">11/4/2016</span> </small><div style="margin-top:5px">I enjoyed this story</div></td>\n</tr>'), ('2017-02-10 09:49:55.423129', 12216403, 244570663, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=4692464&amp;r ... (959 characters truncated) ... u want more people to read you should cut it in at least 15 chapter. It is not manageable just like throwing 60000w into one chapt!</div></td>\n</tr>'), ('2017-02-10 09:49:55.423131', 12216403, 244538305, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=1703795&amp;r ... (1172 characters truncated) ...  him with Draco. The premise was well-put, I found it to be quite interesting and an enjoyable read. Please write more if possible.</div></td>\n</tr>'), ('2017-02-10 09:49:55.423133', 12216403, 243623683, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=7615983&amp;r ... (799 characters truncated) ... e="color:gray">chapter 1 . <span data-xutime="1478254789">11/4/2016</span> </small><div style="margin-top:5px">I enjoyed this story</div></td>\n</tr>'))]
01:49:55 reviews: Job OK (386d1501-3ba5-4182-815e-b9df16356f3f)
01:49:55 Result is kept for 500 seconds
01:49:55 
01:49:55 *** Listening on chapters, profiles, reviews...
01:49:55 reviews: fanfic.jobs.crawl_reviews(12216705) (17a86808-a333-4853-84a5-73562d291ae6)
2017-02-10 01:50:00 [scrapy] ERROR: Error caught on signal handler: <function Spider.close at 0x105aab840>
Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: review_html.book_id, review_html.review_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/twisted/internet/defer.py", line 150, in maybeDeferred
    result = f(*args, **kw)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/pydispatch/robustapply.py", line 55, in robustApply
    return receiver(*arguments, **named)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/scrapy/spiders/__init__.py", line 90, in close
    return closed(reason)
  File "./fanfic/spiders/book.py", line 37, in closed
    session.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/scoping.py", line 157, in do
    return getattr(self.registry(), name)(*args, **kwargs)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 874, in commit
    self.transaction.commit()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 461, in commit
    self._prepare_impl()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 441, in _prepare_impl
    self.session.flush()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2137, in flush
    self._flush(objects)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2257, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py", line 60, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/session.py", line 2221, in _flush
    flush_context.execute()
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 389, in execute
    rec.execute(self)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/unitofwork.py", line 548, in execute
    uow
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 181, in save_obj
    mapper, table, insert)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/orm/persistence.py", line 799, in _emit_insert_statements
    execute(statement, multiparams)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 945, in execute
    return meth(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/sql/elements.py", line 263, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1053, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1189, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1393, in _handle_dbapi_exception
    exc_info
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 202, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/util/compat.py", line 185, in reraise
    raise value.with_traceback(tb)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/base.py", line 1159, in _execute_context
    context)
  File "/Users/davidmcclure/Projects/fanfic-crawler/env/lib/python3.5/site-packages/sqlalchemy/engine/default.py", line 466, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: review_html.book_id, review_html.review_id [SQL: 'INSERT INTO review_html (scraped_at, book_id, review_id, html) VALUES (?, ?, ?, ?)'] [parameters: (('2017-02-10 09:50:00.615113', 12216705, 243700647, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=624829&amp;rw ... (1151 characters truncated) ...  the more confusing when you have chapter thirty-one in its own section. Just split up the chapters and you might get more readers.</div></td>\n</tr>'), ('2017-02-10 09:50:00.615118', 12216705, 243700647, '<tr>\n\t<td style="padding-top:10px;padding-bottom:10px"><span style="float:right"><a href="https://www.fanfiction.net/pm2/post.php?uid=624829&amp;rw ... (1151 characters truncated) ...  the more confusing when you have chapter thirty-one in its own section. Just split up the chapters and you might get more readers.</div></td>\n</tr>'))]
01:50:00 reviews: Job OK (17a86808-a333-4853-84a5-73562d291ae6)
01:50:00 Result is kept for 500 seconds
01:50:00 
01:50:00 *** Listening on chapters, profiles, reviews...
01:50:00 reviews: fanfic.jobs.crawl_reviews(12217219) (2e20410e-c3aa-4c0a-be85-db61e4d86d3b)
01:50:18 reviews: Job OK (2e20410e-c3aa-4c0a-be85-db61e4d86d3b)
01:50:18 Result is kept for 500 seconds
01:50:18 
01:50:18 *** Listening on chapters, profiles, reviews...
01:50:18 reviews: fanfic.jobs.crawl_reviews(12217715) (79540629-d29b-4b2d-a439-82c6a16197e9)
01:50:55 reviews: Job OK (79540629-d29b-4b2d-a439-82c6a16197e9)
01:50:55 Result is kept for 500 seconds
01:50:55 
01:50:55 *** Listening on chapters, profiles, reviews...
01:50:55 reviews: fanfic.jobs.crawl_reviews(12218484) (05f42b28-f17c-4dfa-b361-1d8e61a00385)
01:51:00 reviews: Job OK (05f42b28-f17c-4dfa-b361-1d8e61a00385)
01:51:00 Result is kept for 500 seconds
01:51:00 
01:51:00 *** Listening on chapters, profiles, reviews...
01:51:00 reviews: fanfic.jobs.crawl_reviews(12220691) (26bef548-09af-4141-b4c1-63d0f6ed6acd)
01:51:10 reviews: Job OK (26bef548-09af-4141-b4c1-63d0f6ed6acd)
01:51:10 Result is kept for 500 seconds
01:51:10 
01:51:10 *** Listening on chapters, profiles, reviews...
01:51:10 reviews: fanfic.jobs.crawl_reviews(12221515) (605d6cae-a427-45a5-96a4-7fad42d39b3d)
01:51:20 reviews: Job OK (605d6cae-a427-45a5-96a4-7fad42d39b3d)
01:51:20 Result is kept for 500 seconds
01:51:20 
01:51:20 *** Listening on chapters, profiles, reviews...
01:51:20 reviews: fanfic.jobs.crawl_reviews(12226895) (059e3ee4-c3e2-46f5-8130-2fdc8e728055)
01:52:29 reviews: Job OK (059e3ee4-c3e2-46f5-8130-2fdc8e728055)
01:52:29 Result is kept for 500 seconds
01:52:29 
01:52:29 *** Listening on chapters, profiles, reviews...
01:52:29 reviews: fanfic.jobs.crawl_reviews(12228434) (ef2b342f-0165-4142-bd64-1560e9f41b02)
01:55:25 reviews: Job OK (ef2b342f-0165-4142-bd64-1560e9f41b02)
01:55:25 Result is kept for 500 seconds
01:55:25 Cleaning registries for queue: chapters
01:55:25 Cleaning registries for queue: profiles
01:55:25 Cleaning registries for queue: reviews
01:55:25 
01:55:25 *** Listening on chapters, profiles, reviews...
01:55:25 reviews: fanfic.jobs.crawl_reviews(12228520) (e9c7c835-f812-4585-9bba-1a8484971b04)
01:56:25 reviews: Job OK (e9c7c835-f812-4585-9bba-1a8484971b04)
01:56:25 Result is kept for 500 seconds
01:56:25 
01:56:25 *** Listening on chapters, profiles, reviews...
01:56:25 reviews: fanfic.jobs.crawl_reviews(12231175) (42cc381c-bb6a-4249-b74a-90be63860f0c)
01:56:31 reviews: Job OK (42cc381c-bb6a-4249-b74a-90be63860f0c)
01:56:31 Result is kept for 500 seconds
01:56:31 
01:56:31 *** Listening on chapters, profiles, reviews...
01:56:31 reviews: fanfic.jobs.crawl_reviews(12240312) (f5d57507-42f1-4adf-baac-75bf4e331db9)
01:56:54 reviews: Job OK (f5d57507-42f1-4adf-baac-75bf4e331db9)
01:56:54 Result is kept for 500 seconds
01:56:54 
01:56:54 *** Listening on chapters, profiles, reviews...
01:56:54 reviews: fanfic.jobs.crawl_reviews(12241223) (ee87af13-4d1c-479b-bbdf-dfbc52e8d1af)
01:57:16 reviews: Job OK (ee87af13-4d1c-479b-bbdf-dfbc52e8d1af)
01:57:16 Result is kept for 500 seconds
01:57:16 
01:57:16 *** Listening on chapters, profiles, reviews...
01:57:16 reviews: fanfic.jobs.crawl_reviews(12250162) (33310896-8832-41e9-a7be-cf36db086d44)
01:57:31 reviews: Job OK (33310896-8832-41e9-a7be-cf36db086d44)
01:57:31 Result is kept for 500 seconds
01:57:31 
01:57:31 *** Listening on chapters, profiles, reviews...
01:57:31 reviews: fanfic.jobs.crawl_reviews(12252218) (6efa06ef-4b1f-4da8-b959-aa0ce16947c5)
01:58:03 reviews: Job OK (6efa06ef-4b1f-4da8-b959-aa0ce16947c5)
01:58:03 Result is kept for 500 seconds
01:58:03 
01:58:03 *** Listening on chapters, profiles, reviews...
01:58:03 reviews: fanfic.jobs.crawl_reviews(12254197) (4bc77164-f0ad-4818-a6e0-27546b624159)
01:58:27 reviews: Job OK (4bc77164-f0ad-4818-a6e0-27546b624159)
01:58:27 Result is kept for 500 seconds
01:58:27 
01:58:27 *** Listening on chapters, profiles, reviews...
01:58:27 reviews: fanfic.jobs.crawl_reviews(12260780) (7c31f8ba-661b-465f-ad86-864968afd1cc)
01:59:34 reviews: Job OK (7c31f8ba-661b-465f-ad86-864968afd1cc)
01:59:34 Result is kept for 500 seconds
01:59:34 
01:59:34 *** Listening on chapters, profiles, reviews...
01:59:34 reviews: fanfic.jobs.crawl_reviews(12266455) (94b51a49-a711-4fc1-b80d-27a676c3a451)
01:59:38 reviews: Job OK (94b51a49-a711-4fc1-b80d-27a676c3a451)
01:59:38 Result is kept for 500 seconds
01:59:38 
01:59:38 *** Listening on chapters, profiles, reviews...
Error 61 connecting to localhost:6379. Connection refused.
